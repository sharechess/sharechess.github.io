!function(){function e(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var t=document.createElement("style");t.innerHTML='.header-box{height:var(--header-height);background-color:var(--color-bg-block);position:absolute;top:0;width:100%;display:grid;grid-template-columns:200px 1fr;font-size:1.8rem}.header__logo{padding:1rem;text-align:left;color:var(--color-text-dimmed)}.header__logo-pic{height:2rem;max-width:200px;background-image:var(--logo-url);background-repeat:no-repeat;background-size:contain}.header__options{padding:0 1rem;text-align:right}.header__options-ico{display:inline-block;font-size:2.4rem;position:relative;top:-.2rem;padding-top:1rem;height:100%;margin-left:.5rem;text-align:center}.header__options-ico,.header__options-ico>a,.header__options-ico>a:visited{color:var(--color-text)}.header__options-ico:hover,.header__options-ico>a:hover{color:var(--color-btn);cursor:pointer}.header__support,.header__support:visited,.header__support:active{position:absolute;top:1rem;max-width:300px;margin:auto;left:50%;transform:translate(-50%);color:#d33e5e}.header__support:hover{text-decoration:none;color:#cf002d}@keyframes beat{to{transform:scale(1.4)}}.header__support-ico{animation:beat .5s 6 alternate;transform-origin:center}.header__support:hover .header__support-ico{animation:beat .5s infinite alternate}@media (orientation: portrait){.header__logo-pic{height:2rem;max-width:130px;background-image:var(--logo-mobile-url)}.header-box{grid-template-columns:140px 1fr}}.scrollable{background:var(--color-bg-block);padding:2rem 1rem 2rem 2rem;height:100%;display:flex;overflow:auto}.scrollable__content{overflow-y:auto;overflow-x:hidden;padding:0;padding-right:1rem;width:100%}.scrollable__content::-webkit-scrollbar{width:.7rem;cursor:pointer}.scrollable__content::-webkit-scrollbar-track{background-color:var(--color-scrollbar-track)}.scrollable__content::-webkit-scrollbar-thumb{background-color:var(--color-scrollbar);outline:1px solid var(--color-scrollbar)}@media (orientation: portrait){.scrollable{height:auto;display:block}}.moves{font-size:1.4rem;font-family:Fira Mono;text-align:left;background-color:var(--color-bg-input)}.moves__turn{text-align:center}.move{padding:3px}.move__id{display:inline-block;width:4rem;text-align:right;margin-right:2rem;color:var(--color-text)}.move__ply{display:inline-block;width:7rem;color:var(--color-btn)}.move__ply--current{color:var(--color-text);background-color:var(--color-highlight)}.move__ply:hover{text-decoration:underline;cursor:pointer}@media (orientation: portrait){.moves{text-align:left}.move{display:inline-block}.move__id,.move__ply{display:inline-block;margin-right:.6rem;width:auto}}@media (orientation: landscape) and (max-height: 400px){.moves{display:none}}.controls-box{grid-area:controls;padding:0 2rem 2rem}.controls{background:var(--color-bg-block);padding:2rem 1rem;border-bottom-left-radius:5px;border-bottom-right-radius:5px}.controls__button{margin:0;padding:.5rem;font-size:3rem;text-align:center;width:4.4rem;height:4.4rem;border-radius:0}.flip__button{margin-left:3px;padding:.5rem;font-size:3rem;text-align:center;border-radius:5px;width:4.4rem;height:4.4rem}.controls__button:hover{background:var(--color-btn-light);cursor:pointer}.controls__button--last{margin-right:3px;border-top-right-radius:5px;border-bottom-right-radius:5px}.controls__button--first{margin-left:0;border-top-left-radius:5px;border-bottom-left-radius:5px}@media (orientation: portrait){.controls-box{padding:0}.controls{background:var(--color-bg-block);padding:1.5rem 0;border-bottom-left-radius:5px;border-bottom-right-radius:5px}.controls__button{margin:0 .8vw;padding:.5rem;font-size:3rem;text-align:center;width:12.8vw;height:12.8vw;max-height:6rem;border-radius:5px}.controls__button--next{width:23vw}.flip__button{margin:0 .8vw;padding:.5rem;font-size:3rem;text-align:center;border-radius:5px;width:12.8vw;height:12.8vw;max-height:6rem}}@media (orientation: landscape) and (max-height: 400px){.controls{padding-top:0}}.info-box{grid-area:controls;padding:0 2rem 2rem}.info{background:var(--color-bg-block);padding:2rem;font-size:1.4rem;text-align:left;position:relative}.info__players{position:relative;line-height:2rem;margin-bottom:2rem;padding:0 1rem}.info__player{display:grid;grid-template-columns:auto 40px}.info__right{text-align:right}.info__rating{font-family:Fira Code,monospace;color:var(--color-text-dimmed)}.info__score{font-family:Fira Code,monospace;color:var(--color-score);margin-left:1rem}.info__color{border-radius:1rem;padding:0;border:solid 2px var(--color-tab);width:1.4rem;height:1.4rem;margin-right:.8rem}.info__color--white{background-color:#eee}.info__color--black{background-color:#111}.info__event{margin-bottom:1rem}.info__event,.info__site{font-size:1.3rem;line-height:1.5rem;color:var(--color-text);padding:0 1rem}.info__header{height:13.1rem}.info__analyze{margin-top:2rem}@media (orientation: portrait){.info__header{height:auto}}.load{background:var(--color-bg-block);border-bottom-left-radius:5px;border-bottom-right-radius:5px}.load__game-input{height:25vh;margin-top:2rem}.load__game-input::-webkit-scrollbar{width:.7rem;cursor:pointer}.load__game-input::-webkit-scrollbar-track{box-shadow:inset 0 0 6px rgba(0,0,0,.5)}.load__game-input::-webkit-scrollbar-thumb{background-color:#003b2f;outline:1px solid rgb(0,59,47)}.load__game-btn{width:100%}.load__pgn-file{margin-top:2rem}.load__pgn-file-info{font-size:1.3rem}.load__pgn-file-info p{margin-top:1rem;color:var(--color-text-dimmed)}.load__link-input{margin-top:2rem}.load__daily-game{margin-top:2rem;font-size:1.4rem;text-align:left;text-transform:capitalize}.load__recent{font-size:1.4rem;text-align:left;list-style:circle}.load__recent-item{margin-bottom:.5rem;margin-left:2rem}.load__recent-options{font-size:1.4rem;text-align:left;margin-top:1rem;color:var(--color-text-dimmed)}.load__recent-delete-item{position:relative;display:none}.load__recent-item:hover .load__recent-delete-item{display:inline}.load__recent-delete-item:hover{cursor:pointer;color:var(--color-warning)}@media (orientation: portrait){.load__game-input{height:20vh}}@media (orientation: landscape) and (max-height: 400px){.load__game-input{height:30vh}}.share{border-bottom-left-radius:5px;border-bottom-right-radius:5px}.share__format,.share__size{padding:.8rem;border-radius:0;margin-bottom:1rem;opacity:.5}.share__format{width:33.33%}.share__size{width:20%}.share__format--first,.share__size--first{border-top-left-radius:5px;border-bottom-left-radius:5px}.share__format--last,.share__size--last{border-top-right-radius:5px;border-bottom-right-radius:5px}.share__format--active,.share__size--active{opacity:1}.share__format--active:hover,.share__size--active:hover{cursor:default}.share__btn{margin-bottom:1rem}.header--first{margin-top:0;margin-bottom:2.5rem}.options__button{margin:3px;padding:.5rem;font-size:3rem;line-height:3rem;text-align:center;border-radius:5px;width:4rem;height:4rem;opacity:.5}.options__button--active{opacity:1}.options__button:hover{background:var(--color-btn-light);cursor:pointer}.options__button--last{margin-right:0}.options__button--first{margin-left:0}.rotatable{transition:transform .3s}.rotated{transform:rotate(180deg)}.stylus{text-align:left;font-size:1.4rem;margin-left:1.5rem;color:var(--color-text);font-family:Fira Mono,monospace}.delimiter{color:var(--color-highlight)}.share__stylus{margin-top:2rem;background-color:var(--color-btn-accent);font-size:2rem;line-height:2rem;padding:1.5rem}.share__stylus:hover{background-color:var(--color-btn-accent-light)}.share__stylus span{font-size:1.2rem;line-height:1.2rem}.boards{text-align:center;border-bottom-left-radius:5px;border-bottom-right-radius:5px}.boards__ico{background-color:transparent!important}.collection{text-align:center;border-bottom-left-radius:5px;border-bottom-right-radius:5px}.collection__cards{padding:0;margin:0}.collection__title{text-align:center;text-transform:capitalize}.collection__card{margin:.5rem;cursor:pointer;width:7.2rem;height:9.8rem;background-color:var(--color-bg-card);border-radius:.5rem;box-shadow:var(--card-shadow);display:inline-block;position:relative}.collection__ico{border:solid 5px transparent;cursor:pointer;width:7.2rem;height:7.2rem;background-color:var(--color-highlight);border-radius:.5rem;display:inline-block;background-size:contain;background-repeat:no-repeat;position:relative}.collection__ico--active{border-color:var(--color-frame-marker-active);cursor:default}.collection__actions{width:7.2rem;height:2.6rem;position:absolute;padding:.5rem .2rem;bottom:0;cursor:default;font-size:0}.collection__action,.collection__action:hover{display:inline-block;width:1.6rem;height:1.6rem;background-color:transparent;background-size:contain;background-repeat:no-repeat;cursor:pointer;margin:0 .3rem;opacity:var(--card-buttons-opacity);filter:saturate(0)}.collection__action:hover{background-color:transparent;opacity:1;filter:saturate(1)}.collection__favorite,.collection__favorite:hover{background-image:url(/img/heart.svg)}.collection__favorite--active,.collection__favorite--active:hover{opacity:.8;filter:saturate(1);background-image:url(/img/heart-full.svg)}.collection__favorite--active:hover{opacity:1;filter:saturate(1);background-image:url(/img/heart-full.svg)}.collection__stylus,.collection__stylus:hover{background-image:url(/img/stylus.svg)}.collection__download,.collection__download:hover{background-image:url(/img/download.svg)}.switch{max-width:31.8rem;margin:auto;margin-bottom:1.5rem}.switch__btn{width:50%;opacity:.5}.switch__btn--right{border-top-left-radius:0;border-bottom-left-radius:0}.switch__btn--left{border-top-right-radius:0;border-bottom-right-radius:0}.switch__btn--active{opacity:1}.switch__btn--active:hover{cursor:default}.tab{border-bottom-left-radius:0;border-bottom-right-radius:0;height:3.8rem;background:var(--color-tab);min-width:4rem}.tab:hover{background:var(--color-tab-light)}.tab--active{background:var(--color-bg-block);color:var(--color-text);cursor:default}.tab--active:hover{background:var(--color-bg-block)}.game-box{grid-area:moves;padding:2rem;padding-top:var(--header-margin);min-width:41rem;height:100vh}.game{height:100%;display:grid;grid-template-rows:3.8rem 22rem auto 8.4rem}.game-tabs{display:grid;grid-auto-flow:column;grid-template-columns:1fr 1fr;column-gap:.5rem}.game-tabs--condensed{grid-template-columns:1fr 1fr 1fr}.span2{grid-row-end:span 2}.span3{grid-row-end:span 3}@media (orientation: portrait){.game-box{padding:0;height:auto;min-height:100vh;min-width:36rem}.game{display:block}}@media (orientation: landscape) and (max-height: 400px){.game{grid-template-rows:3.8rem 1fr 6.4rem}}.setup-box{height:100vh;grid-area:setup;padding:2rem;padding-top:var(--header-margin);min-width:41rem}.setup{font-size:1.6rem;height:100%;display:grid;grid-template-rows:3.8rem 1fr}.setup-tabs{display:grid;grid-auto-flow:column;grid-template-columns:1fr 1fr 1fr;column-gap:.5rem}@font-face{font-family:Chess;font-weight:400;font-display:swap;src:url(/fonts/Chess.ttf) format("truetype")}@font-face{font-family:Ubuntu;font-weight:500;font-display:swap;src:url(/fonts/Ubuntu-Medium.ttf) format("truetype")}@font-face{font-family:Ubuntu;font-weight:700;font-display:swap;src:url(/fonts/Ubuntu-Bold.ttf) format("truetype")}@font-face{font-family:Fira Mono;font-display:swap;src:url(/fonts/FiraMono-Medium.ttf) format("truetype")}*{border:0;margin:0;padding:0;box-sizing:border-box;outline:none}html{font-size:10px}body{background-repeat:repeat;background-position:center;text-align:center;font-family:Ubuntu,sans-serif;--header-height: 4rem;--header-margin: 6rem}.invisible{font-size:0;height:0}.ubuntu-font-init{font-family:Ubuntu;font-weight:500}.ubuntu-bold-font-init{font-family:Ubuntu;font-weight:700}.fira-font-init{font-family:Fira Mono;font-weight:500}.chess-font-init{font-family:Chess;font-weight:400}.dark{background-color:#313742;background-image:url(/img/pattern.png);background-size:12rem;color:#d4dde0;--logo-url: url(/img/logo.svg);--logo-mobile-url: url(/img/logo-mobile.svg);--color--score: #ffffff;--color-btn: rgb(0, 173, 136);--color-btn-light: rgb(0, 207, 162);--color-btn-accent: #8bd636;--color-btn-accent-light: #a4f14b;--color-tab: #899399;--color-tab-light: #a9b4bd;--color-bg-block: #17171f;--color-bg-card: #21212c;--color-bg-input: #20242a;--color-border-input: #2d323a;--color-highlight: #ffffff22;--color-text: #aaa;--color-text-contrast: #0e0e13;--color-text-input: #acbddb;--color-text-dimmed: #677794;--color-scrollbar: rgb(0, 59, 47);--color-scrollbar-track: #ffffff22;--color-frame-marker-active: #fff;--card-shadow: .5rem .5rem .5rem #00000077;--card-buttons-opacity: .4;--color-warning: #fc4444}.light{background-color:#959ea1;background-image:url(/img/pattern-light.png);background-size:12rem;color:#1d1f20;--logo-url: url(/img/logo-dark.svg);--logo-mobile-url: url(/img/logo-mobile-dark.svg);--color-btn: rgb(0, 148, 116);--color-btn-light: rgb(0, 114, 89);--color-btn-accent: #6bad1f;--color-btn-accent-light: #89d137;--color-tab: #5d6468;--color-tab-light: #3e4346;--color-bg-block: #dddddd;--color-bg-card: #eeeeee;--color-bg-input: #eeeeee;--color-border-input: #7f8999;--color-highlight: #00000022;--color-text: rgb(46, 54, 58);--color-text-contrast: #fff;--color-text-input: #46494e;--color-text-dimmed: #767980;--color-scrollbar: rgb(133, 184, 173);--color-scrollbar-track: #00000022;--color-frame-marker-active: #000;--card-shadow: .5rem .5rem .5rem #00000044;--card-buttons-opacity: .8;--color-warning: #fc4444}button,.btn,.upload:before{padding:.8rem;font-family:Ubuntu;font-size:1.5rem;background:var(--color-btn);color:var(--color-text-contrast);border-radius:5px;width:100%;-webkit-user-select:none;-moz-user-select:none;user-select:none}button:hover,.btn:hover,.upload:hover:before{background:var(--color-btn-light);text-decoration:none;cursor:pointer}.btn--error,.btn--error:hover{background-color:var(--color-warning)}input,textarea{width:100%;padding:.8rem;font-family:Fira Mono;font-size:1.4rem;margin-bottom:1rem;background:var(--color-bg-input);border:solid 1px var(--color-border-input);color:var(--color-text-input);outline:none;resize:none}input:focus,textarea:focus{border-color:#005744}h2{color:var(--color-text);text-align:left;font-size:1.5rem;margin:2.5rem 0 1.5rem;font-weight:500}h3{color:var(--color-text);text-align:left;font-size:1.6rem;margin:1.5rem 0 1rem;font-weight:500}hr{margin-top:2rem;border-top:solid 1px var(--color-highlight)}a,a:visited,a:active{color:var(--color-btn);text-decoration:none}a.btn,a.btn:visited,a.btn:active{display:inline-block;text-align:center;color:var(--color-text-contrast);text-decoration:none}a:hover{text-decoration:underline}.invisible{opacity:0}.board-box{height:100vh;grid-area:board;padding:var(--header-margin) 0 2rem 0}.board-box--left{padding-left:2rem}.board{box-shadow:0 0 2rem rgba(0,0,0,.6);border-radius:5px;max-width:100%;max-height:100%}.double{display:grid;grid-template-columns:1fr 1fr;column-gap:1rem}.layout{display:grid;grid-template-columns:1fr 2fr 1fr;grid-template-rows:1fr;grid-template-areas:"setup board moves" "setup board moves";height:100vh}@media (orientation: landscape) and (max-width: 1536px){html{font-size:9px}}@media (orientation: landscape) and (max-width: 1365px){.layout{grid-template-columns:2fr 1fr;grid-template-areas:"board moves" "board moves"}}@media (orientation: portrait){html{font-size:10px}.layout{grid-template-columns:1fr;grid-template-areas:"board" "moves" "setup"}.moves-box{height:auto}.board-box{height:auto;max-height:100vh;padding:var(--header-height) 0 1rem 0;font-size:0}.board{border-radius:0}.setup-box{height:auto}}::placeholder{color:var(--color-text-dimmed)}.popup{width:100vw;height:100vh;position:absolute;top:0;background-color:rgba(0,0,0,.7);padding:2rem;display:grid;vertical-align:middle}.popup__box{background-color:var(--color-bg-block);max-width:300px;width:100%;margin:auto;padding:2rem;border-radius:.5rem;box-shadow:0 0 2rem rgba(0,0,0,.6);position:relative;border:solid 1px var(--color-highlight)}.popup__close{width:3.2rem;position:absolute;top:1rem;right:1rem}.popup__title{text-align:left;margin:0 4.2rem 3rem 0}.popup__content{text-align:left;font-size:1.2rem}.popup__content p,.popup__content ul{margin-top:2rem}.popup__content li{margin-top:.5rem;margin-left:2rem}.fs-popup{width:100vw;height:100vh;position:absolute;top:0;display:grid;vertical-align:middle;padding-top:var(--header-height);pointer-events:none}.fs-popup__box{background-color:var(--color-bg-input);min-height:100%;width:100%;margin:auto;padding:6rem 2rem 2rem;position:relative;pointer-events:all}.fs-popup__close{width:3.2rem;position:absolute;top:1rem;right:1rem}.fs-popup__content{text-align:left;font-size:1.2rem;max-width:800px;margin:auto}.about__title{text-align:left;margin:0 4.2rem 3rem 0}.about{text-align:left;font-size:1.2rem;max-width:800px;margin:auto}.about p{margin-top:2rem;font-size:1.4rem;line-height:2rem}.about ul{margin-top:2rem;list-style:none;font-size:1.4rem;line-height:3rem}.about li{margin-top:.5rem;margin-left:2rem}.about kbd{margin-top:.5rem;margin-left:2rem;background-color:var(--color-tab);color:var(--color-text-contrast);padding:.5rem 1rem;margin-right:1rem;border-radius:.5rem;box-shadow:.5rem .5rem 1rem rgba(0,0,0,.2);font-family:Fira Mono,monospace;font-weight:500}.about__shortcuts{display:grid;grid-template-columns:1fr 1fr}ul.about__features{list-style:circle}.us-info{max-width:1200px;font-size:1.4rem}.us-info__steps{display:grid;grid-template-columns:1fr 1fr 1fr;column-gap:4rem}.us-info__intro{font-size:1.6rem;line-height:2.2rem;margin-bottom:5rem}.us-info__step-num{font-size:5rem;margin-top:0;font-family:Ubuntu;padding-bottom:1rem;border-bottom:solid 3px var(--color-btn)}.us-info__step-title{font-size:2rem;padding:1rem 0;margin-bottom:2rem}.us-info__description{line-height:2.2rem;margin-bottom:2rem}.us-info__install-stylus{margin-top:2rem}.us-info__install-stylus .btn{max-width:220px}.us-info__manage-stylus{margin-top:2rem}.us-info__manage-stylus img{border-radius:5px;box-shadow:.7rem .7rem 1rem rgba(0,0,0,.333)}.us-info__text-ico{width:1.8rem;height:1.8rem;position:relative;top:.3rem;margin:0 .5rem}.us-info__browse{display:grid;grid-template-columns:1fr 1fr;column-gap:1rem}.support{max-width:1200px;font-size:1.4rem}.support__intro{margin-bottom:2rem;text-align:center}.support__methods{display:grid;grid-template-columns:repeat(3,1fr);column-gap:3rem;margin-top:10rem}.support__method{padding:5rem 1rem 1rem;border-top:solid .4rem var(--color-btn);position:relative}.support__title{text-align:center;font-size:2rem}.support__ico{width:12rem;position:absolute;top:-6.2rem;left:50%;background-color:var(--color-bg-input);transform:translate(-50%);border:solid 2rem var(--color-bg-input)}.support__ico--coffee{top:-7.2rem;width:13rem}.support__description{line-height:2.2rem;margin-bottom:2rem}.support__donate-btn{margin-top:3rem;background-color:var(--color-btn-accent);padding:1.5rem;font-size:2rem}.support__donate-btn:hover{background-color:var(--color-btn-accent-light)}.support__share{text-align:center;margin-top:5rem}.support__share-intro,.support__subreddit{font-size:1.6rem;margin-bottom:2rem;text-align:center}@media (orientation: portrait){.support__methods{display:grid;grid-template-columns:1fr;margin-top:10rem}.support__method{margin-bottom:7rem}}.resp-sharing-button__link,.resp-sharing-button__icon{display:inline-block}.resp-sharing-button__link{text-decoration:none;color:#fff;margin:.5em}.resp-sharing-button{border-radius:5px;transition:25ms ease-out;padding:.5em .75em;font-family:Helvetica Neue,Helvetica,Arial,sans-serif}.resp-sharing-button__icon svg{width:1em;height:1em;margin-right:.4em;vertical-align:top}.resp-sharing-button--small svg{margin:0;vertical-align:middle}.resp-sharing-button__icon{stroke:#fff;fill:none}.resp-sharing-button__icon--solid,.resp-sharing-button__icon--solidcircle{fill:#fff;stroke:none}.resp-sharing-button--twitter{background-color:#55acee}.resp-sharing-button--twitter:hover{background-color:#2795e9}.resp-sharing-button--pinterest{background-color:#bd081c}.resp-sharing-button--pinterest:hover{background-color:#8c0615}.resp-sharing-button--facebook{background-color:#3b5998}.resp-sharing-button--facebook:hover{background-color:#2d4373}.resp-sharing-button--tumblr{background-color:#35465c}.resp-sharing-button--tumblr:hover{background-color:#222d3c}.resp-sharing-button--reddit{background-color:#fa571b}.resp-sharing-button--reddit:hover{background-color:#ff4500}.resp-sharing-button--google{background-color:#dd4b39}.resp-sharing-button--google:hover{background-color:#c23321}.resp-sharing-button--linkedin{background-color:#0077b5}.resp-sharing-button--linkedin:hover{background-color:#046293}.resp-sharing-button--email{background-color:#777}.resp-sharing-button--email:hover{background-color:#5e5e5e}.resp-sharing-button--xing{background-color:#1a7576}.resp-sharing-button--xing:hover{background-color:#114c4c}.resp-sharing-button--whatsapp{background-color:#25d366}.resp-sharing-button--whatsapp:hover{background-color:#1da851}.resp-sharing-button--hackernews{background-color:#f60}.resp-sharing-button--hackernews:hover,.resp-sharing-button--hackernews:focus{background-color:#fb6200}.resp-sharing-button--vk{background-color:#507299}.resp-sharing-button--vk:hover{background-color:#43648c}.resp-sharing-button--facebook{background-color:#3b5998;border-color:#3b5998}.resp-sharing-button--facebook:hover,.resp-sharing-button--facebook:active{background-color:#2d4373;border-color:#2d4373}.resp-sharing-button--twitter{background-color:#55acee;border-color:#55acee}.resp-sharing-button--twitter:hover,.resp-sharing-button--twitter:active{background-color:#2795e9;border-color:#2795e9}.resp-sharing-button--email{background-color:#777;border-color:#777}.resp-sharing-button--email:hover,.resp-sharing-button--email:active{background-color:#5e5e5e;border-color:#5e5e5e}.resp-sharing-button--reddit{background-color:#fa571b;border-color:#fa571b}.resp-sharing-button--reddit:hover,.resp-sharing-button--reddit:active{background-color:#ff4500;border-color:#ff4500}.resp-sharing-button--whatsapp{background-color:#25d366;border-color:#25d366}.resp-sharing-button--whatsapp:hover,.resp-sharing-button--whatsapp:active{background-color:#1da851;border-color:#1da851}.resp-sharing-button--telegram{background-color:#54a9eb}.resp-sharing-button--telegram:hover{background-color:#4b97d1}.resp-sharing-button__link:visited{color:#fff}\n',document.head.appendChild(t),System.register([],(function(t,o){"use strict";return{execute:function(){t({c:function(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')},g:function(e){if(e.__esModule)return e;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach((function(o){var n=Object.getOwnPropertyDescriptor(e,o);Object.defineProperty(t,o,n.get?n:{enumerable:!0,get:function(){return e[o]}})})),t}});const n={};const r=Symbol("solid-proxy"),i=Symbol("solid-track"),a={equals:(e,t)=>e===t};let s=$;const l={owned:null,cleanups:null,context:null,owner:null};var c=null;let d=null,u=null,h=null,p=null,f=0;function g(e,t){const o=u,n=c,r=0===e.length,i=r?l:{owned:null,cleanups:null,context:null,owner:t||n},a=r?e:()=>e((()=>v((()=>N(i)))));c=i,u=null;try{return T(a,!0)}finally{u=o,c=n}}function _(e,t){const o={value:e,observers:null,observerSlots:null,comparator:(t=t?Object.assign({},a,t):a).equals||void 0};return[k.bind(o),e=>("function"==typeof e&&(e=e(o.value)),x(o,e))]}function m(e,t,o){S(A(e,t,!1,1))}function b(e,t,o){o=o?Object.assign({},a,o):a;const n=A(e,t,!0,0);return n.observers=null,n.observerSlots=null,n.comparator=o.equals||void 0,S(n),k.bind(n)}function v(e){let t,o=u;return u=null,t=e(),u=o,t}function w(){return u}function y(e){const t=b(e),o=b((()=>O(t())));return o.toArray=()=>{const e=o();return Array.isArray(e)?e:null!=e?[e]:[]},o}function k(){if(this.sources&&this.state)if(1===this.state)S(this);else{const e=h;h=null,T((()=>z(this)),!1),h=e}if(u){const e=this.observers?this.observers.length:0;u.sources?(u.sources.push(this),u.sourceSlots.push(e)):(u.sources=[this],u.sourceSlots=[e]),this.observers?(this.observers.push(u),this.observerSlots.push(u.sources.length-1)):(this.observers=[u],this.observerSlots=[u.sources.length-1])}return this.value}function x(e,t,o){let n=e.value;return e.comparator&&e.comparator(n,t)||(e.value=t,e.observers&&e.observers.length&&T((()=>{for(let t=0;t<e.observers.length;t+=1){const o=e.observers[t],n=d;n&&d.disposed.has(o),(n&&!o.tState||!n&&!o.state)&&(o.pure?h.push(o):p.push(o),o.observers&&E(o)),n||(o.state=1)}if(h.length>1e6)throw h=[],new Error}),!1)),t}function S(e){if(!e.fn)return;N(e);const t=c,o=u,n=f;u=c=e,function(e,t,o){let n;try{n=e.fn(t)}catch(r){e.pure&&(e.state=1),I(r)}(!e.updatedAt||e.updatedAt<=o)&&(null!=e.updatedAt&&"observers"in e?x(e,n):e.value=n,e.updatedAt=o)}(e,e.value,n),u=o,c=t}function A(e,t,o,n=1,r){const i={fn:e,state:n,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:c,context:null,pure:o};return null===c||c!==l&&(c.owned?c.owned.push(i):c.owned=[i]),i}function C(e){if(0===e.state)return;if(2===e.state)return z(e);if(e.suspense&&v(e.suspense.inFallback))return e.suspense.effects.push(e);const t=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<f);)e.state&&t.push(e);for(let o=t.length-1;o>=0;o--)if(1===(e=t[o]).state)S(e);else if(2===e.state){const o=h;h=null,T((()=>z(e,t[0])),!1),h=o}}function T(e,t){if(h)return e();let o=!1;t||(h=[]),p?o=!0:p=[],f++;try{const t=e();return function(e){h&&($(h),h=null);if(e)return;const t=p;p=null,t.length&&T((()=>s(t)),!1)}(o),t}catch(n){h||(p=null),I(n)}}function $(e){for(let t=0;t<e.length;t++)C(e[t])}function P(e){let t,o=0;for(t=0;t<e.length;t++){const n=e[t];n.user?e[o++]=n:C(n)}var r;for(n.context&&(n.context=r),t=0;t<o;t++)C(e[t])}function z(e,t){e.state=0;for(let o=0;o<e.sources.length;o+=1){const n=e.sources[o];n.sources&&(1===n.state?n!==t&&C(n):2===n.state&&z(n,t))}}function E(e){for(let t=0;t<e.observers.length;t+=1){const o=e.observers[t];o.state||(o.state=2,o.pure?h.push(o):p.push(o),o.observers&&E(o))}}function N(e){let t;if(e.sources)for(;e.sources.length;){const t=e.sources.pop(),o=e.sourceSlots.pop(),n=t.observers;if(n&&n.length){const e=n.pop(),r=t.observerSlots.pop();o<n.length&&(e.sourceSlots[r]=o,n[o]=e,t.observerSlots[o]=r)}}if(e.owned){for(t=0;t<e.owned.length;t++)N(e.owned[t]);e.owned=null}if(e.cleanups){for(t=0;t<e.cleanups.length;t++)e.cleanups[t]();e.cleanups=null}e.state=0,e.context=null}function I(e){throw e=function(e){return e instanceof Error||"string"==typeof e?e:new Error("Unknown error")}(e)}function O(e){if("function"==typeof e&&!e.length)return O(e());if(Array.isArray(e)){const t=[];for(let o=0;o<e.length;o++){const n=O(e[o]);Array.isArray(n)?t.push.apply(t,n):t.push(n)}return t}return e}const L=Symbol("fallback");function B(e){for(let t=0;t<e.length;t++)e[t]()}function M(e,t,o={}){let n=[],r=[],a=[],s=0,l=t.length>1?[]:null;var d;return d=()=>B(a),null===c||(null===c.cleanups?c.cleanups=[d]:c.cleanups.push(d)),()=>{let c,d,u=e()||[];return u[i],v((()=>{let e,t,i,p,f,_,m,b,v,w=u.length;if(0===w)0!==s&&(B(a),a=[],n=[],r=[],s=0,l&&(l=[])),o.fallback&&(n=[L],r[0]=g((e=>(a[0]=e,o.fallback()))),s=1);else if(0===s){for(r=new Array(w),d=0;d<w;d++)n[d]=u[d],r[d]=g(h);s=w}else{for(i=new Array(w),p=new Array(w),l&&(f=new Array(w)),_=0,m=Math.min(s,w);_<m&&n[_]===u[_];_++);for(m=s-1,b=w-1;m>=_&&b>=_&&n[m]===u[b];m--,b--)i[b]=r[m],p[b]=a[m],l&&(f[b]=l[m]);for(e=new Map,t=new Array(b+1),d=b;d>=_;d--)v=u[d],c=e.get(v),t[d]=void 0===c?-1:c,e.set(v,d);for(c=_;c<=m;c++)v=n[c],d=e.get(v),void 0!==d&&-1!==d?(i[d]=r[c],p[d]=a[c],l&&(f[d]=l[c]),d=t[d],e.set(v,d)):a[c]();for(d=_;d<w;d++)d in i?(r[d]=i[d],a[d]=p[d],l&&(l[d]=f[d],l[d](d))):r[d]=g(h);r=r.slice(0,s=w),n=u.slice(0)}return r}));function h(e){if(a[d]=e,l){const[e,o]=_(d);return l[d]=o,t(u[d],e)}return t(u[d])}}}function R(e,t){return v((()=>e(t||{})))}function F(e){const t="fallback"in e&&{fallback:()=>e.fallback};return b(M((()=>e.each),e.children,t||void 0))}function D(e){let t=!1;const o=e.keyed,n=b((()=>e.when),void 0,{equals:(e,o)=>t?e===o:!e==!o});return b((()=>{const r=n();if(r){const n=e.children,i="function"==typeof n&&n.length>0;return t=o||i,i?v((()=>n(r))):n}return e.fallback}))}function q(e){let t=!1,o=!1;const n=y((()=>e.children)),r=b((()=>{let e=n();Array.isArray(e)||(e=[e]);for(let t=0;t<e.length;t++){const n=e[t].when;if(n)return o=!!e[t].keyed,[t,n,e[t]]}return[-1]}),void 0,{equals:(e,o)=>e[0]===o[0]&&(t?e[1]===o[1]:!e[1]==!o[1])&&e[2]===o[2]});return b((()=>{const[n,i,a]=r();if(n<0)return e.fallback;const s=a.children,l="function"==typeof s&&s.length>0;return t=o||l,l?v((()=>s(i))):s}))}function j(e){return e}function H(e,t){return b(e,void 0,t?void 0:{equals:t})}const W="_$DX_DELEGATE";function U(e,t,o){const n=document.createElement("template");n.innerHTML=e;let r=n.content.firstChild;return o&&(r=r.firstChild),r}function G(e,t=window.document){const o=t[W]||(t[W]=new Set);for(let n=0,r=e.length;n<r;n++){const r=e[n];o.has(r)||(o.add(r),t.addEventListener(r,Y))}}function V(e,t,o){null==o?e.removeAttribute(t):e.setAttribute(t,o)}function X(e,t){null==t?e.removeAttribute("class"):e.className=t}function Q(e,t,o,n){if(n)Array.isArray(o)?(e[`$$${t}`]=o[0],e[`$$${t}Data`]=o[1]):e[`$$${t}`]=o;else if(Array.isArray(o)){const n=o[0];e.addEventListener(t,o[0]=t=>n.call(e,o[1],t))}else e.addEventListener(t,o)}function K(e,t,o,n){if(void 0===o||n||(n=[]),"function"!=typeof t)return Z(e,t,n,o);m((n=>Z(e,t(),n,o)),n)}function Y(e){const t=`$$${e.type}`;let o=e.composedPath&&e.composedPath()[0]||e.target;for(e.target!==o&&Object.defineProperty(e,"target",{configurable:!0,value:o}),Object.defineProperty(e,"currentTarget",{configurable:!0,get:()=>o||document}),n.registry&&!n.done&&(n.done=!0,document.querySelectorAll("[id^=pl-]").forEach((e=>e.remove())));null!==o;){const n=o[t];if(n&&!o.disabled){const r=o[`${t}Data`];if(void 0!==r?n.call(o,r,e):n.call(o,e),e.cancelBubble)return}o=o.host&&o.host!==o&&o.host instanceof Node?o.host:o.parentNode}}function Z(e,t,o,r,i){for(n.context&&!o&&(o=[...e.childNodes]);"function"==typeof o;)o=o();if(t===o)return o;const a=typeof t,s=void 0!==r;if(e=s&&o[0]&&o[0].parentNode||e,"string"===a||"number"===a){if(n.context)return o;if("number"===a&&(t=t.toString()),s){let n=o[0];n&&3===n.nodeType?n.data=t:n=document.createTextNode(t),o=te(e,o,r,n)}else o=""!==o&&"string"==typeof o?e.firstChild.data=t:e.textContent=t}else if(null==t||"boolean"===a){if(n.context)return o;o=te(e,o,r)}else{if("function"===a)return m((()=>{let n=t();for(;"function"==typeof n;)n=n();o=Z(e,n,o,r)})),()=>o;if(Array.isArray(t)){const a=[],l=o&&Array.isArray(o);if(J(a,t,o,i))return m((()=>o=Z(e,a,o,r,!0))),()=>o;if(n.context){if(!a.length)return o;for(let e=0;e<a.length;e++)if(a[e].parentNode)return o=a}if(0===a.length){if(o=te(e,o,r),s)return o}else l?0===o.length?ee(e,a,r):function(e,t,o){let n=o.length,r=t.length,i=n,a=0,s=0,l=t[r-1].nextSibling,c=null;for(;a<r||s<i;)if(t[a]!==o[s]){for(;t[r-1]===o[i-1];)r--,i--;if(r===a){const t=i<n?s?o[s-1].nextSibling:o[i-s]:l;for(;s<i;)e.insertBefore(o[s++],t)}else if(i===s)for(;a<r;)c&&c.has(t[a])||t[a].remove(),a++;else if(t[a]===o[i-1]&&o[s]===t[r-1]){const n=t[--r].nextSibling;e.insertBefore(o[s++],t[a++].nextSibling),e.insertBefore(o[--i],n),t[r]=o[i]}else{if(!c){c=new Map;let e=s;for(;e<i;)c.set(o[e],e++)}const n=c.get(t[a]);if(null!=n)if(s<n&&n<i){let l,d=a,u=1;for(;++d<r&&d<i&&null!=(l=c.get(t[d]))&&l===n+u;)u++;if(u>n-s){const r=t[a];for(;s<n;)e.insertBefore(o[s++],r)}else e.replaceChild(o[s++],t[a++])}else a++;else t[a++].remove()}}else a++,s++}(e,o,a):(o&&te(e),ee(e,a));o=a}else if(t instanceof Node){if(n.context&&t.parentNode)return o=s?[t]:t;if(Array.isArray(o)){if(s)return o=te(e,o,r,t);te(e,o,null,t)}else null!=o&&""!==o&&e.firstChild?e.replaceChild(t,e.firstChild):e.appendChild(t);o=t}}return o}function J(e,t,o,n){let r=!1;for(let i=0,a=t.length;i<a;i++){let a=t[i],s=o&&o[i];if(a instanceof Node)e.push(a);else if(null==a||!0===a||!1===a);else if(Array.isArray(a))r=J(e,a,s)||r;else if("function"==typeof a)if(n){for(;"function"==typeof a;)a=a();r=J(e,Array.isArray(a)?a:[a],Array.isArray(s)?s:[s])||r}else e.push(a),r=!0;else{const t=String(a);s&&3===s.nodeType&&s.data===t?e.push(s):e.push(document.createTextNode(t))}}return r}function ee(e,t,o){for(let n=0,r=t.length;n<r;n++)e.insertBefore(t[n],o)}function te(e,t,o,n){if(void 0===o)return e.textContent="";const r=n||document.createTextNode("");if(t.length){let n=!1;for(let i=t.length-1;i>=0;i--){const a=t[i];if(r!==a){const t=a.parentNode===e;n||i?t&&a.remove():t?e.replaceChild(r,a):e.insertBefore(r,o)}else n=!0}}else e.insertBefore(r,o);return[r]}const oe={horizontal:[0,0,1,0],vertical:[0,0,0,1],"diagonal-top":[0,0,1,1],"diagonal-bottom":[0,1,1,0]},ne=(e,t,o,n,r,i)=>{let a;if("radial"===t.dir){const t=Math.sqrt((o/2)**2+(n/2)**2);a=e.createRadialGradient(r+o/2,i+n/2,t,r+o/2,i+n/2,0)}else{const[s,l,c,d]=oe[t.dir];a=e.createLinearGradient(r+s*o,i+l*n,r+c*o,i+d*n)}const s=t.colors.length-1;return t.colors.forEach(((e,t)=>{a.addColorStop(t/s,e)})),a},re=async(e,t,o,n,r,i,a,s=8)=>{const l=Array.isArray(i)?i:[i];for(const c of l){if("image"===c.type){const i=await a(c.data.src);s<8?e.drawImage(i,0,0,i.width*(s/8),i.height*(s/8),n,r,t,o):e.drawImage(i,n,r,t,o);continue}const i=await("solid"===c.type?c.data.color:ne(e,c.data,t,o,n,r));if(null===i)throw new Error("Cannot create canvas fill style");e.fillStyle=i,e.fillRect(n,r,t,o)}},ie=(e,t,o,n,r=!1,i,a,s,l)=>{const c=a/1024;if(c<=.32)return;const d=22*c,u=6*c,h=4*c,p="1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26".split(",").slice(0,n),f=r?p:p.reverse();e.font=`${d}px Fira Mono`,e.textBaseline=s?"middle":"top",f.forEach(((n,r)=>{e.fillStyle=i>0?t.onBorder:r%2==0?t.onLight:t.onDark;const a=s?i/2:u,c=(s?o*r+i+o/2:o*r+u)+l;e.textAlign=s?"center":"left",e.fillText(n,a,c)}));const g="abcdefghijklmnopqrstuwvxyz".split("").slice(0,n),_=r?g.reverse():g;e.textBaseline=s?"middle":"bottom",_.forEach(((n,r)=>{e.fillStyle=i>0?t.onBorder:r%2==0?t.onDark:t.onLight;const c=s?o*r+i+o/2:o*r+u,d=(s?a-i/2:a-h)+l;e.textAlign=s?"center":"left",e.fillText(n,c,d)}))},ae=(e,t,o)=>{const n="abcdefghijklmnopqrstuwvxyz".indexOf(e[0]),r=Number(e[1])-1;return[t?o-n-1:n,t?r:o-r-1]},se={hidden:["tagged","anarchy-plug","anarchy-plug_candy","anarchy-plug_fresh","anarchy-plug_sepia"],modern:["tatiana","tatiana_wood","tatiana_calm","tatiana_sweet","staunty","staunty_wood","staunty_blue","staunty_lila","libra","libra_wood","libra_plum","libra_sea","governor_bw","governor","governor_patina","governor_purple","riohacha","riohacha_spring","riohacha_winter","riohacha_cute","gioco","gioco_wood","gioco_metal","gioco_purple","pirouetti","pirouetti_mint","pirouetti_summer","pirouetti_dream","pirouetti_border","pirouetti_border_winter","pirouetti_border_coral","pirouetti_border_grass","kosal","kosal_blue","kosal_violet","kosal_red","dubrovny_bw","dubrovny","dubrovny_brown","dubrovny_green","alfarishy","alfarishy_blue","alfarishy_pink","alfarishy_berry","dmuysi","dmuysi_marzipan","dmuysi_kournikova","dmuysi_cotton","icon54","icon54_gray","icon54_brown","icon54_neon","saakyan","saakyan_blue","saakyan_grape","saakyan_coco","trendy","trendy_ink","trendy_brown","trendy_fresh","vecon","vecon_baltic","vecon_hemlock","vecon_cute","echiquier","echiquier_ink","echiquier_flesh","echiquier_grape"],classic:["merida","merida_ink","merida_cyan","merida_traffic","cburnett","cburnett_brown","cburnett_blue","cburnett_purple","alpha","alpha_ink","alpha_wood","alpha_mint","cases","cases_cocoa","cases_gray","cases_forest","chessnut","chessnut_blue","chessnut_brown","chessnut_burgundy","maestro","maestro_blue","maestro_pink","maestro_brown","cardinal","cardinal_blue","cardinal_brown","cardinal_green","companion","companion_red","companion_cyan","companion_eggplant","fresca","fresca_matisse","fresca_zucchini","fresca_camelot","magnetic","magnetic_brown","magnetic_lila","magnetic_orange","maya","maya_brown","maya_warm","maya_cold","fantasy","fantasy_calm","fantasy_warm","fantasy_cold","chess7","chess7_pink","chess7_calm","chess7_yellow","regular","regular_ink","regular_green","regular_purple","condal","condal_cold","condal_warm","condal_mustard","mediaeval","mediaeval_brown","mediaeval_green","mediaeval_orange","reillycraig","reillycraig_tamarind","reillycraig_lawn","reillycraig_dixie","smart","smart_apricot","smart_blue","smart_cocoa","icpieces","icpieces_blue","icpieces_maroon","icpieces_brown","leipzig","leipzig_niagara","leipzig_berry","leipzig_nature","motif","motif_maroon","motif_purple","motif_green","marroquin","marroquin_rajah","marroquin_eggplant","marroquin_toy","harlequin","harlequin_gold","harlequin_peach","harlequin_neon","lucena","lucena_brown","lucena_blue","lucena_pink","adventurer","adventurer_brown","adventurer_grass","adventurer_berry","kingdom","kingdom_blue","kingdom_brown","kingdom_sulu","traveller","traveller_brown","traveller_blue","traveller_green","oldstyle","oldstyle_bondi","oldstyle_brown","oldstyle_gossip"],fun:["anarchy","anarchy_candy","anarchy_fresh","anarchy_sepia","qootee","qootee_summer","qootee_pink","qootee_grape","horsey","horsey_blue","horsey_purple","horsey_pink","caliente","caliente_wood","caliente_blue","caliente_pink","california","california_brown","california_green","california_red","pixel","pixel_spring","pixel_neon","pixel_juicy","checkers","checkers_wood","checkers_grape","checkers_cute"],unusual:["alfonso-x","alfonso-x_brown","alfonso-x_grape","alfonso-x_toy","mark","mark_brown","mark_grape","mark_green","berlin","berlin_blue","berlin_maroon","berlin_loulou","line","line_berry","line_purple","line_toy","spatial","spatial_blue","spatial_salmon","spatial_summer","pirat","pirat_sea","pirat_maroon","pirat_peach","tfb","tfb_brown","tfb_green","tfb_purple","wisdom","wisdom_brown","wisdom_blue","wisdom_grape","utrecht","utrecht_mirage","utrecht_violet","utrecht_crimson","symmetric","symmetric_blue","symmetric_brown","symmetric_purple","millennia","millennia_blue","millennia_sand","millennia_green","shapes","shapes_blue","shapes_brown","shapes_cute","letters","letters_warm","letters_cold","letters_dim"],seasonal:["anarchy_halloween","condal_halloween"]},le=[...se.hidden,...se.modern,...se.classic,...se.fun,...se.unusual,...se.seasonal],ce=["bb","bw","kb","kw","nb","nw","pb","pw","qb","qw","rb","rw"];let de=null,ue=new Map;const he={async load(e,t){await Promise.all(ce.map((o=>t(`/pieces/${e}/${o}.svg`).then((e=>{ue.set(o,e)})))))},async get(e,t,o,n){de!==e&&(await this.load(e,n),de=e);const r=`${t}${o}`;return ue.get(r)}};var pe="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function fe(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ge={exports:{}};
/*!
             * 
             *   canvas-txt v3.0.0
             *   https://github.com/geongeorge/Canvas-Txt
             * 
             *   Copyright (c) Geon George (https://geongeorge.com)
             * 
             *   This source code is licensed under the MIT license found in the
             *   LICENSE file in the root directory of this source tree.
             * 
             */!function(e,t){"undefined"!=typeof self&&self,e.exports=function(e){var t={};function o(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}return o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=0)}([function(e,t,o){function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var o=[],n=!0,r=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(o.push(a.value),!t||o.length!==t);n=!0);}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return r(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(o):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?r(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=Array(t);o<t;o++)n[o]=e[o];return n}o.r(t);var i={debug:!1,align:"center",vAlign:"middle",fontSize:14,fontWeight:"",fontStyle:"",fontVariant:"",font:"Arial",lineHeight:null,justify:!1,drawText:function(e,t,o,r,i,a){var s=this,l=n([o,r,i,a].map((function(e){return parseInt(e)})),4);if(o=l[0],r=l[1],i=l[2],a=l[3],!(0>=i||0>=a||0>=this.fontSize)){var c=o+i,d=r+a;this.textSize&&console.error("%cCanvas-Txt:","font-weight: bold;","textSize is depricated and has been renamed to fontSize");var u=this.fontStyle,h=this.fontVariant,p=this.fontWeight,f=this.fontSize,g=this.font,_="".concat(u," ").concat(h," ").concat(p," ").concat(f,"px ").concat(g);e.font=_;var m,b=r+a/2+parseInt(this.fontSize)/2;"right"===this.align?(m=c,e.textAlign="right"):"left"===this.align?(m=o,e.textAlign="left"):(m=o+i/2,e.textAlign="center");var v=[],w=t.split("\n"),y=this.justify?e.measureText(" ").width:0;w.forEach((function(t){var o=e.measureText(t).width;if(o<=i)v.push(t);else{var n,r,a,l=t,c=i;for(o=e.measureText(l).width;o>c;){for(n=0,r=0,a="";r<c;)n++,a=l.substr(0,n),r=e.measureText(l.substr(0,n)).width;n--,a=a.substr(0,n);var d=n;if(" "!=l.substr(n,1)){for(;" "!=l.substr(n,1)&&0!=n;)n--;0==n&&(n=d),a=l.substr(0,n)}a=s.justify?s.justifyLine(e,a,y," ",i):a,l=l.substr(n),o=e.measureText(l).width,v.push(a)}0<o&&v.push(l)}}));var k=this.lineHeight?this.lineHeight:this.getTextHeight(e,t,_),x=k*(v.length-1),S=r;return"top"===this.vAlign?b=r+this.fontSize:"bottom"===this.vAlign?(b=d-x,S=d):(S=r+a/2,b-=x/2),v.forEach((function(t){t=t.trim(),e.fillText(t,m,b),b+=k})),this.debug&&(e.lineWidth=3,e.strokeStyle="#00909e",e.strokeRect(o,r,i,a),e.lineWidth=2,e.strokeStyle="#f6d743",e.beginPath(),e.moveTo(m,r),e.lineTo(m,d),e.stroke(),e.strokeStyle="#ff6363",e.beginPath(),e.moveTo(o,S),e.lineTo(c,S),e.stroke()),{height:x+k}}},getTextHeight:function(e,t,o){var n=e.textBaseline,r=e.font;e.textBaseline="bottom",e.font=o;var i=e.measureText(t).actualBoundingBoxAscent;return e.textBaseline=n,e.font=r,i},justifyLine:function(e,t,o,n,r){var i=Math.floor,a=t.trim(),s=e.measureText(a).width,l=a.split(/\s+/).length-1,c=i((r-s)/o);if(0>=l||0>=c)return a;for(var d=i(c/l),u=c-l*d,h=[],p=0;p<d;p++)h.push(n);return h=h.join(""),a.replace(/\s+/g,(function(e){var t=0<u?h+n:h;return u--,e+t}))}};t.default=i}])}(ge);var _e=fe(ge.exports);const me=(e,t,o,n,r,i,a,s,l)=>(e.font=`${r} ${n}px ${o}`,e.textAlign=s,e.textBaseline="middle",e.fillText(t,i,a,l),Math.ceil(e.measureText(t).width)),be=async(e,t,o,n,r,i,a,s)=>{if(e.clearRect(0,0,t,t),await re(e,t,t+2*n,0,0,r.border,a),s)(async(e,t,o,n,r,i)=>{var a,s;const l=null!==(a=i.PuzzleMotif)&&void 0!==a?a:"Solve the Puzzle",c=null!==(s=i.PuzzleDescription)&&void 0!==s?s:"";e.fillStyle=r.coords.onBorder,me(e,l,"Ubuntu",42*o,700,t/2,(t*o+n)/4,"center"),_e.fontSize=30*o,_e.lineHeight=35*o,_e.align="left",_e.font="Ubuntu",_e.drawText(e,c,.1*t,0,.8*t,t+2*n)})(e,t,o,n,r,i);else{const a="Ubuntu",s=[{key:"WhitePretty",line:60*o,fontSize:42*o,n:0},{key:"BlackPretty",line:60*o,fontSize:42*o,n:2},{key:"Event",line:30*o,fontSize:20*o,n:4},{key:"Round",line:30*o,fontSize:20*o,n:5},{key:"DatePretty",line:30*o,fontSize:20*o,n:7},{key:"Site",line:30*o,fontSize:20*o,n:8}],l=new Set(Object.keys(i)),c=s.filter((({key:e})=>l.has(e)));if(i.WhitePretty&&i.BlackPretty&&c.push({key:"vs",line:50*o,fontSize:20*o,n:1}),(i.Event||i.Round)&&c.push({key:"margin",line:100*o,fontSize:0,n:3}),i.Date||i.Site){const e=i.Event||i.Round?20*o:100*o;c.push({key:"margin",line:e,fontSize:0,n:6})}const d=c.reduce(((e,t)=>e+t.line),0);let u=(t+2*n-d)/2;e.fillStyle=r.coords.onBorder,c.sort(((e,t)=>e.n-t.n)).forEach((({key:o,line:n,fontSize:r})=>{if("vs"===o){return me(e,"vs",a,r,700,t/2,u+n/2,"center"),void(u+=n)}if("margin"===o)return void(u+=n);const s=i[o];if(s){me(e,"Round"===o?`Round ${s}`:s,a,r,700,t/2,u+n/2,"center",.9*t)}u+=n}))}const l=await(async e=>{let t;{const e=await fetch("/img/logo-full-mono.svg");t=await e.text()}const o=t.replace(/black/g,e);return`data:image/svg+xml;base64,${btoa(o)}`})(r.coords.onBorder),c=await a(l),d=.6*t,u=c.height*(d/c.width);e.drawImage(c,.2*t,n+t+n-2*u,d,u)},ve={k:"l",q:"w",r:"t",b:"n",n:"j",p:"o"},we=e=>{if(null===e)return!1;try{return new URL(e),!0}catch{return!1}},ye=e=>new Promise((t=>{const o=new Image;o.addEventListener("load",(()=>t(o)),{once:!0}),o.src=e})),ke={category:"solid",background:{type:"solid",data:{color:"transparent"}},dark:{type:"solid",data:{color:"#00ad88"}},light:{type:"solid",data:{color:"#9EE0BC"}},moveIndicator:{color:"#ffff0055"},border:{type:"solid",data:{color:"#00735a"}},coords:{onLight:"#00735a",onDark:"#d4fff5",onBorder:"#bbfaec"}},xe={size:720,tiles:8,boardStyle:"standard",piecesStyle:"tatiana",showBorder:!0,showExtraInfo:!0,showMaterial:!0,showMoveIndicator:!0,showChecks:!0,showCoords:!0,showShadows:!1,flipped:!1,puzzle:!1},Se={White:"White",Black:"Black",WhitePretty:"White",BlackPretty:"Black",WhiteElo:null,BlackElo:null,Date:null,DatePretty:null,Event:null,Round:null,Site:null,Result:null,PuzzleTitle:null,PuzzleMotif:null,PuzzleDescription:null},Ae=e=>fetch(`/board-templates/${e}.json`).then((e=>e.json()));class Ce{constructor(t=ye,o=(()=>document.createElement("canvas")),n=Ae){e(this,"cfg",xe),e(this,"_anonymous",!1),e(this,"scale",1),e(this,"borderScale",1),e(this,"borderOnly",!1),e(this,"hollow",!1),e(this,"size",0),e(this,"squareSize",0),e(this,"innerSize",0),e(this,"borderWidth",0),e(this,"margin",0),e(this,"style",ke),e(this,"header",Se),e(this,"lastPosition",null),e(this,"background",null),e(this,"currentScreen","move"),e(this,"ctx",void 0),e(this,"tempCtx",void 0),e(this,"tempCanvas",void 0),e(this,"canvas",void 0),this.loadImage=t,this.createCanvas=o,this.loadStyle=n,this.canvas=this.createCanvas(),this.tempCanvas=this.createCanvas();const r=this.canvas.getContext("2d"),i=this.tempCanvas.getContext("2d");if(null===r||null===i)throw new Error("Cannot create canvas 2D context");this.ctx=r,this.tempCtx=i}async init(e={}){await this.updateConfig(e,!1)}async setCanvas(e){this.canvas=e,this.ctx=e.getContext("2d"),this.setSize(this.cfg.size),await this.refresh()}async updateConfig(e,t=!0){const o={...this.cfg,...e};this.cfg=o,this.setSize(o.size),await this.setStyle(o.boardStyle,t),t&&await this.refresh()}set anonymous(e){this._anonymous=e,this.refresh()}async refresh(){await this.renderBackground(),"title"===this.currentScreen?await this.titleFrame(this.header):null!==this.lastPosition&&await this.frame(this.lastPosition,this.header),await this.render()}setSize(e){this.size=e,this.scale=e/720,this.margin=this.cfg.showExtraInfo?Math.round(50*this.scale):0;const t=e+2*this.margin;this.canvas.width===e&&this.canvas.height===t||(this.canvas.width=e,this.canvas.height=t,this.tempCanvas.width=e,this.tempCanvas.height=t);const o=this.cfg.showBorder?this.size/32*this.borderScale:0,n=this.size-2*o;return this.squareSize=Math.floor(n/this.cfg.tiles),this.innerSize=this.squareSize*this.cfg.tiles,this.borderWidth=(this.size-this.innerSize)/2,this}getSize(){return this.size}setBorderScale(e){this.borderScale=e,this.setSize(this.cfg.size)}setBorderOnly(e){this.borderOnly=e}setHollow(e){this.hollow=e}async setStyle(e,t=!0){this.style=await this.loadStyle(e),this.cfg.boardStyle=e,t&&await this.refresh()}async setPiecesStyle(e){this.cfg.piecesStyle=e,await this.refresh()}async setAllStyles(e,t){this.cfg.piecesStyle=e,this.style=await this.loadStyle(t),this.cfg.boardStyle=t,await this.refresh()}async flip(){return this.cfg.flipped=!this.cfg.flipped,await this.refresh(),this}async flipWhite(){this.cfg.flipped&&(this.cfg.flipped=!1,await this.refresh())}async flipBlack(){this.cfg.flipped||(this.cfg.flipped=!0,await this.refresh())}async hideBorder(){this.cfg.showBorder=!1,this.setSize(this.size),await this.refresh()}async showBorder(){this.cfg.showBorder=!0,this.setSize(this.size),await this.refresh()}async toggleBorder(){this.cfg.showBorder=!this.cfg.showBorder,this.setSize(this.size),await this.refresh()}async toggleExtraInfo(){this.cfg.showExtraInfo=!this.cfg.showExtraInfo,this.setSize(this.size),await this.refresh()}async toggleShadows(){this.cfg.showShadows=!this.cfg.showShadows,await this.refresh()}async togglePuzzle(){this.cfg.puzzle=!this.cfg.puzzle,await this.refresh()}getFinalHeader(){return this._anonymous?{...this.header,White:"Anonymous",Black:"Anonymous",WhitePretty:"Anonymous",BlackPretty:"Anonymous",Site:we(this.header.Site)?null:this.header.Site}:{...this.header,Site:we(this.header.Site)?this.header.Site.replace(/^http[s]*:\/\//,""):this.header.Site}}async titleFrame(e){this.currentScreen="title",this.header=e,await be(this.tempCtx,this.size,this.scale,this.margin,this.style,this.getFinalHeader(),this.loadImage,this.cfg.puzzle)}async renderBackground(){const e=this.createCanvas(),t=e.getContext("2d");e.width=this.size,e.height=this.size+2*this.margin;const{background:o,dark:n,light:r,border:i,coords:a}=this.style;t.clearRect(0,0,this.canvas.width,this.canvas.height),await re(t,this.width,this.height,0,0,i,this.loadImage),await re(t,this.innerSize,this.innerSize,this.cfg.showBorder?this.borderWidth:0,(this.cfg.showBorder?this.borderWidth:0)+this.margin,o,this.loadImage,this.cfg.tiles);for(let s=0;s<this.cfg.tiles;s++)for(let e=0;e<this.cfg.tiles;e++){const o=e%2==0&&s%2==0||e%2!=0&&s%2!=0?r:n,i=e*this.squareSize+this.borderWidth,a=s*this.squareSize+this.borderWidth+this.margin;await re(t,this.squareSize,this.squareSize,i,a,o,this.loadImage)}this.cfg.showBorder&&this.cfg.showCoords&&ie(t,a,this.squareSize,this.cfg.tiles,this.cfg.flipped,this.borderWidth,this.size,this.cfg.showBorder,this.margin),this.background=e}async frame(e,t){var o;this.currentScreen="move",this.lastPosition=e,this.header=null!=t?t:this.header,this.tempCtx.clearRect(0,0,this.tempCanvas.width,this.tempCanvas.height),null===this.background&&await this.renderBackground(),this.tempCtx.drawImage(await this.background,0,0),null!==(o=this.lastPosition)&&void 0!==o&&o.move&&this.cfg.showMoveIndicator&&await(async(e,t,o,{moveIndicator:n},r,i,a,s,l)=>{const[c,d]=ae(t.from,a,i),[u,h]=ae(t.to,a,i),[p,f,g,_]=[c,d,u,h].map((e=>e*o+r)),m={type:"solid",data:{color:n.color}};re(e,o,o,p,f+s,m,l),re(e,o,o,g,_+s,m,l)})(this.tempCtx,this.lastPosition.move,this.squareSize,this.style,this.borderWidth,this.cfg.tiles,this.cfg.flipped,this.margin,this.loadImage),!this.cfg.showBorder&&this.cfg.showCoords&&ie(this.tempCtx,this.style.coords,this.squareSize,this.cfg.tiles,this.cfg.flipped,this.borderWidth,this.size,this.cfg.showBorder,this.margin),this.lastPosition&&(await(async(e,t,o,n,r,i,a,s=!0,l)=>{const{placement:c,check:d,mate:u,turn:h}=t;e.shadowColor="rgba(0, 0, 0, 0)",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0;for(const{x:p,y:f,type:g,color:_}of c){const t=await he.get(a,g,_,l),c=r?7-f:f,m=r?7-p:p;if((d||u)&&"k"===g&&_===h){const r=u?"#ff002f":"#ffa600";e.shadowColor=r,e.shadowBlur=.15*o,e.shadowOffsetX=0,e.shadowOffsetY=0,e.drawImage(t,n+m*o,n+c*o+i,o,o)}else s&&(e.shadowColor="rgba(0, 0, 0, 0.5)",e.shadowOffsetX=.07*o,e.shadowOffsetY=.07*o,e.shadowBlur=.1*o);e.drawImage(t,n+m*o,n+c*o+i,o,o),e.shadowColor="rgba(0, 0, 0, 0)",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0}})(this.tempCtx,this.lastPosition,this.squareSize,this.borderWidth,this.cfg.flipped,this.margin,this.cfg.piecesStyle,this.cfg.showShadows,this.loadImage),this.cfg.showExtraInfo&&t&&await(async(e,t,o,n,r,i,a,s,l,c)=>{const d=Math.round(20*n);let u=(r-d)/2,h=r/2;const p=u;if(e.fillStyle=i.coords.onBorder,c){var f;me(e,`Find the best move for ${"b"===l.turn?"black":"white"}.`,"Ubuntu",d,700,p,o-h,"left"),me(e,null!==(f=a.PuzzleTitle)&&void 0!==f?f:"sharechess.github.io","Ubuntu",d,700,p,h,"left")}else{{const t=me(e,"Anonymous"===a.White?"White":a.White,"Ubuntu",d,700,p,s?h:o-h,"left"),n=a.WhiteElo?` ${a.WhiteElo}`:"";me(e,n,"Fira Mono",d,500,p+t,s?h:o-h,"left")}{const t=me(e,"Anonymous"===a.Black?"Black":a.Black,"Ubuntu",d,700,p,s?o-h:h,"left"),n=a.BlackElo?` ${a.BlackElo}`:"";me(e,n,"Fira Mono",d,500,p+t,s?o-h:h,"left")}}let g=0,_=0;if(l.last&&a.Result){const[r,i]=a.Result.split("-"),l="0"===i?"Lost":"1"===i?"Won":"Draw",c=me(e,"0"===r?"Lost":"1"===r?"Won":"Draw","Ubuntu",d,700,t-u,s?h:o-h,"right"),p=me(e,l,"Ubuntu",d,700,t-u,s?o-h:h,"right"),f=Math.max(c,p);g=f+20*n,_=f+20*n}const{diff:m,imbalance:b}=l.material,v=m>0?`+${Math.abs(m)}`:"";g+=me(e,v,"Fira Mono",d,500,t-u-g,s?h:o-h,"right");const w=m<0?`+${Math.abs(m)}`:"";_+=me(e,w,"Fira Mono",d,500,t-u-_,s?o-h:h,"right");for(const[y,k]of Object.entries(b.w))for(let r=0;r<k;r++){const i=me(e,ve[y],"Chess",d,500,t-u-g,(s?h:o-h)-2*n,"right");g+=r===k-1?.85*i:"p"===y?.4*i:.6*i}for(const[y,k]of Object.entries(b.b))for(let r=0;r<k;r++){const i=me(e,ve[y],"Chess",d,500,t-u-_,(s?o-h:h)-2*n,"right");_+=r===k-1?.85*i:"p"===y?.4*i:.6*i}})(this.tempCtx,this.width,this.height,this.scale,this.margin,this.style,this.getFinalHeader(),this.cfg.flipped,this.lastPosition,this.cfg.puzzle))}render(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.drawImage(this.tempCanvas,0,0)}async renderStatic(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);const{background:e,dark:t,light:o,border:n}=this.style;if(await re(this.ctx,this.width,this.height,0,0,n,this.loadImage),this.borderOnly)this.hollow&&this.ctx.clearRect(this.borderWidth,this.borderWidth+this.margin,this.innerSize,this.innerSize);else{await re(this.ctx,this.innerSize,this.innerSize,this.cfg.showBorder?this.borderWidth:0,(this.cfg.showBorder?this.borderWidth:0)+this.margin,e,this.loadImage,this.cfg.tiles);for(let e=0;e<this.cfg.tiles;e++)for(let n=0;n<this.cfg.tiles;n++){const r=n%2==0&&e%2==0||n%2!=0&&e%2!=0?o:t,i=n*this.squareSize+this.borderWidth,a=e*this.squareSize+this.borderWidth+this.margin;re(this.ctx,this.squareSize,this.squareSize,i,a,r,this.loadImage)}}}toImgUrl(){return this.canvas.toDataURL()}toImageData(){return this.ctx.getImageData(0,0,this.width,this.height)}toClampedArray(){return this.ctx.getImageData(0,0,this.width,this.height).data}toImgElement(){const e=this.toImgUrl(),t=new Image;return t.classList.add("board"),t.src=e,t}get width(){return this.size}get height(){return this.size+2*this.margin}toGIF(){}}const Te="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",$e=["1-0","0-1","1/2-1/2","*"],Pe={b:[16,32,17,15],w:[-16,-32,-17,-15]},ze={n:[-18,-33,-31,-14,18,33,31,14],b:[-17,-15,17,15],r:[-16,1,16,-1],q:[-17,-16,-15,1,17,16,15,-1],k:[-17,-16,-15,1,17,16,15,-1]},Ee=[20,0,0,0,0,0,0,24,0,0,0,0,0,0,20,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,24,24,24,24,24,24,56,0,56,24,24,24,24,24,24,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,20,0,0,0,0,0,0,24,0,0,0,0,0,0,20],Ne=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,0,16,0,15,0,0,0,0,0,0,0,0,0,0,0,0,17,16,15,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,-15,-16,-17,0,0,0,0,0,0,0,0,0,0,0,0,-15,0,-16,0,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],Ie={p:0,n:1,b:2,r:3,q:4,k:5},Oe={NORMAL:1,CAPTURE:2,BIG_PAWN:4,EP_CAPTURE:8,PROMOTION:16,KSIDE_CASTLE:32,QSIDE_CASTLE:64},Le={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},Be={w:[{square:Le.a1,flag:Oe.QSIDE_CASTLE},{square:Le.h1,flag:Oe.KSIDE_CASTLE}],b:[{square:Le.a8,flag:Oe.QSIDE_CASTLE},{square:Le.h8,flag:Oe.KSIDE_CASTLE}]};function Me(e){var t=e.charAt(0);if(t>="a"&&t<="h"){if(e.match(/[a-h]\d.*[a-h]\d/))return;return Xe}return"o"===(t=t.toLowerCase())?Ke:t}function Re(e){return e.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}function Fe(e){return e>>4}function De(e){return 15&e}function qe(e){var t=De(e),o=Fe(e);return"abcdefgh".substring(t,t+1)+"87654321".substring(o,o+1)}function je(e){return e===Ge?Ue:Ge}function He(e){var t=e instanceof Array?[]:{};for(var o in e)t[o]="object"==typeof o?He(e[o]):e[o];return t}function We(e){return e.replace(/^\s+|\s+$/g,"")}const Ue="b",Ge="w",Ve=-1,Xe="p",Qe="b",Ke="k";!function(){for(var e=[],t=Le.a8;t<=Le.h1;t++)136&t?t+=7:e.push(qe(t))}();const Ye={NORMAL:"n",CAPTURE:"c",BIG_PAWN:"b",EP_CAPTURE:"e",PROMOTION:"p",KSIDE_CASTLE:"k",QSIDE_CASTLE:"q"},Ze=function(e){var t=new Array(128),o={w:Ve,b:Ve},n=Ge,r={w:0,b:0},i=Ve,a=0,s=1,l=[],c={},d={};function u(e){void 0===e&&(e=!1),t=new Array(128),o={w:Ve,b:Ve},n=Ge,r={w:0,b:0},i=Ve,a=0,s=1,l=[],e||(c={}),d={},b(_())}function h(){for(var e=[],t={},o=function(e){e in d&&(t[e]=d[e])};l.length>0;)e.push(N());for(o(_());e.length>0;)E(e.pop()),o(_());d=t}function p(){f(Te)}function f(e,t){void 0===t&&(t=!1);var o=e.split(/\s+/),l=o[0],c=0;if(!g(e).valid)return!1;u(t);for(var d=0;d<l.length;d++){var h=l.charAt(d);if("/"===h)c+=8;else if(-1!=="0123456789".indexOf(h))c+=parseInt(h,10);else{var p=h<"a"?Ge:Ue;w({type:h.toLowerCase(),color:p},qe(c)),c++}}return n=o[1],o[2].indexOf("K")>-1&&(r.w|=Oe.KSIDE_CASTLE),o[2].indexOf("Q")>-1&&(r.w|=Oe.QSIDE_CASTLE),o[2].indexOf("k")>-1&&(r.b|=Oe.KSIDE_CASTLE),o[2].indexOf("q")>-1&&(r.b|=Oe.QSIDE_CASTLE),i="-"===o[3]?Ve:Le[o[3]],a=parseInt(o[4],10),s=parseInt(o[5],10),b(_()),!0}function g(e){var t="No errors.",o="FEN string must contain six space-delimited fields.",n="6th field (move number) must be a positive integer.",r="5th field (half move counter) must be a non-negative integer.",i="4th field (en-passant square) is invalid.",a="3rd field (castling availability) is invalid.",s="2nd field (side to move) is invalid.",l="1st field (piece positions) does not contain 8 '/'-delimited rows.",c="1st field (piece positions) is invalid [consecutive numbers].",d="1st field (piece positions) is invalid [invalid piece].",u="1st field (piece positions) is invalid [row too large].",h="Illegal en-passant square",p=e.split(/\s+/);if(6!==p.length)return{valid:!1,error_number:1,error:o};if(isNaN(parseInt(p[5]))||parseInt(p[5],10)<=0)return{valid:!1,error_number:2,error:n};if(isNaN(parseInt(p[4]))||parseInt(p[4],10)<0)return{valid:!1,error_number:3,error:r};if(!/^(-|[abcdefgh][36])$/.test(p[3]))return{valid:!1,error_number:4,error:i};if(!/^(KQ?k?q?|Qk?q?|kq?|q|-)$/.test(p[2]))return{valid:!1,error_number:5,error:a};if(!/^(w|b)$/.test(p[1]))return{valid:!1,error_number:6,error:s};var f=p[0].split("/");if(8!==f.length)return{valid:!1,error_number:7,error:l};for(var g=0;g<f.length;g++){for(var _=0,m=!1,b=0;b<f[g].length;b++)if(isNaN(f[g][b])){if(!/^[prnbqkPRNBQK]$/.test(f[g][b]))return{valid:!1,error_number:9,error:d};_+=1,m=!1}else{if(m)return{valid:!1,error_number:8,error:c};_+=parseInt(f[g][b],10),m=!0}if(8!==_)return{valid:!1,error_number:10,error:u}}return"3"==p[3][1]&&"w"==p[1]||"6"==p[3][1]&&"b"==p[1]?{valid:!1,error_number:11,error:h}:{valid:!0,error_number:0,error:t}}function _(){for(var e=0,o="",l=Le.a8;l<=Le.h1;l++){if(null==t[l])e++;else{e>0&&(o+=e,e=0);var c=t[l].color,d=t[l].type;o+=c===Ge?d.toUpperCase():d.toLowerCase()}l+1&136&&(e>0&&(o+=e),l!==Le.h1&&(o+="/"),e=0,l+=8)}var u="";r[Ge]&Oe.KSIDE_CASTLE&&(u+="K"),r[Ge]&Oe.QSIDE_CASTLE&&(u+="Q"),r[Ue]&Oe.KSIDE_CASTLE&&(u+="k"),r[Ue]&Oe.QSIDE_CASTLE&&(u+="q"),u=u||"-";var h=i===Ve?"-":qe(i);return[o,n,u,h,a,s].join(" ")}function m(e){for(var t=0;t<e.length;t+=2)"string"==typeof e[t]&&"string"==typeof e[t+1]&&(c[e[t]]=e[t+1]);return c}function b(e){l.length>0||(e!==Te?(c.SetUp="1",c.FEN=e):(delete c.SetUp,delete c.FEN))}function v(e){var o=t[Le[e]];return o?{type:o.type,color:o.color}:null}function w(e,n){if(!("type"in e)||!("color"in e))return!1;if(-1==="pnbrqkPNBRQK".indexOf(e.type.toLowerCase()))return!1;if(!(n in Le))return!1;var r=Le[n];return(e.type!=Ke||o[e.color]==Ve||o[e.color]==r)&&(t[r]={type:e.type,color:e.color},e.type===Ke&&(o[e.color]=r),b(_()),!0)}function y(e,t,o,r,i){var a={color:n,from:t,to:o,flags:r,piece:e[t].type};return i&&(a.flags|=Oe.PROMOTION,a.promotion=i),e[o]?a.captured=e[o].type:r&Oe.EP_CAPTURE&&(a.captured=Xe),a}function k(e){function a(e,t,o,n,r){if(e[o].type!==Xe||0!==Fe(n)&&7!==Fe(n))t.push(y(e,o,n,r));else for(var i=["q","r",Qe,"n"],a=0,s=i.length;a<s;a++)t.push(y(e,o,n,r,i[a]))}var s=[],l=n,c=je(l),d={b:1,w:6},u=Le.a8,h=Le.h1,p=!1,f=void 0===e||!("legal"in e)||e.legal,g=void 0===e||!("piece"in e)||"string"!=typeof e.piece||e.piece.toLowerCase();if(void 0!==e&&"square"in e){if(!(e.square in Le))return[];u=h=Le[e.square],p=!0}for(var _=u;_<=h;_++)if(136&_)_+=7;else{var m=t[_];if(null!=m&&m.color===l)if(m.type!==Xe||!0!==g&&g!==Xe){if(!0===g||g===m.type)for(var b=0,v=ze[m.type].length;b<v;b++){var w=ze[m.type][b];for(k=_;!(136&(k+=w));){if(null!=t[k]){if(t[k].color===l)break;a(t,s,_,k,Oe.CAPTURE);break}if(a(t,s,_,k,Oe.NORMAL),"n"===m.type||"k"===m.type)break}}}else{var k=_+Pe[l][0];if(null==t[k]){a(t,s,_,k,Oe.NORMAL);var k=_+Pe[l][1];d[l]===Fe(_)&&null==t[k]&&a(t,s,_,k,Oe.BIG_PAWN)}for(b=2;b<4;b++){136&(k=_+Pe[l][b])||(null!=t[k]&&t[k].color===c?a(t,s,_,k,Oe.CAPTURE):k===i&&a(t,s,_,i,Oe.EP_CAPTURE))}}}if(!(!0!==g&&g!==Ke||p&&h!==o[l])){if(r[l]&Oe.KSIDE_CASTLE){var x=(C=o[l])+2;null!=t[C+1]||null!=t[x]||S(c,o[l])||S(c,C+1)||S(c,x)||a(t,s,o[l],x,Oe.KSIDE_CASTLE)}if(r[l]&Oe.QSIDE_CASTLE){var C;x=(C=o[l])-2;null!=t[C-1]||null!=t[C-2]||null!=t[C-3]||S(c,o[l])||S(c,C-1)||S(c,x)||a(t,s,o[l],x,Oe.QSIDE_CASTLE)}}if(!f)return s;var T=[];for(_=0,v=s.length;_<v;_++)E(s[_]),A(l)||T.push(s[_]),N();return T}function x(e,t){var o="";if(e.flags&Oe.KSIDE_CASTLE)o="O-O";else if(e.flags&Oe.QSIDE_CASTLE)o="O-O-O";else{if(e.piece!==Xe){var n=function(e,t){for(var o=e.from,n=e.to,r=e.piece,i=0,a=0,s=0,l=0,c=t.length;l<c;l++){var d=t[l].from,u=t[l].to;r===t[l].piece&&o!==d&&n===u&&(i++,Fe(o)===Fe(d)&&a++,De(o)===De(d)&&s++)}return i>0?a>0&&s>0?qe(o):s>0?qe(o).charAt(1):qe(o).charAt(0):""}(e,t);o+=e.piece.toUpperCase()+n}e.flags&(Oe.CAPTURE|Oe.EP_CAPTURE)&&(e.piece===Xe&&(o+=qe(e.from)[0]),o+="x"),o+=qe(e.to),e.flags&Oe.PROMOTION&&(o+="="+e.promotion.toUpperCase())}return E(e),C()&&(T()?o+="#":o+="+"),N(),o}function S(e,o){for(var n=Le.a8;n<=Le.h1;n++)if(136&n)n+=7;else if(null!=t[n]&&t[n].color===e){var r=t[n],i=n-o,a=i+119;if(Ee[a]&1<<Ie[r.type]){if(r.type===Xe){if(i>0){if(r.color===Ge)return!0}else if(r.color===Ue)return!0;continue}if("n"===r.type||"k"===r.type)return!0;for(var s=Ne[a],l=n+s,c=!1;l!==o;){if(null!=t[l]){c=!0;break}l+=s}if(!c)return!0}}return!1}function A(e){return S(je(e),o[e])}function C(){return A(n)}function T(){return C()&&0===k().length}function $(){return!C()&&0===k().length}function P(){for(var e={},o=[],n=0,r=0,i=Le.a8;i<=Le.h1;i++)if(r=(r+1)%2,136&i)i+=7;else{var a=t[i];a&&(e[a.type]=a.type in e?e[a.type]+1:1,a.type===Qe&&o.push(r),n++)}if(2===n)return!0;if(3===n&&(1===e.b||1===e.n))return!0;if(n===e.b+2){var s=0,l=o.length;for(i=0;i<l;i++)s+=o[i];if(0===s||s===l)return!0}return!1}function z(){for(var e=[],t={},o=!1;;){var n=N();if(!n)break;e.push(n)}for(;;){var r=_().split(" ").slice(0,4).join(" ");if(t[r]=r in t?t[r]+1:1,t[r]>=3&&(o=!0),!e.length)break;E(e.pop())}return o}function E(e){var c=n,d=je(c);if(function(e){l.push({move:e,kings:{b:o.b,w:o.w},turn:n,castling:{b:r.b,w:r.w},ep_square:i,half_moves:a,move_number:s})}(e),t[e.to]=t[e.from],t[e.from]=null,e.flags&Oe.EP_CAPTURE&&(n===Ue?t[e.to-16]=null:t[e.to+16]=null),e.flags&Oe.PROMOTION&&(t[e.to]={type:e.promotion,color:c}),t[e.to].type===Ke){if(o[t[e.to].color]=e.to,e.flags&Oe.KSIDE_CASTLE){var u=e.to-1,h=e.to+1;t[u]=t[h],t[h]=null}else if(e.flags&Oe.QSIDE_CASTLE){u=e.to+1,h=e.to-2;t[u]=t[h],t[h]=null}r[c]=""}if(r[c])for(var p=0,f=Be[c].length;p<f;p++)if(e.from===Be[c][p].square&&r[c]&Be[c][p].flag){r[c]^=Be[c][p].flag;break}if(r[d])for(p=0,f=Be[d].length;p<f;p++)if(e.to===Be[d][p].square&&r[d]&Be[d][p].flag){r[d]^=Be[d][p].flag;break}i=e.flags&Oe.BIG_PAWN?"b"===n?e.to-16:e.to+16:Ve,e.piece===Xe||e.flags&(Oe.CAPTURE|Oe.EP_CAPTURE)?a=0:a++,n===Ue&&s++,n=je(n)}function N(){var e=l.pop();if(null==e)return null;var c=e.move;o=e.kings,n=e.turn,r=e.castling,i=e.ep_square,a=e.half_moves,s=e.move_number;var d,u,h=n,p=je(n);if(t[c.from]=t[c.to],t[c.from].type=c.piece,t[c.to]=null,c.flags&Oe.CAPTURE)t[c.to]={type:c.captured,color:p};else if(c.flags&Oe.EP_CAPTURE){var f;f=h===Ue?c.to-16:c.to+16,t[f]={type:Xe,color:p}}c.flags&(Oe.KSIDE_CASTLE|Oe.QSIDE_CASTLE)&&(c.flags&Oe.KSIDE_CASTLE?(d=c.to+1,u=c.to-1):c.flags&Oe.QSIDE_CASTLE&&(d=c.to-2,u=c.to+1),t[d]=t[u],t[u]=null);return c}function I(e,t){for(var o=Re(e),n=0;n<2;n++){if(1==n){if(!t)return null;var r=!1;if(c=o.match(/([pnbrqkPNBRQK])?([a-h][1-8])x?-?([a-h][1-8])([qrbnQRBN])?/)){var i=c[1],a=c[2],s=c[3],l=c[4];1==a.length&&(r=!0)}else{var c;if(c=o.match(/([pnbrqkPNBRQK])?([a-h]?[1-8]?)x?-?([a-h][1-8])([qrbnQRBN])?/)){i=c[1],a=c[2],s=c[3],l=c[4];if(1==a.length)r=!0}}}for(var d=Me(o),u=k({legal:!0,piece:i||d}),h=0,p=u.length;h<p;h++)switch(n){case 0:if(o===Re(x(u[h],u)))return u[h];break;case 1:if(c){if(!(i&&i.toLowerCase()!=u[h].piece||Le[a]!=u[h].from||Le[s]!=u[h].to||l&&l.toLowerCase()!=u[h].promotion))return u[h];if(r){var f=qe(u[h].from);if(!(i&&i.toLowerCase()!=u[h].piece||Le[s]!=u[h].to||a!=f[0]&&a!=f[1]||l&&l.toLowerCase()!=u[h].promotion))return u[h]}}}}return null}function O(e){var t=He(e);t.san=x(t,k({legal:!0})),t.to=qe(t.to),t.from=qe(t.from);var o="";for(var n in Oe)Oe[n]&t.flags&&(o+=Ye[n]);return t.flags=o,t}function L(e){for(var t=k({legal:!1}),o=0,r=n,i=0,a=t.length;i<a;i++){if(E(t[i]),!A(r))if(e-1>0)o+=L(e-1);else o++;N()}return o}return f(void 0===e?Te:e),{load:function(e){return f(e)},reset:function(){return p()},moves:function(e){for(var t=k(e),o=[],n=0,r=t.length;n<r;n++)void 0!==e&&"verbose"in e&&e.verbose?o.push(O(t[n])):o.push(x(t[n],k({legal:!0})));return o},in_check:function(){return C()},in_checkmate:function(){return T()},in_stalemate:function(){return $()},in_draw:function(){return a>=100||$()||P()||z()},insufficient_material:function(){return P()},in_threefold_repetition:function(){return z()},game_over:function(){return a>=100||T()||$()||P()||z()},validate_fen:function(e){return g(e)},fen:function(){return _()},board:function(){for(var e=[],o=[],n=Le.a8;n<=Le.h1;n++)null==t[n]?o.push(null):o.push({square:qe(n),type:t[n].type,color:t[n].color}),n+1&136&&(e.push(o),o=[],n+=8);return e},pgn:function(e){var t="object"==typeof e&&"string"==typeof e.newline_char?e.newline_char:"\n",o="object"==typeof e&&"number"==typeof e.max_width?e.max_width:0,n=[],r=!1;for(var i in c)n.push("["+i+' "'+c[i]+'"]'+t),r=!0;r&&l.length&&n.push(t);for(var a=function(e){var t=d[_()];void 0!==t&&(e=`${e}${e.length>0?" ":""}{${t}}`);return e},u=[];l.length>0;)u.push(N());var h=[],p="";for(0===u.length&&h.push(a(""));u.length>0;){p=a(p);var f=u.pop();if(l.length||"b"!==f.color)"w"===f.color&&(p.length&&h.push(p),p=s+".");else{const e=`${s}. ...`;p=p?`${p} ${e}`:e}p=p+" "+x(f,k({legal:!0})),E(f)}if(p.length&&h.push(a(p)),void 0!==c.Result&&h.push(c.Result),0===o)return n.join("")+h.join(" ");var g=function(){return n.length>0&&" "===n[n.length-1]&&(n.pop(),!0)},m=function(e,r){for(var i of r.split(" "))if(i){if(e+i.length>o){for(;g();)e--;n.push(t),e=0}n.push(i),e+=i.length,n.push(" "),e++}return g()&&e--,e},b=0;for(i=0;i<h.length;i++)b+h[i].length>o&&h[i].includes("{")?b=m(b,h[i]):(b+h[i].length>o&&0!==i?(" "===n[n.length-1]&&n.pop(),n.push(t),b=0):0!==i&&(n.push(" "),b++),n.push(h[i]),b+=h[i].length);return n.join("")},load_pgn:function(e,t){var o=void 0!==t&&"sloppy"in t&&t.sloppy;function n(e){return e.replace(/\\/g,"\\")}e=e.trim();var r="object"==typeof t&&"string"==typeof t.newline_char?t.newline_char:"\r?\n",i=new RegExp("^(\\[((?:"+n(r)+")|.)*\\])(?:\\s*"+n(r)+"){2}"),a=i.test(e)?i.exec(e)[1]:"";p();var s=function(e,t){for(var o="object"==typeof t&&"string"==typeof t.newline_char?t.newline_char:"\r?\n",r={},i=e.split(new RegExp(n(o))),a="",s="",l=0;l<i.length;l++){var c=/^\s*\[([A-Za-z]+)\s*"(.*)"\s*\]\s*$/;a=i[l].replace(c,"$1"),s=i[l].replace(c,"$2"),We(a).length>0&&(r[a]=s)}return r}(a,t),l="";for(var u in s)"fen"===u.toLowerCase()&&(l=s[u]),m([u,s[u]]);if(o){if(l&&!f(l,!0))return!1}else if(!("1"!==s.SetUp||"FEN"in s&&f(s.FEN,!0)))return!1;for(var h=function(e){return`{${function(e){return Array.from(e).map((function(e){return e.charCodeAt(0)<128?e.charCodeAt(0).toString(16):encodeURIComponent(e).replace(/\%/g,"").toLowerCase()})).join("")}((e=e.replace(new RegExp(n(r),"g")," ")).slice(1,e.length-1))}}`},g=function(e){if(e.startsWith("{")&&e.endsWith("}"))return function(e){return 0==e.length?"":decodeURIComponent("%"+e.match(/.{1,2}/g).join("%"))}(e.slice(1,e.length-1))},b=e.replace(a,"").replace(new RegExp(`({[^}]*})+?|;([^${n(r)}]*)`,"g"),(function(e,t,o){return void 0!==t?h(t):" "+h(`{${o.slice(1)}}`)})).replace(new RegExp(n(r),"g")," "),v=/(\([^\(\)]+\))+?/g;v.test(b);)b=b.replace(v,"");var w=We(b=(b=(b=b.replace(/\d+\.(\.\.)?/g,"")).replace(/\.\.\./g,"")).replace(/\$\d+/g,"")).split(new RegExp(/\s+/));w=w.join(",").replace(/,,+/g,",").split(",");for(var y="",k="",x=0;x<w.length;x++){var S=g(w[x]);if(void 0===S)if(null==(y=I(w[x],o))){if(!($e.indexOf(w[x])>-1))return!1;k=w[x]}else k="",E(y);else d[_()]=S}return k&&Object.keys(c).length&&!c.Result&&m(["Result",k]),!0},header:function(){return m(arguments)},turn:function(){return n},move:function(e,t){var o=void 0!==t&&"sloppy"in t&&t.sloppy,n=null;if("string"==typeof e)n=I(e,o);else if("object"==typeof e)for(var r=k(),i=0,a=r.length;i<a;i++)if(e.from===qe(r[i].from)&&e.to===qe(r[i].to)&&(!("promotion"in r[i])||e.promotion===r[i].promotion)){n=r[i];break}if(!n)return null;var s=O(n);return E(n),s},undo:function(){var e=N();return e?O(e):null},clear:function(){return u()},put:function(e,t){return w(e,t)},get:function(e){return v(e)},ascii(){for(var e="   +------------------------+\n",o=Le.a8;o<=Le.h1;o++){if(0===De(o)&&(e+=" "+"87654321"[Fe(o)]+" |"),null==t[o])e+=" . ";else{var n=t[o].type;e+=" "+(t[o].color===Ge?n.toUpperCase():n.toLowerCase())+" "}o+1&136&&(e+="|\n",o+=8)}return e+="   +------------------------+\n",e+="     a  b  c  d  e  f  g  h"},remove:function(e){return function(e){var n=v(e);return t[Le[e]]=null,n&&n.type===Ke&&(o[n.color]=Ve),b(_()),n}(e)},perft:function(e){return L(e)},square_color:function(e){if(e in Le){var t=Le[e];return(Fe(t)+De(t))%2==0?"light":"dark"}return null},history:function(e){for(var t=[],o=[],n=(void 0!==e&&"verbose"in e&&e.verbose);l.length>0;)t.push(N());for(;t.length>0;){var r=t.pop();n?o.push(O(r)):o.push(x(r,k({legal:!0}))),E(r)}return o},get_comment:function(){return d[_()]},set_comment:function(e){d[_()]=e.replace("{","[").replace("}","]")},delete_comment:function(){var e=d[_()];return delete d[_()],e},get_comments:function(){return h(),Object.keys(d).map((function(e){return{fen:e,comment:d[e]}}))},delete_comments:function(){return h(),Object.keys(d).map((function(e){var t=d[e];return delete d[e],{fen:e,comment:t}}))}}},Je={Event:"E",Site:"S",Round:"N",White:"W",Black:"B",Date:"D",Result:"R",FEN:"F",SetUp:"SU",WhiteElo:"WE",BlackElo:"BE",PuzzleTitle:"PT",PuzzleMotif:"PM",PuzzleDescription:"PD"},et=Object.keys(Je),tt=Object.fromEntries(Object.entries(Je).map((([e,t])=>[t,e]))),ot=e=>{const t=new Ze;if(t.load_pgn(e),t.delete_comments(),!t.header().Result){const o=(e.trim().match(/(1-0)|(0-1)|(1\/2-1\/2)$/)||[])[0];o&&t.header("Result",o)}const o=Object.entries(t.header()),[n,r]=o.length>0?t.pgn().split("\n\n"):[void 0,t.pgn()];return[o.filter((([e,t])=>et.includes(e)&&"?"!==t)).map((([e,t])=>`[${e} "${t}"]`)).sort().join("\n"),r].join("\n\n")},nt=e=>{const t=new Ze;t.load_pgn(e);const o=t.history().join(" "),n=Object.entries(t.header()).filter((([e])=>et.includes(e))).map((([e,t])=>`${Je[e]} ${t}`)).sort().join("\n");return btoa([n,o].join("\n\n"))},rt=e=>{const[t,o]=atob(e).split("\n\n");let n;return[t.split("\n").map((e=>{const[t,...o]=e.split(" "),r=o.join(" ");return"R"===t&&(n=r),`[${tt[t]} "${r}"]`})).join("\n"),o.split(" ").map(((e,t)=>t%2==0?`${t/2+1}. ${e}`:e)).join(" ")+` ${n}`].join("\n\n")},it=["January","February","March","April","May","June","July","August","September","October","November","December"],at=e=>{const[t,o,n]=e.split(".").map(Number),r=Number.isNaN(o)?null:it[o-1],i=Number.isNaN(n)||null===r?null:n,a=Number.isNaN(t)?null:t;return r&&i&&a?`${r} ${i}, ${a}`:r&&a?`${r} ${a}`:a?String(a):""},st=e=>e.split(",").map((e=>e.trim())).reverse().join(" "),lt=new Map([["q",9],["r",5],["b",3],["n",3],["p",1]]),ct=(e,t=null)=>e&&"?"!==e?e:t;class dt{constructor(){e(this,"positions",[]),e(this,"game",new Ze)}loadPGN(e){const t=new Ze,o=new Ze;t.load_pgn(ot(e)),t.delete_comments();const n=t.history({verbose:!0}),r=t.header().FEN;return r&&o.load(r),this.positions=[{ply:0,move:null,end:n.length,fen:o.fen(),check:o.in_check(),mate:o.in_checkmate(),turn:o.turn(),material:this.materialInfo(o.board()),placement:this.getPlacement(o.fen()),last:0===n.length}],n.forEach(((e,t)=>{o.move(e);const r=o.fen();this.positions.push({ply:t+1,move:e,end:n.length-1-t,fen:r,check:o.in_check(),mate:o.in_checkmate(),turn:o.turn(),material:this.materialInfo(o.board()),placement:this.getPlacement(r),last:t===n.length-1})})),this.game=t,this}loadFEN(e){return this.game=new Ze(e),this.positions=[{ply:0,move:null,end:0,fen:e,check:this.game.in_check(),mate:this.game.in_checkmate(),turn:this.game.turn(),material:this.materialInfo(this.game.board()),placement:this.getPlacement(this.game.fen()),last:!0}],this}getPlacement(e){const t=new Ze(e).board(),o=[];for(let n=0;n<8;n++)for(let e=0;e<8;e++)if(null!==t[n][e]){const{type:r,color:i}=t[n][e];o.push({x:e,y:n,type:r,color:i})}return o}materialInfo(e){const t=e.flat().filter(Boolean),o={w:0,b:0},n={w:{p:0,n:0,b:0,r:0,q:0},b:{p:0,n:0,b:0,r:0,q:0}},r={w:{p:0,n:0,b:0,r:0,q:0},b:{p:0,n:0,b:0,r:0,q:0}};for(const a of t)if(null!==a&&"k"!==a.type){var i;o[a.color]+=null!==(i=lt.get(a.type))&&void 0!==i?i:0,r[a.color][a.type]+=1;const e="b"===a.color?"w":"b";0===n[e][a.type]?n[a.color][a.type]+=1:n[e][a.type]-=1}return{sum:o,imbalance:n,count:r,diff:o.w-o.b}}get length(){return this.positions.length}get header(){const e=this.game.header(),t=ct(e.White,"Anonymous"),o=ct(e.Black,"Anonymous"),n=ct(e.Date);return{White:t,Black:o,WhitePretty:st(t),BlackPretty:st(o),WhiteElo:ct(e.WhiteElo),BlackElo:ct(e.BlackElo),Date:n,DatePretty:null===n?null:at(n),Event:ct(e.Event),Round:ct(e.Round),Site:ct(e.Site),Result:ct(e.Result),PuzzleTitle:ct(e.PuzzleTitle),PuzzleMotif:ct(e.PuzzleMotif),PuzzleDescription:ct(e.PuzzleDescription)}}getTitle({anonymous:e}){const t=this.header;return`${e?"Anonymous":t.WhitePretty} vs ${e?"Anonymous":t.BlackPretty}`+(t.Event?` | ${t.Event}`:"")+(t.Round?`, Round ${t.Round}`:"")+(t.DatePretty?` | ${t.DatePretty}`:"")}getShortTitle({anonymous:e}){const t=this.header;return`${e?"Anonymous":t.WhitePretty} vs ${e?"Anonymous":t.BlackPretty}`+(t.Event?` | ${t.Event}`:"")}getFileName(e){const t=this.header,o=e?"Anonymous":t.WhitePretty,n=e?"Anonymous":t.BlackPretty;return((t.Date?`${t.Date.replace(/\?/g,"X").replace(/\./g,"-")}_`:"")+`${o}_${n}`+(t.Event?`_${t.Event}`:"")+(t.Round?`_R${t.Round}`:"")).replace(/\s+/g,"-")}get pgn(){return this.game.pgn()}get anonymousPGN(){const e=this.game.pgn().replace(/\[White .+\]/,'[White "Anonymous"]').replace(/\[Black .+\]/,'[Black "Anonymous"]');return we(this.header.Site)?e.replace(/\[Site .+\]/,'[Site "?"]'):e}getPosition(e){const t=this.positions[e];return null!=t?t:null}getMoves(){return this.positions.slice(1).map((({move:e})=>null==e?void 0:e.san))}}var ut={exports:{}};ut.exports=gt,ut.exports.isMobile=gt,ut.exports.default=gt;const ht=/(android|bb\d+|meego).+mobile|armv7l|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|samsungbrowser|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,pt=/CrOS/,ft=/android|ipad|playbook|silk/i;function gt(e){e||(e={});let t=e.ua;if(t||"undefined"==typeof navigator||(t=navigator.userAgent),t&&t.headers&&"string"==typeof t.headers["user-agent"]&&(t=t.headers["user-agent"]),"string"!=typeof t)return!1;let o=ht.test(t)&&!pt.test(t)||!!e.tablet&&ft.test(t);return!o&&e.tablet&&e.featureDetect&&navigator&&navigator.maxTouchPoints>1&&-1!==t.indexOf("Macintosh")&&-1!==t.indexOf("Safari")&&(o=!0),o}var _t=ut.exports;const mt=Symbol("store-raw"),bt=Symbol("store-node"),vt=Symbol("store-name");function wt(e,t){let o=e[r];if(!o&&(Object.defineProperty(e,r,{value:o=new Proxy(e,Tt)}),!Array.isArray(e))){const t=Object.keys(e),n=Object.getOwnPropertyDescriptors(e);for(let r=0,i=t.length;r<i;r++){const i=t[r];if(n[i].get){const t=n[i].get.bind(o);Object.defineProperty(e,i,{get:t})}}}return o}function yt(e){let t;return null!=e&&"object"==typeof e&&(e[r]||!(t=Object.getPrototypeOf(e))||t===Object.prototype||Array.isArray(e))}function kt(e,t=new Set){let o,n,r,i;if(o=null!=e&&e[mt])return o;if(!yt(e)||t.has(e))return e;if(Array.isArray(e)){Object.isFrozen(e)?e=e.slice(0):t.add(e);for(let o=0,i=e.length;o<i;o++)r=e[o],(n=kt(r,t))!==r&&(e[o]=n)}else{Object.isFrozen(e)?e=Object.assign({},e):t.add(e);const o=Object.keys(e),a=Object.getOwnPropertyDescriptors(e);for(let s=0,l=o.length;s<l;s++)i=o[s],a[i].get||(r=e[i],(n=kt(r,t))!==r&&(e[i]=n))}return e}function xt(e){let t=e[bt];return t||Object.defineProperty(e,bt,{value:t={}}),t}function St(e,t,o){return e[t]||(e[t]=Ct(o))}function At(e){if(w()){const t=xt(e);(t._||(t._=Ct()))()}}function Ct(e){const[t,o]=_(e,{equals:!1,internal:!0});return t.$=o,t}const Tt={get(e,t,o){if(t===mt)return e;if(t===r)return o;if(t===i)return At(e),o;const n=xt(e),a=n.hasOwnProperty(t);let s=a?n[t]():e[t];if(t===bt||"__proto__"===t)return s;if(!a){const o=Object.getOwnPropertyDescriptor(e,t);!w()||"function"==typeof s&&!e.hasOwnProperty(t)||o&&o.get||(s=St(n,t,s)())}return yt(s)?wt(s):s},has(e,t){if(t===mt||t===r||t===i||t===bt||"__proto__"===t)return!0;const o=xt(e)[t];return o&&o(),t in e},set:()=>!0,deleteProperty:()=>!0,ownKeys:function(e){return At(e),Reflect.ownKeys(e)},getOwnPropertyDescriptor:function(e,t){const o=Reflect.getOwnPropertyDescriptor(e,t);return o&&!o.get&&o.configurable&&t!==r&&t!==bt&&t!==vt?(delete o.value,delete o.writable,o.get=()=>e[r][t],o):o}};function $t(e,t,o,n=!1){if(!n&&e[t]===o)return;const r=e[t],i=e.length;void 0===o?delete e[t]:e[t]=o;let a,s=xt(e);(a=St(s,t,r))&&a.$((()=>o)),Array.isArray(e)&&e.length!==i&&(a=St(s,"length",i))&&a.$(e.length),(a=s._)&&a.$()}function Pt(e,t){const o=Object.keys(t);for(let n=0;n<o.length;n+=1){const r=o[n];$t(e,r,t[r])}}function zt(e,t,o=[]){let n,r=e;if(t.length>1){n=t.shift();const i=typeof n,a=Array.isArray(e);if(Array.isArray(n)){for(let r=0;r<n.length;r++)zt(e,[n[r]].concat(t),o);return}if(a&&"function"===i){for(let r=0;r<e.length;r++)n(e[r],r)&&zt(e,[r].concat(t),o);return}if(a&&"object"===i){const{from:r=0,to:i=e.length-1,by:a=1}=n;for(let n=r;n<=i;n+=a)zt(e,[n].concat(t),o);return}if(t.length>1)return void zt(e[n],t,[n].concat(o));r=e[n],o=[n].concat(o)}let i=t[0];"function"==typeof i&&(i=i(r,o),i===r)||void 0===n&&null==i||(i=kt(i),void 0===n||yt(r)&&yt(i)&&!Array.isArray(i)?Pt(r,i):$t(e,n,i))}const Et=["halloween_purple","halloween_web","halloween_green","halloween_swamp","standard","spring","azure","violet","rose","peach","clay","rock","lila","leko","patina","mud","spun","gulf","silk","nobel","qootee","qootee_summer","qootee_pink","qootee_grape","marino","bay","havelock","picont","oracle","rhino","mist","pigeon","oxford","mandy","copper","salmon","camelot","cadillac","mona","carnation","tangerine","sienna","fuzzy","flamingo","orange","jaffa","ronchi","conifer","olive","turmeric","bahia","husk","york","sulu","sushi","salad","meadow","observatory","keppel","casal","mule","russett","sirocco","nevada","danny","danny_green","danny_cyan","danny_blue","danny_purple","danny_pink","danny_red","danny_yellow","lichess","danya","botez","avocado","mono_chico","mono_mojo","mono_mahogany","mono_mulberry","mono_blue","mono_teal","mono_goblin","mono_sycamore","mono_coral","mono_flamingo","mono_rose","mono_heliotrope","mono_cornflower","mono_dodger","mono_meadow","mono_mantis","mono_coper","mono_contessa","mono_terracotta","mono_harvest","mono_kashmir","mono_affair","mono_cadillac","mono_beaver","mono_asparagus","mono_amazon","mono_nevada","mono_mobster","mono_bw","mono_bw2","mono_sharechess_dark","mono_sharechess_light","smooth_sunset","smooth_summer","smooth_spring","smooth_forest","smooth_laguna","smooth_sea","smooth_violet","smooth_mono","contrast_a","contrast_b","contrast_c","contrast_d","rainbow_light","rainbow","rainbow_dark","rainbow_night","clouds_bermuda","clouds_kimberly","clouds_wisteria","clouds_rose","clouds_sandal","clouds_gimblet","clouds_cucumber","clouds_acapulco","chessception_brown","chessception_green","chessception_pink","chessception_violet","wood1","wood2","wood3","wood4","wood5","wood6","wood7","wood8","wood9","wood10","wood11","wood12","wood13","wood14","wood15","wood16","lines_parchment","lines_alabaster","lines_paper","lines_cardboard","grass1","grass2","grass3","grass4","asphalt1","asphalt2","asphalt3","asphalt4","leather1","leather2","leather3","leather4"],Nt={seasonal:["halloween_purple","halloween_web","halloween_green","halloween_swamp"],solid:["standard","spring","azure","violet","rose","peach","clay","rock","lila","leko","patina","mud","spun","gulf","silk","nobel","qootee","qootee_summer","qootee_pink","qootee_grape","marino","bay","havelock","picont","oracle","rhino","mist","pigeon","oxford","mandy","copper","salmon","camelot","cadillac","mona","carnation","tangerine","sienna","fuzzy","flamingo","orange","jaffa","ronchi","conifer","olive","turmeric","bahia","husk","york","sulu","sushi","salad","meadow","observatory","keppel","casal","mule","russett","sirocco","nevada","danny","danny_green","danny_cyan","danny_blue","danny_purple","danny_pink","danny_red","danny_yellow","lichess","danya","botez","avocado","mono_chico","mono_mojo","mono_mahogany","mono_mulberry","mono_blue","mono_teal","mono_goblin","mono_sycamore","mono_coral","mono_flamingo","mono_rose","mono_heliotrope","mono_cornflower","mono_dodger","mono_meadow","mono_mantis","mono_coper","mono_contessa","mono_terracotta","mono_harvest","mono_kashmir","mono_affair","mono_cadillac","mono_beaver","mono_asparagus","mono_amazon","mono_nevada","mono_mobster","mono_bw","mono_bw2","mono_sharechess_dark","mono_sharechess_light"],gradient:["smooth_sunset","smooth_summer","smooth_spring","smooth_forest","smooth_laguna","smooth_sea","smooth_violet","smooth_mono","contrast_a","contrast_b","contrast_c","contrast_d","rainbow_light","rainbow","rainbow_dark","rainbow_night"],texture:["clouds_bermuda","clouds_kimberly","clouds_wisteria","clouds_rose","clouds_sandal","clouds_gimblet","clouds_cucumber","clouds_acapulco","chessception_brown","chessception_green","chessception_pink","chessception_violet","wood1","wood2","wood3","wood4","wood5","wood6","wood7","wood8","wood9","wood10","wood11","wood12","wood13","wood14","wood15","wood16","lines_parchment","lines_alabaster","lines_paper","lines_cardboard","grass1","grass2","grass3","grass4","asphalt1","asphalt2","asphalt3","asphalt4","leather1","leather2","leather3","leather4"]},It=e=>(Et.includes(e.boardStyle)||delete e.boardStyle,le.includes(e.piecesStyle)||delete e.piecesStyle,e);var Ot={exports:{}};!function(e,t){!function(o,n){var r="function",i="undefined",a="object",s="string",l="model",c="name",d="type",u="vendor",h="version",p="architecture",f="console",g="mobile",_="tablet",m="smarttv",b="wearable",v="embedded",w="Amazon",y="Apple",k="ASUS",x="BlackBerry",S="Firefox",A="Google",C="Huawei",T="LG",$="Microsoft",P="Motorola",z="Opera",E="Samsung",N="Sony",I="Xiaomi",O="Zebra",L="Facebook",B=function(e){for(var t={},o=0;o<e.length;o++)t[e[o].toUpperCase()]=e[o];return t},M=function(e,t){return typeof e===s&&-1!==R(t).indexOf(R(e))},R=function(e){return e.toLowerCase()},F=function(e,t){if(typeof e===s)return e=e.replace(/^\s\s*/,"").replace(/\s\s*$/,""),typeof t===i?e:e.substring(0,255)},D=function(e,t){for(var o,i,s,l,c,d,u=0;u<t.length&&!c;){var h=t[u],p=t[u+1];for(o=i=0;o<h.length&&!c;)if(c=h[o++].exec(e))for(s=0;s<p.length;s++)d=c[++i],typeof(l=p[s])===a&&l.length>0?2===l.length?typeof l[1]==r?this[l[0]]=l[1].call(this,d):this[l[0]]=l[1]:3===l.length?typeof l[1]!==r||l[1].exec&&l[1].test?this[l[0]]=d?d.replace(l[1],l[2]):n:this[l[0]]=d?l[1].call(this,d,l[2]):n:4===l.length&&(this[l[0]]=d?l[3].call(this,d.replace(l[1],l[2])):n):this[l]=d||n;u+=2}},q=function(e,t){for(var o in t)if(typeof t[o]===a&&t[o].length>0){for(var r=0;r<t[o].length;r++)if(M(t[o][r],e))return"?"===o?n:o}else if(M(t[o],e))return"?"===o?n:o;return e},j={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},H={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[h,[c,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[h,[c,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[c,h],[/opios[\/ ]+([\w\.]+)/i],[h,[c,"Opera Mini"]],[/\bopr\/([\w\.]+)/i],[h,[c,z]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale|qqbrowserlite|qq)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[c,h],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[h,[c,"UCBrowser"]],[/\bqbcore\/([\w\.]+)/i],[h,[c,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[h,[c,"WeChat"]],[/konqueror\/([\w\.]+)/i],[h,[c,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[h,[c,"IE"]],[/yabrowser\/([\w\.]+)/i],[h,[c,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[c,/(.+)/,"$1 Secure Browser"],h],[/\bfocus\/([\w\.]+)/i],[h,[c,"Firefox Focus"]],[/\bopt\/([\w\.]+)/i],[h,[c,"Opera Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[h,[c,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[h,[c,"Dolphin"]],[/coast\/([\w\.]+)/i],[h,[c,"Opera Coast"]],[/miuibrowser\/([\w\.]+)/i],[h,[c,"MIUI Browser"]],[/fxios\/([-\w\.]+)/i],[h,[c,S]],[/\bqihu|(qi?ho?o?|360)browser/i],[[c,"360 Browser"]],[/(oculus|samsung|sailfish)browser\/([\w\.]+)/i],[[c,/(.+)/,"$1 Browser"],h],[/(comodo_dragon)\/([\w\.]+)/i],[[c,/_/g," "],h],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[c,h],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i],[c],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[c,L],h],[/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[c,h],[/\bgsa\/([\w\.]+) .*safari\//i],[h,[c,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[h,[c,"Chrome Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[c,"Chrome WebView"],h],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[h,[c,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[c,h],[/version\/([\w\.]+) .*mobile\/\w+ (safari)/i],[h,[c,"Mobile Safari"]],[/version\/([\w\.]+) .*(mobile ?safari|safari)/i],[h,c],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[c,[h,q,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[c,h],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[c,"Netscape"],h],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[h,[c,"Firefox Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[c,h]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[p,"amd64"]],[/(ia32(?=;))/i],[[p,R]],[/((?:i[346]|x)86)[;\)]/i],[[p,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[p,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[p,"armhf"]],[/windows (ce|mobile); ppc;/i],[[p,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[p,/ower/,"",R]],[/(sun4\w)[;\)]/i],[[p,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[p,R]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[pt]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[l,[u,E],[d,_]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[l,[u,E],[d,g]],[/\((ip(?:hone|od)[\w ]*);/i],[l,[u,y],[d,g]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[l,[u,y],[d,_]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[l,[u,C],[d,_]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}-[atu]?[ln][01259x][012359][an]?)\b(?!.+d\/s)/i],[l,[u,C],[d,g]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[l,/_/g," "],[u,I],[d,g]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[l,/_/g," "],[u,I],[d,_]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[l,[u,"OPPO"],[d,g]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[l,[u,"Vivo"],[d,g]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[l,[u,"Realme"],[d,g]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[l,[u,P],[d,g]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[l,[u,P],[d,_]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[l,[u,T],[d,_]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[l,[u,T],[d,g]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[l,[u,"Lenovo"],[d,_]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[l,/_/g," "],[u,"Nokia"],[d,g]],[/(pixel c)\b/i],[l,[u,A],[d,_]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[l,[u,A],[d,g]],[/droid.+ ([c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[l,[u,N],[d,g]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[l,"Xperia Tablet"],[u,N],[d,_]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[l,[u,"OnePlus"],[d,g]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[l,[u,w],[d,_]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[l,/(.+)/g,"Fire Phone $1"],[u,w],[d,g]],[/(playbook);[-\w\),; ]+(rim)/i],[l,u,[d,_]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[l,[u,x],[d,g]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[l,[u,k],[d,_]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[l,[u,k],[d,g]],[/(nexus 9)/i],[l,[u,"HTC"],[d,_]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic|sony)[-_ ]?([-\w]*)/i],[u,[l,/_/g," "],[d,g]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[l,[u,"Acer"],[d,_]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[l,[u,"Meizu"],[d,g]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[l,[u,"Sharp"],[d,g]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[u,l,[d,g]],[/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[u,l,[d,_]],[/(surface duo)/i],[l,[u,$],[d,_]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[l,[u,"Fairphone"],[d,g]],[/(u304aa)/i],[l,[u,"AT&T"],[d,g]],[/\bsie-(\w*)/i],[l,[u,"Siemens"],[d,g]],[/\b(rct\w+) b/i],[l,[u,"RCA"],[d,_]],[/\b(venue[\d ]{2,7}) b/i],[l,[u,"Dell"],[d,_]],[/\b(q(?:mv|ta)\w+) b/i],[l,[u,"Verizon"],[d,_]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[l,[u,"Barnes & Noble"],[d,_]],[/\b(tm\d{3}\w+) b/i],[l,[u,"NuVision"],[d,_]],[/\b(k88) b/i],[l,[u,"ZTE"],[d,_]],[/\b(nx\d{3}j) b/i],[l,[u,"ZTE"],[d,g]],[/\b(gen\d{3}) b.+49h/i],[l,[u,"Swiss"],[d,g]],[/\b(zur\d{3}) b/i],[l,[u,"Swiss"],[d,_]],[/\b((zeki)?tb.*\b) b/i],[l,[u,"Zeki"],[d,_]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[u,"Dragon Touch"],l,[d,_]],[/\b(ns-?\w{0,9}) b/i],[l,[u,"Insignia"],[d,_]],[/\b((nxa|next)-?\w{0,9}) b/i],[l,[u,"NextBook"],[d,_]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[u,"Voice"],l,[d,g]],[/\b(lvtel\-)?(v1[12]) b/i],[[u,"LvTel"],l,[d,g]],[/\b(ph-1) /i],[l,[u,"Essential"],[d,g]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[l,[u,"Envizen"],[d,_]],[/\b(trio[-\w\. ]+) b/i],[l,[u,"MachSpeed"],[d,_]],[/\btu_(1491) b/i],[l,[u,"Rotor"],[d,_]],[/(shield[\w ]+) b/i],[l,[u,"Nvidia"],[d,_]],[/(sprint) (\w+)/i],[u,l,[d,g]],[/(kin\.[onetw]{3})/i],[[l,/\./g," "],[u,$],[d,g]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[l,[u,O],[d,_]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[l,[u,O],[d,g]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[u,l,[d,f]],[/droid.+; (shield) bui/i],[l,[u,"Nvidia"],[d,f]],[/(playstation [345portablevi]+)/i],[l,[u,N],[d,f]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[l,[u,$],[d,f]],[/smart-tv.+(samsung)/i],[u,[d,m]],[/hbbtv.+maple;(\d+)/i],[[l,/^/,"SmartTV"],[u,E],[d,m]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[u,T],[d,m]],[/(apple) ?tv/i],[u,[l,"Apple TV"],[d,m]],[/crkey/i],[[l,"Chromecast"],[u,A],[d,m]],[/droid.+aft(\w)( bui|\))/i],[l,[u,w],[d,m]],[/\(dtv[\);].+(aquos)/i],[l,[u,"Sharp"],[d,m]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w ]*; *(\w[^;]*);([^;]*)/i],[[u,F],[l,F],[d,m]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[d,m]],[/((pebble))app/i],[u,l,[d,b]],[/droid.+; (glass) \d/i],[l,[u,A],[d,b]],[/droid.+; (wt63?0{2,3})\)/i],[l,[u,O],[d,b]],[/(quest( 2)?)/i],[l,[u,L],[d,b]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[u,[d,v]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[l,[d,g]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[l,[d,_]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[d,_]],[/(phone|mobile(?:[;\/]| safari)|pda(?=.+windows ce))/i],[[d,g]],[/(android[-\w\. ]{0,9});.+buil/i],[l,[u,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[h,[c,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[h,[c,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[c,h],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[h,c]],os:[[/microsoft (windows) (vista|xp)/i],[c,h],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[c,[h,q,j]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[c,"Windows"],[h,q,j]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[h,/_/g,"."],[c,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[c,"Mac OS"],[h,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86)/i],[h,c],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[c,h],[/\(bb(10);/i],[h,[c,x]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[h,[c,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[h,[c,"Firefox OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[h,[c,"webOS"]],[/crkey\/([\d\.]+)/i],[h,[c,"Chromecast"]],[/(cros) [\w]+ ([\w\.]+\w)/i],[[c,"Chromium OS"],h],[/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[c,h],[/(sunos) ?([\w\.\d]*)/i],[[c,"Solaris"],h],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[c,h]]},W=function(e,t){if(typeof e===a&&(t=e,e=n),!(this instanceof W))return new W(e,t).getResult();var r=e||(typeof o!==i&&o.navigator&&o.navigator.userAgent?o.navigator.userAgent:""),l=t?function(e,t){var o={};for(var n in e)t[n]&&t[n].length%2==0?o[n]=t[n].concat(e[n]):o[n]=e[n];return o}(H,t):H;return this.getBrowser=function(){var e,t={};return t.name=n,t.version=n,D.call(t,r,l.browser),t.major=typeof(e=t.version)===s?e.replace(/[^\d\.]/g,"").split(".")[0]:n,t},this.getCPU=function(){var e={};return e.architecture=n,D.call(e,r,l.cpu),e},this.getDevice=function(){var e={};return e.vendor=n,e.model=n,e.type=n,D.call(e,r,l.device),e},this.getEngine=function(){var e={};return e.name=n,e.version=n,D.call(e,r,l.engine),e},this.getOS=function(){var e={};return e.name=n,e.version=n,D.call(e,r,l.os),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return r},this.setUA=function(e){return r=typeof e===s&&e.length>255?F(e,255):e,this},this.setUA(r),this};W.VERSION="1.0.2",W.BROWSER=B([c,h,"major"]),W.CPU=B([p]),W.DEVICE=B([l,u,d,f,g,m,_,b,v]),W.ENGINE=W.OS=B([c,h]),e.exports&&(t=e.exports=W),t.UAParser=W;var U=typeof o!==i&&(o.jQuery||o.Zepto);if(U&&!U.ua){var G=new W;U.ua=G.getResult(),U.ua.get=function(){return G.getUA()},U.ua.set=function(e){G.setUA(e);var t=G.getResult();for(var o in t)U.ua[o]=t[o]}}}("object"==typeof window?window:pe)}(Ot,Ot.exports);const Lt=(0,Ot.exports)(),Bt=_t(),Mt=(()=>{const e=localStorage.getItem("boardConfig"),t=localStorage.getItem("gameConfig"),o=localStorage.getItem("siteConfig"),n=localStorage.getItem("recent"),r=localStorage.getItem("pieces"),i=localStorage.getItem("boards");return{boardConfig:null===e?{}:It(JSON.parse(e)),gameConfig:null===t?{}:JSON.parse(t),siteConfig:null===o?{}:JSON.parse(o),recent:null===n?[]:JSON.parse(n),pieces:null===r?new Set:new Set(JSON.parse(r)),boards:null===i?new Set:new Set(JSON.parse(i))}})(),Rt={boardConfig:{size:1024,tiles:8,boardStyle:"standard",piecesStyle:"tatiana",showBorder:!1,showExtraInfo:!0,showMaterial:!0,showMoveIndicator:!0,showChecks:!0,showCoords:!0,showShadows:!1,flipped:!1,puzzle:!1,...Mt.boardConfig},gameConfig:{titleScreen:!0,format:"GIF",picSize:"M",animationSize:"M",...Mt.gameConfig},siteConfig:{darkMode:!0,sounds:!0,speech:!1,wrongBrowserPopup:!0,androidAppPopup:!0,iOSAppPopup:!0,...Mt.siteConfig},game:new dt,pgn:"",fen:"",moves:[],ply:0,mobile:Bt,layout:window.innerWidth<window.innerHeight?"single":window.innerWidth<1366?"double":"triple",activeTab:"load",activeLeftTab:"share",playing:!1,anonymous:!1,refreshHash:!0,browser:Lt.browser.name,os:Lt.os.name,about:!1,userStylesInfo:!1,fullscreenPopup:null,recent:Mt.recent,favoritePieces:Mt.pieces,favoriteBoards:Mt.boards,showFavoritePieces:!1,showFavoriteBoards:!1},[Ft,Dt]=function(...[e,t]){const o=kt(e||{}),n=Array.isArray(o);return[wt(o),function(...e){T((()=>{n&&1===e.length?function(e,t){if("function"==typeof t&&(t=t(e)),t=kt(t),Array.isArray(t)){if(e===t)return;let o=0,n=t.length;for(;o<n;o++){const n=t[o];e[o]!==n&&$t(e,o,n)}$t(e,"length",n)}else Pt(e,t)}(o,e[0]):zt(o,e)}),!1)}]}(Rt);var qt={};
/*!
             *  howler.js v2.2.3
             *  howlerjs.com
             *
             *  (c) 2013-2020, James Simpson of GoldFire Studios
             *  goldfirestudios.com
             *
             *  MIT License
             */!function(e){!function(){var t=function(){this.init()};t.prototype={init:function(){var e=this||o;return e._counter=1e3,e._html5AudioPool=[],e.html5PoolSize=10,e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e._canPlayEvent="canplaythrough",e._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,e.masterGain=null,e.noAudio=!1,e.usingWebAudio=!0,e.autoSuspend=!0,e.ctx=null,e.autoUnlock=!0,e._setup(),e},volume:function(e){var t=this||o;if(e=parseFloat(e),t.ctx||d(),void 0!==e&&e>=0&&e<=1){if(t._volume=e,t._muted)return t;t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e,o.ctx.currentTime);for(var n=0;n<t._howls.length;n++)if(!t._howls[n]._webAudio)for(var r=t._howls[n]._getSoundIds(),i=0;i<r.length;i++){var a=t._howls[n]._soundById(r[i]);a&&a._node&&(a._node.volume=a._volume*e)}return t}return t._volume},mute:function(e){var t=this||o;t.ctx||d(),t._muted=e,t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e?0:t._volume,o.ctx.currentTime);for(var n=0;n<t._howls.length;n++)if(!t._howls[n]._webAudio)for(var r=t._howls[n]._getSoundIds(),i=0;i<r.length;i++){var a=t._howls[n]._soundById(r[i]);a&&a._node&&(a._node.muted=!!e||a._muted)}return t},stop:function(){for(var e=this||o,t=0;t<e._howls.length;t++)e._howls[t].stop();return e},unload:function(){for(var e=this||o,t=e._howls.length-1;t>=0;t--)e._howls[t].unload();return e.usingWebAudio&&e.ctx&&void 0!==e.ctx.close&&(e.ctx.close(),e.ctx=null,d()),e},codecs:function(e){return(this||o)._codecs[e.replace(/^x-/,"")]},_setup:function(){var e=this||o;if(e.state=e.ctx&&e.ctx.state||"suspended",e._autoSuspend(),!e.usingWebAudio)if("undefined"!=typeof Audio)try{void 0===(new Audio).oncanplaythrough&&(e._canPlayEvent="canplay")}catch(t){e.noAudio=!0}else e.noAudio=!0;try{(new Audio).muted&&(e.noAudio=!0)}catch(t){}return e.noAudio||e._setupCodecs(),e},_setupCodecs:function(){var e=this||o,t=null;try{t="undefined"!=typeof Audio?new Audio:null}catch(d){return e}if(!t||"function"!=typeof t.canPlayType)return e;var n=t.canPlayType("audio/mpeg;").replace(/^no$/,""),r=e._navigator?e._navigator.userAgent:"",i=r.match(/OPR\/([0-6].)/g),a=i&&parseInt(i[0].split("/")[1],10)<33,s=-1!==r.indexOf("Safari")&&-1===r.indexOf("Chrome"),l=r.match(/Version\/(.*?) /),c=s&&l&&parseInt(l[1],10)<15;return e._codecs={mp3:!(a||!n&&!t.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!n,opus:!!t.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(t.canPlayType('audio/wav; codecs="1"')||t.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!t.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!t.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(t.canPlayType("audio/x-m4a;")||t.canPlayType("audio/m4a;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(t.canPlayType("audio/x-m4b;")||t.canPlayType("audio/m4b;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(t.canPlayType("audio/x-mp4;")||t.canPlayType("audio/mp4;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!(c||!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!(c||!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!t.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(t.canPlayType("audio/x-flac;")||t.canPlayType("audio/flac;")).replace(/^no$/,"")},e},_unlockAudio:function(){var e=this||o;if(!e._audioUnlocked&&e.ctx){e._audioUnlocked=!1,e.autoUnlock=!1,e._mobileUnloaded||44100===e.ctx.sampleRate||(e._mobileUnloaded=!0,e.unload()),e._scratchBuffer=e.ctx.createBuffer(1,1,22050);var t=function(o){for(;e._html5AudioPool.length<e.html5PoolSize;)try{var n=new Audio;n._unlocked=!0,e._releaseHtml5Audio(n)}catch(o){e.noAudio=!0;break}for(var r=0;r<e._howls.length;r++)if(!e._howls[r]._webAudio)for(var i=e._howls[r]._getSoundIds(),a=0;a<i.length;a++){var s=e._howls[r]._soundById(i[a]);s&&s._node&&!s._node._unlocked&&(s._node._unlocked=!0,s._node.load())}e._autoResume();var l=e.ctx.createBufferSource();l.buffer=e._scratchBuffer,l.connect(e.ctx.destination),void 0===l.start?l.noteOn(0):l.start(0),"function"==typeof e.ctx.resume&&e.ctx.resume(),l.onended=function(){l.disconnect(0),e._audioUnlocked=!0,document.removeEventListener("touchstart",t,!0),document.removeEventListener("touchend",t,!0),document.removeEventListener("click",t,!0),document.removeEventListener("keydown",t,!0);for(var o=0;o<e._howls.length;o++)e._howls[o]._emit("unlock")}};return document.addEventListener("touchstart",t,!0),document.addEventListener("touchend",t,!0),document.addEventListener("click",t,!0),document.addEventListener("keydown",t,!0),e}},_obtainHtml5Audio:function(){var e=this||o;if(e._html5AudioPool.length)return e._html5AudioPool.pop();var t=(new Audio).play();return t&&"undefined"!=typeof Promise&&(t instanceof Promise||"function"==typeof t.then)&&t.catch((function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")})),new Audio},_releaseHtml5Audio:function(e){var t=this||o;return e._unlocked&&t._html5AudioPool.push(e),t},_autoSuspend:function(){var e=this;if(e.autoSuspend&&e.ctx&&void 0!==e.ctx.suspend&&o.usingWebAudio){for(var t=0;t<e._howls.length;t++)if(e._howls[t]._webAudio)for(var n=0;n<e._howls[t]._sounds.length;n++)if(!e._howls[t]._sounds[n]._paused)return e;return e._suspendTimer&&clearTimeout(e._suspendTimer),e._suspendTimer=setTimeout((function(){if(e.autoSuspend){e._suspendTimer=null,e.state="suspending";var t=function(){e.state="suspended",e._resumeAfterSuspend&&(delete e._resumeAfterSuspend,e._autoResume())};e.ctx.suspend().then(t,t)}}),3e4),e}},_autoResume:function(){var e=this;if(e.ctx&&void 0!==e.ctx.resume&&o.usingWebAudio)return"running"===e.state&&"interrupted"!==e.ctx.state&&e._suspendTimer?(clearTimeout(e._suspendTimer),e._suspendTimer=null):"suspended"===e.state||"running"===e.state&&"interrupted"===e.ctx.state?(e.ctx.resume().then((function(){e.state="running";for(var t=0;t<e._howls.length;t++)e._howls[t]._emit("resume")})),e._suspendTimer&&(clearTimeout(e._suspendTimer),e._suspendTimer=null)):"suspending"===e.state&&(e._resumeAfterSuspend=!0),e}};var o=new t,n=function(e){e.src&&0!==e.src.length?this.init(e):console.error("An array of source files must be passed with any new Howl.")};n.prototype={init:function(e){var t=this;return o.ctx||d(),t._autoplay=e.autoplay||!1,t._format="string"!=typeof e.format?e.format:[e.format],t._html5=e.html5||!1,t._muted=e.mute||!1,t._loop=e.loop||!1,t._pool=e.pool||5,t._preload="boolean"!=typeof e.preload&&"metadata"!==e.preload||e.preload,t._rate=e.rate||1,t._sprite=e.sprite||{},t._src="string"!=typeof e.src?e.src:[e.src],t._volume=void 0!==e.volume?e.volume:1,t._xhr={method:e.xhr&&e.xhr.method?e.xhr.method:"GET",headers:e.xhr&&e.xhr.headers?e.xhr.headers:null,withCredentials:!(!e.xhr||!e.xhr.withCredentials)&&e.xhr.withCredentials},t._duration=0,t._state="unloaded",t._sounds=[],t._endTimers={},t._queue=[],t._playLock=!1,t._onend=e.onend?[{fn:e.onend}]:[],t._onfade=e.onfade?[{fn:e.onfade}]:[],t._onload=e.onload?[{fn:e.onload}]:[],t._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],t._onplayerror=e.onplayerror?[{fn:e.onplayerror}]:[],t._onpause=e.onpause?[{fn:e.onpause}]:[],t._onplay=e.onplay?[{fn:e.onplay}]:[],t._onstop=e.onstop?[{fn:e.onstop}]:[],t._onmute=e.onmute?[{fn:e.onmute}]:[],t._onvolume=e.onvolume?[{fn:e.onvolume}]:[],t._onrate=e.onrate?[{fn:e.onrate}]:[],t._onseek=e.onseek?[{fn:e.onseek}]:[],t._onunlock=e.onunlock?[{fn:e.onunlock}]:[],t._onresume=[],t._webAudio=o.usingWebAudio&&!t._html5,void 0!==o.ctx&&o.ctx&&o.autoUnlock&&o._unlockAudio(),o._howls.push(t),t._autoplay&&t._queue.push({event:"play",action:function(){t.play()}}),t._preload&&"none"!==t._preload&&t.load(),t},load:function(){var e=this,t=null;if(o.noAudio)e._emit("loaderror",null,"No audio support.");else{"string"==typeof e._src&&(e._src=[e._src]);for(var n=0;n<e._src.length;n++){var i,s;if(e._format&&e._format[n])i=e._format[n];else{if("string"!=typeof(s=e._src[n])){e._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(i=/^data:audio\/([^;,]+);/i.exec(s))||(i=/\.([^.]+)$/.exec(s.split("?",1)[0])),i&&(i=i[1].toLowerCase())}if(i||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),i&&o.codecs(i)){t=e._src[n];break}}if(t)return e._src=t,e._state="loading","https:"===window.location.protocol&&"http:"===t.slice(0,5)&&(e._html5=!0,e._webAudio=!1),new r(e),e._webAudio&&a(e),e;e._emit("loaderror",null,"No codec support for selected audio sources.")}},play:function(e,t){var n=this,r=null;if("number"==typeof e)r=e,e=null;else{if("string"==typeof e&&"loaded"===n._state&&!n._sprite[e])return null;if(void 0===e&&(e="__default",!n._playLock)){for(var i=0,a=0;a<n._sounds.length;a++)n._sounds[a]._paused&&!n._sounds[a]._ended&&(i++,r=n._sounds[a]._id);1===i?e=null:r=null}}var s=r?n._soundById(r):n._inactiveSound();if(!s)return null;if(r&&!e&&(e=s._sprite||"__default"),"loaded"!==n._state){s._sprite=e,s._ended=!1;var l=s._id;return n._queue.push({event:"play",action:function(){n.play(l)}}),l}if(r&&!s._paused)return t||n._loadQueue("play"),s._id;n._webAudio&&o._autoResume();var c=Math.max(0,s._seek>0?s._seek:n._sprite[e][0]/1e3),d=Math.max(0,(n._sprite[e][0]+n._sprite[e][1])/1e3-c),u=1e3*d/Math.abs(s._rate),h=n._sprite[e][0]/1e3,p=(n._sprite[e][0]+n._sprite[e][1])/1e3;s._sprite=e,s._ended=!1;var f=function(){s._paused=!1,s._seek=c,s._start=h,s._stop=p,s._loop=!(!s._loop&&!n._sprite[e][2])};if(!(c>=p)){var g=s._node;if(n._webAudio){var _=function(){n._playLock=!1,f(),n._refreshBuffer(s);var e=s._muted||n._muted?0:s._volume;g.gain.setValueAtTime(e,o.ctx.currentTime),s._playStart=o.ctx.currentTime,void 0===g.bufferSource.start?s._loop?g.bufferSource.noteGrainOn(0,c,86400):g.bufferSource.noteGrainOn(0,c,d):s._loop?g.bufferSource.start(0,c,86400):g.bufferSource.start(0,c,d),u!==1/0&&(n._endTimers[s._id]=setTimeout(n._ended.bind(n,s),u)),t||setTimeout((function(){n._emit("play",s._id),n._loadQueue()}),0)};"running"===o.state&&"interrupted"!==o.ctx.state?_():(n._playLock=!0,n.once("resume",_),n._clearTimer(s._id))}else{var m=function(){g.currentTime=c,g.muted=s._muted||n._muted||o._muted||g.muted,g.volume=s._volume*o.volume(),g.playbackRate=s._rate;try{var r=g.play();if(r&&"undefined"!=typeof Promise&&(r instanceof Promise||"function"==typeof r.then)?(n._playLock=!0,f(),r.then((function(){n._playLock=!1,g._unlocked=!0,t?n._loadQueue():n._emit("play",s._id)})).catch((function(){n._playLock=!1,n._emit("playerror",s._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),s._ended=!0,s._paused=!0}))):t||(n._playLock=!1,f(),n._emit("play",s._id)),g.playbackRate=s._rate,g.paused)return void n._emit("playerror",s._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==e||s._loop?n._endTimers[s._id]=setTimeout(n._ended.bind(n,s),u):(n._endTimers[s._id]=function(){n._ended(s),g.removeEventListener("ended",n._endTimers[s._id],!1)},g.addEventListener("ended",n._endTimers[s._id],!1))}catch(i){n._emit("playerror",s._id,i)}};"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"===g.src&&(g.src=n._src,g.load());var b=window&&window.ejecta||!g.readyState&&o._navigator.isCocoonJS;if(g.readyState>=3||b)m();else{n._playLock=!0,n._state="loading";var v=function(){n._state="loaded",m(),g.removeEventListener(o._canPlayEvent,v,!1)};g.addEventListener(o._canPlayEvent,v,!1),n._clearTimer(s._id)}}return s._id}n._ended(s)},pause:function(e){var t=this;if("loaded"!==t._state||t._playLock)return t._queue.push({event:"pause",action:function(){t.pause(e)}}),t;for(var o=t._getSoundIds(e),n=0;n<o.length;n++){t._clearTimer(o[n]);var r=t._soundById(o[n]);if(r&&!r._paused&&(r._seek=t.seek(o[n]),r._rateSeek=0,r._paused=!0,t._stopFade(o[n]),r._node))if(t._webAudio){if(!r._node.bufferSource)continue;void 0===r._node.bufferSource.stop?r._node.bufferSource.noteOff(0):r._node.bufferSource.stop(0),t._cleanBuffer(r._node)}else isNaN(r._node.duration)&&r._node.duration!==1/0||r._node.pause();arguments[1]||t._emit("pause",r?r._id:null)}return t},stop:function(e,t){var o=this;if("loaded"!==o._state||o._playLock)return o._queue.push({event:"stop",action:function(){o.stop(e)}}),o;for(var n=o._getSoundIds(e),r=0;r<n.length;r++){o._clearTimer(n[r]);var i=o._soundById(n[r]);i&&(i._seek=i._start||0,i._rateSeek=0,i._paused=!0,i._ended=!0,o._stopFade(n[r]),i._node&&(o._webAudio?i._node.bufferSource&&(void 0===i._node.bufferSource.stop?i._node.bufferSource.noteOff(0):i._node.bufferSource.stop(0),o._cleanBuffer(i._node)):isNaN(i._node.duration)&&i._node.duration!==1/0||(i._node.currentTime=i._start||0,i._node.pause(),i._node.duration===1/0&&o._clearSound(i._node))),t||o._emit("stop",i._id))}return o},mute:function(e,t){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"mute",action:function(){n.mute(e,t)}}),n;if(void 0===t){if("boolean"!=typeof e)return n._muted;n._muted=e}for(var r=n._getSoundIds(t),i=0;i<r.length;i++){var a=n._soundById(r[i]);a&&(a._muted=e,a._interval&&n._stopFade(a._id),n._webAudio&&a._node?a._node.gain.setValueAtTime(e?0:a._volume,o.ctx.currentTime):a._node&&(a._node.muted=!!o._muted||e),n._emit("mute",a._id))}return n},volume:function(){var e,t,n,r=this,i=arguments;if(0===i.length)return r._volume;if(1===i.length||2===i.length&&void 0===i[1]){var a=r._getSoundIds(),s=a.indexOf(i[0]);s>=0?t=parseInt(i[0],10):e=parseFloat(i[0])}else i.length>=2&&(e=parseFloat(i[0]),t=parseInt(i[1],10));if(!(void 0!==e&&e>=0&&e<=1))return(n=t?r._soundById(t):r._sounds[0])?n._volume:0;if("loaded"!==r._state||r._playLock)return r._queue.push({event:"volume",action:function(){r.volume.apply(r,i)}}),r;void 0===t&&(r._volume=e),t=r._getSoundIds(t);for(var l=0;l<t.length;l++)(n=r._soundById(t[l]))&&(n._volume=e,i[2]||r._stopFade(t[l]),r._webAudio&&n._node&&!n._muted?n._node.gain.setValueAtTime(e,o.ctx.currentTime):n._node&&!n._muted&&(n._node.volume=e*o.volume()),r._emit("volume",n._id));return r},fade:function(e,t,n,r){var i=this;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"fade",action:function(){i.fade(e,t,n,r)}}),i;e=Math.min(Math.max(0,parseFloat(e)),1),t=Math.min(Math.max(0,parseFloat(t)),1),n=parseFloat(n),i.volume(e,r);for(var a=i._getSoundIds(r),s=0;s<a.length;s++){var l=i._soundById(a[s]);if(l){if(r||i._stopFade(a[s]),i._webAudio&&!l._muted){var c=o.ctx.currentTime,d=c+n/1e3;l._volume=e,l._node.gain.setValueAtTime(e,c),l._node.gain.linearRampToValueAtTime(t,d)}i._startFadeInterval(l,e,t,n,a[s],void 0===r)}}return i},_startFadeInterval:function(e,t,o,n,r,i){var a=this,s=t,l=o-t,c=Math.abs(l/.01),d=Math.max(4,c>0?n/c:n),u=Date.now();e._fadeTo=o,e._interval=setInterval((function(){var r=(Date.now()-u)/n;u=Date.now(),s+=l*r,s=Math.round(100*s)/100,s=l<0?Math.max(o,s):Math.min(o,s),a._webAudio?e._volume=s:a.volume(s,e._id,!0),i&&(a._volume=s),(o<t&&s<=o||o>t&&s>=o)&&(clearInterval(e._interval),e._interval=null,e._fadeTo=null,a.volume(o,e._id),a._emit("fade",e._id))}),d)},_stopFade:function(e){var t=this,n=t._soundById(e);return n&&n._interval&&(t._webAudio&&n._node.gain.cancelScheduledValues(o.ctx.currentTime),clearInterval(n._interval),n._interval=null,t.volume(n._fadeTo,e),n._fadeTo=null,t._emit("fade",e)),t},loop:function(){var e,t,o,n=this,r=arguments;if(0===r.length)return n._loop;if(1===r.length){if("boolean"!=typeof r[0])return!!(o=n._soundById(parseInt(r[0],10)))&&o._loop;e=r[0],n._loop=e}else 2===r.length&&(e=r[0],t=parseInt(r[1],10));for(var i=n._getSoundIds(t),a=0;a<i.length;a++)(o=n._soundById(i[a]))&&(o._loop=e,n._webAudio&&o._node&&o._node.bufferSource&&(o._node.bufferSource.loop=e,e&&(o._node.bufferSource.loopStart=o._start||0,o._node.bufferSource.loopEnd=o._stop,n.playing(i[a])&&(n.pause(i[a],!0),n.play(i[a],!0)))));return n},rate:function(){var e,t,n,r=this,i=arguments;if(0===i.length)t=r._sounds[0]._id;else if(1===i.length){var a=r._getSoundIds(),s=a.indexOf(i[0]);s>=0?t=parseInt(i[0],10):e=parseFloat(i[0])}else 2===i.length&&(e=parseFloat(i[0]),t=parseInt(i[1],10));if("number"!=typeof e)return(n=r._soundById(t))?n._rate:r._rate;if("loaded"!==r._state||r._playLock)return r._queue.push({event:"rate",action:function(){r.rate.apply(r,i)}}),r;void 0===t&&(r._rate=e),t=r._getSoundIds(t);for(var l=0;l<t.length;l++)if(n=r._soundById(t[l])){r.playing(t[l])&&(n._rateSeek=r.seek(t[l]),n._playStart=r._webAudio?o.ctx.currentTime:n._playStart),n._rate=e,r._webAudio&&n._node&&n._node.bufferSource?n._node.bufferSource.playbackRate.setValueAtTime(e,o.ctx.currentTime):n._node&&(n._node.playbackRate=e);var c=r.seek(t[l]),d=(r._sprite[n._sprite][0]+r._sprite[n._sprite][1])/1e3-c,u=1e3*d/Math.abs(n._rate);!r._endTimers[t[l]]&&n._paused||(r._clearTimer(t[l]),r._endTimers[t[l]]=setTimeout(r._ended.bind(r,n),u)),r._emit("rate",n._id)}return r},seek:function(){var e,t,n=this,r=arguments;if(0===r.length)n._sounds.length&&(t=n._sounds[0]._id);else if(1===r.length){var i=n._getSoundIds(),a=i.indexOf(r[0]);a>=0?t=parseInt(r[0],10):n._sounds.length&&(t=n._sounds[0]._id,e=parseFloat(r[0]))}else 2===r.length&&(e=parseFloat(r[0]),t=parseInt(r[1],10));if(void 0===t)return 0;if("number"==typeof e&&("loaded"!==n._state||n._playLock))return n._queue.push({event:"seek",action:function(){n.seek.apply(n,r)}}),n;var s=n._soundById(t);if(s){if(!("number"==typeof e&&e>=0)){if(n._webAudio){var l=n.playing(t)?o.ctx.currentTime-s._playStart:0,c=s._rateSeek?s._rateSeek-s._seek:0;return s._seek+(c+l*Math.abs(s._rate))}return s._node.currentTime}var d=n.playing(t);d&&n.pause(t,!0),s._seek=e,s._ended=!1,n._clearTimer(t),n._webAudio||!s._node||isNaN(s._node.duration)||(s._node.currentTime=e);var u=function(){d&&n.play(t,!0),n._emit("seek",t)};if(d&&!n._webAudio){var h=function(){n._playLock?setTimeout(h,0):u()};setTimeout(h,0)}else u()}return n},playing:function(e){var t=this;if("number"==typeof e){var o=t._soundById(e);return!!o&&!o._paused}for(var n=0;n<t._sounds.length;n++)if(!t._sounds[n]._paused)return!0;return!1},duration:function(e){var t=this,o=t._duration,n=t._soundById(e);return n&&(o=t._sprite[n._sprite][1]/1e3),o},state:function(){return this._state},unload:function(){for(var e=this,t=e._sounds,n=0;n<t.length;n++)t[n]._paused||e.stop(t[n]._id),e._webAudio||(e._clearSound(t[n]._node),t[n]._node.removeEventListener("error",t[n]._errorFn,!1),t[n]._node.removeEventListener(o._canPlayEvent,t[n]._loadFn,!1),t[n]._node.removeEventListener("ended",t[n]._endFn,!1),o._releaseHtml5Audio(t[n]._node)),delete t[n]._node,e._clearTimer(t[n]._id);var r=o._howls.indexOf(e);r>=0&&o._howls.splice(r,1);var a=!0;for(n=0;n<o._howls.length;n++)if(o._howls[n]._src===e._src||e._src.indexOf(o._howls[n]._src)>=0){a=!1;break}return i&&a&&delete i[e._src],o.noAudio=!1,e._state="unloaded",e._sounds=[],e=null,null},on:function(e,t,o,n){var r=this["_on"+e];return"function"==typeof t&&r.push(n?{id:o,fn:t,once:n}:{id:o,fn:t}),this},off:function(e,t,o){var n=this,r=n["_on"+e],i=0;if("number"==typeof t&&(o=t,t=null),t||o)for(i=0;i<r.length;i++){var a=o===r[i].id;if(t===r[i].fn&&a||!t&&a){r.splice(i,1);break}}else if(e)n["_on"+e]=[];else{var s=Object.keys(n);for(i=0;i<s.length;i++)0===s[i].indexOf("_on")&&Array.isArray(n[s[i]])&&(n[s[i]]=[])}return n},once:function(e,t,o){return this.on(e,t,o,1),this},_emit:function(e,t,o){for(var n=this,r=n["_on"+e],i=r.length-1;i>=0;i--)r[i].id&&r[i].id!==t&&"load"!==e||(setTimeout(function(e){e.call(this,t,o)}.bind(n,r[i].fn),0),r[i].once&&n.off(e,r[i].fn,r[i].id));return n._loadQueue(e),n},_loadQueue:function(e){var t=this;if(t._queue.length>0){var o=t._queue[0];o.event===e&&(t._queue.shift(),t._loadQueue()),e||o.action()}return t},_ended:function(e){var t=this,n=e._sprite;if(!t._webAudio&&e._node&&!e._node.paused&&!e._node.ended&&e._node.currentTime<e._stop)return setTimeout(t._ended.bind(t,e),100),t;var r=!(!e._loop&&!t._sprite[n][2]);if(t._emit("end",e._id),!t._webAudio&&r&&t.stop(e._id,!0).play(e._id),t._webAudio&&r){t._emit("play",e._id),e._seek=e._start||0,e._rateSeek=0,e._playStart=o.ctx.currentTime;var i=1e3*(e._stop-e._start)/Math.abs(e._rate);t._endTimers[e._id]=setTimeout(t._ended.bind(t,e),i)}return t._webAudio&&!r&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,e._rateSeek=0,t._clearTimer(e._id),t._cleanBuffer(e._node),o._autoSuspend()),t._webAudio||r||t.stop(e._id,!0),t},_clearTimer:function(e){var t=this;if(t._endTimers[e]){if("function"!=typeof t._endTimers[e])clearTimeout(t._endTimers[e]);else{var o=t._soundById(e);o&&o._node&&o._node.removeEventListener("ended",t._endTimers[e],!1)}delete t._endTimers[e]}return t},_soundById:function(e){for(var t=this,o=0;o<t._sounds.length;o++)if(e===t._sounds[o]._id)return t._sounds[o];return null},_inactiveSound:function(){var e=this;e._drain();for(var t=0;t<e._sounds.length;t++)if(e._sounds[t]._ended)return e._sounds[t].reset();return new r(e)},_drain:function(){var e=this,t=e._pool,o=0,n=0;if(!(e._sounds.length<t)){for(n=0;n<e._sounds.length;n++)e._sounds[n]._ended&&o++;for(n=e._sounds.length-1;n>=0;n--){if(o<=t)return;e._sounds[n]._ended&&(e._webAudio&&e._sounds[n]._node&&e._sounds[n]._node.disconnect(0),e._sounds.splice(n,1),o--)}}},_getSoundIds:function(e){if(void 0===e){for(var t=[],o=0;o<this._sounds.length;o++)t.push(this._sounds[o]._id);return t}return[e]},_refreshBuffer:function(e){return e._node.bufferSource=o.ctx.createBufferSource(),e._node.bufferSource.buffer=i[this._src],e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop||0),e._node.bufferSource.playbackRate.setValueAtTime(e._rate,o.ctx.currentTime),this},_cleanBuffer:function(e){var t=o._navigator&&o._navigator.vendor.indexOf("Apple")>=0;if(o._scratchBuffer&&e.bufferSource&&(e.bufferSource.onended=null,e.bufferSource.disconnect(0),t))try{e.bufferSource.buffer=o._scratchBuffer}catch(n){}return e.bufferSource=null,this},_clearSound:function(e){/MSIE |Trident\//.test(o._navigator&&o._navigator.userAgent)||(e.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var r=function(e){this._parent=e,this.init()};r.prototype={init:function(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._rate=t._rate,e._seek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++o._counter,t._sounds.push(e),e.create(),e},create:function(){var e=this,t=e._parent,n=o._muted||e._muted||e._parent._muted?0:e._volume;return t._webAudio?(e._node=void 0===o.ctx.createGain?o.ctx.createGainNode():o.ctx.createGain(),e._node.gain.setValueAtTime(n,o.ctx.currentTime),e._node.paused=!0,e._node.connect(o.masterGain)):o.noAudio||(e._node=o._obtainHtml5Audio(),e._errorFn=e._errorListener.bind(e),e._node.addEventListener("error",e._errorFn,!1),e._loadFn=e._loadListener.bind(e),e._node.addEventListener(o._canPlayEvent,e._loadFn,!1),e._endFn=e._endListener.bind(e),e._node.addEventListener("ended",e._endFn,!1),e._node.src=t._src,e._node.preload=!0===t._preload?"auto":t._preload,e._node.volume=n*o.volume(),e._node.load()),e},reset:function(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._rate=t._rate,e._seek=0,e._rateSeek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++o._counter,e},_errorListener:function(){var e=this;e._parent._emit("loaderror",e._id,e._node.error?e._node.error.code:0),e._node.removeEventListener("error",e._errorFn,!1)},_loadListener:function(){var e=this,t=e._parent;t._duration=Math.ceil(10*e._node.duration)/10,0===Object.keys(t._sprite).length&&(t._sprite={__default:[0,1e3*t._duration]}),"loaded"!==t._state&&(t._state="loaded",t._emit("load"),t._loadQueue()),e._node.removeEventListener(o._canPlayEvent,e._loadFn,!1)},_endListener:function(){var e=this,t=e._parent;t._duration===1/0&&(t._duration=Math.ceil(10*e._node.duration)/10,t._sprite.__default[1]===1/0&&(t._sprite.__default[1]=1e3*t._duration),t._ended(e)),e._node.removeEventListener("ended",e._endFn,!1)}};var i={},a=function(e){var t=e._src;if(i[t])return e._duration=i[t].duration,void c(e);if(/^data:[^;]+;base64,/.test(t)){for(var o=atob(t.split(",")[1]),n=new Uint8Array(o.length),r=0;r<o.length;++r)n[r]=o.charCodeAt(r);l(n.buffer,e)}else{var a=new XMLHttpRequest;a.open(e._xhr.method,t,!0),a.withCredentials=e._xhr.withCredentials,a.responseType="arraybuffer",e._xhr.headers&&Object.keys(e._xhr.headers).forEach((function(t){a.setRequestHeader(t,e._xhr.headers[t])})),a.onload=function(){var t=(a.status+"")[0];"0"===t||"2"===t||"3"===t?l(a.response,e):e._emit("loaderror",null,"Failed loading audio file with status: "+a.status+".")},a.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete i[t],e.load())},s(a)}},s=function(e){try{e.send()}catch(t){e.onerror()}},l=function(e,t){var n=function(){t._emit("loaderror",null,"Decoding audio data failed.")},r=function(e){e&&t._sounds.length>0?(i[t._src]=e,c(t,e)):n()};"undefined"!=typeof Promise&&1===o.ctx.decodeAudioData.length?o.ctx.decodeAudioData(e).then(r).catch(n):o.ctx.decodeAudioData(e,r,n)},c=function(e,t){t&&!e._duration&&(e._duration=t.duration),0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue())},d=function(){if(o.usingWebAudio){try{"undefined"!=typeof AudioContext?o.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?o.ctx=new webkitAudioContext:o.usingWebAudio=!1}catch(i){o.usingWebAudio=!1}o.ctx||(o.usingWebAudio=!1);var e=/iP(hone|od|ad)/.test(o._navigator&&o._navigator.platform),t=o._navigator&&o._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),n=t?parseInt(t[1],10):null;if(e&&n&&n<9){var r=/safari/.test(o._navigator&&o._navigator.userAgent.toLowerCase());o._navigator&&!r&&(o.usingWebAudio=!1)}o.usingWebAudio&&(o.masterGain=void 0===o.ctx.createGain?o.ctx.createGainNode():o.ctx.createGain(),o.masterGain.gain.setValueAtTime(o._muted?0:o._volume,o.ctx.currentTime),o.masterGain.connect(o.ctx.destination)),o._setup()}};e.Howler=o,e.Howl=n,void 0!==pe?(pe.HowlerGlobal=t,pe.Howler=o,pe.Howl=n,pe.Sound=r):"undefined"!=typeof window&&(window.HowlerGlobal=t,window.Howler=o,window.Howl=n,window.Sound=r)}(),
/*!
             *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
             *  
             *  howler.js v2.2.3
             *  howlerjs.com
             *
             *  (c) 2013-2020, James Simpson of GoldFire Studios
             *  goldfirestudios.com
             *
             *  MIT License
             */
function(){var e;HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){var t=this;if(!t.ctx||!t.ctx.listener)return t;for(var o=t._howls.length-1;o>=0;o--)t._howls[o].stereo(e);return t},HowlerGlobal.prototype.pos=function(e,t,o){var n=this;return n.ctx&&n.ctx.listener?(t="number"!=typeof t?n._pos[1]:t,o="number"!=typeof o?n._pos[2]:o,"number"!=typeof e?n._pos:(n._pos=[e,t,o],void 0!==n.ctx.listener.positionX?(n.ctx.listener.positionX.setTargetAtTime(n._pos[0],Howler.ctx.currentTime,.1),n.ctx.listener.positionY.setTargetAtTime(n._pos[1],Howler.ctx.currentTime,.1),n.ctx.listener.positionZ.setTargetAtTime(n._pos[2],Howler.ctx.currentTime,.1)):n.ctx.listener.setPosition(n._pos[0],n._pos[1],n._pos[2]),n)):n},HowlerGlobal.prototype.orientation=function(e,t,o,n,r,i){var a=this;if(!a.ctx||!a.ctx.listener)return a;var s=a._orientation;return t="number"!=typeof t?s[1]:t,o="number"!=typeof o?s[2]:o,n="number"!=typeof n?s[3]:n,r="number"!=typeof r?s[4]:r,i="number"!=typeof i?s[5]:i,"number"!=typeof e?s:(a._orientation=[e,t,o,n,r,i],void 0!==a.ctx.listener.forwardX?(a.ctx.listener.forwardX.setTargetAtTime(e,Howler.ctx.currentTime,.1),a.ctx.listener.forwardY.setTargetAtTime(t,Howler.ctx.currentTime,.1),a.ctx.listener.forwardZ.setTargetAtTime(o,Howler.ctx.currentTime,.1),a.ctx.listener.upX.setTargetAtTime(n,Howler.ctx.currentTime,.1),a.ctx.listener.upY.setTargetAtTime(r,Howler.ctx.currentTime,.1),a.ctx.listener.upZ.setTargetAtTime(i,Howler.ctx.currentTime,.1)):a.ctx.listener.setOrientation(e,t,o,n,r,i),a)},Howl.prototype.init=(e=Howl.prototype.init,function(t){var o=this;return o._orientation=t.orientation||[1,0,0],o._stereo=t.stereo||null,o._pos=t.pos||null,o._pannerAttr={coneInnerAngle:void 0!==t.coneInnerAngle?t.coneInnerAngle:360,coneOuterAngle:void 0!==t.coneOuterAngle?t.coneOuterAngle:360,coneOuterGain:void 0!==t.coneOuterGain?t.coneOuterGain:0,distanceModel:void 0!==t.distanceModel?t.distanceModel:"inverse",maxDistance:void 0!==t.maxDistance?t.maxDistance:1e4,panningModel:void 0!==t.panningModel?t.panningModel:"HRTF",refDistance:void 0!==t.refDistance?t.refDistance:1,rolloffFactor:void 0!==t.rolloffFactor?t.rolloffFactor:1},o._onstereo=t.onstereo?[{fn:t.onstereo}]:[],o._onpos=t.onpos?[{fn:t.onpos}]:[],o._onorientation=t.onorientation?[{fn:t.onorientation}]:[],e.call(this,t)}),Howl.prototype.stereo=function(e,o){var n=this;if(!n._webAudio)return n;if("loaded"!==n._state)return n._queue.push({event:"stereo",action:function(){n.stereo(e,o)}}),n;var r=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===o){if("number"!=typeof e)return n._stereo;n._stereo=e,n._pos=[e,0,0]}for(var i=n._getSoundIds(o),a=0;a<i.length;a++){var s=n._soundById(i[a]);if(s){if("number"!=typeof e)return s._stereo;s._stereo=e,s._pos=[e,0,0],s._node&&(s._pannerAttr.panningModel="equalpower",s._panner&&s._panner.pan||t(s,r),"spatial"===r?void 0!==s._panner.positionX?(s._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),s._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),s._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):s._panner.setPosition(e,0,0):s._panner.pan.setValueAtTime(e,Howler.ctx.currentTime)),n._emit("stereo",s._id)}}return n},Howl.prototype.pos=function(e,o,n,r){var i=this;if(!i._webAudio)return i;if("loaded"!==i._state)return i._queue.push({event:"pos",action:function(){i.pos(e,o,n,r)}}),i;if(o="number"!=typeof o?0:o,n="number"!=typeof n?-.5:n,void 0===r){if("number"!=typeof e)return i._pos;i._pos=[e,o,n]}for(var a=i._getSoundIds(r),s=0;s<a.length;s++){var l=i._soundById(a[s]);if(l){if("number"!=typeof e)return l._pos;l._pos=[e,o,n],l._node&&(l._panner&&!l._panner.pan||t(l,"spatial"),void 0!==l._panner.positionX?(l._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),l._panner.positionY.setValueAtTime(o,Howler.ctx.currentTime),l._panner.positionZ.setValueAtTime(n,Howler.ctx.currentTime)):l._panner.setPosition(e,o,n)),i._emit("pos",l._id)}}return i},Howl.prototype.orientation=function(e,o,n,r){var i=this;if(!i._webAudio)return i;if("loaded"!==i._state)return i._queue.push({event:"orientation",action:function(){i.orientation(e,o,n,r)}}),i;if(o="number"!=typeof o?i._orientation[1]:o,n="number"!=typeof n?i._orientation[2]:n,void 0===r){if("number"!=typeof e)return i._orientation;i._orientation=[e,o,n]}for(var a=i._getSoundIds(r),s=0;s<a.length;s++){var l=i._soundById(a[s]);if(l){if("number"!=typeof e)return l._orientation;l._orientation=[e,o,n],l._node&&(l._panner||(l._pos||(l._pos=i._pos||[0,0,-.5]),t(l,"spatial")),void 0!==l._panner.orientationX?(l._panner.orientationX.setValueAtTime(e,Howler.ctx.currentTime),l._panner.orientationY.setValueAtTime(o,Howler.ctx.currentTime),l._panner.orientationZ.setValueAtTime(n,Howler.ctx.currentTime)):l._panner.setOrientation(e,o,n)),i._emit("orientation",l._id)}}return i},Howl.prototype.pannerAttr=function(){var e,o,n,r=this,i=arguments;if(!r._webAudio)return r;if(0===i.length)return r._pannerAttr;if(1===i.length){if("object"!=typeof i[0])return(n=r._soundById(parseInt(i[0],10)))?n._pannerAttr:r._pannerAttr;e=i[0],void 0===o&&(e.pannerAttr||(e.pannerAttr={coneInnerAngle:e.coneInnerAngle,coneOuterAngle:e.coneOuterAngle,coneOuterGain:e.coneOuterGain,distanceModel:e.distanceModel,maxDistance:e.maxDistance,refDistance:e.refDistance,rolloffFactor:e.rolloffFactor,panningModel:e.panningModel}),r._pannerAttr={coneInnerAngle:void 0!==e.pannerAttr.coneInnerAngle?e.pannerAttr.coneInnerAngle:r._coneInnerAngle,coneOuterAngle:void 0!==e.pannerAttr.coneOuterAngle?e.pannerAttr.coneOuterAngle:r._coneOuterAngle,coneOuterGain:void 0!==e.pannerAttr.coneOuterGain?e.pannerAttr.coneOuterGain:r._coneOuterGain,distanceModel:void 0!==e.pannerAttr.distanceModel?e.pannerAttr.distanceModel:r._distanceModel,maxDistance:void 0!==e.pannerAttr.maxDistance?e.pannerAttr.maxDistance:r._maxDistance,refDistance:void 0!==e.pannerAttr.refDistance?e.pannerAttr.refDistance:r._refDistance,rolloffFactor:void 0!==e.pannerAttr.rolloffFactor?e.pannerAttr.rolloffFactor:r._rolloffFactor,panningModel:void 0!==e.pannerAttr.panningModel?e.pannerAttr.panningModel:r._panningModel})}else 2===i.length&&(e=i[0],o=parseInt(i[1],10));for(var a=r._getSoundIds(o),s=0;s<a.length;s++)if(n=r._soundById(a[s])){var l=n._pannerAttr;l={coneInnerAngle:void 0!==e.coneInnerAngle?e.coneInnerAngle:l.coneInnerAngle,coneOuterAngle:void 0!==e.coneOuterAngle?e.coneOuterAngle:l.coneOuterAngle,coneOuterGain:void 0!==e.coneOuterGain?e.coneOuterGain:l.coneOuterGain,distanceModel:void 0!==e.distanceModel?e.distanceModel:l.distanceModel,maxDistance:void 0!==e.maxDistance?e.maxDistance:l.maxDistance,refDistance:void 0!==e.refDistance?e.refDistance:l.refDistance,rolloffFactor:void 0!==e.rolloffFactor?e.rolloffFactor:l.rolloffFactor,panningModel:void 0!==e.panningModel?e.panningModel:l.panningModel};var c=n._panner;c?(c.coneInnerAngle=l.coneInnerAngle,c.coneOuterAngle=l.coneOuterAngle,c.coneOuterGain=l.coneOuterGain,c.distanceModel=l.distanceModel,c.maxDistance=l.maxDistance,c.refDistance=l.refDistance,c.rolloffFactor=l.rolloffFactor,c.panningModel=l.panningModel):(n._pos||(n._pos=r._pos||[0,0,-.5]),t(n,"spatial"))}return r},Sound.prototype.init=function(e){return function(){var t=this,o=t._parent;t._orientation=o._orientation,t._stereo=o._stereo,t._pos=o._pos,t._pannerAttr=o._pannerAttr,e.call(this),t._stereo?o.stereo(t._stereo):t._pos&&o.pos(t._pos[0],t._pos[1],t._pos[2],t._id)}}(Sound.prototype.init),Sound.prototype.reset=function(e){return function(){var t=this,o=t._parent;return t._orientation=o._orientation,t._stereo=o._stereo,t._pos=o._pos,t._pannerAttr=o._pannerAttr,t._stereo?o.stereo(t._stereo):t._pos?o.pos(t._pos[0],t._pos[1],t._pos[2],t._id):t._panner&&(t._panner.disconnect(0),t._panner=void 0,o._refreshBuffer(t)),e.call(this)}}(Sound.prototype.reset);var t=function(e,t){"spatial"===(t=t||"spatial")?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.panningModel=e._pannerAttr.panningModel,void 0!==e._panner.positionX?(e._panner.positionX.setValueAtTime(e._pos[0],Howler.ctx.currentTime),e._panner.positionY.setValueAtTime(e._pos[1],Howler.ctx.currentTime),e._panner.positionZ.setValueAtTime(e._pos[2],Howler.ctx.currentTime)):e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),void 0!==e._panner.orientationX?(e._panner.orientationX.setValueAtTime(e._orientation[0],Howler.ctx.currentTime),e._panner.orientationY.setValueAtTime(e._orientation[1],Howler.ctx.currentTime),e._panner.orientationZ.setValueAtTime(e._orientation[2],Howler.ctx.currentTime)):e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2])):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.setValueAtTime(e._stereo,Howler.ctx.currentTime)),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id,!0)}}()}(qt);const jt={move:new qt.Howl({src:["/sfx/move.mp3"],volume:.3}),take:new qt.Howl({src:["/sfx/take.mp3"],volume:.9}),swap:new qt.Howl({src:["/sfx/swap.mp3"],volume:.6}),snap:new qt.Howl({src:["/sfx/snap.mp3"],volume:.6}),rewind:new qt.Howl({src:["/sfx/rewind.mp3"],volume:1}),enPassant:new qt.Howl({src:["/sfx/anarchy/en-passant.mp3"],volume:.5}),horsyMove:new qt.Howl({src:["/sfx/anarchy/horsy-move.mp3"],volume:.5}),horsyTake:new qt.Howl({src:["/sfx/anarchy/horsy-take.mp3"],volume:.5}),brickMove:new qt.Howl({src:["/sfx/anarchy/brick-move.mp3"],volume:.3}),brickTake:new qt.Howl({src:["/sfx/anarchy/brick-take.mp3"],volume:.2}),brickCastle:new qt.Howl({src:["/sfx/anarchy/brick-castle.mp3"],volume:.3}),coneMove:new qt.Howl({src:["/sfx/anarchy/cone-move.mp3"],volume:1}),coneTake:new qt.Howl({src:["/sfx/anarchy/cone-take.mp3"],volume:.3}),pipiMove:new qt.Howl({src:["/sfx/anarchy/pipi-move.mp3"],volume:.2}),pipiTake:new qt.Howl({src:["/sfx/anarchy/pipi-take.mp3"],volume:.4}),toyMove:new qt.Howl({src:["/sfx/anarchy/toy-move.mp3"],volume:.9}),toyTake:new qt.Howl({src:["/sfx/anarchy/toy-take.mp3"],volume:.8}),deathMove:new qt.Howl({src:["/sfx/anarchy/death-move.mp3"],volume:.4}),deathTake:new qt.Howl({src:["/sfx/anarchy/death-take.mp3"],volume:.25}),death:new qt.Howl({src:["/sfx/anarchy/checkmate.mp3"],volume:1}),hit:new qt.Howl({src:["/sfx/anarchy/hit.mp3"],volume:.25})},Ht={x:" takes ","+":" check!","#":" mate!","=":" promotes to a ",P:"pawn ",R:"rook ",B:"bishop ",N:"knight ",Q:"queen ",K:"king ","O-O":"short castle","O-O-O":"long castle"},Wt=50,Ut=1,Gt="en-US";class Vt{constructor(){e(this,"voice",void 0),window.speechSynthesis?(this.setVoice(),window.speechSynthesis.onvoiceschanged=this.setVoice.bind(this)):this.voice=void 0}setVoice(){const e=speechSynthesis.getVoices();this.voice=e.length>0?e.find((e=>e.lang===Gt)):void 0}say(e){const t=new SpeechSynthesisUtterance(e);t.volume=Wt/100,t.lang=Gt,this.voice&&(t.voice=this.voice),t.rate=1+Ut/10,speechSynthesis.speak(t)}}const Xt=e=>new Promise((t=>setTimeout(t,e)));class Qt{constructor(t,o){e(this,"interval",1e3),e(this,"game",new dt),e(this,"ply",0),e(this,"callback",(()=>{})),e(this,"speech",void 0),e(this,"playing",!1),this.board=t,this.config=o,this.speech=new Vt}async init(){await this.board.frame(this.game.getPosition(0),this.game.header).then((e=>this.board.render()))}watch(e){this.callback=e}updateConfig(e){this.config={...this.config,...e}}getPosition(){const e=this.game.getPosition(this.ply);return Dt({ply:e.ply}),Dt({fen:e.fen}),e}async load(e){this.pause(),this.game=e,this.ply=0,await this.board.frame(this.getPosition(),this.game.header),this.board.render()}async play(){for(this.playing=!0,this.callback(this.playing,this.ply),this.ply===this.game.getMoves().length&&this.first();await Xt(this.interval),this.playing;)this.next()}pause(){this.playing=!1,this.callback(this.playing,this.ply)}async prev(){const e=this.ply-1;if(!(e<-1||e<0&&!1===this.config.titleScreen)){if(this.ply=e,-1===e)return await this.board.titleFrame(this.game.header),void this.board.render();await this.board.frame(this.getPosition(),this.game.header),this.board.render(),Ft.siteConfig.sounds&&jt.rewind.play()}}playSFX(e){var t,o;e.mate?jt.snap.play():/[ce]/.test(null===(t=e.move)||void 0===t?void 0:t.flags)?jt.take.play():/[kqp]/.test(null===(o=e.move)||void 0===o?void 0:o.flags)?jt.swap.play():jt.move.play()}playAnarchySFX(e){var t,o,n,r,i;if(null!==(t=e.move)&&void 0!==t&&t.flags&&e.move.flags.includes("e")?jt.enPassant.play():e.mate&&jt.death.play(),null!==(o=e.move)&&void 0!==o&&o.flags&&e.move.flags.includes("p")&&jt.brickCastle.play(),null!==(n=e.move)&&void 0!==n&&n.flags&&e.move.flags.includes("c"))switch(e.move.piece){case"p":jt.coneTake.play();break;case"r":jt.brickTake.play();break;case"n":jt.hit.play(),jt.horsyTake.play();break;case"k":jt.pipiTake.play();break;case"q":jt.deathTake.play();break;case"b":jt.toyTake.play();break;default:jt.take.play()}else if(/[kq]/.test(null===(r=e.move)||void 0===r?void 0:r.flags))jt.brickCastle.play();else switch(null===(i=e.move)||void 0===i?void 0:i.piece){case"p":jt.coneMove.play();break;case"r":jt.brickMove.play();break;case"n":jt.horsyMove.play();break;case"k":jt.pipiMove.play();break;case"q":jt.deathMove.play();break;case"b":jt.toyMove.play();break;default:jt.move.play()}}async next(){const e=this.ply+1;if(e>=this.game.length)return void this.pause();this.ply=e;const t=this.getPosition();if(await this.board.frame(t,this.game.header),this.board.render(),window.speechSynthesis&&Ft.siteConfig.speech){var o;if(this.ply>0)this.speech.say((e=>{if("O-O"===e||"O-O-O"===e)e=Ht[e];else{const t=e.match(/[a-h1-8][a-h][1-8]/);t&&(e=e.replace(t[0],`${t[0][0]} ${t[0][1]}${t[0][2]}`)),e=e.split("").map((e=>{var t;return null!==(t=Ht[e])&&void 0!==t?t:e})).join("").replace(/\s{2,}/g," ")}return e})(null===(o=t.move)||void 0===o?void 0:o.san));if(0===t.end){const e=this.game.header.Result;e&&this.speech.say("1-0"===e?"White wins!":"0-1"===e?"Black wins!":"Draw!")}}this.ply>0&&Ft.siteConfig.sounds&&(Ft.boardConfig.piecesStyle.includes("anarchy")?this.playAnarchySFX(t):this.playSFX(t))}async first(){this.ply=0,await this.board.frame(this.getPosition(),this.game.header),this.board.render()}async last(){this.ply=this.game.length-1,await this.board.frame(this.getPosition(),this.game.header),this.board.render()}async goto(e){this.ply=e,await this.board.frame(this.getPosition(),this.game.header),this.board.render()}}const Kt=U('<div class="header__options-ico"><i class="las"></i></div>'),Yt=U('<div class="header__options-ico" title="SUPPORT"><i class="las la-heart"></i></div>'),Zt=U('<a href="" class="header__support"><i class="las la-heart header__support-ico"></i> &nbsp;Support the project</a>'),Jt=U('<header class="header-box"><div class="header__logo"><a href="/"><div class="header__logo-pic"></div></a></div><div class="header__options"><div class="header__options-ico"><i class="las"></i></div><div class="header__options-ico"><i class="las"></i></div><div class="header__options-ico" title="VISIT SUBREDDIT"><a href="https://www.reddit.com/r/sharechess" target="_blank"><i class="lab la-reddit-alien"></i></a></div><div class="header__options-ico" title="SOURCE CODE"><a href="https://github.com/sharechess/sharechess" target="_blank"><i class="lab la-github"></i></a></div><div class="header__options-ico" title="ABOUT"><i class="las la-question-circle"></i></div></div></header>'),eo=e=>(()=>{const t=Jt.cloneNode(!0),o=t.firstChild.nextSibling,n=o.firstChild,r=n.firstChild,i=n.nextSibling,a=i.firstChild,s=i.nextSibling,l=s.nextSibling.nextSibling;return Q(n,"click",e.handlers.toggleDarkMode,!0),Q(i,"click",e.handlers.toggleSound,!0),K(o,R(D,{get when(){return window.speechSynthesis},get children(){const t=Kt.cloneNode(!0),o=t.firstChild;return Q(t,"click",e.handlers.toggleSpeech,!0),m((e=>{const n=Ft.siteConfig.speech?"SPEECH OFF":"SPEECH ON",r=!Ft.siteConfig.speech,i=!!Ft.siteConfig.speech;return n!==e._v$&&V(t,"title",e._v$=n),r!==e._v$2&&o.classList.toggle("la-deaf",e._v$2=r),i!==e._v$3&&o.classList.toggle("la-assistive-listening-systems",e._v$3=i),e}),{_v$:void 0,_v$2:void 0,_v$3:void 0}),t}}),s),l.$$click=()=>{Dt("fullscreenPopup","about"===Ft.fullscreenPopup?null:"about")},K(o,R(D,{get when(){return Ft.mobile},get children(){const e=Yt.cloneNode(!0);return e.$$click=()=>{Dt("fullscreenPopup","support"===Ft.fullscreenPopup?null:"support")},e}}),null),K(t,R(D,{get when(){return!Ft.mobile},get children(){const e=Zt.cloneNode(!0);return e.$$click=e=>{e.preventDefault(),Dt("fullscreenPopup","support")},e}}),null),m((e=>{const t=Ft.siteConfig.darkMode?"SWITCH TO LIGHT MODE":"SWITCH TO DARK MODE",o=!!Ft.siteConfig.darkMode,s=!Ft.siteConfig.darkMode,l=Ft.siteConfig.sounds?"MUTE":"SOUND ON",c=!Ft.siteConfig.sounds,d=!!Ft.siteConfig.sounds;return t!==e._v$4&&V(n,"title",e._v$4=t),o!==e._v$5&&r.classList.toggle("la-sun",e._v$5=o),s!==e._v$6&&r.classList.toggle("la-moon",e._v$6=s),l!==e._v$7&&V(i,"title",e._v$7=l),c!==e._v$8&&a.classList.toggle("la-volume-mute",e._v$8=c),d!==e._v$9&&a.classList.toggle("la-volume-up",e._v$9=d),e}),{_v$4:void 0,_v$5:void 0,_v$6:void 0,_v$7:void 0,_v$8:void 0,_v$9:void 0}),t})();G(["click"]);var to={},oo={};Object.defineProperty(oo,"__esModule",{value:!0});const no=(e,t=[])=>e.length<2?e:(...o)=>{return(n=[...t,...o]).length>=e.length?e(...n):no(e,n);var n};oo.curry=no,oo.default=no,Object.defineProperty(to,"__esModule",{value:!0}),to.chunk_=void 0;const ro=oo.curry(((e,t)=>{if(e<=0)throw new Error("Chunk size has to be greater than 0.");const o=new Array(Math.ceil(t.length/e));for(let n=0,r=0;n<t.length;n+=e,r++)o[r]=t.slice(n,n+e);return o}));to.chunk_=ro;var io=to.default=ro;const ao=U('<div><div class="scrollable__content"></div></div>'),so=e=>(()=>{const t=ao.cloneNode(!0);return K(t.firstChild,(()=>e.children)),m((()=>X(t,`scrollable ${e.class}`))),t})();const lo=U('<p class="moves__turn"></p>'),co=U('<div class="move"><span class="move__id">.</span><span class="move__ply"></span><span class="move__ply"></span></div>'),uo=e=>(function(e,t,o){s=P;const n=A(e,t,!1,1);n.user=!0,p?p.push(n):S(n)}((()=>{var e;Ft.mobile||(null===(e=document.querySelector(`[data-ply="${Ft.ply}"]`))||void 0===e||e.scrollIntoView())})),R(so,{get class(){return"moves"+(e.class?` ${e.class}`:"")},get children(){return[R(D,{get when(){return 0===e.moves.length},get children(){const e=lo.cloneNode(!0);return K(e,(()=>{const e=H((()=>!!Ft.game.getPosition(0).mate),!0);return()=>e()?"Checkmate.":"w"===Ft.game.getPosition(0).turn?"White to move.":"Black to move."})()),e}}),R(F,{get each(){return io(2,e.moves)},children:(t,o)=>{const[n,r]=t;return(()=>{const t=co.cloneNode(!0),i=t.firstChild,a=i.firstChild,s=i.nextSibling,l=s.nextSibling;return K(i,(()=>o()+1),a),s.$$click=()=>e.handlers.goto(2*o()+1),K(s,n),l.$$click=()=>e.handlers.goto(2*o()+2),K(l,r),m((e=>{const t=!(Ft.ply!==2*o()+1),n=2*o()+1,r=!(Ft.ply!==2*o()+2),i=2*o()+2;return t!==e._v$&&s.classList.toggle("move__ply--current",e._v$=t),n!==e._v$2&&V(s,"data-ply",e._v$2=n),r!==e._v$3&&l.classList.toggle("move__ply--current",e._v$3=r),i!==e._v$4&&V(l,"data-ply",e._v$4=i),e}),{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),t})()}})]}}));G(["click"]);const ho=U('<i class="las la-play"></i>'),po=U('<div class="controls"><button class="controls__button controls__button--first" title="FIRST"><i class="las la-angle-double-left"></i></button><button class="controls__button" title="PREV"><i class="las la-angle-left"></i></button><button class="controls__button"></button><button class="controls__button controls__button--next" title="NEXT"><i class="las la-angle-right"></i></button><button class="controls__button controls__button--last" title="LAST"><i class="las la-angle-double-right"></i></button><button title="FLIP" class="flip__button"><i class="las la-sync rotatable"></i></button></div>'),fo=U('<i class="las la-pause"></i>'),go=e=>(()=>{const t=po.cloneNode(!0),o=t.firstChild,n=o.nextSibling,r=n.nextSibling,i=r.nextSibling,a=i.nextSibling,s=a.nextSibling,l=s.firstChild;return Q(o,"click",e.handlers.first,!0),Q(n,"click",e.handlers.prev,!0),Q(r,"click",e.handlers.togglePlay,!0),K(r,R(D,{get when(){return!Ft.playing},get fallback(){return fo.cloneNode(!0)},get children(){return ho.cloneNode(!0)}})),Q(i,"click",e.handlers.next,!0),Q(a,"click",e.handlers.last,!0),Q(s,"click",e.handlers.flip,!0),m((e=>{const t=Ft.playing?"PAUSE":"PLAY",o=!!Ft.boardConfig.flipped;return t!==e._v$&&V(r,"title",e._v$=t),o!==e._v$2&&l.classList.toggle("rotated",e._v$2=o),e}),{_v$:void 0,_v$2:void 0}),t})();G(["click"]);const _o=e=>{if(null===e)return!1;try{return"https:"===new URL(e).protocol}catch{return!1}},mo=U("<span></span>"),bo=U('<span class="info__rating"> (<!>)</span>'),vo=U("<p></p>"),wo=U("<p>Round </p>"),yo=U("<a></a>"),ko=U('<div class="info"><div class="info__header"><div class="info__players"><div class="info__player"><div class="info__left"><button class="info__color info__color--white"></button></div><div class="info__right"><span class="info__score"></span></div></div><div class="info__player"><div class="info__left"><button class="info__color info__color--black"></button></div><div class="info__right"><span class="info__score"></span></div></div></div><div class="info__event"></div><div class="info__site"></div></div><div class="info__analyze"><button><i class="las la-vial"></i> </button></div></div>'),xo=e=>{const[t,o]=_(!1);return(()=>{const n=ko.cloneNode(!0),r=n.firstChild,i=r.firstChild,a=i.firstChild,s=a.firstChild;s.firstChild;const l=s.nextSibling.firstChild,c=a.nextSibling.firstChild;c.firstChild;const d=c.nextSibling.firstChild,u=i.nextSibling,h=u.nextSibling,p=r.nextSibling.firstChild;return p.firstChild.nextSibling,K(s,R(D,{get when(){return!Ft.anonymous},fallback:"Anonymous",get children(){return[(()=>{const e=mo.cloneNode(!0);return V(e,"contenteditable",!1),K(e,(()=>Ft.game.header.WhitePretty)),e})()," "]}}),null),K(s,R(D,{get when(){return Ft.game.header.WhiteElo},get children(){const e=bo.cloneNode(!0),t=e.firstChild.nextSibling;return t.nextSibling,K(e,(()=>Ft.game.header.WhiteElo),t),e}}),null),K(l,(()=>"1-0"===Ft.game.header.Result?"1":"0-1"===Ft.game.header.Result?"0":"1/2-1/2"===Ft.game.header.Result?"1/2":"")),K(c,R(D,{get when(){return!Ft.anonymous},fallback:"Anonymous",get children(){return[(()=>{const e=mo.cloneNode(!0);return V(e,"contenteditable",!1),K(e,(()=>Ft.game.header.BlackPretty)),e})()," "]}}),null),K(c,R(D,{get when(){return Ft.game.header.BlackElo},get children(){const e=bo.cloneNode(!0),t=e.firstChild.nextSibling;return t.nextSibling,K(e,(()=>Ft.game.header.BlackElo),t),e}}),null),K(d,(()=>"1-0"===Ft.game.header.Result?"0":"0-1"===Ft.game.header.Result?"1":"1/2-1/2"===Ft.game.header.Result?"1/2":"")),K(u,R(D,{get when(){return Ft.game.header.Event},get children(){const e=vo.cloneNode(!0);return K(e,(()=>Ft.game.header.Event)),e}}),null),K(u,R(D,{get when(){return Ft.game.header.Round},get children(){const e=wo.cloneNode(!0);return e.firstChild,K(e,(()=>Ft.game.header.Round),null),e}}),null),K(h,R(D,{get when(){return Ft.game.header.Site},get children(){const e=vo.cloneNode(!0);return K(e,R(D,{get when(){return!Ft.anonymous||!we(Ft.game.header.Site)},get children(){return R(D,{get when(){return _o(Ft.game.header.Site)},get fallback(){return Ft.game.header.Site},get children(){const e=yo.cloneNode(!0);return K(e,(()=>{var e;return null===(e=Ft.game.header.Site)||void 0===e?void 0:e.replace(/^https:\/\//,"")})),m((()=>{var t;return V(e,"href",null!==(t=Ft.game.header.Site)&&void 0!==t?t:"")})),e}})}})),e}}),null),K(h,R(D,{get when(){return Ft.game.header.DatePretty},get children(){const e=vo.cloneNode(!0);return K(e,(()=>Ft.game.header.DatePretty)),e}}),null),p.$$click=async()=>{await e.handlers.openOnLichess()||(o(!0),setTimeout((()=>o(!1)),1e3))},K(p,(()=>t()?"Cannot import to lichess":"Analyze on Lichess"),null),m((()=>p.classList.toggle("btn--error",!!t()))),n})()};G(["click"]);const So=e=>new Promise(((t,o)=>{const n=new FileReader;n.onload=()=>{t(n.result)},n.onerror=o,n.readAsText(e)}));const Ao=U('<button class="load__game-btn"><i class="las la-paste"></i> </button>'),Co=U("<hr>"),To=U('<textarea class="load__game-input" name="load-game" placeholder="Paste PGN, FEN or Lichess link..."></textarea>'),$o=U('<button class="load__game-btn"></button>'),Po=U('<input type="file" accept="application/vnd.chess-pgn,application/x-chess-pgn,.pgn">'),zo=U('<button class="load__pgn-btn load__pgn-file">Upload PGN file</button>'),Eo=U('<div class="load__pgn-file-info"><p>or</p><p>drop the PGN file anywhere on the page</p></div>'),No=U('<p class="load__daily-game"><a href="">Load game of the day</a></p>'),Io=U("<h2>Recent:</h2>"),Oo=U('<ul class="load__recent"></ul>'),Lo=U('<a href=""></a>'),Bo=U('<p class="load__recent-options"><a href="">clear all</a></p>'),Mo=U('<li class="load__recent-item"><a></a> <i class="las la-trash-alt load__recent-delete-item"></i></li>'),Ro=e=>{const[t,o]=_(""),[n,r]=_(!1),[i,a]=_(!1),[s,l]=_(!1);let c;return R(so,{get class(){return"load"+(e.class?` ${e.class}`:"")},get children(){return[(()=>{const t=Ao.cloneNode(!0);return t.firstChild.nextSibling,t.$$click=async()=>{await e.handlers.loadFromClipboard()||(r(!0),setTimeout((()=>r(!1)),1e3))},K(t,(()=>n()?"Incorrect data":"Load from clipboard"),null),m((()=>t.classList.toggle("btn--error",!!n()))),t})(),Co.cloneNode(!0),(()=>{const e=To.cloneNode(!0);return e.$$input=e=>o(e.currentTarget.value),V(e,"spellcheck",!1),m((()=>e.value=t())),e})(),(()=>{const n=$o.cloneNode(!0);return n.$$click=async()=>{await e.handlers.load(t())||(a(!0),setTimeout((()=>a(!1)),1e3)),o("")},K(n,(()=>i()?"Incorrect data":"LOAD")),m((()=>n.classList.toggle("btn--error",!!i()))),n})(),Co.cloneNode(!0),(()=>{const t=Po.cloneNode(!0);t.addEventListener("change",(async t=>{const o=t.target;if(null!=o&&o.files&&o.files.length>0){const t=await So(o.files[0]);Dt("refreshHash",!1),e.handlers.loadPGN(t)}}));var o,n,r;return"function"==typeof c?(o=c,n=t,v((()=>o(n,r)))):c=t,t.style.setProperty("display","none"),t})(),(()=>{const e=zo.cloneNode(!0);return e.$$click=()=>{c&&c.click()},e})(),R(D,{get when(){return!Ft.mobile},get children(){return Eo.cloneNode(!0)}}),Co.cloneNode(!0),(()=>{const t=No.cloneNode(!0);return t.firstChild.$$click=t=>{t.preventDefault(),e.handlers.loadGameOfTheDay()},t})(),R(D,{get when(){return Ft.recent.filter((e=>e.hash!==location.hash)).length>0},get children(){return[Io.cloneNode(!0),(()=>{const t=Oo.cloneNode(!0);return K(t,R(F,{get each(){return Ft.recent.filter((e=>e.hash!==location.hash)).slice(0,s()?void 0:5)},children:t=>(()=>{const o=Mo.cloneNode(!0),n=o.firstChild,r=n.nextSibling.nextSibling;return K(n,(()=>t.title.split(" | ")[0])),r.$$click=()=>e.handlers.deleteRecent(t.hash),m((()=>V(n,"href",t.hash))),o})()})),t})(),(()=>{const t=Bo.cloneNode(!0),o=t.firstChild;return K(t,R(D,{get when(){return Ft.recent.filter((e=>e.hash!==location.hash)).length>5},get children(){return[(()=>{const e=Lo.cloneNode(!0);return e.$$click=e=>{e.preventDefault(),l(!s())},K(e,(()=>s()?"show less":"show more")),e})()," ","|"," "]}}),o),Q(o,"click",e.handlers.clearRecent,!0),t})()]}})]}})};G(["click","input"]);const Fo=(e,t,o)=>{const n="string"==typeof e?e:URL.createObjectURL(e),r=document.createElement("a");r.href=n,r.download=`${t}.${o}`,r.target="_blank",r.click(),URL.revokeObjectURL(n)},Do=async e=>{const[t,o]=e.pathname.replace(/^\//,"").split("/").map((e=>e.trim()));if(/^(([a-z0-9]{8})|([a-z0-9]{12}))$/i.test(t)){const n=t.slice(0,8),r=await fetch(`https://lichess.org/game/export/${n}?evals=0&clocks=0`);if(!String(r.status).startsWith("2"))return{error:!0,errorType:"SERVER_ERROR"};return{error:!1,pgn:await r.text(),side:String(o).startsWith("black")||e.hash.startsWith("black")?"b":"w"}}return{error:!0,errorType:"INCORRECT_LINK"}},qo={pgn:"",fen:"",side:"w",ply:0};let jo={...qo};const Ho={set(e){if(e.fen)return jo={...qo},jo.fen=e.fen,void(location.hash=`fen/${jo.fen.replace(/ /g,"_")}`);e.pgn&&(jo={...qo},jo.pgn=nt(e.pgn)),e.side&&(jo.side=e.side),void 0!==e.ply&&(jo.ply=e.ply),location.hash=`pgn/${jo.side}/${jo.ply}/${jo.pgn}`},get:()=>location.href,getFENLink:e=>`${location.origin}/#fen/${e.replace(/ /g,"_")}`,async read(){const e=new URL(location.href),[t,...o]=location.hash.split("/");if(/fen/.test(t))jo={...qo},jo.fen=decodeURI(o.join("/")).replace(/_/g," ");else if(/pgn/.test(t)){const[e,t,...n]=o;jo.side=e,jo.ply=Number(t),jo.pgn=n.join("/"),jo.fen=""}else if(/lid/.test(t)){const[e,t,...n]=o;jo.side=e,jo.ply=Number(t);const r=await Do(new URL(`https://lichess.org/${n[0]}`));r.error?(jo.pgn="",jo.fen=""):(jo.pgn=nt(ot(r.pgn)),jo.fen="")}return{pgn:jo.pgn?rt(jo.pgn):"",fen:jo.fen,side:jo.side,ply:jo.ply,boardStyle:e.searchParams.get("b"),piecesStyle:e.searchParams.get("p")}},entries:()=>({...jo})},Wo=U('<div class="share__view"><h2 class="header--first">Board options</h2><button class="options__button" title="TOGGLE ANONYMOUS"><i class="las la-user-secret"></i></button><button class="options__button"><i class="las la-expand"></i></button><button class="options__button"><i class="las la-info-circle"></i></button><button class="options__button"><i class="las la-heading"></i></button><button class="options__button"><i class="las la-cloud"></i></button><button class="options__button" title="RENDER AS PUZZLE"><i class="las la-puzzle-piece"></i></button><button class="options__button options__button--last options__button--active" title="RANDOM STYLE"><i class="las la-dice-three"></i></button></div>'),Uo=U("<hr>"),Go=U('<div class="share__fen"><h2>Current position</h2><input type="text" name="current_fen" readonly placeholder="Current FEN..."><div class="double"><button class="share__btn share__btn--left"></button><button class="share__btn share__btn--right"></button></div><hr class="invisible"><button class="share__size share__size--first" title="360px">XS</button><button class="share__size" title="512px">S</button><button class="share__size" title="720px">M</button><button class="share__size" title="1024px">L</button><button class="share__size share__size--last" title="1440px">XL</button><button class="share__btn"></button></div>'),Vo=U('<div class="share__pgn"><h2>Game</h2><div class="double"><button class="share__btn"></button><button class="share__btn"></button></div><div class="double"><button class="share__btn">Export PGN</button><button class="share__btn"></button></div></div>'),Xo=U('<div class="share__animation"><hr class="invisible"><button class="share__size share__size--first" title="360px">XS</button><button class="share__size" title="512px">S</button><button class="share__size" title="720px">M</button><button class="share__size" title="1024px">L</button><button class="share__size share__size--last" title="1440px">XL</button><button class="share__format share__format--first">GIF</button><button class="share__format">MP4</button><button class="share__format share__format--last">WebM</button><button class="share__create-animation"></button></div>'),Qo=U('<button class="share__stylus">INSTALL STYLES<br><span>for lichess.org, chess.com & more</span></button>'),Ko=e=>{const[t,o]=_(""),[n,r]=_(!1),[i,a]=_(!1),s=e=>{o(e),setTimeout((()=>o("")),1e3)};return R(so,{get class(){return"share"+(e.class?` ${e.class}`:"")},get children(){return[(()=>{const t=Wo.cloneNode(!0),o=t.firstChild.nextSibling,n=o.nextSibling,r=n.nextSibling,i=r.nextSibling,a=i.nextSibling,s=a.nextSibling,l=s.nextSibling;return Q(o,"click",e.handlers.toggleAnonymous,!0),Q(n,"click",e.handlers.toggleBorder,!0),Q(r,"click",e.handlers.toggleExtraInfo,!0),Q(i,"click",e.handlers.toggleTitleScreen,!0),Q(a,"click",e.handlers.toggleShadows,!0),Q(s,"click",e.handlers.togglePuzzle,!0),Q(l,"click",e.handlers.randomStyle,!0),m((e=>{const t=!!Ft.anonymous,l=!!Ft.boardConfig.showBorder,c=Ft.boardConfig.showBorder?"HIDE BORDER":"SHOW BORDER",d=!!Ft.boardConfig.showExtraInfo,u=Ft.boardConfig.showExtraInfo?"HIDE EXTRA INFO":"SHOW EXTRA INFO",h=!!Ft.gameConfig.titleScreen,p=Ft.gameConfig.titleScreen?"EXCLUDE TITLE SCREEN":"INCLUDE TITLE SCREEN",f=!!Ft.boardConfig.showShadows,g=Ft.boardConfig.showShadows?"HIDE SHADOWS":"SHOW SHADOWS",_=!!Ft.boardConfig.puzzle;return t!==e._v$&&o.classList.toggle("options__button--active",e._v$=t),l!==e._v$2&&n.classList.toggle("options__button--active",e._v$2=l),c!==e._v$3&&V(n,"title",e._v$3=c),d!==e._v$4&&r.classList.toggle("options__button--active",e._v$4=d),u!==e._v$5&&V(r,"title",e._v$5=u),h!==e._v$6&&i.classList.toggle("options__button--active",e._v$6=h),p!==e._v$7&&V(i,"title",e._v$7=p),f!==e._v$8&&a.classList.toggle("options__button--active",e._v$8=f),g!==e._v$9&&V(a,"title",e._v$9=g),_!==e._v$10&&s.classList.toggle("options__button--active",e._v$10=_),e}),{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0,_v$5:void 0,_v$6:void 0,_v$7:void 0,_v$8:void 0,_v$9:void 0,_v$10:void 0}),t})(),Uo.cloneNode(!0),(()=>{const o=Go.cloneNode(!0),i=o.firstChild.nextSibling,a=i.nextSibling,l=a.firstChild,c=l.nextSibling,d=a.nextSibling.nextSibling,u=d.nextSibling,h=u.nextSibling,p=h.nextSibling,f=p.nextSibling,g=f.nextSibling;return i.$$click=e=>{e.target.select()},l.$$click=()=>{navigator.clipboard.writeText(Ft.fen),s("fen")},K(l,(()=>"fen"===t()?"Copied!":"Copy FEN")),c.$$click=()=>{navigator.clipboard.writeText(Ho.getFENLink(Ft.fen)),s("fen-link")},K(c,(()=>"fen-link"===t()?"Copied!":"Copy link")),d.$$click=()=>Dt("gameConfig","picSize","XS"),u.$$click=()=>Dt("gameConfig","picSize","S"),h.$$click=()=>Dt("gameConfig","picSize","M"),p.$$click=()=>Dt("gameConfig","picSize","L"),f.$$click=()=>Dt("gameConfig","picSize","XL"),g.$$click=async()=>{r(!0),await e.handlers.downloadImage(),r(!1)},K(g,(()=>n()?"Please wait...":"Save as image")),m((e=>{const t=!("XS"!==Ft.gameConfig.picSize),o=!("S"!==Ft.gameConfig.picSize),n=!("M"!==Ft.gameConfig.picSize),r=!("L"!==Ft.gameConfig.picSize),i=!("XL"!==Ft.gameConfig.picSize);return t!==e._v$11&&d.classList.toggle("share__size--active",e._v$11=t),o!==e._v$12&&u.classList.toggle("share__size--active",e._v$12=o),n!==e._v$13&&h.classList.toggle("share__size--active",e._v$13=n),r!==e._v$14&&p.classList.toggle("share__size--active",e._v$14=r),i!==e._v$15&&f.classList.toggle("share__size--active",e._v$15=i),e}),{_v$11:void 0,_v$12:void 0,_v$13:void 0,_v$14:void 0,_v$15:void 0}),m((()=>i.value=Ft.fen)),o})(),R(D,{get when(){return Ft.pgn},get children(){return[Uo.cloneNode(!0),(()=>{const e=Vo.cloneNode(!0),o=e.firstChild.nextSibling,n=o.firstChild,r=n.nextSibling,i=o.nextSibling.firstChild,a=i.nextSibling;return n.$$click=()=>{navigator.clipboard.writeText(Ft.anonymous?Ft.game.anonymousPGN:Ft.pgn),s("pgn")},K(n,(()=>"pgn"===t()?"Copied!":"Copy PGN")),r.$$click=()=>{navigator.clipboard.writeText(window.location.href),s("pgn-link")},K(r,(()=>"pgn-link"===t()?"Copied!":"Copy link")),i.$$click=()=>{const e=new Blob([Ft.pgn],{type:"application/vnd.chess-pgn;charset=utf-8"}),t=Ft.game.getFileName(Ft.anonymous);Fo(e,t,"pgn")},a.$$click=()=>{const e=`[${Ft.game.getTitle({anonymous:Ft.anonymous})}](${window.location.href})`;navigator.clipboard.writeText(e),s("markdown")},K(a,(()=>"markdown"===t()?"Copied!":"Copy markdown")),e})(),(()=>{const t=Xo.cloneNode(!0),o=t.firstChild.nextSibling,n=o.nextSibling,r=n.nextSibling,s=r.nextSibling,l=s.nextSibling,c=l.nextSibling,d=c.nextSibling,u=d.nextSibling,h=u.nextSibling;return o.$$click=()=>Dt("gameConfig","animationSize","XS"),n.$$click=()=>Dt("gameConfig","animationSize","S"),r.$$click=()=>Dt("gameConfig","animationSize","M"),s.$$click=()=>Dt("gameConfig","animationSize","L"),l.$$click=()=>Dt("gameConfig","animationSize","XL"),c.$$click=()=>Dt("gameConfig","format","GIF"),d.$$click=()=>Dt("gameConfig","format","MP4"),u.$$click=()=>Dt("gameConfig","format","WebM"),h.$$click=async()=>{a(!0),await e.handlers.downloadAnimation(),a(!1)},K(h,(()=>i()?"Please wait...":"Save animation")),m((e=>{const t=!("XS"!==Ft.gameConfig.animationSize),i=!("S"!==Ft.gameConfig.animationSize),a=!("M"!==Ft.gameConfig.animationSize),h=!("L"!==Ft.gameConfig.animationSize),p=!("XL"!==Ft.gameConfig.animationSize),f=!("GIF"!==Ft.gameConfig.format),g=!("MP4"!==Ft.gameConfig.format),_=!("WebM"!==Ft.gameConfig.format);return t!==e._v$16&&o.classList.toggle("share__size--active",e._v$16=t),i!==e._v$17&&n.classList.toggle("share__size--active",e._v$17=i),a!==e._v$18&&r.classList.toggle("share__size--active",e._v$18=a),h!==e._v$19&&s.classList.toggle("share__size--active",e._v$19=h),p!==e._v$20&&l.classList.toggle("share__size--active",e._v$20=p),f!==e._v$21&&c.classList.toggle("share__format--active",e._v$21=f),g!==e._v$22&&d.classList.toggle("share__format--active",e._v$22=g),_!==e._v$23&&u.classList.toggle("share__format--active",e._v$23=_),e}),{_v$16:void 0,_v$17:void 0,_v$18:void 0,_v$19:void 0,_v$20:void 0,_v$21:void 0,_v$22:void 0,_v$23:void 0}),t})()]}}),R(D,{get when(){return H((()=>!Ft.mobile),!0)()&&["Chrome","Firefox","Opera"].includes(Ft.browser)},get children(){return[Uo.cloneNode(!0),(()=>{const e=Qo.cloneNode(!0);return e.$$click=()=>Dt("fullscreenPopup","styles"),e})()]}})]}})};G(["click"]);const Yo=U('<a target="_blank" class="collection__action collection__stylus" title="Install via Stylus"></a>'),Zo=U('<a target="_blank" class="collection__action collection__download" title="Download"></a>'),Jo=U('<div class="collection__card"><div></div><div class="collection__actions"><a href="" class="collection__action collection__favorite" title="Add to favorites"></a></div></div>'),en=e=>(()=>{const t=Jo.cloneNode(!0),o=t.firstChild,n=o.nextSibling,r=n.firstChild;return o.$$click=()=>{Dt("boardConfig","boardStyle",e.item.key),e.handlers.changeBoardStyle(e.item.key)},V(o,"draggable",!1),r.$$click=t=>{t.preventDefault(),e.handlers.toggleFavoriteBoard(e.item.key)},K(n,R(D,{get when(){return!Ft.mobile},get children(){return[(()=>{const t=Yo.cloneNode(!0);return m((()=>V(t,"href",`stylus/boards/${e.item.key}.user.css`))),t})(),(()=>{const t=Zo.cloneNode(!0);return m((()=>V(t,"href",`download/boards/${e.item.key}.zip`))),t})()]}}),null),m((t=>{const n="collection__ico boards__ico"+(Ft.boardConfig.boardStyle===e.item.key?" collection__ico--active":""),i=`url(${e.item.img})`,a=e.item.key,s=!!Ft.favoriteBoards.has(e.item.key);return n!==t._v$&&X(o,t._v$=n),i!==t._v$2&&o.style.setProperty("background-image",t._v$2=i),a!==t._v$3&&V(o,"title",t._v$3=a),s!==t._v$4&&r.classList.toggle("collection__favorite--active",t._v$4=s),t}),{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),t})();G(["click"]);const tn=U('<p class="switch"><button class="switch__btn switch__btn--left">All</button><button class="switch__btn switch__btn--right">Favorite</button></p>'),on=U('<div class="collection_cards"></div>'),nn=U('<div class="collection_cards"><h2 class="collection__title"></h2></div>'),rn=e=>R(so,{get class(){return"collection"+(e.class?` ${e.class}`:"")},get children(){return[(()=>{const e=tn.cloneNode(!0),t=e.firstChild,o=t.nextSibling;return t.$$click=()=>Dt("showFavoriteBoards",!1),o.$$click=()=>Dt("showFavoriteBoards",!0),m((e=>{const n=!Ft.showFavoriteBoards,r=!!Ft.showFavoriteBoards;return n!==e._v$&&t.classList.toggle("switch__btn--active",e._v$=n),r!==e._v$2&&o.classList.toggle("switch__btn--active",e._v$2=r),e}),{_v$:void 0,_v$2:void 0}),e})(),R(D,{get when(){return!Ft.showFavoriteBoards},get children(){return R(F,{get each(){return Object.entries(Nt).filter((([e])=>"hidden"!==e))},children:([t,o])=>(()=>{const n=nn.cloneNode(!0);return K(n.firstChild,t),K(n,R(F,{each:o,children:t=>R(en,{get handlers(){return e.handlers},item:{key:t,img:`/boards/ico/${t}_ico.png`}})}),null),n})()})}}),R(D,{get when(){return Ft.showFavoriteBoards},get children(){const t=on.cloneNode(!0);return K(t,R(F,{get each(){return Et.filter((e=>Ft.favoriteBoards.has(e)))},children:t=>R(en,{get handlers(){return e.handlers},item:{key:t,img:`/boards/ico/${t}_ico.png`}})})),t}})]}});G(["click"]);const an=U('<a target="_blank" class="collection__action collection__stylus" title="Install via Stylus"></a>'),sn=U('<a class="collection__action collection__download" title="Download"></a>'),ln=U('<div class="collection__card"><div></div><div class="collection__actions"><a href="" class="collection__action collection__favorite" title="Add to favorites"></a></div></div>'),cn=e=>(()=>{const t=ln.cloneNode(!0),o=t.firstChild,n=o.nextSibling,r=n.firstChild;return o.$$click=()=>{Dt("boardConfig","piecesStyle",e.item.key),e.handlers.changePiecesStyle(e.item.key)},V(o,"draggable",!1),r.$$click=t=>{t.preventDefault(),e.handlers.toggleFavoritePieces(e.item.key)},K(n,R(D,{get when(){return!Ft.mobile},get children(){return[(()=>{const t=an.cloneNode(!0);return m((()=>V(t,"href",`stylus/pieces/${e.item.key}${Ft.boardConfig.showShadows?"_shadows":""}.user.css`))),t})(),(()=>{const t=sn.cloneNode(!0);return m((()=>V(t,"href",`download/pieces/${e.item.key}.zip`))),t})()]}}),null),m((t=>{const n="collection__ico"+(Ft.boardConfig.piecesStyle===e.item.key?" collection__ico--active":""),i=`url(${e.item.img})`,a=e.item.key,s=!!Ft.favoritePieces.has(e.item.key);return n!==t._v$&&X(o,t._v$=n),i!==t._v$2&&o.style.setProperty("background-image",t._v$2=i),a!==t._v$3&&V(o,"title",t._v$3=a),s!==t._v$4&&r.classList.toggle("collection__favorite--active",t._v$4=s),t}),{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),t})();G(["click"]);const dn=U('<p class="switch"><button class="switch__btn switch__btn--left">All</button><button class="switch__btn switch__btn--right">Favorite</button></p>'),un=U('<div class="collection_cards"></div>'),hn=U('<div class="collection_cards"><h2 class="collection__title"></h2></div>'),pn=e=>R(so,{get class(){return"collection"+(e.class?` ${e.class}`:"")},get children(){return[(()=>{const e=dn.cloneNode(!0),t=e.firstChild,o=t.nextSibling;return t.$$click=()=>Dt("showFavoritePieces",!1),o.$$click=()=>Dt("showFavoritePieces",!0),m((e=>{const n=!Ft.showFavoritePieces,r=!!Ft.showFavoritePieces;return n!==e._v$&&t.classList.toggle("switch__btn--active",e._v$=n),r!==e._v$2&&o.classList.toggle("switch__btn--active",e._v$2=r),e}),{_v$:void 0,_v$2:void 0}),e})(),R(D,{get when(){return!Ft.showFavoritePieces},get children(){return R(F,{get each(){return Object.entries(se).filter((([e])=>"hidden"!==e))},children:([t,o])=>(()=>{const n=hn.cloneNode(!0);return K(n.firstChild,t),K(n,R(F,{each:o,children:t=>R(cn,{get handlers(){return e.handlers},item:{key:t,img:`/pieces/${t}/nw.svg`}})}),null),n})()})}}),R(D,{get when(){return Ft.showFavoritePieces},get children(){const t=un.cloneNode(!0);return K(t,R(F,{get each(){return le.filter((e=>Ft.favoritePieces.has(e)))},children:t=>R(cn,{get handlers(){return e.handlers},item:{key:t,img:`/pieces/${t}/nw.svg`}})})),t}})]}});G(["click"]);const fn=U("<button></button>"),gn=e=>(()=>{const t=fn.cloneNode(!0);return t.$$click=()=>e.setTab(e.name),K(t,(()=>e.children)),m((()=>X(t,"tab"+(e.isActive?" tab--active":"")))),t})();G(["click"]);const _n=U('<i class="las la-chess-board"></i>'),mn=U('<i class="las la-chess"></i>'),bn=U('<div class="game"><div class="game-tabs"></div></div>'),vn=e=>{Dt("activeTab",e)},wn=e=>(()=>{const t=bn.cloneNode(!0),o=t.firstChild;return K(o,R(gn,{name:"game",setTab:vn,get isActive(){return"game"===Ft.activeTab},children:"GAME"}),null),K(o,R(gn,{name:"load",setTab:vn,get isActive(){return"load"===Ft.activeTab},children:"LOAD"}),null),K(o,R(D,{get when(){return"triple"!==Ft.layout},get children(){return[R(gn,{name:"share",setTab:vn,get isActive(){return"share"===Ft.activeTab},children:"SHARE"}),R(gn,{name:"boards",setTab:vn,get isActive(){return"boards"===Ft.activeTab},get children(){return _n.cloneNode(!0)}}),R(gn,{name:"pieces",setTab:vn,get isActive(){return"pieces"===Ft.activeTab},get children(){return mn.cloneNode(!0)}})]}}),null),K(t,R(q,{get children(){return[R(j,{get when(){return"game"===Ft.activeTab},get children(){return[R(xo,{get handlers(){return e.handlers}}),R(uo,{get moves(){return e.moves},get handlers(){return e.handlers},get class(){return"single"===Ft.layout?"span2":void 0}}),R(D,{get when(){return"single"!==Ft.layout},get children(){return R(go,{get handlers(){return e.handlers}})}})]}}),R(j,{get when(){return"load"===Ft.activeTab},get children(){return R(Ro,{get handlers(){return e.handlers},class:"span3"})}}),R(D,{get when(){return"triple"!==Ft.layout},get children(){return[R(j,{get when(){return"share"===Ft.activeTab},get children(){return R(Ko,{get handlers(){return e.handlers},class:"span3"})}}),R(j,{get when(){return"boards"===Ft.activeTab},get children(){return R(rn,{get handlers(){return e.handlers},class:"span3"})}}),R(j,{get when(){return"pieces"===Ft.activeTab},get children(){return R(pn,{get handlers(){return e.handlers},class:"span3"})}})]}})]}}),null),m((()=>o.classList.toggle("game-tabs--condensed",!("triple"===Ft.layout)))),t})();const yn=U('<i class="las la-share"></i>'),kn=U('<i class="las la-chess-board"></i>'),xn=U('<i class="las la-chess"></i>'),Sn=U('<div class="setup"><div class="setup-tabs"></div></div>'),An=e=>Dt("activeLeftTab",e),Cn=e=>(()=>{const t=Sn.cloneNode(!0),o=t.firstChild;return K(o,R(gn,{name:"share",setTab:An,get isActive(){return"share"===Ft.activeLeftTab},get children(){return[yn.cloneNode(!0)," SHARE"]}}),null),K(o,R(gn,{name:"boards",setTab:An,get isActive(){return"boards"===Ft.activeLeftTab},get children(){return[kn.cloneNode(!0)," BOARDS"]}}),null),K(o,R(gn,{name:"pieces",setTab:An,get isActive(){return"pieces"===Ft.activeLeftTab},get children(){return[xn.cloneNode(!0)," PIECES"]}}),null),K(t,R(q,{get children(){return[R(j,{get when(){return"share"===Ft.activeLeftTab},get children(){return R(Ko,{get handlers(){return e.handlers}})}}),R(j,{get when(){return"boards"===Ft.activeLeftTab},get children(){return R(rn,{get handlers(){return e.handlers}})}}),R(j,{get when(){return"pieces"===Ft.activeLeftTab},get children(){return R(pn,{get handlers(){return e.handlers}})}})]}}),null),t})();const Tn=U('<div class="popup"><div class="popup__box"><button class="popup__close"><i class="las la-times"></i></button><h2 class="popup__title"></h2><div class="popup__content"></div></div></div>'),$n=e=>(()=>{const t=Tn.cloneNode(!0),o=t.firstChild.firstChild,n=o.nextSibling,r=n.nextSibling;return Q(o,"click",e.onClose,!0),K(n,(()=>e.title)),K(r,(()=>e.children)),t})();G(["click"]);const Pn=e=>{switch(e){case"board":localStorage.setItem("boardConfig",JSON.stringify(Ft.boardConfig));break;case"game":localStorage.setItem("gameConfig",JSON.stringify(Ft.gameConfig));break;case"site":localStorage.setItem("siteConfig",JSON.stringify(Ft.siteConfig));break;case"recent":localStorage.setItem("recent",JSON.stringify(Ft.recent));break;case"pieces":localStorage.setItem("pieces",JSON.stringify([...Ft.favoritePieces]));break;case"boards":localStorage.setItem("boards",JSON.stringify([...Ft.favoriteBoards]))}},zn=U("<p>Saving files may not work correctly in this browser.</p>"),En=U("<p>To enjoy the full functionality of the website, please open it in <u><b>Safari</b></u>.</p>"),Nn=()=>R(D,{get when(){var e;return!Ft.siteConfig.iOSAppPopup&&Ft.siteConfig.wrongBrowserPopup&&"iOS"===Ft.os&&!(null!==(e=Ft.browser)&&void 0!==e&&e.includes("Safari"))},get children(){return R($n,{onClose:()=>{Dt("siteConfig","wrongBrowserPopup",!1),Pn("site")},title:"Note",get children(){return[zn.cloneNode(!0),En.cloneNode(!0)]}})}}),In=U("<p>For easy access, you can install this website as a standalone app.</p>"),On=U("<ul>To do that:<li>open the website in Chrome,</li><li>tap the menu icon (3 dots in the corner),</li><li>tap <u><b>Add to Home screen</b></u>.</li></ul>"),Ln=()=>R(D,{get when(){var e;return Ft.siteConfig.androidAppPopup&&(null===(e=Ft.os)||void 0===e?void 0:e.includes("Android"))},get children(){return R($n,{onClose:()=>{Dt("siteConfig","androidAppPopup",!1),Pn("site")},title:"Tip",get children(){return[In.cloneNode(!0),On.cloneNode(!0)]}})}}),Bn=U("<p>For easy access, you can install this website as a standalone app.</p>"),Mn=U("<ul>To do that:<li>open the website in Safari,</li><li>tap the Share icon,</li><li>tap <u><b>Add to Home Screen</b></u>.</li></ul>"),Rn=()=>R(D,{get when(){var e;return Ft.siteConfig.iOSAppPopup&&(null===(e=Ft.os)||void 0===e?void 0:e.includes("iOS"))},get children(){return R($n,{onClose:()=>{Dt("siteConfig","iOSAppPopup",!1),Pn("site")},title:"Tip",get children(){return[Bn.cloneNode(!0),Mn.cloneNode(!0)]}})}});const Fn=U('<div class="fs-popup"><div class="fs-popup__box"><button class="fs-popup__close"><i class="las la-times"></i></button><div></div></div></div>'),Dn=e=>(()=>{const t=Fn.cloneNode(!0),o=t.firstChild.firstChild,n=o.nextSibling;return Q(o,"click",e.onCLose,!0),K(n,(()=>e.children)),m((()=>X(n,`fs-popup__content ${e.class}`))),t})();G(["click"]);const qn=U("<h2>About</h2>"),jn=U("<p><b>ShareChess</b> is a free, open-source website that allows you to:</p>"),Hn=U('<ul class="about__features"><li>share chess games as self-contained replay links (the whole game is stored in the URL),</li><li>create images and animations of chess games and positions,</li><li>install additional chessboard styles and piece sets for major chess websites!</li></ul>'),Wn=U('<p>You can find the complete source code on my <a href="https://github.com/sharechess/sharechess">GitHub page</a>.</p>'),Un=U('<p>Follow my <a href="https://www.reddit.com/r/sharechess/" target="_blank">subreddit</a> for news, updates, and chess-related content!</p>'),Gn=U("<hr>"),Vn=U("<h2>Keyboard Shortcuts</h2>"),Xn=U('<div class="about__shortcuts"><ul><li><kbd>→</kbd> Next move</li><li><kbd>←</kbd> Previous move</li><li><kbd>↑</kbd> Start position</li><li><kbd>↓</kbd> Final position</li><li><kbd>f</kbd> Flip the board</li><li><kbd>Space</kbd> Play / Pause</li><li><kbd>Enter</kbd> Analyze on Lichess</li></ul><ul><li><kbd>l</kbd> Load from clipboard</li><li><kbd>a</kbd> Toggle anonymous</li><li><kbd>b</kbd> Toggle border</li><li><kbd>i</kbd> Toggle extra info</li><li><kbd>h</kbd> Toggle header (title screen)</li><li><kbd>s</kbd> Toggle shadows</li><li><kbd>p</kbd> Toggle puzzle view</li></ul></div>'),Qn=()=>R(D,{get when(){return"about"===Ft.fullscreenPopup},get children(){return R(Dn,{class:"about",onCLose:()=>Dt("fullscreenPopup",null),get children(){return[qn.cloneNode(!0),jn.cloneNode(!0),Hn.cloneNode(!0),Wn.cloneNode(!0),Un.cloneNode(!0),R(D,{get when(){return!Ft.mobile},get children(){return[Gn.cloneNode(!0),Vn.cloneNode(!0),Xn.cloneNode(!0)]}})]}})}});const Kn=U('<p class="us-info__intro">You can install any chessboard and piece styles from this website for <!>by following the instructions below.</p>'),Yn=U('<div class="us-info__steps"><div class="us-info__step"><h2 class="us-info__step-num">1</h2><h3 class="us-info__step-title">Install Stylus</h3><p class="us-info__description">Get the Stylus extension for your browser, that allows you to use custom styles on other websites.</p><p class="us-info__install-stylus"><a class="btn" target="_blank">Install the extension</a></p></div><div class="us-info__step"><h2 class="us-info__step-num">2</h2><h3 class="us-info__step-title">Choose your chessboard and pieces</h3><p class="us-info__description">Install any of the piece or chessboard styles by clicking the <img class="us-info__text-ico" src="img/stylus.svg" alt=""> icon on the chessboard / piece set card.</p><p class="us-info__description">This will open a stylesheet, click <strong>"Install / Reinstall style"</strong> button in the top left corner.</p><p class="us-info__browse"><button>Browse Chessboards</button><button>Browse Pieces</button></p></div><div class="us-info__step"><h2 class="us-info__step-num">3</h2><h3 class="us-info__step-title">Manage your styles</h3><p class="us-info__description">Toggle installed styles via Stylus extension menu. Pin the extension for easy access.</p><p class="us-info__manage-stylus"><img src="img/stylus-popup.png" alt=""></p></div></div>'),Zn=U('<a target="_blank">, </a>'),Jn=e=>()=>{Dt("fullscreenPopup",null),"triple"===Ft.layout?Dt("activeLeftTab",e):Dt("activeTab",e)},er=["lichess.org","chess.com","openingtree.com","chessgames.com","chess24.com","chesstempo.com","listudy.org","chesspecker.com","chessbase.com","wikipedia.org","aimchess.com","chessable.com"],tr=()=>R(D,{get when(){return"styles"===Ft.fullscreenPopup},get children(){return R(Dn,{class:"us-info",onCLose:()=>Dt("fullscreenPopup",null),get children(){return[(()=>{const e=Kn.cloneNode(!0),t=e.firstChild.nextSibling;return t.nextSibling,K(e,R(F,{each:er,children:e=>(()=>{const t=Zn.cloneNode(!0),o=t.firstChild;return V(t,"href",`https://${e}`),K(t,e,o),t})()}),t),e})(),(()=>{const e=Yn.cloneNode(!0),t=e.firstChild,o=t.firstChild.nextSibling.nextSibling.nextSibling.firstChild,n=t.nextSibling.firstChild.nextSibling.nextSibling.nextSibling.nextSibling.firstChild,r=n.nextSibling;return Q(n,"click",Jn("boards"),!0),Q(r,"click",Jn("pieces"),!0),m((()=>V(o,"href","Chrome"===Ft.browser?"https://chrome.google.com/webstore/detail/stylus/clngdbkpkpeebahjckkjfobafhncgmne":"Firefox"===Ft.browser?"https://addons.mozilla.org/pl/firefox/addon/styl-us/":"https://addons.opera.com/pl/extensions/details/stylus/"))),e})()]}})}});G(["click"]);const or=U('<p class="support__intro">If you like what I\'m doing, you can support the project financially, contribute your work and ideas, and share the projects with others.</p>'),nr=U('<div class="support__methods"><div class="support__method"><img class="support__ico" src="img/github.svg" alt="contribute"><h2 class="support__title">Help improve the website</h2><p class="support__description">You can suggest improvements and report bugs via <a href="https://github.com/sharechess/sharechess/issues" target="_blank">GitHub Issues</a> or by messaging me on <a href="https://www.reddit.com/message/compose/?to=kap89&amp;subject=ShareChess%20issue" target="_blank">Reddit.</a></p><p class="support__description">If you are a programmer, you can contribute to the project directly. Yu can find the source code on my <a href="https://github.com/sharechess/sharechess" target="_blank">GitHub Page.</a></p></div><div class="support__method"><img class="support__ico support__ico--coffee" src="img/donate.svg" alt="donate"><h2 class="support__title">Buy me a coffee</h2><p class="support__description">The project is free for everyone, and does not use ads or trackers. It takes some time and effort, but I\'m fine supporting it on my own.</p><p class="support__description">If you really want to, you can help fuel the development of the project by buying me a symbolic coffee!</p><a href="https://www.buymeacoffee.com/maciejcaderek" target="_blank" class="support__donate-btn btn">DONATE</a></div><div class="support__method"><img class="support__ico" src="img/artists.svg" alt="design"><h2 class="support__title">Design a chessboard or piece set</h2><p class="support__description">If you are an artist, or just like to create stuff, you can submit a new board design or a piece set.</p><p class="support__description">You can find instructions on how to prepare the assets on my <a href="https://github.com/sharechess/sharechess#designing-new-boards-and-piece-sets" target="_blank">GitHub page.</a></p><p class="support__description">Message me on <a href="https://www.reddit.com/message/compose/?to=kap89&amp;subject=ShareChess%20design" target="_blank">Reddit</a> or open a <a href="https://github.com/sharechess/sharechess/issues" target="_blank">GitHub issue</a> to coordinate the details.</p></div></div>'),rr=U("<hr>"),ir=U('<div class="support__share"><p class="support__subreddit">Follow my <a href="https://www.reddit.com/r/sharechess/" target="_blank">subreddit</a> for news, updates, and chess-related content!</p><p class="support__share-intro">Share the project with others, to help it grow!</p><div class="share__targets"><a class="resp-sharing-button__link" href="https://facebook.com/sharer/sharer.php?u=https%3A%2F%2Fsharechess.github.io" target="_blank" rel="noopener" aria-label="Facebook"><div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18.77 7.46H14.5v-1.9c0-.9.6-1.1 1-1.1h3V.5h-4.33C10.24.5 9.5 3.44 9.5 5.32v2.15h-3v4h3v12h5v-12h3.85l.42-4z"></path></svg></div>Facebook</div></a><a class="resp-sharing-button__link" href="https://twitter.com/intent/tweet/?text=ShareChess%20-%20chess%20with%20style!&amp;url=https%3A%2F%2Fsharechess.github.io" target="_blank" rel="noopener" aria-label="Twitter"><div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M23.44 4.83c-.8.37-1.5.38-2.22.02.93-.56.98-.96 1.32-2.02-.88.52-1.86.9-2.9 1.1-.82-.88-2-1.43-3.3-1.43-2.5 0-4.55 2.04-4.55 4.54 0 .36.03.7.1 1.04-3.77-.2-7.12-2-9.36-4.75-.4.67-.6 1.45-.6 2.3 0 1.56.8 2.95 2 3.77-.74-.03-1.44-.23-2.05-.57v.06c0 2.2 1.56 4.03 3.64 4.44-.67.2-1.37.2-2.06.08.58 1.8 2.26 3.12 4.25 3.16C5.78 18.1 3.37 18.74 1 18.46c2 1.3 4.4 2.04 6.97 2.04 8.35 0 12.92-6.92 12.92-12.93 0-.2 0-.4-.02-.6.9-.63 1.96-1.22 2.56-2.14z"></path></svg></div>Twitter</div></a><a class="resp-sharing-button__link" href="mailto:?subject=ShareChess%20-%20chess%20with%20style!&amp;body=https%3A%2F%2Fsharechess.github.io" target="_self" rel="noopener" aria-label="E-Mail"><div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22 4H2C.9 4 0 4.9 0 6v12c0 1.1.9 2 2 2h20c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zM7.25 14.43l-3.5 2c-.08.05-.17.07-.25.07-.17 0-.34-.1-.43-.25-.14-.24-.06-.55.18-.68l3.5-2c.24-.14.55-.06.68.18.14.24.06.55-.18.68zm4.75.07c-.1 0-.2-.03-.27-.08l-8.5-5.5c-.23-.15-.3-.46-.15-.7.15-.22.46-.3.7-.14L12 13.4l8.23-5.32c.23-.15.54-.08.7.15.14.23.07.54-.16.7l-8.5 5.5c-.08.04-.17.07-.27.07zm8.93 1.75c-.1.16-.26.25-.43.25-.08 0-.17-.02-.25-.07l-3.5-2c-.24-.13-.32-.44-.18-.68s.44-.32.68-.18l3.5 2c.24.13.32.44.18.68z"></path></svg></div>E-Mail</div></a><a class="resp-sharing-button__link" href="https://reddit.com/submit/?url=https%3A%2F%2Fsharechess.github.io&amp;resubmit=true&amp;title=ShareChess%20-%20chess%20with%20style!" target="_blank" rel="noopener" aria-label="Reddit"><div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M24 11.5c0-1.65-1.35-3-3-3-.96 0-1.86.48-2.42 1.24-1.64-1-3.75-1.64-6.07-1.72.08-1.1.4-3.05 1.52-3.7.72-.4 1.73-.24 3 .5C17.2 6.3 18.46 7.5 20 7.5c1.65 0 3-1.35 3-3s-1.35-3-3-3c-1.38 0-2.54.94-2.88 2.22-1.43-.72-2.64-.8-3.6-.25-1.64.94-1.95 3.47-2 4.55-2.33.08-4.45.7-6.1 1.72C4.86 8.98 3.96 8.5 3 8.5c-1.65 0-3 1.35-3 3 0 1.32.84 2.44 2.05 2.84-.03.22-.05.44-.05.66 0 3.86 4.5 7 10 7s10-3.14 10-7c0-.22-.02-.44-.05-.66 1.2-.4 2.05-1.54 2.05-2.84zM2.3 13.37C1.5 13.07 1 12.35 1 11.5c0-1.1.9-2 2-2 .64 0 1.22.32 1.6.82-1.1.85-1.92 1.9-2.3 3.05zm3.7.13c0-1.1.9-2 2-2s2 .9 2 2-.9 2-2 2-2-.9-2-2zm9.8 4.8c-1.08.63-2.42.96-3.8.96-1.4 0-2.74-.34-3.8-.95-.24-.13-.32-.44-.2-.68.15-.24.46-.32.7-.18 1.83 1.06 4.76 1.06 6.6 0 .23-.13.53-.05.67.2.14.23.06.54-.18.67zm.2-2.8c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm5.7-2.13c-.38-1.16-1.2-2.2-2.3-3.05.38-.5.97-.82 1.6-.82 1.1 0 2 .9 2 2 0 .84-.53 1.57-1.3 1.87z"></path></svg></div>Reddit</div></a><a class="resp-sharing-button__link" href="whatsapp://send?text=ShareChess%20-%20chess%20with%20style!%20https%3A%2F%2Fsharechess.github.io" target="_blank" rel="noopener" aria-label="WhatsApp"><div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.1 3.9C17.9 1.7 15 .5 12 .5 5.8.5.7 5.6.7 11.9c0 2 .5 3.9 1.5 5.6L.6 23.4l6-1.6c1.6.9 3.5 1.3 5.4 1.3 6.3 0 11.4-5.1 11.4-11.4-.1-2.8-1.2-5.7-3.3-7.8zM12 21.4c-1.7 0-3.3-.5-4.8-1.3l-.4-.2-3.5 1 1-3.4L4 17c-1-1.5-1.4-3.2-1.4-5.1 0-5.2 4.2-9.4 9.4-9.4 2.5 0 4.9 1 6.7 2.8 1.8 1.8 2.8 4.2 2.8 6.7-.1 5.2-4.3 9.4-9.5 9.4zm5.1-7.1c-.3-.1-1.7-.9-1.9-1-.3-.1-.5-.1-.7.1-.2.3-.8 1-.9 1.1-.2.2-.3.2-.6.1s-1.2-.5-2.3-1.4c-.9-.8-1.4-1.7-1.6-2-.2-.3 0-.5.1-.6s.3-.3.4-.5c.2-.1.3-.3.4-.5.1-.2 0-.4 0-.5C10 9 9.3 7.6 9 7c-.1-.4-.4-.3-.5-.3h-.6s-.4.1-.7.3c-.3.3-1 1-1 2.4s1 2.8 1.1 3c.1.2 2 3.1 4.9 4.3.7.3 1.2.5 1.6.6.7.2 1.3.2 1.8.1.6-.1 1.7-.7 1.9-1.3.2-.7.2-1.2.2-1.3-.1-.3-.3-.4-.6-.5z"></path></svg></div>WhatsApp</div></a><a class="resp-sharing-button__link" href="https://telegram.me/share/url?text=ShareChess%20-%20chess%20with%20style!&amp;url=https%3A%2F%2Fsharechess.github.io" target="_blank" rel="noopener" aria-label="Telegram"><div class="resp-sharing-button resp-sharing-button--telegram resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M.707 8.475C.275 8.64 0 9.508 0 9.508s.284.867.718 1.03l5.09 1.897 1.986 6.38a1.102 1.102 0 0 0 1.75.527l2.96-2.41a.405.405 0 0 1 .494-.013l5.34 3.87a1.1 1.1 0 0 0 1.046.135 1.1 1.1 0 0 0 .682-.803l3.91-18.795A1.102 1.102 0 0 0 22.5.075L.706 8.475z"></path></svg></div>Telegram</div></a></div></div>'),ar=()=>R(D,{get when(){return"support"===Ft.fullscreenPopup},get children(){return R(Dn,{class:"support",onCLose:()=>Dt("fullscreenPopup",null),get children(){return[or.cloneNode(!0),nr.cloneNode(!0),rr.cloneNode(!0),ir.cloneNode(!0)]}})}}),sr=U('<div id="setup" class="setup-box"></div>'),lr=U('<div><div class="layout"><div id="board" class="board-box"><canvas class="board" id="canvas"></canvas></div><div id="moves" class="game-box"></div></div></div>'),cr=e=>(()=>{const t=lr.cloneNode(!0),o=t.firstChild,n=o.firstChild;n.firstChild;const r=n.nextSibling;return K(t,R(eo,{get handlers(){return e.handlers}}),o),K(o,R(D,{get when(){return"triple"===Ft.layout},get children(){const t=sr.cloneNode(!0);return K(t,R(Cn,{get handlers(){return e.handlers}})),t}}),n),K(n,R(D,{get when(){return"single"===Ft.layout},get children(){return R(go,{get handlers(){return e.handlers}})}}),null),K(r,R(wn,{get moves(){return e.state.moves},get handlers(){return e.handlers}})),K(t,R(Qn,{}),null),K(t,R(tr,{}),null),K(t,R(ar,{}),null),K(t,R(Nn,{}),null),K(t,R(Ln,{}),null),K(t,R(Rn,{}),null),m((e=>{const o=!Ft.siteConfig.darkMode,r=!("double"!==Ft.layout);return o!==e._v$&&t.classList.toggle("light",e._v$=o),r!==e._v$2&&n.classList.toggle("board-box--left",e._v$2=r),e}),{_v$:void 0,_v$2:void 0}),t})(),dr={XS:360,S:512,M:720,L:1024,XL:1440},ur=function(e,t){return e()},hr=/^([1-8kqrbnp]+\/)+[1-8kqrbnp]+ [wb] ([kq]+|-) ([a-h1-8]{2}|-) \d+ \d+$/i,pr=/((\[[a-z0-9]+ +"[^"\n\r]+"](\r\n|\r|\n))*(\r\n|\r|\n)+){0,1}\d+\. *[a-h1-8x+#=.]+/i,fr=e=>{var t,o;return e[(t=0,o=e.length-1,Math.round(Math.random()*(t-o))+o)]},gr=(e,t)=>({prev(){e.pause(),e.prev()},next(){e.pause(),e.next()},first(){e.pause(),e.first()},last(){e.pause(),e.last()},togglePlay(){e.playing?e.pause():e.play()},goto(t){e.pause(),e.goto(t)},toggleBorder(){t.toggleBorder(),Dt("boardConfig","showBorder",!Ft.boardConfig.showBorder),Pn("board")},showBorder(){t.showBorder(),Dt("boardConfig","showBorder",!0),Pn("board")},hideBorder(){t.hideBorder(),Dt("boardConfig","showBorder",!1),Pn("board")},toggleExtraInfo(){t.toggleExtraInfo(),Dt("boardConfig","showExtraInfo",!Ft.boardConfig.showExtraInfo),Pn("board")},toggleAnonymous(){if(Dt("anonymous",!Ft.anonymous),t.anonymous=Ft.anonymous,""!==Ft.pgn){const e=Ft.anonymous?Ft.game.anonymousPGN:Ft.game.pgn;Ho.set({pgn:e}),Dt("refreshHash",!1)}},toggleTitleScreen(){Dt("gameConfig","titleScreen",!Ft.gameConfig.titleScreen),Pn("game")},toggleShadows(){t.toggleShadows(),Dt("boardConfig","showShadows",!Ft.boardConfig.showShadows),Pn("board")},flip(){const e=Ft.recent.findIndex((e=>e.hash===location.hash));t.flip(),Dt("boardConfig","flipped",!Ft.boardConfig.flipped),Dt("refreshHash",!1),Ho.set({side:Ft.boardConfig.flipped?"b":"w"}),-1!==e&&(Dt("recent",e,"hash",location.hash),Pn("recent"))},changeBoardStyle(e){t.setStyle(e),Dt("boardConfig","boardStyle",e),Pn("board")},changePiecesStyle(e){t.setPiecesStyle(e),Dt("boardConfig","piecesStyle",e),Pn("board")},async loadPGN(o,n="w",r=0){const i=(new dt).loadPGN(o);Dt({pgn:i.pgn,fen:"",moves:i.getMoves(),ply:0,game:i}),Ho.set({pgn:i.pgn,side:n,ply:r}),await e.load(i),Dt("activeTab","game"),"w"===n?t.flipWhite():t.flipBlack(),Dt("boardConfig","flipped","b"===n),document.title=`ShareChess - ${i.getTitle({anonymous:!1})}`,""!==location.hash&&(Dt("recent",(e=>{const t=e.filter((({hash:e})=>e!==location.hash));return t.unshift({hash:location.hash,title:i.getShortTitle({anonymous:Ft.anonymous})}),t.slice(0,20)})),Pn("recent"))},async loadFEN(o,n=!0){const r=(new dt).loadFEN(o);Dt({pgn:"",fen:o,moves:r.getMoves(),ply:0,game:r}),await e.load(r),n&&(Ho.set({fen:Ft.fen}),Dt("activeTab","game"));const i=r.getPosition(0).turn;"w"===i?t.flipWhite():t.flipBlack(),Dt("boardConfig","flipped","b"===i),document.title="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1"===o?"ShareChess - Chess With Style":`ShareChess - FEN ${o}`},async load(e){return Dt("refreshHash",!1),(e=>hr.test(e.trim()))(e)?(await this.loadFEN(e),!0):(e=>pr.test(e))(e)?(await this.loadPGN(e),!0):!!_o(e)&&(await this.importPGN(e),!0)},async loadFromClipboard(){const e=await navigator.clipboard.readText();return this.load(e)},async importPGN(e){const t=await(async e=>{let t;try{t=new URL(e)}catch{return{error:!0,errorType:"INCORRECT_LINK"}}return/^(www\.)*lichess\.org/.test(t.hostname)?Do(t):{error:!0,errorType:"INCORRECT_LINK"}})(e);t.error||await this.loadPGN(t.pgn,t.side)},async downloadImage(){await new Promise((e=>setTimeout(e,0)));const e=await(async(e,t,o=0,n,r)=>{const i=new dt;t?i.loadPGN(t):i.loadFEN(e);const a=new Ce;await a.init({...n,size:dr[r]});const s=i.getPosition(o);return await a.frame(s,i.header),a.render(),a.toImgUrl()})(Ft.fen,Ft.pgn,Ft.ply,Ft.boardConfig,Ft.gameConfig.picSize);Fo(e,`fen_${Date.now()}`,"png")},async downloadAnimation(){await new Promise((e=>setTimeout(e,0)));const e=await(async(e,t,n,r,i)=>{const a=(new dt).loadPGN(e),s=new Ce;await s.init({...t,size:dr[r]});const l=new(0,(await ur("GIF"===n?()=>o.import("./GIF-legacy.ec9ae848.js"):"MP4"===n?()=>o.import("./MP4-legacy.9c61fc53.js"):()=>o.import("./WebM-legacy.3730439e.js"))).default)(s.width,s.height,!0),c=a.header;i&&(await s.titleFrame(c),s.render(),await l.add(s,4));for(let o=0;o<a.length;o++){const e=a.getPosition(o);await s.frame(e,c),s.render();const t=0===e.end?5:0!==e.ply||i?1:2;await l.add(s,t)}return await l.render()})(Ft.pgn,Ft.boardConfig,Ft.gameConfig.format,Ft.gameConfig.animationSize,Ft.gameConfig.titleScreen),t=Ft.game.getFileName(Ft.anonymous);Fo(e,t,Ft.gameConfig.format.toLowerCase())},toggleSound(){Dt("siteConfig","sounds",!Ft.siteConfig.sounds),Pn("site")},toggleSpeech(){Dt("siteConfig","speech",!Ft.siteConfig.speech),Pn("site")},toggleDarkMode(){Dt("siteConfig","darkMode",!Ft.siteConfig.darkMode),Pn("site")},async openOnLichess(){if(""===Ft.pgn)return window.open(`https://lichess.org/analysis/${Ft.fen.replace(/\s+/g,"_")}`),!0;try{const e=await(async(e,t)=>{if(t&&/^https:\/\/lichess\.org\/.{8}/.test(t))return t;const o=new URLSearchParams({pgn:e}).toString();try{const e=await fetch("https://lichess.org/api/import",{headers:{"content-type":"application/x-www-form-urlencoded"},body:o,method:"POST"});if(200===e.status)return(await e.json()).url;throw new Error("Cannot import to lichess")}catch(n){throw new Error("Cannot import to lichess")}})(Ft.pgn,Ft.game.header.Site);return window.open(`${e}/${Ft.boardConfig.flipped?"black":""}`),!0}catch(e){return!1}},toggleFavoritePieces(e){Ft.favoritePieces.has(e)?Dt("favoritePieces",(t=>{const o=new Set([...t]);return o.delete(e),o})):Dt("favoritePieces",(t=>{const o=new Set([...t]);return o.add(e),o})),Pn("pieces")},toggleFavoriteBoard(e){Ft.favoriteBoards.has(e)?Dt("favoriteBoards",(t=>{const o=new Set([...t]);return o.delete(e),o})):Dt("favoriteBoards",(t=>{const o=new Set([...t]);return o.add(e),o})),Pn("boards")},clearRecent(e){e.preventDefault(),Dt("recent",Ft.recent.filter((e=>e.hash===location.hash))),Pn("recent")},deleteRecent(e){Dt("recent",(t=>t.filter((t=>t.hash!==e)))),Pn("recent")},async loadGameOfTheDay(){const e=new Date,t=e.getFullYear(),o=`daily-games/${String(e.getMonth()+1).padStart(2,"0")}.${String(e.getDate()).padStart(2,"0")}.json`,n=await fetch(o),r=await n.json(),i=r[t%r.length];location.hash=`#pgn/w/0/${i}`},async randomStyle(){const e=fr(Et),o=fr(le);await t.setAllStyles(o,e),Dt("boardConfig","boardStyle",e),Dt("boardConfig","piecesStyle",o),Pn("board")},togglePuzzle(){t.togglePuzzle(),Dt("boardConfig","puzzle",!Ft.boardConfig.puzzle),Pn("board")}}),_r=async(e,t,o)=>{Dt("refreshHash",e);const{pgn:n,fen:r,side:i,ply:a,boardStyle:s,piecesStyle:l}=await Ho.read();await(n?t.loadPGN(n,i,a):r?t.loadFEN(r):t.loadFEN("rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",!1)),0!==a&&t.goto(a),s&&Et.includes(s)&&(Dt("boardConfig","boardStyle",s),o.setStyle(s)),l&&le.includes(l)&&(Dt("boardConfig","piecesStyle",l),o.setPiecesStyle(l)),Dt("refreshHash",!0)};(async()=>{const e=new Ce;await e.init(),console.log(Ft.boardConfig),await e.init(Ft.boardConfig);const t=new Qt(e,Ft.gameConfig);t.watch((e=>Dt("playing",e)));const o=gr(t,e);!function(e,t,o){let n;g((r=>{n=r,t===document?e():K(t,e(),t.firstChild?null:void 0,o)}))}((()=>R(cr,{handlers:o,state:Ft})),document.getElementById("root"));const n=document.getElementById("canvas");await e.setCanvas(n),await t.init(),await _r(!1,o,e),((e,t)=>{if(document.addEventListener("dblclick",(function(e){e.preventDefault()})),window.addEventListener("resize",(()=>{Dt("layout",window.innerWidth<window.innerHeight?"single":window.innerWidth<1366?"double":"triple")})),window.addEventListener("hashchange",(()=>{Ft.refreshHash?_r(!0,e,t):Dt("refreshHash",!0)})),!Ft.mobile){const t={ArrowLeft:e.prev,ArrowRight:e.next,ArrowUp:e.first,ArrowDown:e.last,f:e.flip," ":e.togglePlay,Enter:e.openOnLichess,l:e.loadFromClipboard.bind(e),a:e.toggleAnonymous,b:e.toggleBorder,i:e.toggleExtraInfo,h:e.toggleTitleScreen,s:e.toggleShadows,p:e.togglePuzzle};document.addEventListener("keydown",(e=>{const o=e.target;t[e.key]&&"INPUT"!==(null==o?void 0:o.nodeName)&&"TEXTAREA"!==(null==o?void 0:o.nodeName)&&(e.preventDefault(),t[e.key]())}));const o=e=>{e.preventDefault(),e.stopPropagation()};["dragenter","dragover","dragleave","drop"].forEach((e=>{document.addEventListener(e,o,!1)})),document.addEventListener("drop",(async t=>{var o;if(null!==(o=t.dataTransfer)&&void 0!==o&&o.files&&t.dataTransfer.files.length>0){const o=await So(t.dataTransfer.files[0]);Dt("refreshHash",!1),e.loadPGN(o)}}))}})(o,e)})()}}}))}();
