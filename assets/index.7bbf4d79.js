function xs(){import("data:text/javascript,")}const or=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function e(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerpolicy&&(l.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?l.credentials="include":s.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function o(s){if(s.ep)return;s.ep=!0;const l=e(s);fetch(s.href,l)}};or();const ze={};function sr(r){ze.context=r}const ar=(r,t)=>r===t,et=Symbol("solid-proxy"),Wt=Symbol("solid-track"),$t={equals:ar};let Nn=Mn;const Ke=1,kt=2,On={owned:null,cleanups:null,context:null,owner:null};var ye=null;let Je=null,he=null,Se=null,He=null,Zt=0;function yt(r,t){const e=he,o=ye,s=r.length===0,l=s?On:{owned:null,cleanups:null,context:null,owner:t||o},c=s?r:()=>r(()=>tt(()=>en(l)));ye=l,he=null;try{return st(c,!0)}finally{he=e,ye=o}}function De(r,t){t=t?Object.assign({},$t,t):$t;const e={value:r,observers:null,observerSlots:null,comparator:t.equals||void 0},o=s=>(typeof s=="function"&&(s=s(e.value)),Bn(e,s));return[Rn.bind(e),o]}function Z(r,t,e){const o=Jt(r,t,!1,Ke);pt(o)}function lr(r,t,e){Nn=_r;const o=Jt(r,t,!1,Ke);o.user=!0,He?He.push(o):pt(o)}function Xe(r,t,e){e=e?Object.assign({},$t,e):$t;const o=Jt(r,t,!0,0);return o.observers=null,o.observerSlots=null,o.comparator=e.equals||void 0,pt(o),Rn.bind(o)}function cr(r){return st(r,!1)}function tt(r){let t,e=he;return he=null,t=r(),he=e,t}function ur(r){return ye===null||(ye.cleanups===null?ye.cleanups=[r]:ye.cleanups.push(r)),r}function Ln(){return he}function fr(r){const t=Xe(r),e=Xe(()=>Ut(t()));return e.toArray=()=>{const o=e();return Array.isArray(o)?o:o!=null?[o]:[]},e}function Rn(){const r=Je;if(this.sources&&(this.state||r))if(this.state===Ke||r)pt(this);else{const t=Se;Se=null,st(()=>xt(this),!1),Se=t}if(he){const t=this.observers?this.observers.length:0;he.sources?(he.sources.push(this),he.sourceSlots.push(t)):(he.sources=[this],he.sourceSlots=[t]),this.observers?(this.observers.push(he),this.observerSlots.push(he.sources.length-1)):(this.observers=[he],this.observerSlots=[he.sources.length-1])}return this.value}function Bn(r,t,e){let o=r.value;return(!r.comparator||!r.comparator(o,t))&&(r.value=t,r.observers&&r.observers.length&&st(()=>{for(let s=0;s<r.observers.length;s+=1){const l=r.observers[s],c=Je&&Je.running;c&&Je.disposed.has(l),(c&&!l.tState||!c&&!l.state)&&(l.pure?Se.push(l):He.push(l),l.observers&&zn(l)),c||(l.state=Ke)}if(Se.length>1e6)throw Se=[],new Error},!1)),t}function pt(r){if(!r.fn)return;en(r);const t=ye,e=he,o=Zt;he=ye=r,dr(r,r.value,o),he=e,ye=t}function dr(r,t,e){let o;try{o=r.fn(t)}catch(s){r.pure&&(r.state=Ke),Dn(s)}(!r.updatedAt||r.updatedAt<=e)&&(r.updatedAt!=null&&"observers"in r?Bn(r,o):r.value=o,r.updatedAt=e)}function Jt(r,t,e,o=Ke,s){const l={fn:r,state:o,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:ye,context:null,pure:e};return ye===null||ye!==On&&(ye.owned?ye.owned.push(l):ye.owned=[l]),l}function At(r){const t=Je;if(r.state===0||t)return;if(r.state===kt||t)return xt(r);if(r.suspense&&tt(r.suspense.inFallback))return r.suspense.effects.push(r);const e=[r];for(;(r=r.owner)&&(!r.updatedAt||r.updatedAt<Zt);)(r.state||t)&&e.push(r);for(let o=e.length-1;o>=0;o--)if(r=e[o],r.state===Ke||t)pt(r);else if(r.state===kt||t){const s=Se;Se=null,st(()=>xt(r,e[0]),!1),Se=s}}function st(r,t){if(Se)return r();let e=!1;t||(Se=[]),He?e=!0:He=[],Zt++;try{const o=r();return hr(e),o}catch(o){Se||(He=null),Dn(o)}}function hr(r){if(Se&&(Mn(Se),Se=null),r)return;const t=He;He=null,t.length&&st(()=>Nn(t),!1)}function Mn(r){for(let t=0;t<r.length;t++)At(r[t])}function _r(r){let t,e=0;for(t=0;t<r.length;t++){const o=r[t];o.user?r[e++]=o:At(o)}for(ze.context&&sr(),t=0;t<e;t++)At(r[t])}function xt(r,t){const e=Je;r.state=0;for(let o=0;o<r.sources.length;o+=1){const s=r.sources[o];s.sources&&(s.state===Ke||e?s!==t&&At(s):(s.state===kt||e)&&xt(s,t))}}function zn(r){const t=Je;for(let e=0;e<r.observers.length;e+=1){const o=r.observers[e];(!o.state||t)&&(o.state=kt,o.pure?Se.push(o):He.push(o),o.observers&&zn(o))}}function en(r){let t;if(r.sources)for(;r.sources.length;){const e=r.sources.pop(),o=r.sourceSlots.pop(),s=e.observers;if(s&&s.length){const l=s.pop(),c=e.observerSlots.pop();o<s.length&&(l.sourceSlots[c]=o,s[o]=l,e.observerSlots[o]=c)}}if(r.owned){for(t=0;t<r.owned.length;t++)en(r.owned[t]);r.owned=null}if(r.cleanups){for(t=0;t<r.cleanups.length;t++)r.cleanups[t]();r.cleanups=null}r.state=0,r.context=null}function pr(r){return r instanceof Error||typeof r=="string"?r:new Error("Unknown error")}function Dn(r){throw r=pr(r),r}function Ut(r){if(typeof r=="function"&&!r.length)return Ut(r());if(Array.isArray(r)){const t=[];for(let e=0;e<r.length;e++){const o=Ut(r[e]);Array.isArray(o)?t.push.apply(t,o):t.push(o)}return t}return r}const gr=Symbol("fallback");function ln(r){for(let t=0;t<r.length;t++)r[t]()}function mr(r,t,e={}){let o=[],s=[],l=[],c=0,h=t.length>1?[]:null;return ur(()=>ln(l)),()=>{let d=r()||[],b,_;return d[Wt],tt(()=>{let i=d.length,a,u,f,p,g,$,y,k,P;if(i===0)c!==0&&(ln(l),l=[],o=[],s=[],c=0,h&&(h=[])),e.fallback&&(o=[gr],s[0]=yt(M=>(l[0]=M,e.fallback())),c=1);else if(c===0){for(s=new Array(i),_=0;_<i;_++)o[_]=d[_],s[_]=yt(n);c=i}else{for(f=new Array(i),p=new Array(i),h&&(g=new Array(i)),$=0,y=Math.min(c,i);$<y&&o[$]===d[$];$++);for(y=c-1,k=i-1;y>=$&&k>=$&&o[y]===d[k];y--,k--)f[k]=s[y],p[k]=l[y],h&&(g[k]=h[y]);for(a=new Map,u=new Array(k+1),_=k;_>=$;_--)P=d[_],b=a.get(P),u[_]=b===void 0?-1:b,a.set(P,_);for(b=$;b<=y;b++)P=o[b],_=a.get(P),_!==void 0&&_!==-1?(f[_]=s[b],p[_]=l[b],h&&(g[_]=h[b]),_=u[_],a.set(P,_)):l[b]();for(_=$;_<i;_++)_ in f?(s[_]=f[_],l[_]=p[_],h&&(h[_]=g[_],h[_](_))):s[_]=yt(n);s=s.slice(0,c=i),o=d.slice(0)}return s});function n(i){if(l[_]=i,h){const[a,u]=De(_);return h[_]=u,t(d[_],a)}return t(d[_])}}}function T(r,t){return tt(()=>r(t||{}))}function gt(r){const t="fallback"in r&&{fallback:()=>r.fallback};return Xe(mr(()=>r.each,r.children,t||void 0))}function U(r){let t=!1;const e=r.keyed,o=Xe(()=>r.when,void 0,{equals:(s,l)=>t?s===l:!s==!l});return Xe(()=>{const s=o();if(s){const l=r.children,c=typeof l=="function"&&l.length>0;return t=e||c,c?tt(()=>l(s)):l}return r.fallback})}function Fn(r){let t=!1,e=!1;const o=fr(()=>r.children),s=Xe(()=>{let l=o();Array.isArray(l)||(l=[l]);for(let c=0;c<l.length;c++){const h=l[c].when;if(h)return e=!!l[c].keyed,[c,h,l[c]]}return[-1]},void 0,{equals:(l,c)=>l[0]===c[0]&&(t?l[1]===c[1]:!l[1]==!c[1])&&l[2]===c[2]});return Xe(()=>{const[l,c,h]=s();if(l<0)return r.fallback;const d=h.children,b=typeof d=="function"&&d.length>0;return t=e||b,b?tt(()=>d(c)):d})}function We(r){return r}function Nt(r,t){return Xe(r,void 0,t?void 0:{equals:t})}function br(r,t,e){let o=e.length,s=t.length,l=o,c=0,h=0,d=t[s-1].nextSibling,b=null;for(;c<s||h<l;){if(t[c]===e[h]){c++,h++;continue}for(;t[s-1]===e[l-1];)s--,l--;if(s===c){const _=l<o?h?e[h-1].nextSibling:e[l-h]:d;for(;h<l;)r.insertBefore(e[h++],_)}else if(l===h)for(;c<s;)(!b||!b.has(t[c]))&&t[c].remove(),c++;else if(t[c]===e[l-1]&&e[h]===t[s-1]){const _=t[--s].nextSibling;r.insertBefore(e[h++],t[c++].nextSibling),r.insertBefore(e[--l],_),t[s]=e[l]}else{if(!b){b=new Map;let n=h;for(;n<l;)b.set(e[n],n++)}const _=b.get(t[c]);if(_!=null)if(h<_&&_<l){let n=c,i=1,a;for(;++n<s&&n<l&&!((a=b.get(t[n]))==null||a!==_+i);)i++;if(i>_-h){const u=t[c];for(;h<_;)r.insertBefore(e[h++],u)}else r.replaceChild(e[h++],t[c++])}else c++;else t[c++].remove()}}}const cn="_$DX_DELEGATE";function vr(r,t,e){let o;return yt(s=>{o=s,t===document?r():N(t,r(),t.firstChild?null:void 0,e)}),()=>{o(),t.textContent=""}}function I(r,t,e){const o=document.createElement("template");o.innerHTML=r;let s=o.content.firstChild;return e&&(s=s.firstChild),s}function Pe(r,t=window.document){const e=t[cn]||(t[cn]=new Set);for(let o=0,s=r.length;o<s;o++){const l=r[o];e.has(l)||(e.add(l),t.addEventListener(l,yr))}}function oe(r,t,e){e==null?r.removeAttribute(t):r.setAttribute(t,e)}function mt(r,t){t==null?r.removeAttribute("class"):r.className=t}function ue(r,t,e,o){if(o)Array.isArray(e)?(r[`$$${t}`]=e[0],r[`$$${t}Data`]=e[1]):r[`$$${t}`]=e;else if(Array.isArray(e)){const s=e[0];r.addEventListener(t,e[0]=l=>s.call(r,e[1],l))}else r.addEventListener(t,e)}function wr(r,t,e){return tt(()=>r(t,e))}function N(r,t,e,o){if(e!==void 0&&!o&&(o=[]),typeof t!="function")return Tt(r,t,o,e);Z(s=>Tt(r,t(),s,e),o)}function yr(r){const t=`$$${r.type}`;let e=r.composedPath&&r.composedPath()[0]||r.target;for(r.target!==e&&Object.defineProperty(r,"target",{configurable:!0,value:e}),Object.defineProperty(r,"currentTarget",{configurable:!0,get(){return e||document}}),ze.registry&&!ze.done&&(ze.done=!0,document.querySelectorAll("[id^=pl-]").forEach(o=>o.remove()));e!==null;){const o=e[t];if(o&&!e.disabled){const s=e[`${t}Data`];if(s!==void 0?o.call(e,s,r):o.call(e,r),r.cancelBubble)return}e=e.host&&e.host!==e&&e.host instanceof Node?e.host:e.parentNode}}function Tt(r,t,e,o,s){for(ze.context&&!e&&(e=[...r.childNodes]);typeof e=="function";)e=e();if(t===e)return e;const l=typeof t,c=o!==void 0;if(r=c&&e[0]&&e[0].parentNode||r,l==="string"||l==="number"){if(ze.context)return e;if(l==="number"&&(t=t.toString()),c){let h=e[0];h&&h.nodeType===3?h.data=t:h=document.createTextNode(t),e=nt(r,e,o,h)}else e!==""&&typeof e=="string"?e=r.firstChild.data=t:e=r.textContent=t}else if(t==null||l==="boolean"){if(ze.context)return e;e=nt(r,e,o)}else{if(l==="function")return Z(()=>{let h=t();for(;typeof h=="function";)h=h();e=Tt(r,h,e,o)}),()=>e;if(Array.isArray(t)){const h=[],d=e&&Array.isArray(e);if(Vt(h,t,e,s))return Z(()=>e=Tt(r,h,e,o,!0)),()=>e;if(ze.context){if(!h.length)return e;for(let b=0;b<h.length;b++)if(h[b].parentNode)return e=h}if(h.length===0){if(e=nt(r,e,o),c)return e}else d?e.length===0?un(r,h,o):br(r,e,h):(e&&nt(r),un(r,h));e=h}else if(t instanceof Node){if(ze.context&&t.parentNode)return e=c?[t]:t;if(Array.isArray(e)){if(c)return e=nt(r,e,o,t);nt(r,e,null,t)}else e==null||e===""||!r.firstChild?r.appendChild(t):r.replaceChild(t,r.firstChild);e=t}}return e}function Vt(r,t,e,o){let s=!1;for(let l=0,c=t.length;l<c;l++){let h=t[l],d=e&&e[l];if(h instanceof Node)r.push(h);else if(!(h==null||h===!0||h===!1))if(Array.isArray(h))s=Vt(r,h,d)||s;else if(typeof h=="function")if(o){for(;typeof h=="function";)h=h();s=Vt(r,Array.isArray(h)?h:[h],Array.isArray(d)?d:[d])||s}else r.push(h),s=!0;else{const b=String(h);d&&d.nodeType===3&&d.data===b?r.push(d):r.push(document.createTextNode(b))}}return s}function un(r,t,e){for(let o=0,s=t.length;o<s;o++)r.insertBefore(t[o],e)}function nt(r,t,e,o){if(e===void 0)return r.textContent="";const s=o||document.createTextNode("");if(t.length){let l=!1;for(let c=t.length-1;c>=0;c--){const h=t[c];if(s!==h){const d=h.parentNode===r;!l&&!c?d?r.replaceChild(s,h):r.insertBefore(s,e):d&&h.remove()}else l=!0}}else r.insertBefore(s,e);return[s]}const Sr={horizontal:[0,0,1,0],vertical:[0,0,0,1],"diagonal-top":[0,0,1,1],"diagonal-bottom":[0,1,1,0]},$r=(r,t,e,o,s,l)=>{let c;if(t.dir==="radial"){const d=Math.sqrt((e/2)**2+(o/2)**2);c=r.createRadialGradient(s+e/2,l+o/2,d,s+e/2,l+o/2,0)}else{const[d,b,_,n]=Sr[t.dir];c=r.createLinearGradient(s+d*e,l+b*o,s+_*e,l+n*o)}const h=t.colors.length-1;return t.colors.forEach((d,b)=>{c.addColorStop(b/h,d)}),c},Fe=async(r,t,e,o,s,l,c,h=8)=>{const d=Array.isArray(l)?l:[l];for(const b of d){if(b.type==="image"){const n=await c(b.data.src);h<8?r.drawImage(n,0,0,n.width*(h/8),n.height*(h/8),o,s,t,e):r.drawImage(n,o,s,t,e);continue}const _=await(b.type==="solid"?b.data.color:$r(r,b.data,t,e,o,s));if(_===null)throw new Error("Cannot create canvas fill style");r.fillStyle=_,r.fillRect(o,s,t,e)}},kr=22,Ar="Fira Mono",fn=(r,t,e,o,s=!1,l,c,h,d)=>{const b=c/1024;if(b<=.32)return;const _=kr*b,n=6*b,i=4*b,a="1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26".split(",").slice(0,o),u=s?a:a.reverse();r.font=`${_}px ${Ar}`,r.textBaseline=h?"middle":"top",u.forEach((g,$)=>{r.fillStyle=l>0?t.onBorder:$%2===0?t.onLight:t.onDark;const y=h?l/2:n,k=(h?e*$+l+e/2:e*$+n)+d;r.textAlign=h?"center":"left",r.fillText(g,y,k)});const f="abcdefghijklmnopqrstuwvxyz".split("").slice(0,o),p=s?f.reverse():f;r.textBaseline=h?"middle":"bottom",p.forEach((g,$)=>{r.fillStyle=l>0?t.onBorder:$%2===0?t.onDark:t.onLight;const y=h?e*$+l+e/2:e*$+n,k=(h?c-l/2:c-i)+d;r.textAlign=h?"center":"left",r.fillText(g,y,k)})},xr="abcdefghijklmnopqrstuwvxyz",dn=(r,t,e)=>{const o=xr.indexOf(r[0]),s=Number(r[1])-1;return[t?e-o-1:o,t?s:e-s-1]},Tr=async(r,t,e,{moveIndicator:o},s,l,c,h,d)=>{const[b,_]=dn(t.from,c,l),[n,i]=dn(t.to,c,l),[a,u,f,p]=[b,_,n,i].map($=>$*e+s),g={type:"solid",data:{color:o.color}};Fe(r,e,e,a,u+h,g,d),Fe(r,e,e,f,p+h,g,d)},Ot=["tatiana","tatiana_wood","tatiana_calm","tatiana_sweet","staunty","staunty_wood","staunty_blue","staunty_lila","libra","libra_wood","libra_plum","libra_sea","governor_bw","governor","governor_patina","governor_purple","anarchy","anarchy_candy","anarchy_fresh","anarchy_sepia","qootee","qootee_summer","qootee_pink","qootee_grape","echiquier","echiquier_ink","echiquier_flesh","echiquier_grape","riohacha","riohacha_spring","riohacha_winter","riohacha_cute","gioco","gioco_wood","gioco_metal","gioco_purple","alpha","alpha_ink","alpha_wood","alpha_mint","california","california_brown","california_green","california_red","dubrovny_bw","dubrovny","dubrovny_brown","dubrovny_green","cburnett","cburnett_brown","cburnett_blue","cburnett_purple","cases","cases_cocoa","cases_gray","cases_forest","smart","smart_apricot","smart_blue","smart_cocoa","chessnut","chessnut_blue","chessnut_brown","chessnut_burgundy","maestro","maestro_blue","maestro_pink","maestro_brown","merida","merida_ink","merida_cyan","merida_traffic","cardinal","cardinal_blue","cardinal_brown","cardinal_green","companion","companion_red","companion_cyan","companion_eggplant","pirouetti","pirouetti_mint","pirouetti_summer","pirouetti_dream","pirouetti_border","pirouetti_border_winter","pirouetti_border_coral","pirouetti_border_grass","horsey","horsey_blue","horsey_purple","horsey_pink","fresca","fresca_matisse","fresca_zucchini","fresca_camelot","kosal","kosal_blue","kosal_violet","kosal_red","magnetic","magnetic_brown","magnetic_lila","magnetic_orange","maya","maya_brown","maya_warm","maya_cold","pixel","pixel_spring","pixel_neon","pixel_juicy","fantasy","fantasy_calm","fantasy_warm","fantasy_cold","chess7","chess7_pink","chess7_calm","chess7_yellow","regular","regular_ink","regular_green","regular_purple","condal","condal_cold","condal_warm","condal_mustard","mediaeval","mediaeval_brown","mediaeval_green","mediaeval_orange","reillycraig","reillycraig_tamarind","reillycraig_lawn","reillycraig_dixie","tfb","tfb_brown","tfb_green","tfb_purple","icpieces","icpieces_blue","icpieces_maroon","icpieces_brown","leipzig","leipzig_niagara","leipzig_berry","leipzig_nature","motif","motif_maroon","motif_purple","motif_green","marroquin","marroquin_rajah","marroquin_eggplant","marroquin_toy","harlequin","harlequin_gold","harlequin_peach","harlequin_neon","lucena","lucena_brown","lucena_blue","lucena_pink","mark","mark_brown","mark_grape","mark_green","wisdom","wisdom_brown","wisdom_blue","wisdom_grape","adventurer","adventurer_brown","adventurer_grass","adventurer_berry","alfonso-x","alfonso-x_brown","alfonso-x_grape","alfonso-x_toy","berlin","berlin_blue","berlin_maroon","berlin_loulou","kingdom","kingdom_blue","kingdom_brown","kingdom_sulu","traveller","traveller_brown","traveller_blue","traveller_green","line","line_berry","line_purple","line_toy","pirat","pirat_sea","pirat_maroon","pirat_peach","spatial","spatial_blue","spatial_salmon","spatial_summer","symmetric","symmetric_blue","symmetric_brown","symmetric_purple","utrecht","utrecht_mirage","utrecht_violet","utrecht_crimson","dmuysi","dmuysi_marzipan","dmuysi_kournikova","dmuysi_cotton","icon54","icon54_gray","icon54_brown","icon54_neon","saakyan","saakyan_blue","saakyan_grape","saakyan_coco","trendy","trendy_ink","trendy_brown","trendy_fresh","vecon","vecon_baltic","vecon_hemlock","vecon_cute","alfarishy","alfarishy_blue","alfarishy_pink","alfarishy_berry","oldstyle","oldstyle_bondi","oldstyle_brown","oldstyle_gossip","millennia","millennia_blue","millennia_sand","millennia_green","shapes","shapes_blue","shapes_brown","shapes_cute","letters","letters_warm","letters_cold","letters_dim","checkers","checkers_wood","checkers_grape","checkers_cute"],Cr=["bb","bw","kb","kw","nb","nw","pb","pw","qb","qw","rb","rw"];let hn=null,_n=new Map;const Er={async load(r,t){await Promise.all(Cr.map(e=>{const o=`/pieces/${r}/${e}.svg`;return t(o).then(s=>{_n.set(e,s)})}))},async get(r,t,e,o){hn!==r&&(await this.load(r,o),hn=r);const s=`${t}${e}`;return _n.get(s)}},Pr=async(r,t,e,o,s,l,c,h=!0,d)=>{const{placement:b,check:_,mate:n,turn:i}=t;r.shadowColor="rgba(0, 0, 0, 0)",r.shadowBlur=0,r.shadowOffsetX=0,r.shadowOffsetY=0;for(const{x:a,y:u,type:f,color:p}of b){const g=await Er.get(c,f,p,d),$=s?8-1-u:u,y=s?8-1-a:a;if((_||n)&&f==="k"&&p===i){const k=n?"#ff002f":"#ffa600";r.shadowColor=k,r.shadowBlur=e*.15,r.shadowOffsetX=0,r.shadowOffsetY=0,r.drawImage(g,o+y*e,o+$*e+l,e,e)}else h&&(r.shadowColor="rgba(0, 0, 0, 0.5)",r.shadowOffsetX=e*.07,r.shadowOffsetY=e*.07,r.shadowBlur=e*.1);r.drawImage(g,o+y*e,o+$*e+l,e,e),r.shadowColor="rgba(0, 0, 0, 0)",r.shadowBlur=0,r.shadowOffsetX=0,r.shadowOffsetY=0}};var Qe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ir(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function Ts(r){if(r.__esModule)return r;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(r).forEach(function(e){var o=Object.getOwnPropertyDescriptor(r,e);Object.defineProperty(t,e,o.get?o:{enumerable:!0,get:function(){return r[e]}})}),t}function Cs(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Hn={exports:{}};/*!
 * 
 *   canvas-txt v3.0.0
 *   https://github.com/geongeorge/Canvas-Txt
 * 
 *   Copyright (c) Geon George (https://geongeorge.com)
 * 
 *   This source code is licensed under the MIT license found in the
 *   LICENSE file in the root directory of this source tree.
 * 
 */(function(r,t){(function(e,o){r.exports=o()})(typeof self<"u"?self:Qe,function(){return function(e){var o={};function s(l){if(o[l])return o[l].exports;var c=o[l]={i:l,l:!1,exports:{}};return e[l].call(c.exports,c,c.exports,s),c.l=!0,c.exports}return s.m=e,s.c=o,s.d=function(l,c,h){s.o(l,c)||Object.defineProperty(l,c,{enumerable:!0,get:h})},s.r=function(l){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(l,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(l,"__esModule",{value:!0})},s.t=function(l,c){if(1&c&&(l=s(l)),8&c||4&c&&typeof l=="object"&&l&&l.__esModule)return l;var h=Object.create(null);if(s.r(h),Object.defineProperty(h,"default",{enumerable:!0,value:l}),2&c&&typeof l!="string")for(var d in l)s.d(h,d,function(b){return l[b]}.bind(null,d));return h},s.n=function(l){var c=l&&l.__esModule?function(){return l.default}:function(){return l};return s.d(c,"a",c),c},s.o=function(l,c){return Object.prototype.hasOwnProperty.call(l,c)},s.p="",s(s.s=0)}([function(e,o,s){function l(d,b){return function(_){if(Array.isArray(_))return _}(d)||function(_,n){if(typeof Symbol<"u"&&Symbol.iterator in Object(_)){var i=[],a=!0,u=!1,f=void 0;try{for(var p,g=_[Symbol.iterator]();!(a=(p=g.next()).done)&&(i.push(p.value),!n||i.length!==n);a=!0);}catch($){u=!0,f=$}finally{try{a||g.return==null||g.return()}finally{if(u)throw f}}return i}}(d,b)||function(_,n){if(_){if(typeof _=="string")return c(_,n);var i=Object.prototype.toString.call(_).slice(8,-1);return i==="Object"&&_.constructor&&(i=_.constructor.name),i==="Map"||i==="Set"?Array.from(i):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?c(_,n):void 0}}(d,b)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function c(d,b){(b==null||b>d.length)&&(b=d.length);for(var _=0,n=Array(b);_<b;_++)n[_]=d[_];return n}s.r(o);var h={debug:!1,align:"center",vAlign:"middle",fontSize:14,fontWeight:"",fontStyle:"",fontVariant:"",font:"Arial",lineHeight:null,justify:!1,drawText:function(d,b,_,n,i,a){var u=this,f=l([_,n,i,a].map(function(ve){return parseInt(ve)}),4);if(_=f[0],n=f[1],i=f[2],a=f[3],!(0>=i||0>=a||0>=this.fontSize)){var p=_+i,g=n+a;this.textSize&&console.error("%cCanvas-Txt:","font-weight: bold;","textSize is depricated and has been renamed to fontSize");var $=this.fontStyle,y=this.fontVariant,k=this.fontWeight,P=this.fontSize,M=this.font,D="".concat($," ").concat(y," ").concat(k," ").concat(P,"px ").concat(M);d.font=D;var Y,L=n+a/2+parseInt(this.fontSize)/2;this.align==="right"?(Y=p,d.textAlign="right"):this.align==="left"?(Y=_,d.textAlign="left"):(Y=_+i/2,d.textAlign="center");var ne=[],pe=b.split(`
`),Oe=this.justify?d.measureText("\u200A").width:0;pe.forEach(function(ve){var fe=d.measureText(ve).width;if(fe<=i)ne.push(ve);else{var ie,Le,ge,we=ve,m=i;for(fe=d.measureText(we).width;fe>m;){for(ie=0,Le=0,ge="";Le<m;)ie++,ge=we.substr(0,ie),Le=d.measureText(we.substr(0,ie)).width;ie--,ge=ge.substr(0,ie);var w=ie;if(we.substr(ie,1)!=" "){for(;we.substr(ie,1)!=" "&&ie!=0;)ie--;ie==0&&(ie=w),ge=we.substr(0,ie)}ge=u.justify?u.justifyLine(d,ge,Oe,"\u200A",i):ge,we=we.substr(ie),fe=d.measureText(we).width,ne.push(ge)}0<fe&&ne.push(we)}});var me=this.lineHeight?this.lineHeight:this.getTextHeight(d,b,D),_e=me*(ne.length-1),Te=n;return this.vAlign==="top"?L=n+this.fontSize:this.vAlign==="bottom"?(L=g-_e,Te=g):(Te=n+a/2,L-=_e/2),ne.forEach(function(ve){ve=ve.trim(),d.fillText(ve,Y,L),L+=me}),this.debug&&(d.lineWidth=3,d.strokeStyle="#00909e",d.strokeRect(_,n,i,a),d.lineWidth=2,d.strokeStyle="#f6d743",d.beginPath(),d.moveTo(Y,n),d.lineTo(Y,g),d.stroke(),d.strokeStyle="#ff6363",d.beginPath(),d.moveTo(_,Te),d.lineTo(p,Te),d.stroke()),{height:_e+me}}},getTextHeight:function(d,b,_){var n=d.textBaseline,i=d.font;d.textBaseline="bottom",d.font=_;var a=d.measureText(b).actualBoundingBoxAscent;return d.textBaseline=n,d.font=i,a},justifyLine:function(d,b,_,n,i){var a=Math.floor,u=b.trim(),f=d.measureText(u).width,p=u.split(/\s+/).length-1,g=a((i-f)/_);if(0>=p||0>=g)return u;for(var $=a(g/p),y=g-p*$,k=[],P=0;P<$;P++)k.push(n);return k=k.join(""),u.replace(/\s+/g,function(M){var D=0<y?k+n:k;return y--,M+D})}};o.default=h}])})})(Hn);var lt=Ir(Hn.exports);const $e=(r,t,e,o,s,l,c,h,d)=>(r.font=`${s} ${o}px ${e}`,r.textAlign=h,r.textBaseline="middle",r.fillText(t,l,c,d),Math.ceil(r.measureText(t).width)),Nr=async r=>{let t;t=await(await fetch("/img/logo-full-mono.svg")).text();const e=t.replace(/black/g,r);return`data:image/svg+xml;base64,${btoa(e)}`},Or=async(r,t,e,o,s,l)=>{const c=l.PuzzleMotif??"Solve the Puzzle",h=l.PuzzleDescription??"";r.fillStyle=s.coords.onBorder,$e(r,c,"Ubuntu",42*e,700,t/2,(t*e+o)/4,"center"),lt.fontSize=30*e,lt.lineHeight=35*e,lt.align="left",lt.font="Ubuntu",lt.drawText(r,h,t*.1,0,t*.8,t+o*2)},Lr=async(r,t,e,o,s,l,c,h)=>{if(r.clearRect(0,0,t,t),await Fe(r,t,t+o*2,0,0,s.border,c),h)Or(r,t,e,o,s,l);else{const i="Ubuntu",a=[{key:"WhitePretty",line:60*e,fontSize:42*e,n:0},{key:"BlackPretty",line:60*e,fontSize:42*e,n:2},{key:"Event",line:30*e,fontSize:20*e,n:4},{key:"Round",line:30*e,fontSize:20*e,n:5},{key:"DatePretty",line:30*e,fontSize:20*e,n:7},{key:"Site",line:30*e,fontSize:20*e,n:8}],u=new Set(Object.keys(l)),f=a.filter(({key:$})=>u.has($));if(l.WhitePretty&&l.BlackPretty&&f.push({key:"vs",line:50*e,fontSize:20*e,n:1}),(l.Event||l.Round)&&f.push({key:"margin",line:100*e,fontSize:0,n:3}),l.Date||l.Site){const $=l.Event||l.Round?20*e:100*e;f.push({key:"margin",line:$,fontSize:0,n:6})}const p=f.reduce(($,y)=>$+y.line,0);let g=(t+o*2-p)/2;r.fillStyle=s.coords.onBorder,f.sort(($,y)=>$.n-y.n).forEach(({key:$,line:y,fontSize:k})=>{if($==="vs"){const M=g+y/2;$e(r,"vs",i,k,700,t/2,M,"center"),g+=y;return}if($==="margin"){g+=y;return}const P=l[$];if(P){const M=$==="Round"?`Round ${P}`:P,D=g+y/2;$e(r,M,i,k,700,t/2,D,"center",t*.9)}g+=y})}const d=await Nr(s.coords.onBorder),b=await c(d),_=t*.6,n=b.height*(_/b.width);r.drawImage(b,t*.2,o+t+o-n*2,_,n)},pn={k:"l",q:"w",r:"t",b:"n",n:"j",p:"o"},Rr=async(r,t,e,o,s,l,c,h,d,b)=>{const _=Math.round(20*o);let n=(s-_)/2,i=s/2;const a=n;if(r.fillStyle=l.coords.onBorder,b)$e(r,`Find the best move for ${d.turn==="b"?"black":"white"}.`,"Ubuntu",_,700,a,e-i,"left"),$e(r,c.PuzzleTitle??"sharechess.github.io","Ubuntu",_,700,a,i,"left");else{{const k=$e(r,c.White==="Anonymous"?"White":c.White,"Ubuntu",_,700,a,h?i:e-i,"left"),P=c.WhiteElo?` ${c.WhiteElo}`:"";$e(r,P,"Fira Mono",_,500,a+k,h?i:e-i,"left")}{const k=$e(r,c.Black==="Anonymous"?"Black":c.Black,"Ubuntu",_,700,a,h?e-i:i,"left"),P=c.BlackElo?` ${c.BlackElo}`:"";$e(r,P,"Fira Mono",_,500,a+k,h?e-i:i,"left")}}let u=0,f=0;if(d.last&&c.Result){const[k,P]=c.Result.split("-"),M=k==="0"?"Lost":k==="1"?"Won":"Draw",D=P==="0"?"Lost":P==="1"?"Won":"Draw",Y=$e(r,M,"Ubuntu",_,700,t-n,h?i:e-i,"right"),L=$e(r,D,"Ubuntu",_,700,t-n,h?e-i:i,"right"),ne=Math.max(Y,L);u=ne+20*o,f=ne+20*o}const{diff:p,imbalance:g}=d.material,$=p>0?`+${Math.abs(p)}`:"";u+=$e(r,$,"Fira Mono",_,500,t-n-u,h?i:e-i,"right");const y=p<0?`+${Math.abs(p)}`:"";f+=$e(r,y,"Fira Mono",_,500,t-n-f,h?e-i:i,"right");for(const[k,P]of Object.entries(g.w))for(let M=0;M<P;M++){const D=$e(r,pn[k],"Chess",_,500,t-n-u,(h?i:e-i)-2*o,"right");u+=M===P-1?D*.85:k==="p"?D*.4:D*.6}for(const[k,P]of Object.entries(g.b))for(let M=0;M<P;M++){const D=$e(r,pn[k],"Chess",_,500,t-n-f,(h?e-i:i)-2*o,"right");f+=M===P-1?D*.85:k==="p"?D*.4:D*.6}},Ct=r=>{if(r===null)return!1;try{return new URL(r),!0}catch{return!1}},Br=r=>new Promise(t=>{const e=new Image;e.addEventListener("load",()=>t(e),{once:!0}),e.src=r}),Mr={category:"solid",background:{type:"solid",data:{color:"transparent"}},dark:{type:"solid",data:{color:"#00ad88"}},light:{type:"solid",data:{color:"#9EE0BC"}},moveIndicator:{color:"#ffff0055"},border:{type:"solid",data:{color:"#00735a"}},coords:{onLight:"#00735a",onDark:"#d4fff5",onBorder:"#bbfaec"}},zr={size:720,tiles:8,boardStyle:"standard",piecesStyle:"tatiana",showBorder:!0,showExtraInfo:!0,showMaterial:!0,showMoveIndicator:!0,showChecks:!0,showCoords:!0,showShadows:!1,flipped:!1,puzzle:!1},Dr={White:"White",Black:"Black",WhitePretty:"White",BlackPretty:"Black",WhiteElo:null,BlackElo:null,Date:null,DatePretty:null,Event:null,Round:null,Site:null,Result:null,PuzzleTitle:null,PuzzleMotif:null,PuzzleDescription:null},Fr=r=>fetch(`/board-templates/${r}.json`).then(t=>t.json());class tn{constructor(t=Br,e=()=>document.createElement("canvas"),o=Fr){this.loadImage=t,this.createCanvas=e,this.loadStyle=o,this.canvas=this.createCanvas(),this.tempCanvas=this.createCanvas();const s=this.canvas.getContext("2d"),l=this.tempCanvas.getContext("2d");if(s===null||l===null)throw new Error("Cannot create canvas 2D context");this.ctx=s,this.tempCtx=l}cfg=zr;_anonymous=!1;scale=1;borderScale=1;borderOnly=!1;hollow=!1;size=0;squareSize=0;innerSize=0;borderWidth=0;margin=0;style=Mr;header=Dr;lastPosition=null;background=null;currentScreen="move";ctx;tempCtx;tempCanvas;canvas;async init(t={}){await this.updateConfig(t,!1)}async setCanvas(t){this.canvas=t,this.ctx=t.getContext("2d"),this.setSize(this.cfg.size),await this.refresh()}async updateConfig(t,e=!0){const o={...this.cfg,...t};this.cfg=o,this.setSize(o.size),await this.setStyle(o.boardStyle,e),e&&await this.refresh()}set anonymous(t){this._anonymous=t,this.refresh()}async refresh(){await this.renderBackground(),this.currentScreen==="title"?await this.titleFrame(this.header):this.lastPosition!==null&&await this.frame(this.lastPosition,this.header),await this.render()}setSize(t){this.size=t,this.scale=t/720,this.margin=this.cfg.showExtraInfo?Math.round(50*this.scale):0;const e=t+this.margin*2;(this.canvas.width!==t||this.canvas.height!==e)&&(this.canvas.width=t,this.canvas.height=e,this.tempCanvas.width=t,this.tempCanvas.height=e);const o=this.cfg.showBorder?this.size/32*this.borderScale:0,s=this.size-o*2;return this.squareSize=Math.floor(s/this.cfg.tiles),this.innerSize=this.squareSize*this.cfg.tiles,this.borderWidth=(this.size-this.innerSize)/2,this}getSize(){return this.size}setBorderScale(t){this.borderScale=t,this.setSize(this.cfg.size)}setBorderOnly(t){this.borderOnly=t}setHollow(t){this.hollow=t}async setStyle(t,e=!0){this.style=await this.loadStyle(t),this.cfg.boardStyle=t,e&&await this.refresh()}async setPiecesStyle(t){this.cfg.piecesStyle=t,await this.refresh()}async setAllStyles(t,e){this.cfg.piecesStyle=t,this.style=await this.loadStyle(e),this.cfg.boardStyle=e,await this.refresh()}async flip(){return this.cfg.flipped=!this.cfg.flipped,await this.refresh(),this}async flipWhite(){!this.cfg.flipped||(this.cfg.flipped=!1,await this.refresh())}async flipBlack(){this.cfg.flipped||(this.cfg.flipped=!0,await this.refresh())}async hideBorder(){this.cfg.showBorder=!1,this.setSize(this.size),await this.refresh()}async showBorder(){this.cfg.showBorder=!0,this.setSize(this.size),await this.refresh()}async toggleBorder(){this.cfg.showBorder=!this.cfg.showBorder,this.setSize(this.size),await this.refresh()}async toggleExtraInfo(){this.cfg.showExtraInfo=!this.cfg.showExtraInfo,this.setSize(this.size),await this.refresh()}async toggleShadows(){this.cfg.showShadows=!this.cfg.showShadows,await this.refresh()}async togglePuzzle(){this.cfg.puzzle=!this.cfg.puzzle,await this.refresh()}getFinalHeader(){return this._anonymous?{...this.header,White:"Anonymous",Black:"Anonymous",WhitePretty:"Anonymous",BlackPretty:"Anonymous",Site:Ct(this.header.Site)?null:this.header.Site}:{...this.header,Site:Ct(this.header.Site)?this.header.Site.replace(/^http[s]*:\/\//,""):this.header.Site}}async titleFrame(t){this.currentScreen="title",this.header=t,await Lr(this.tempCtx,this.size,this.scale,this.margin,this.style,this.getFinalHeader(),this.loadImage,this.cfg.puzzle)}async renderBackground(){const t=this.createCanvas(),e=t.getContext("2d");t.width=this.size,t.height=this.size+this.margin*2;const{background:o,dark:s,light:l,border:c,coords:h}=this.style;e.clearRect(0,0,this.canvas.width,this.canvas.height),await Fe(e,this.width,this.height,0,0,c,this.loadImage),await Fe(e,this.innerSize,this.innerSize,this.cfg.showBorder?this.borderWidth:0,(this.cfg.showBorder?this.borderWidth:0)+this.margin,o,this.loadImage,this.cfg.tiles);for(let d=0;d<this.cfg.tiles;d++)for(let b=0;b<this.cfg.tiles;b++){const _=b%2===0&&d%2===0||b%2!==0&&d%2!==0?l:s,n=b*this.squareSize+this.borderWidth,i=d*this.squareSize+this.borderWidth+this.margin;await Fe(e,this.squareSize,this.squareSize,n,i,_,this.loadImage)}this.cfg.showBorder&&this.cfg.showCoords&&fn(e,h,this.squareSize,this.cfg.tiles,this.cfg.flipped,this.borderWidth,this.size,this.cfg.showBorder,this.margin),this.background=t}async frame(t,e){this.currentScreen="move",this.lastPosition=t,this.header=e??this.header,this.tempCtx.clearRect(0,0,this.tempCanvas.width,this.tempCanvas.height),this.background===null&&await this.renderBackground(),this.tempCtx.drawImage(await this.background,0,0),this.lastPosition?.move&&this.cfg.showMoveIndicator&&await Tr(this.tempCtx,this.lastPosition.move,this.squareSize,this.style,this.borderWidth,this.cfg.tiles,this.cfg.flipped,this.margin,this.loadImage),!this.cfg.showBorder&&this.cfg.showCoords&&fn(this.tempCtx,this.style.coords,this.squareSize,this.cfg.tiles,this.cfg.flipped,this.borderWidth,this.size,this.cfg.showBorder,this.margin),this.lastPosition&&(await Pr(this.tempCtx,this.lastPosition,this.squareSize,this.borderWidth,this.cfg.flipped,this.margin,this.cfg.piecesStyle,this.cfg.showShadows,this.loadImage),this.cfg.showExtraInfo&&e&&await Rr(this.tempCtx,this.width,this.height,this.scale,this.margin,this.style,this.getFinalHeader(),this.cfg.flipped,this.lastPosition,this.cfg.puzzle))}render(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.drawImage(this.tempCanvas,0,0)}async renderStatic(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);const{background:t,dark:e,light:o,border:s}=this.style;if(await Fe(this.ctx,this.width,this.height,0,0,s,this.loadImage),this.borderOnly){this.hollow&&this.ctx.clearRect(this.borderWidth,this.borderWidth+this.margin,this.innerSize,this.innerSize);return}await Fe(this.ctx,this.innerSize,this.innerSize,this.cfg.showBorder?this.borderWidth:0,(this.cfg.showBorder?this.borderWidth:0)+this.margin,t,this.loadImage,this.cfg.tiles);for(let l=0;l<this.cfg.tiles;l++)for(let c=0;c<this.cfg.tiles;c++){const h=c%2===0&&l%2===0||c%2!==0&&l%2!==0?o:e,d=c*this.squareSize+this.borderWidth,b=l*this.squareSize+this.borderWidth+this.margin;Fe(this.ctx,this.squareSize,this.squareSize,d,b,h,this.loadImage)}}toImgUrl(){return this.canvas.toDataURL()}toImageData(){return this.ctx.getImageData(0,0,this.width,this.height)}toClampedArray(){return this.ctx.getImageData(0,0,this.width,this.height).data}toImgElement(){const t=this.toImgUrl(),e=new Image;return e.classList.add("board"),e.src=t,e}get width(){return this.size}get height(){return this.size+this.margin*2}toGIF(){}}const Hr="pnbrqkPNBRQK",zt="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",qr=["1-0","0-1","1/2-1/2","*"],Dt={b:[16,32,17,15],w:[-16,-32,-17,-15]},gn={n:[-18,-33,-31,-14,18,33,31,14],b:[-17,-15,17,15],r:[-16,1,16,-1],q:[-17,-16,-15,1,17,16,15,-1],k:[-17,-16,-15,1,17,16,15,-1]},Gr=[20,0,0,0,0,0,0,24,0,0,0,0,0,0,20,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,24,24,24,24,24,24,56,0,56,24,24,24,24,24,24,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,20,0,0,0,0,0,0,24,0,0,0,0,0,0,20],jr=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,0,16,0,15,0,0,0,0,0,0,0,0,0,0,0,0,17,16,15,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,-15,-16,-17,0,0,0,0,0,0,0,0,0,0,0,0,-15,0,-16,0,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],Wr={p:0,n:1,b:2,r:3,q:4,k:5},F={NORMAL:1,CAPTURE:2,BIG_PAWN:4,EP_CAPTURE:8,PROMOTION:16,KSIDE_CASTLE:32,QSIDE_CASTLE:64},Ur=7,Vr=6,Xr=1,Kr=0,Q={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},qe={w:[{square:Q.a1,flag:F.QSIDE_CASTLE},{square:Q.h1,flag:F.KSIDE_CASTLE}],b:[{square:Q.a8,flag:F.QSIDE_CASTLE},{square:Q.h8,flag:F.KSIDE_CASTLE}]},Yr=0,mn=1;function Qr(r,t){for(var e=r.from,o=r.to,s=r.piece,l=0,c=0,h=0,d=0,b=t.length;d<b;d++){var _=t[d].from,n=t[d].to,i=t[d].piece;s===i&&e!==_&&o===n&&(l++,Ue(e)===Ue(_)&&c++,dt(e)===dt(_)&&h++)}return l>0?c>0&&h>0?Ae(e):h>0?Ae(e).charAt(1):Ae(e).charAt(0):""}function Zr(r){var t=r.charAt(0);if(t>="a"&&t<="h"){var e=r.match(/[a-h]\d.*[a-h]\d/);return e?void 0:Be}return t=t.toLowerCase(),t==="o"?rt:t}function bn(r){return r.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}function Ue(r){return r>>4}function dt(r){return r&15}function Ae(r){var t=dt(r),e=Ue(r);return"abcdefgh".substring(t,t+1)+"87654321".substring(e,e+1)}function ct(r){return r===Me?je:Me}function Jr(r){return"0123456789".indexOf(r)!==-1}function qn(r){var t=r instanceof Array?[]:{};for(var e in r)typeof e=="object"?t[e]=qn(r[e]):t[e]=r[e];return t}function vn(r){return r.replace(/^\s+|\s+$/g,"")}const je="b",Me="w",Ne=-1,Be="p",wn="n",vt="b",ei="r",ti="q",rt="k";(function(){for(var r=[],t=Q.a8;t<=Q.h1;t++){if(t&136){t+=7;continue}r.push(Ae(t))}return r})();const ni={NORMAL:"n",CAPTURE:"c",BIG_PAWN:"b",EP_CAPTURE:"e",PROMOTION:"p",KSIDE_CASTLE:"k",QSIDE_CASTLE:"q"},Ze=function(r){var t=new Array(128),e={w:Ne,b:Ne},o=Me,s={w:0,b:0},l=Ne,c=0,h=1,d=[],b={},_={};u(typeof r>"u"?zt:r);function n(m){typeof m>"u"&&(m=!1),t=new Array(128),e={w:Ne,b:Ne},o=Me,s={w:0,b:0},l=Ne,c=0,h=1,d=[],m||(b={}),_={},$(p())}function i(){for(var m=[],w={},S=function(A){A in _&&(w[A]=_[A])};d.length>0;)m.push(ie());for(S(p());m.length>0;)fe(m.pop()),S(p());_=w}function a(){u(zt)}function u(m,w){typeof w>"u"&&(w=!1);var S=m.split(/\s+/),A=S[0],C=0;if(!f(m).valid)return!1;n(w);for(var x=0;x<A.length;x++){var R=A.charAt(x);if(R==="/")C+=8;else if(Jr(R))C+=parseInt(R,10);else{var q=R<"a"?Me:je;k({type:R.toLowerCase(),color:q},Ae(C)),C++}}return o=S[1],S[2].indexOf("K")>-1&&(s.w|=F.KSIDE_CASTLE),S[2].indexOf("Q")>-1&&(s.w|=F.QSIDE_CASTLE),S[2].indexOf("k")>-1&&(s.b|=F.KSIDE_CASTLE),S[2].indexOf("q")>-1&&(s.b|=F.QSIDE_CASTLE),l=S[3]==="-"?Ne:Q[S[3]],c=parseInt(S[4],10),h=parseInt(S[5],10),$(p()),!0}function f(m){var w={0:"No errors.",1:"FEN string must contain six space-delimited fields.",2:"6th field (move number) must be a positive integer.",3:"5th field (half move counter) must be a non-negative integer.",4:"4th field (en-passant square) is invalid.",5:"3rd field (castling availability) is invalid.",6:"2nd field (side to move) is invalid.",7:"1st field (piece positions) does not contain 8 '/'-delimited rows.",8:"1st field (piece positions) is invalid [consecutive numbers].",9:"1st field (piece positions) is invalid [invalid piece].",10:"1st field (piece positions) is invalid [row too large].",11:"Illegal en-passant square"},S=m.split(/\s+/);if(S.length!==6)return{valid:!1,error_number:1,error:w[1]};if(isNaN(parseInt(S[5]))||parseInt(S[5],10)<=0)return{valid:!1,error_number:2,error:w[2]};if(isNaN(parseInt(S[4]))||parseInt(S[4],10)<0)return{valid:!1,error_number:3,error:w[3]};if(!/^(-|[abcdefgh][36])$/.test(S[3]))return{valid:!1,error_number:4,error:w[4]};if(!/^(KQ?k?q?|Qk?q?|kq?|q|-)$/.test(S[2]))return{valid:!1,error_number:5,error:w[5]};if(!/^(w|b)$/.test(S[1]))return{valid:!1,error_number:6,error:w[6]};var A=S[0].split("/");if(A.length!==8)return{valid:!1,error_number:7,error:w[7]};for(var C=0;C<A.length;C++){for(var x=0,R=!1,q=0;q<A[C].length;q++)if(isNaN(A[C][q])){if(!/^[prnbqkPRNBQK]$/.test(A[C][q]))return{valid:!1,error_number:9,error:w[9]};x+=1,R=!1}else{if(R)return{valid:!1,error_number:8,error:w[8]};x+=parseInt(A[C][q],10),R=!0}if(x!==8)return{valid:!1,error_number:10,error:w[10]}}return S[3][1]=="3"&&S[1]=="w"||S[3][1]=="6"&&S[1]=="b"?{valid:!1,error_number:11,error:w[11]}:{valid:!0,error_number:0,error:w[0]}}function p(){for(var m=0,w="",S=Q.a8;S<=Q.h1;S++){if(t[S]==null)m++;else{m>0&&(w+=m,m=0);var A=t[S].color,C=t[S].type;w+=A===Me?C.toUpperCase():C.toLowerCase()}S+1&136&&(m>0&&(w+=m),S!==Q.h1&&(w+="/"),m=0,S+=8)}var x="";s[Me]&F.KSIDE_CASTLE&&(x+="K"),s[Me]&F.QSIDE_CASTLE&&(x+="Q"),s[je]&F.KSIDE_CASTLE&&(x+="k"),s[je]&F.QSIDE_CASTLE&&(x+="q"),x=x||"-";var R=l===Ne?"-":Ae(l);return[w,o,x,R,c,h].join(" ")}function g(m){for(var w=0;w<m.length;w+=2)typeof m[w]=="string"&&typeof m[w+1]=="string"&&(b[m[w]]=m[w+1]);return b}function $(m){d.length>0||(m!==zt?(b.SetUp="1",b.FEN=m):(delete b.SetUp,delete b.FEN))}function y(m){var w=t[Q[m]];return w?{type:w.type,color:w.color}:null}function k(m,w){if(!("type"in m&&"color"in m)||Hr.indexOf(m.type.toLowerCase())===-1||!(w in Q))return!1;var S=Q[w];return m.type==rt&&!(e[m.color]==Ne||e[m.color]==S)?!1:(t[S]={type:m.type,color:m.color},m.type===rt&&(e[m.color]=S),$(p()),!0)}function P(m){var w=y(m);return t[Q[m]]=null,w&&w.type===rt&&(e[w.color]=Ne),$(p()),w}function M(m,w,S,A,C){var x={color:o,from:w,to:S,flags:A,piece:m[w].type};return C&&(x.flags|=F.PROMOTION,x.promotion=C),m[S]?x.captured=m[S].type:A&F.EP_CAPTURE&&(x.captured=Be),x}function D(m){function w(B,W,O,G,H){if(B[O].type===Be&&(Ue(G)===Kr||Ue(G)===Ur))for(var Re=[ti,ei,vt,wn],X=0,Ie=Re.length;X<Ie;X++)W.push(M(B,O,G,H,Re[X]));else W.push(M(B,O,G,H))}var S=[],A=o,C=ct(A),x={b:Xr,w:Vr},R=Q.a8,q=Q.h1,K=!1,J=typeof m<"u"&&"legal"in m?m.legal:!0,de=typeof m<"u"&&"piece"in m&&typeof m.piece=="string"?m.piece.toLowerCase():!0;if(typeof m<"u"&&"square"in m)if(m.square in Q)R=q=Q[m.square],K=!0;else return[];for(var z=R;z<=q;z++){if(z&136){z+=7;continue}var V=t[z];if(!(V==null||V.color!==A)){if(V.type===Be&&(de===!0||de===Be)){var j=z+Dt[A][0];if(t[j]==null){w(t,S,z,j,F.NORMAL);var j=z+Dt[A][1];x[A]===Ue(z)&&t[j]==null&&w(t,S,z,j,F.BIG_PAWN)}for(ee=2;ee<4;ee++){var j=z+Dt[A][ee];j&136||(t[j]!=null&&t[j].color===C?w(t,S,z,j,F.CAPTURE):j===l&&w(t,S,z,l,F.EP_CAPTURE))}}else if(de===!0||de===V.type)for(var ee=0,ae=gn[V.type].length;ee<ae;ee++)for(var ke=gn[V.type][ee],j=z;j+=ke,!(j&136);){if(t[j]==null)w(t,S,z,j,F.NORMAL);else{if(t[j].color===A)break;w(t,S,z,j,F.CAPTURE);break}if(V.type==="n"||V.type==="k")break}}}if((de===!0||de===rt)&&(!K||q===e[A])){if(s[A]&F.KSIDE_CASTLE){var te=e[A],be=te+2;t[te+1]==null&&t[be]==null&&!L(C,e[A])&&!L(C,te+1)&&!L(C,be)&&w(t,S,e[A],be,F.KSIDE_CASTLE)}if(s[A]&F.QSIDE_CASTLE){var te=e[A],be=te-2;t[te-1]==null&&t[te-2]==null&&t[te-3]==null&&!L(C,e[A])&&!L(C,te-1)&&!L(C,be)&&w(t,S,e[A],be,F.QSIDE_CASTLE)}}if(!J)return S;for(var Ce=[],z=0,ae=S.length;z<ae;z++)fe(S[z]),ne(A)||Ce.push(S[z]),ie();return Ce}function Y(m,w){var S="";if(m.flags&F.KSIDE_CASTLE)S="O-O";else if(m.flags&F.QSIDE_CASTLE)S="O-O-O";else{if(m.piece!==Be){var A=Qr(m,w);S+=m.piece.toUpperCase()+A}m.flags&(F.CAPTURE|F.EP_CAPTURE)&&(m.piece===Be&&(S+=Ae(m.from)[0]),S+="x"),S+=Ae(m.to),m.flags&F.PROMOTION&&(S+="="+m.promotion.toUpperCase())}return fe(m),pe()&&(Oe()?S+="#":S+="+"),ie(),S}function L(m,w){for(var S=Q.a8;S<=Q.h1;S++){if(S&136){S+=7;continue}if(!(t[S]==null||t[S].color!==m)){var A=t[S],C=S-w,x=C+119;if(Gr[x]&1<<Wr[A.type]){if(A.type===Be){if(C>0){if(A.color===Me)return!0}else if(A.color===je)return!0;continue}if(A.type==="n"||A.type==="k")return!0;for(var R=jr[x],q=S+R,K=!1;q!==w;){if(t[q]!=null){K=!0;break}q+=R}if(!K)return!0}}}return!1}function ne(m){return L(ct(m),e[m])}function pe(){return ne(o)}function Oe(){return pe()&&D().length===0}function me(){return!pe()&&D().length===0}function _e(){for(var m={},w=[],S=0,A=0,C=Q.a8;C<=Q.h1;C++){if(A=(A+1)%2,C&136){C+=7;continue}var x=t[C];x&&(m[x.type]=x.type in m?m[x.type]+1:1,x.type===vt&&w.push(A),S++)}if(S===2)return!0;if(S===3&&(m[vt]===1||m[wn]===1))return!0;if(S===m[vt]+2){for(var R=0,q=w.length,C=0;C<q;C++)R+=w[C];if(R===0||R===q)return!0}return!1}function Te(){for(var m=[],w={},S=!1;;){var A=ie();if(!A)break;m.push(A)}for(;;){var C=p().split(" ").slice(0,4).join(" ");if(w[C]=C in w?w[C]+1:1,w[C]>=3&&(S=!0),!m.length)break;fe(m.pop())}return S}function ve(m){d.push({move:m,kings:{b:e.b,w:e.w},turn:o,castling:{b:s.b,w:s.w},ep_square:l,half_moves:c,move_number:h})}function fe(m){var w=o,S=ct(w);if(ve(m),t[m.to]=t[m.from],t[m.from]=null,m.flags&F.EP_CAPTURE&&(o===je?t[m.to-16]=null:t[m.to+16]=null),m.flags&F.PROMOTION&&(t[m.to]={type:m.promotion,color:w}),t[m.to].type===rt){if(e[t[m.to].color]=m.to,m.flags&F.KSIDE_CASTLE){var A=m.to-1,C=m.to+1;t[A]=t[C],t[C]=null}else if(m.flags&F.QSIDE_CASTLE){var A=m.to+1,C=m.to-2;t[A]=t[C],t[C]=null}s[w]=""}if(s[w]){for(var x=0,R=qe[w].length;x<R;x++)if(m.from===qe[w][x].square&&s[w]&qe[w][x].flag){s[w]^=qe[w][x].flag;break}}if(s[S]){for(var x=0,R=qe[S].length;x<R;x++)if(m.to===qe[S][x].square&&s[S]&qe[S][x].flag){s[S]^=qe[S][x].flag;break}}m.flags&F.BIG_PAWN?o==="b"?l=m.to-16:l=m.to+16:l=Ne,m.piece===Be||m.flags&(F.CAPTURE|F.EP_CAPTURE)?c=0:c++,o===je&&h++,o=ct(o)}function ie(){var m=d.pop();if(m==null)return null;var w=m.move;e=m.kings,o=m.turn,s=m.castling,l=m.ep_square,c=m.half_moves,h=m.move_number;var S=o,A=ct(o);if(t[w.from]=t[w.to],t[w.from].type=w.piece,t[w.to]=null,w.flags&F.CAPTURE)t[w.to]={type:w.captured,color:A};else if(w.flags&F.EP_CAPTURE){var C;S===je?C=w.to-16:C=w.to+16,t[C]={type:Be,color:A}}if(w.flags&(F.KSIDE_CASTLE|F.QSIDE_CASTLE)){var x,R;w.flags&F.KSIDE_CASTLE?(x=w.to+1,R=w.to-1):w.flags&F.QSIDE_CASTLE&&(x=w.to-2,R=w.to+1),t[x]=t[R],t[R]=null}return w}function Le(m,w){for(var S=bn(m),A=0;A<2;A++){if(A==mn){if(!w)return null;var C=!1,x=S.match(/([pnbrqkPNBRQK])?([a-h][1-8])x?-?([a-h][1-8])([qrbnQRBN])?/);if(x){var R=x[1],q=x[2],K=x[3],J=x[4];q.length==1&&(C=!0)}else{var x=S.match(/([pnbrqkPNBRQK])?([a-h]?[1-8]?)x?-?([a-h][1-8])([qrbnQRBN])?/);if(x){var R=x[1],q=x[2],K=x[3],J=x[4];if(q.length==1)var C=!0}}}for(var de=Zr(S),z=D({legal:!0,piece:R||de}),V=0,j=z.length;V<j;V++)switch(A){case Yr:{if(S===bn(Y(z[V],z)))return z[V];break}case mn:if(x){if((!R||R.toLowerCase()==z[V].piece)&&Q[q]==z[V].from&&Q[K]==z[V].to&&(!J||J.toLowerCase()==z[V].promotion))return z[V];if(C){var ee=Ae(z[V].from);if((!R||R.toLowerCase()==z[V].piece)&&Q[K]==z[V].to&&(q==ee[0]||q==ee[1])&&(!J||J.toLowerCase()==z[V].promotion))return z[V]}}}}return null}function ge(m){var w=qn(m);w.san=Y(w,D({legal:!0})),w.to=Ae(w.to),w.from=Ae(w.from);var S="";for(var A in F)F[A]&w.flags&&(S+=ni[A]);return w.flags=S,w}function we(m){for(var w=D({legal:!1}),S=0,A=o,C=0,x=w.length;C<x;C++){if(fe(w[C]),!ne(A))if(m-1>0){var R=we(m-1);S+=R}else S++;ie()}return S}return{load:function(m){return u(m)},reset:function(){return a()},moves:function(m){for(var w=D(m),S=[],A=0,C=w.length;A<C;A++)typeof m<"u"&&"verbose"in m&&m.verbose?S.push(ge(w[A])):S.push(Y(w[A],D({legal:!0})));return S},in_check:function(){return pe()},in_checkmate:function(){return Oe()},in_stalemate:function(){return me()},in_draw:function(){return c>=100||me()||_e()||Te()},insufficient_material:function(){return _e()},in_threefold_repetition:function(){return Te()},game_over:function(){return c>=100||Oe()||me()||_e()||Te()},validate_fen:function(m){return f(m)},fen:function(){return p()},board:function(){for(var m=[],w=[],S=Q.a8;S<=Q.h1;S++)t[S]==null?w.push(null):w.push({square:Ae(S),type:t[S].type,color:t[S].color}),S+1&136&&(m.push(w),w=[],S+=8);return m},pgn:function(m){var w=typeof m=="object"&&typeof m.newline_char=="string"?m.newline_char:`
`,S=typeof m=="object"&&typeof m.max_width=="number"?m.max_width:0,A=[],C=!1;for(var x in b)A.push("["+x+' "'+b[x]+'"]'+w),C=!0;C&&d.length&&A.push(w);for(var R=function(ee){var ae=_[p()];if(typeof ae<"u"){var ke=ee.length>0?" ":"";ee=`${ee}${ke}{${ae}}`}return ee},q=[];d.length>0;)q.push(ie());var K=[],J="";for(q.length===0&&K.push(R(""));q.length>0;){J=R(J);var de=q.pop();if(!d.length&&de.color==="b"){const ee=`${h}. ...`;J=J?`${J} ${ee}`:ee}else de.color==="w"&&(J.length&&K.push(J),J=h+".");J=J+" "+Y(de,D({legal:!0})),fe(de)}if(J.length&&K.push(R(J)),typeof b.Result<"u"&&K.push(b.Result),S===0)return A.join("")+K.join(" ");for(var z=function(){return A.length>0&&A[A.length-1]===" "?(A.pop(),!0):!1},V=function(ee,ae){for(var ke of ae.split(" "))if(!!ke){if(ee+ke.length>S){for(;z();)ee--;A.push(w),ee=0}A.push(ke),ee+=ke.length,A.push(" "),ee++}return z()&&ee--,ee},j=0,x=0;x<K.length;x++){if(j+K[x].length>S&&K[x].includes("{")){j=V(j,K[x]);continue}j+K[x].length>S&&x!==0?(A[A.length-1]===" "&&A.pop(),A.push(w),j=0):x!==0&&(A.push(" "),j++),A.push(K[x]),j+=K[x].length}return A.join("")},load_pgn:function(m,w){var S=typeof w<"u"&&"sloppy"in w?w.sloppy:!1;function A(O){return O.replace(/\\/g,"\\")}function C(O,G){for(var H=typeof G=="object"&&typeof G.newline_char=="string"?G.newline_char:`\r?
`,Re={},X=O.split(new RegExp(A(H))),Ie="",xe="",Ye=0;Ye<X.length;Ye++){var at=/^\s*\[([A-Za-z]+)\s*"(.*)"\s*\]\s*$/;Ie=X[Ye].replace(at,"$1"),xe=X[Ye].replace(at,"$2"),vn(Ie).length>0&&(Re[Ie]=xe)}return Re}m=m.trim();var x=typeof w=="object"&&typeof w.newline_char=="string"?w.newline_char:`\r?
`,R=new RegExp("^(\\[((?:"+A(x)+")|.)*\\])(?:\\s*"+A(x)+"){2}"),q=R.test(m)?R.exec(m)[1]:"";a();var K=C(q,w),J="";for(var de in K)de.toLowerCase()==="fen"&&(J=K[de]),g([de,K[de]]);if(S){if(J&&!u(J,!0))return!1}else if(K.SetUp==="1"&&!("FEN"in K&&u(K.FEN,!0)))return!1;for(var z=function(O){return Array.from(O).map(function(G){return G.charCodeAt(0)<128?G.charCodeAt(0).toString(16):encodeURIComponent(G).replace(/\%/g,"").toLowerCase()}).join("")},V=function(O){return O.length==0?"":decodeURIComponent("%"+O.match(/.{1,2}/g).join("%"))},j=function(O){return O=O.replace(new RegExp(A(x),"g")," "),`{${z(O.slice(1,O.length-1))}}`},ee=function(O){if(O.startsWith("{")&&O.endsWith("}"))return V(O.slice(1,O.length-1))},ae=m.replace(q,"").replace(new RegExp(`({[^}]*})+?|;([^${A(x)}]*)`,"g"),function(O,G,H){return G!==void 0?j(G):" "+j(`{${H.slice(1)}}`)}).replace(new RegExp(A(x),"g")," "),ke=/(\([^\(\)]+\))+?/g;ke.test(ae);)ae=ae.replace(ke,"");ae=ae.replace(/\d+\.(\.\.)?/g,""),ae=ae.replace(/\.\.\./g,""),ae=ae.replace(/\$\d+/g,"");var te=vn(ae).split(new RegExp(/\s+/));te=te.join(",").replace(/,,+/g,",").split(",");for(var be="",Ce="",B=0;B<te.length;B++){var W=ee(te[B]);if(W!==void 0){_[p()]=W;continue}if(be=Le(te[B],S),be==null)if(qr.indexOf(te[B])>-1)Ce=te[B];else return!1;else Ce="",fe(be)}return Ce&&Object.keys(b).length&&!b.Result&&g(["Result",Ce]),!0},header:function(){return g(arguments)},turn:function(){return o},move:function(m,w){var S=typeof w<"u"&&"sloppy"in w?w.sloppy:!1,A=null;if(typeof m=="string")A=Le(m,S);else if(typeof m=="object"){for(var C=D(),x=0,R=C.length;x<R;x++)if(m.from===Ae(C[x].from)&&m.to===Ae(C[x].to)&&(!("promotion"in C[x])||m.promotion===C[x].promotion)){A=C[x];break}}if(!A)return null;var q=ge(A);return fe(A),q},undo:function(){var m=ie();return m?ge(m):null},clear:function(){return n()},put:function(m,w){return k(m,w)},get:function(m){return y(m)},ascii(){for(var m=`   +------------------------+
`,w=Q.a8;w<=Q.h1;w++){if(dt(w)===0&&(m+=" "+"87654321"[Ue(w)]+" |"),t[w]==null)m+=" . ";else{var S=t[w].type,A=t[w].color,C=A===Me?S.toUpperCase():S.toLowerCase();m+=" "+C+" "}w+1&136&&(m+=`|
`,w+=8)}return m+=`   +------------------------+
`,m+="     a  b  c  d  e  f  g  h",m},remove:function(m){return P(m)},perft:function(m){return we(m)},square_color:function(m){if(m in Q){var w=Q[m];return(Ue(w)+dt(w))%2===0?"light":"dark"}return null},history:function(m){for(var w=[],S=[],A=typeof m<"u"&&("verbose"in m)&&m.verbose;d.length>0;)w.push(ie());for(;w.length>0;){var C=w.pop();A?S.push(ge(C)):S.push(Y(C,D({legal:!0}))),fe(C)}return S},get_comment:function(){return _[p()]},set_comment:function(m){_[p()]=m.replace("{","[").replace("}","]")},delete_comment:function(){var m=_[p()];return delete _[p()],m},get_comments:function(){return i(),Object.keys(_).map(function(m){return{fen:m,comment:_[m]}})},delete_comments:function(){return i(),Object.keys(_).map(function(m){var w=_[m];return delete _[m],{fen:m,comment:w}})}}},nn={Event:"E",Site:"S",Round:"N",White:"W",Black:"B",Date:"D",Result:"R",FEN:"F",SetUp:"SU",WhiteElo:"WE",BlackElo:"BE",PuzzleTitle:"PT",PuzzleMotif:"PM",PuzzleDescription:"PD"},Gn=Object.keys(nn),ri=Object.fromEntries(Object.entries(nn).map(([r,t])=>[t,r])),jn=r=>{const t=new Ze;if(t.load_pgn(r),t.delete_comments(),!t.header().Result){const c=(r.trim().match(/(1-0)|(0-1)|(1\/2-1\/2)$/)||[])[0];c&&t.header("Result",c)}const e=Object.entries(t.header()),[o,s]=e.length>0?t.pgn().split(`

`):[void 0,t.pgn()];return[e.filter(([c,h])=>Gn.includes(c)&&h!=="?").map(([c,h])=>`[${c} "${h}"]`).sort().join(`
`),s].join(`

`)},yn=r=>{const t=new Ze;t.load_pgn(r);const e=t.history().join(" "),o=Object.entries(t.header()).filter(([s])=>Gn.includes(s)).map(([s,l])=>`${nn[s]} ${l}`).sort().join(`
`);return btoa([o,e].join(`

`))},ii=r=>{const[t,e]=atob(r).split(`

`);let o;const s=t.split(`
`).map(c=>{const[h,...d]=c.split(" "),b=d.join(" ");return h==="R"&&(o=b),`[${ri[h]} "${b}"]`}).join(`
`),l=e.split(" ").map((c,h)=>h%2===0?`${h/2+1}. ${c}`:c).join(" ")+` ${o}`;return[s,l].join(`

`)},oi=["January","February","March","April","May","June","July","August","September","October","November","December"],si=r=>{const[t,e,o]=r.split(".").map(Number),s=Number.isNaN(e)?null:oi[e-1],l=Number.isNaN(o)||s===null?null:o,c=Number.isNaN(t)?null:t;return s&&l&&c?`${s} ${l}, ${c}`:s&&c?`${s} ${c}`:c?String(c):""},Sn=r=>r.split(",").map(t=>t.trim()).reverse().join(" "),ai=new Map([["q",9],["r",5],["b",3],["n",3],["p",1]]),Ee=(r,t=null)=>!r||r==="?"?t:r;class ot{positions=[];game=new Ze;constructor(){}loadPGN(t){const e=new Ze,o=new Ze;e.load_pgn(jn(t)),e.delete_comments();const s=e.history({verbose:!0}),l=e.header().FEN;return l&&o.load(l),this.positions=[{ply:0,move:null,end:s.length,fen:o.fen(),check:o.in_check(),mate:o.in_checkmate(),turn:o.turn(),material:this.materialInfo(o.board()),placement:this.getPlacement(o.fen()),last:s.length===0}],s.forEach((c,h)=>{o.move(c);const d=o.fen();this.positions.push({ply:h+1,move:c,end:s.length-1-h,fen:d,check:o.in_check(),mate:o.in_checkmate(),turn:o.turn(),material:this.materialInfo(o.board()),placement:this.getPlacement(d),last:h===s.length-1})}),this.game=e,this}loadFEN(t){return this.game=new Ze(t),this.positions=[{ply:0,move:null,end:0,fen:t,check:this.game.in_check(),mate:this.game.in_checkmate(),turn:this.game.turn(),material:this.materialInfo(this.game.board()),placement:this.getPlacement(this.game.fen()),last:!0}],this}getPlacement(t){const e=new Ze(t).board(),o=[];for(let s=0;s<8;s++)for(let l=0;l<8;l++)if(e[s][l]!==null){const{type:c,color:h}=e[s][l];o.push({x:l,y:s,type:c,color:h})}return o}materialInfo(t){const e=t.flat().filter(Boolean),o={w:0,b:0},s={w:{p:0,n:0,b:0,r:0,q:0},b:{p:0,n:0,b:0,r:0,q:0}},l={w:{p:0,n:0,b:0,r:0,q:0},b:{p:0,n:0,b:0,r:0,q:0}};for(const c of e)if(c!==null&&c.type!=="k"){o[c.color]+=ai.get(c.type)??0,l[c.color][c.type]+=1;const h=c.color==="b"?"w":"b";s[h][c.type]===0?s[c.color][c.type]+=1:s[h][c.type]-=1}return{sum:o,imbalance:s,count:l,diff:o.w-o.b}}get length(){return this.positions.length}get header(){const t=this.game.header(),e=Ee(t.White,"Anonymous"),o=Ee(t.Black,"Anonymous"),s=Ee(t.Date);return{White:e,Black:o,WhitePretty:Sn(e),BlackPretty:Sn(o),WhiteElo:Ee(t.WhiteElo),BlackElo:Ee(t.BlackElo),Date:s,DatePretty:s===null?null:si(s),Event:Ee(t.Event),Round:Ee(t.Round),Site:Ee(t.Site),Result:Ee(t.Result),PuzzleTitle:Ee(t.PuzzleTitle),PuzzleMotif:Ee(t.PuzzleMotif),PuzzleDescription:Ee(t.PuzzleDescription)}}getTitle({anonymous:t}){const e=this.header,o=t?"Anonymous":e.WhitePretty,s=t?"Anonymous":e.BlackPretty;return`${o} vs ${s}`+(e.Event?` | ${e.Event}`:"")+(e.Round?`, Round ${e.Round}`:"")+(e.DatePretty?` | ${e.DatePretty}`:"")}getShortTitle({anonymous:t}){const e=this.header,o=t?"Anonymous":e.WhitePretty,s=t?"Anonymous":e.BlackPretty;return`${o} vs ${s}`+(e.Event?` | ${e.Event}`:"")}getFileName(t){const e=this.header,o=t?"Anonymous":e.WhitePretty,s=t?"Anonymous":e.BlackPretty;return((e.Date?`${e.Date.replace(/\?/g,"X").replace(/\./g,"-")}_`:"")+`${o}_${s}`+(e.Event?`_${e.Event}`:"")+(e.Round?`_R${e.Round}`:"")).replace(/\s+/g,"-")}get pgn(){return this.game.pgn()}get anonymousPGN(){const t=this.game.pgn().replace(/\[White .+\]/,'[White "Anonymous"]').replace(/\[Black .+\]/,'[Black "Anonymous"]');return Ct(this.header.Site)?t.replace(/\[Site .+\]/,'[Site "?"]'):t}getPosition(t){return this.positions[t]??null}getMoves(){return this.positions.slice(1).map(({move:t})=>t?.san)}}var Lt={exports:{}};Lt.exports=rn;Lt.exports.isMobile=rn;Lt.exports.default=rn;const li=/(android|bb\d+|meego).+mobile|armv7l|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|samsungbrowser|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,ci=/CrOS/,ui=/android|ipad|playbook|silk/i;function rn(r){r||(r={});let t=r.ua;if(!t&&typeof navigator<"u"&&(t=navigator.userAgent),t&&t.headers&&typeof t.headers["user-agent"]=="string"&&(t=t.headers["user-agent"]),typeof t!="string")return!1;let e=li.test(t)&&!ci.test(t)||!!r.tablet&&ui.test(t);return!e&&r.tablet&&r.featureDetect&&navigator&&navigator.maxTouchPoints>1&&t.indexOf("Macintosh")!==-1&&t.indexOf("Safari")!==-1&&(e=!0),e}var fi=Lt.exports;const Xt=Symbol("store-raw"),ht=Symbol("store-node"),di=Symbol("store-name");function Wn(r,t){let e=r[et];if(!e&&(Object.defineProperty(r,et,{value:e=new Proxy(r,pi)}),!Array.isArray(r))){const o=Object.keys(r),s=Object.getOwnPropertyDescriptors(r);for(let l=0,c=o.length;l<c;l++){const h=o[l];if(s[h].get){const d=s[h].get.bind(e);Object.defineProperty(r,h,{get:d})}}}return e}function Et(r){let t;return r!=null&&typeof r=="object"&&(r[et]||!(t=Object.getPrototypeOf(r))||t===Object.prototype||Array.isArray(r))}function _t(r,t=new Set){let e,o,s,l;if(e=r!=null&&r[Xt])return e;if(!Et(r)||t.has(r))return r;if(Array.isArray(r)){Object.isFrozen(r)?r=r.slice(0):t.add(r);for(let c=0,h=r.length;c<h;c++)s=r[c],(o=_t(s,t))!==s&&(r[c]=o)}else{Object.isFrozen(r)?r=Object.assign({},r):t.add(r);const c=Object.keys(r),h=Object.getOwnPropertyDescriptors(r);for(let d=0,b=c.length;d<b;d++)l=c[d],!h[l].get&&(s=r[l],(o=_t(s,t))!==s&&(r[l]=o))}return r}function Pt(r){let t=r[ht];return t||Object.defineProperty(r,ht,{value:t={}}),t}function Kt(r,t,e){return r[t]||(r[t]=Vn(e))}function hi(r,t){const e=Reflect.getOwnPropertyDescriptor(r,t);return!e||e.get||!e.configurable||t===et||t===ht||t===di||(delete e.value,delete e.writable,e.get=()=>r[et][t]),e}function Un(r){if(Ln()){const t=Pt(r);(t._||(t._=Vn()))()}}function _i(r){return Un(r),Reflect.ownKeys(r)}function Vn(r){const[t,e]=De(r,{equals:!1,internal:!0});return t.$=e,t}const pi={get(r,t,e){if(t===Xt)return r;if(t===et)return e;if(t===Wt)return Un(r),e;const o=Pt(r),s=o.hasOwnProperty(t);let l=s?o[t]():r[t];if(t===ht||t==="__proto__")return l;if(!s){const c=Object.getOwnPropertyDescriptor(r,t);Ln()&&(typeof l!="function"||r.hasOwnProperty(t))&&!(c&&c.get)&&(l=Kt(o,t,l)())}return Et(l)?Wn(l):l},has(r,t){if(t===Xt||t===et||t===Wt||t===ht||t==="__proto__")return!0;const e=Pt(r)[t];return e&&e(),t in r},set(){return!0},deleteProperty(){return!0},ownKeys:_i,getOwnPropertyDescriptor:hi};function It(r,t,e,o=!1){if(!o&&r[t]===e)return;const s=r[t],l=r.length;e===void 0?delete r[t]:r[t]=e;let c=Pt(r),h;(h=Kt(c,t,s))&&h.$(()=>e),Array.isArray(r)&&r.length!==l&&(h=Kt(c,"length",l))&&h.$(r.length),(h=c._)&&h.$()}function Xn(r,t){const e=Object.keys(t);for(let o=0;o<e.length;o+=1){const s=e[o];It(r,s,t[s])}}function gi(r,t){if(typeof t=="function"&&(t=t(r)),t=_t(t),Array.isArray(t)){if(r===t)return;let e=0,o=t.length;for(;e<o;e++){const s=t[e];r[e]!==s&&It(r,e,s)}It(r,"length",o)}else Xn(r,t)}function ft(r,t,e=[]){let o,s=r;if(t.length>1){o=t.shift();const c=typeof o,h=Array.isArray(r);if(Array.isArray(o)){for(let d=0;d<o.length;d++)ft(r,[o[d]].concat(t),e);return}else if(h&&c==="function"){for(let d=0;d<r.length;d++)o(r[d],d)&&ft(r,[d].concat(t),e);return}else if(h&&c==="object"){const{from:d=0,to:b=r.length-1,by:_=1}=o;for(let n=d;n<=b;n+=_)ft(r,[n].concat(t),e);return}else if(t.length>1){ft(r[o],t,[o].concat(e));return}s=r[o],e=[o].concat(e)}let l=t[0];typeof l=="function"&&(l=l(s,e),l===s)||o===void 0&&l==null||(l=_t(l),o===void 0||Et(s)&&Et(l)&&!Array.isArray(l)?Xn(s,l):It(r,o,l))}function mi(...[r,t]){const e=_t(r||{}),o=Array.isArray(e),s=Wn(e);function l(...c){cr(()=>{o&&c.length===1?gi(e,c[0]):ft(e,c)})}return[s,l]}const Rt=["standard","spring","azure","violet","rose","peach","clay","rock","lila","leko","patina","mud","spun","gulf","silk","nobel","qootee","qootee_summer","qootee_pink","qootee_grape","marino","bay","havelock","picont","oracle","rhino","mist","pigeon","oxford","mandy","copper","salmon","camelot","cadillac","mona","carnation","tangerine","sienna","fuzzy","flamingo","orange","jaffa","ronchi","conifer","olive","turmeric","bahia","husk","york","sulu","sushi","salad","meadow","observatory","keppel","casal","mule","russett","sirocco","nevada","danny","danny_green","danny_cyan","danny_blue","danny_purple","danny_pink","danny_red","danny_yellow","lichess","danya","botez","avocado","mono_chico","mono_mojo","mono_mahogany","mono_mulberry","mono_blue","mono_teal","mono_goblin","mono_sycamore","mono_coral","mono_flamingo","mono_rose","mono_heliotrope","mono_cornflower","mono_dodger","mono_meadow","mono_mantis","mono_coper","mono_contessa","mono_terracotta","mono_harvest","mono_kashmir","mono_affair","mono_cadillac","mono_beaver","mono_asparagus","mono_amazon","mono_nevada","mono_mobster","mono_bw","mono_bw2","mono_sharechess_dark","mono_sharechess_light","smooth_sunset","smooth_summer","smooth_spring","smooth_forest","smooth_laguna","smooth_sea","smooth_violet","smooth_mono","contrast_a","contrast_b","contrast_c","contrast_d","rainbow_light","rainbow","rainbow_dark","rainbow_night","clouds_bermuda","clouds_kimberly","clouds_wisteria","clouds_rose","clouds_sandal","clouds_gimblet","clouds_cucumber","clouds_acapulco","chessception_brown","chessception_green","chessception_pink","chessception_violet","wood1","wood2","wood3","wood4","wood5","wood6","wood7","wood8","wood9","wood10","wood11","wood12","wood13","wood14","wood15","wood16","lines_parchment","lines_alabaster","lines_paper","lines_cardboard","grass1","grass2","grass3","grass4","asphalt1","asphalt2","asphalt3","asphalt4","leather1","leather2","leather3","leather4"],bi=r=>(Rt.includes(r.boardStyle)||delete r.boardStyle,Ot.includes(r.piecesStyle)||delete r.piecesStyle,r),vi=()=>{const r=localStorage.getItem("boardConfig"),t=localStorage.getItem("gameConfig"),e=localStorage.getItem("siteConfig"),o=localStorage.getItem("recent"),s=localStorage.getItem("pieces"),l=localStorage.getItem("boards");return{boardConfig:r===null?{}:bi(JSON.parse(r)),gameConfig:t===null?{}:JSON.parse(t),siteConfig:e===null?{}:JSON.parse(e),recent:o===null?[]:JSON.parse(o),pieces:s===null?new Set:new Set(JSON.parse(s)),boards:l===null?new Set:new Set(JSON.parse(l))}};var Yt={exports:{}};(function(r,t){(function(e,o){var s="1.0.2",l="",c="?",h="function",d="undefined",b="object",_="string",n="major",i="model",a="name",u="type",f="vendor",p="version",g="architecture",$="console",y="mobile",k="tablet",P="smarttv",M="wearable",D="embedded",Y=255,L="Amazon",ne="Apple",pe="ASUS",Oe="BlackBerry",me="Browser",_e="Chrome",Te="Edge",ve="Firefox",fe="Google",ie="Huawei",Le="LG",ge="Microsoft",we="Motorola",m="Opera",w="Samsung",S="Sony",A="Xiaomi",C="Zebra",x="Facebook",R=function(B,W){var O={};for(var G in B)W[G]&&W[G].length%2===0?O[G]=W[G].concat(B[G]):O[G]=B[G];return O},q=function(B){for(var W={},O=0;O<B.length;O++)W[B[O].toUpperCase()]=B[O];return W},K=function(B,W){return typeof B===_?J(W).indexOf(J(B))!==-1:!1},J=function(B){return B.toLowerCase()},de=function(B){return typeof B===_?B.replace(/[^\d\.]/g,l).split(".")[0]:o},z=function(B,W){if(typeof B===_)return B=B.replace(/^\s\s*/,l).replace(/\s\s*$/,l),typeof W===d?B:B.substring(0,Y)},V=function(B,W){for(var O=0,G,H,Re,X,Ie,xe;O<W.length&&!Ie;){var Ye=W[O],at=W[O+1];for(G=H=0;G<Ye.length&&!Ie;)if(Ie=Ye[G++].exec(B),Ie)for(Re=0;Re<at.length;Re++)xe=Ie[++H],X=at[Re],typeof X===b&&X.length>0?X.length===2?typeof X[1]==h?this[X[0]]=X[1].call(this,xe):this[X[0]]=X[1]:X.length===3?typeof X[1]===h&&!(X[1].exec&&X[1].test)?this[X[0]]=xe?X[1].call(this,xe,X[2]):o:this[X[0]]=xe?xe.replace(X[1],X[2]):o:X.length===4&&(this[X[0]]=xe?X[3].call(this,xe.replace(X[1],X[2])):o):this[X]=xe||o;O+=2}},j=function(B,W){for(var O in W)if(typeof W[O]===b&&W[O].length>0){for(var G=0;G<W[O].length;G++)if(K(W[O][G],B))return O===c?o:O}else if(K(W[O],B))return O===c?o:O;return B},ee={"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"},ae={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},ke={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[p,[a,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[p,[a,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[a,p],[/opios[\/ ]+([\w\.]+)/i],[p,[a,m+" Mini"]],[/\bopr\/([\w\.]+)/i],[p,[a,m]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale|qqbrowserlite|qq)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[a,p],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[p,[a,"UC"+me]],[/\bqbcore\/([\w\.]+)/i],[p,[a,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[p,[a,"WeChat"]],[/konqueror\/([\w\.]+)/i],[p,[a,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[p,[a,"IE"]],[/yabrowser\/([\w\.]+)/i],[p,[a,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[a,/(.+)/,"$1 Secure "+me],p],[/\bfocus\/([\w\.]+)/i],[p,[a,ve+" Focus"]],[/\bopt\/([\w\.]+)/i],[p,[a,m+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[p,[a,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[p,[a,"Dolphin"]],[/coast\/([\w\.]+)/i],[p,[a,m+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[p,[a,"MIUI "+me]],[/fxios\/([-\w\.]+)/i],[p,[a,ve]],[/\bqihu|(qi?ho?o?|360)browser/i],[[a,"360 "+me]],[/(oculus|samsung|sailfish)browser\/([\w\.]+)/i],[[a,/(.+)/,"$1 "+me],p],[/(comodo_dragon)\/([\w\.]+)/i],[[a,/_/g," "],p],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[a,p],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i],[a],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[a,x],p],[/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[a,p],[/\bgsa\/([\w\.]+) .*safari\//i],[p,[a,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[p,[a,_e+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[a,_e+" WebView"],p],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[p,[a,"Android "+me]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[a,p],[/version\/([\w\.]+) .*mobile\/\w+ (safari)/i],[p,[a,"Mobile Safari"]],[/version\/([\w\.]+) .*(mobile ?safari|safari)/i],[p,a],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[a,[p,j,ee]],[/(webkit|khtml)\/([\w\.]+)/i],[a,p],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[a,"Netscape"],p],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[p,[a,ve+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[a,p]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[g,"amd64"]],[/(ia32(?=;))/i],[[g,J]],[/((?:i[346]|x)86)[;\)]/i],[[g,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[g,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[g,"armhf"]],[/windows (ce|mobile); ppc;/i],[[g,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[g,/ower/,l,J]],[/(sun4\w)[;\)]/i],[[g,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[g,J]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[pt]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[i,[f,w],[u,k]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[i,[f,w],[u,y]],[/\((ip(?:hone|od)[\w ]*);/i],[i,[f,ne],[u,y]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[i,[f,ne],[u,k]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[i,[f,ie],[u,k]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}-[atu]?[ln][01259x][012359][an]?)\b(?!.+d\/s)/i],[i,[f,ie],[u,y]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[i,/_/g," "],[f,A],[u,y]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[i,/_/g," "],[f,A],[u,k]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[i,[f,"OPPO"],[u,y]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[i,[f,"Vivo"],[u,y]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[i,[f,"Realme"],[u,y]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[i,[f,we],[u,y]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[i,[f,we],[u,k]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[i,[f,Le],[u,k]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[i,[f,Le],[u,y]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[i,[f,"Lenovo"],[u,k]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[i,/_/g," "],[f,"Nokia"],[u,y]],[/(pixel c)\b/i],[i,[f,fe],[u,k]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[i,[f,fe],[u,y]],[/droid.+ ([c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[i,[f,S],[u,y]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[i,"Xperia Tablet"],[f,S],[u,k]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[i,[f,"OnePlus"],[u,y]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[i,[f,L],[u,k]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[i,/(.+)/g,"Fire Phone $1"],[f,L],[u,y]],[/(playbook);[-\w\),; ]+(rim)/i],[i,f,[u,k]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[i,[f,Oe],[u,y]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[i,[f,pe],[u,k]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[i,[f,pe],[u,y]],[/(nexus 9)/i],[i,[f,"HTC"],[u,k]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic|sony)[-_ ]?([-\w]*)/i],[f,[i,/_/g," "],[u,y]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[i,[f,"Acer"],[u,k]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[i,[f,"Meizu"],[u,y]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[i,[f,"Sharp"],[u,y]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[f,i,[u,y]],[/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[f,i,[u,k]],[/(surface duo)/i],[i,[f,ge],[u,k]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[i,[f,"Fairphone"],[u,y]],[/(u304aa)/i],[i,[f,"AT&T"],[u,y]],[/\bsie-(\w*)/i],[i,[f,"Siemens"],[u,y]],[/\b(rct\w+) b/i],[i,[f,"RCA"],[u,k]],[/\b(venue[\d ]{2,7}) b/i],[i,[f,"Dell"],[u,k]],[/\b(q(?:mv|ta)\w+) b/i],[i,[f,"Verizon"],[u,k]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[i,[f,"Barnes & Noble"],[u,k]],[/\b(tm\d{3}\w+) b/i],[i,[f,"NuVision"],[u,k]],[/\b(k88) b/i],[i,[f,"ZTE"],[u,k]],[/\b(nx\d{3}j) b/i],[i,[f,"ZTE"],[u,y]],[/\b(gen\d{3}) b.+49h/i],[i,[f,"Swiss"],[u,y]],[/\b(zur\d{3}) b/i],[i,[f,"Swiss"],[u,k]],[/\b((zeki)?tb.*\b) b/i],[i,[f,"Zeki"],[u,k]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[f,"Dragon Touch"],i,[u,k]],[/\b(ns-?\w{0,9}) b/i],[i,[f,"Insignia"],[u,k]],[/\b((nxa|next)-?\w{0,9}) b/i],[i,[f,"NextBook"],[u,k]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[f,"Voice"],i,[u,y]],[/\b(lvtel\-)?(v1[12]) b/i],[[f,"LvTel"],i,[u,y]],[/\b(ph-1) /i],[i,[f,"Essential"],[u,y]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[i,[f,"Envizen"],[u,k]],[/\b(trio[-\w\. ]+) b/i],[i,[f,"MachSpeed"],[u,k]],[/\btu_(1491) b/i],[i,[f,"Rotor"],[u,k]],[/(shield[\w ]+) b/i],[i,[f,"Nvidia"],[u,k]],[/(sprint) (\w+)/i],[f,i,[u,y]],[/(kin\.[onetw]{3})/i],[[i,/\./g," "],[f,ge],[u,y]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[i,[f,C],[u,k]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[i,[f,C],[u,y]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[f,i,[u,$]],[/droid.+; (shield) bui/i],[i,[f,"Nvidia"],[u,$]],[/(playstation [345portablevi]+)/i],[i,[f,S],[u,$]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[i,[f,ge],[u,$]],[/smart-tv.+(samsung)/i],[f,[u,P]],[/hbbtv.+maple;(\d+)/i],[[i,/^/,"SmartTV"],[f,w],[u,P]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[f,Le],[u,P]],[/(apple) ?tv/i],[f,[i,ne+" TV"],[u,P]],[/crkey/i],[[i,_e+"cast"],[f,fe],[u,P]],[/droid.+aft(\w)( bui|\))/i],[i,[f,L],[u,P]],[/\(dtv[\);].+(aquos)/i],[i,[f,"Sharp"],[u,P]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w ]*; *(\w[^;]*);([^;]*)/i],[[f,z],[i,z],[u,P]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[u,P]],[/((pebble))app/i],[f,i,[u,M]],[/droid.+; (glass) \d/i],[i,[f,fe],[u,M]],[/droid.+; (wt63?0{2,3})\)/i],[i,[f,C],[u,M]],[/(quest( 2)?)/i],[i,[f,x],[u,M]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[f,[u,D]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[i,[u,y]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[i,[u,k]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[u,k]],[/(phone|mobile(?:[;\/]| safari)|pda(?=.+windows ce))/i],[[u,y]],[/(android[-\w\. ]{0,9});.+buil/i],[i,[f,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[p,[a,Te+"HTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[p,[a,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[a,p],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[p,a]],os:[[/microsoft (windows) (vista|xp)/i],[a,p],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[a,[p,j,ae]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[a,"Windows"],[p,j,ae]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[p,/_/g,"."],[a,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[a,"Mac OS"],[p,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86)/i],[p,a],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[a,p],[/\(bb(10);/i],[p,[a,Oe]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[p,[a,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[p,[a,ve+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[p,[a,"webOS"]],[/crkey\/([\d\.]+)/i],[p,[a,_e+"cast"]],[/(cros) [\w]+ ([\w\.]+\w)/i],[[a,"Chromium OS"],p],[/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[a,p],[/(sunos) ?([\w\.\d]*)/i],[[a,"Solaris"],p],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[a,p]]},te=function(B,W){if(typeof B===b&&(W=B,B=o),!(this instanceof te))return new te(B,W).getResult();var O=B||(typeof e!==d&&e.navigator&&e.navigator.userAgent?e.navigator.userAgent:l),G=W?R(ke,W):ke;return this.getBrowser=function(){var H={};return H[a]=o,H[p]=o,V.call(H,O,G.browser),H.major=de(H.version),H},this.getCPU=function(){var H={};return H[g]=o,V.call(H,O,G.cpu),H},this.getDevice=function(){var H={};return H[f]=o,H[i]=o,H[u]=o,V.call(H,O,G.device),H},this.getEngine=function(){var H={};return H[a]=o,H[p]=o,V.call(H,O,G.engine),H},this.getOS=function(){var H={};return H[a]=o,H[p]=o,V.call(H,O,G.os),H},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return O},this.setUA=function(H){return O=typeof H===_&&H.length>Y?z(H,Y):H,this},this.setUA(O),this};te.VERSION=s,te.BROWSER=q([a,p,n]),te.CPU=q([g]),te.DEVICE=q([i,f,u,$,y,P,k,M,D]),te.ENGINE=te.OS=q([a,p]),r.exports&&(t=r.exports=te),t.UAParser=te;var be=typeof e!==d&&(e.jQuery||e.Zepto);if(be&&!be.ua){var Ce=new te;be.ua=Ce.getResult(),be.ua.get=function(){return Ce.getUA()},be.ua.set=function(B){Ce.setUA(B);var W=Ce.getResult();for(var O in W)be.ua[O]=W[O]}}})(typeof window=="object"?window:Qe)})(Yt,Yt.exports);var wi=Yt.exports;const $n=wi(),yi=fi(),Ge=vi(),Si={size:1024,tiles:8,boardStyle:"standard",piecesStyle:"tatiana",showBorder:!1,showExtraInfo:!0,showMaterial:!0,showMoveIndicator:!0,showChecks:!0,showCoords:!0,showShadows:!1,flipped:!1,puzzle:!1},$i={titleScreen:!0,format:"GIF",picSize:"M",animationSize:"M"},ki={darkMode:!0,sounds:!0,speech:!1,wrongBrowserPopup:!0,androidAppPopup:!0,iOSAppPopup:!0},Ai={boardConfig:{...Si,...Ge.boardConfig},gameConfig:{...$i,...Ge.gameConfig},siteConfig:{...ki,...Ge.siteConfig},game:new ot,pgn:"",fen:"",moves:[],ply:0,mobile:yi,layout:window.innerWidth<window.innerHeight?"single":window.innerWidth<1366?"double":"triple",activeTab:"load",activeLeftTab:"share",playing:!1,anonymous:!1,refreshHash:!0,browser:$n.browser.name,os:$n.os.name,about:!1,userStylesInfo:!1,fullscreenPopup:null,recent:Ge.recent,favoritePieces:Ge.pieces,favoriteBoards:Ge.boards,showFavoritePieces:Ge.pieces.size>0,showFavoriteBoards:Ge.boards.size>0},[v,E]=mi(Ai);var le={};/*!
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(r){(function(){var t=function(){this.init()};t.prototype={init:function(){var n=this||e;return n._counter=1e3,n._html5AudioPool=[],n.html5PoolSize=10,n._codecs={},n._howls=[],n._muted=!1,n._volume=1,n._canPlayEvent="canplaythrough",n._navigator=typeof window<"u"&&window.navigator?window.navigator:null,n.masterGain=null,n.noAudio=!1,n.usingWebAudio=!0,n.autoSuspend=!0,n.ctx=null,n.autoUnlock=!0,n._setup(),n},volume:function(n){var i=this||e;if(n=parseFloat(n),i.ctx||_(),typeof n<"u"&&n>=0&&n<=1){if(i._volume=n,i._muted)return i;i.usingWebAudio&&i.masterGain.gain.setValueAtTime(n,e.ctx.currentTime);for(var a=0;a<i._howls.length;a++)if(!i._howls[a]._webAudio)for(var u=i._howls[a]._getSoundIds(),f=0;f<u.length;f++){var p=i._howls[a]._soundById(u[f]);p&&p._node&&(p._node.volume=p._volume*n)}return i}return i._volume},mute:function(n){var i=this||e;i.ctx||_(),i._muted=n,i.usingWebAudio&&i.masterGain.gain.setValueAtTime(n?0:i._volume,e.ctx.currentTime);for(var a=0;a<i._howls.length;a++)if(!i._howls[a]._webAudio)for(var u=i._howls[a]._getSoundIds(),f=0;f<u.length;f++){var p=i._howls[a]._soundById(u[f]);p&&p._node&&(p._node.muted=n?!0:p._muted)}return i},stop:function(){for(var n=this||e,i=0;i<n._howls.length;i++)n._howls[i].stop();return n},unload:function(){for(var n=this||e,i=n._howls.length-1;i>=0;i--)n._howls[i].unload();return n.usingWebAudio&&n.ctx&&typeof n.ctx.close<"u"&&(n.ctx.close(),n.ctx=null,_()),n},codecs:function(n){return(this||e)._codecs[n.replace(/^x-/,"")]},_setup:function(){var n=this||e;if(n.state=n.ctx&&n.ctx.state||"suspended",n._autoSuspend(),!n.usingWebAudio)if(typeof Audio<"u")try{var i=new Audio;typeof i.oncanplaythrough>"u"&&(n._canPlayEvent="canplay")}catch{n.noAudio=!0}else n.noAudio=!0;try{var i=new Audio;i.muted&&(n.noAudio=!0)}catch{}return n.noAudio||n._setupCodecs(),n},_setupCodecs:function(){var n=this||e,i=null;try{i=typeof Audio<"u"?new Audio:null}catch{return n}if(!i||typeof i.canPlayType!="function")return n;var a=i.canPlayType("audio/mpeg;").replace(/^no$/,""),u=n._navigator?n._navigator.userAgent:"",f=u.match(/OPR\/([0-6].)/g),p=f&&parseInt(f[0].split("/")[1],10)<33,g=u.indexOf("Safari")!==-1&&u.indexOf("Chrome")===-1,$=u.match(/Version\/(.*?) /),y=g&&$&&parseInt($[1],10)<15;return n._codecs={mp3:!!(!p&&(a||i.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!a,opus:!!i.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!i.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!i.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(i.canPlayType('audio/wav; codecs="1"')||i.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!i.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!i.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(i.canPlayType("audio/x-m4a;")||i.canPlayType("audio/m4a;")||i.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(i.canPlayType("audio/x-m4b;")||i.canPlayType("audio/m4b;")||i.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(i.canPlayType("audio/x-mp4;")||i.canPlayType("audio/mp4;")||i.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!y&&i.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!y&&i.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!i.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(i.canPlayType("audio/x-flac;")||i.canPlayType("audio/flac;")).replace(/^no$/,"")},n},_unlockAudio:function(){var n=this||e;if(!(n._audioUnlocked||!n.ctx)){n._audioUnlocked=!1,n.autoUnlock=!1,!n._mobileUnloaded&&n.ctx.sampleRate!==44100&&(n._mobileUnloaded=!0,n.unload()),n._scratchBuffer=n.ctx.createBuffer(1,1,22050);var i=function(a){for(;n._html5AudioPool.length<n.html5PoolSize;)try{var u=new Audio;u._unlocked=!0,n._releaseHtml5Audio(u)}catch{n.noAudio=!0;break}for(var f=0;f<n._howls.length;f++)if(!n._howls[f]._webAudio)for(var p=n._howls[f]._getSoundIds(),g=0;g<p.length;g++){var $=n._howls[f]._soundById(p[g]);$&&$._node&&!$._node._unlocked&&($._node._unlocked=!0,$._node.load())}n._autoResume();var y=n.ctx.createBufferSource();y.buffer=n._scratchBuffer,y.connect(n.ctx.destination),typeof y.start>"u"?y.noteOn(0):y.start(0),typeof n.ctx.resume=="function"&&n.ctx.resume(),y.onended=function(){y.disconnect(0),n._audioUnlocked=!0,document.removeEventListener("touchstart",i,!0),document.removeEventListener("touchend",i,!0),document.removeEventListener("click",i,!0),document.removeEventListener("keydown",i,!0);for(var k=0;k<n._howls.length;k++)n._howls[k]._emit("unlock")}};return document.addEventListener("touchstart",i,!0),document.addEventListener("touchend",i,!0),document.addEventListener("click",i,!0),document.addEventListener("keydown",i,!0),n}},_obtainHtml5Audio:function(){var n=this||e;if(n._html5AudioPool.length)return n._html5AudioPool.pop();var i=new Audio().play();return i&&typeof Promise<"u"&&(i instanceof Promise||typeof i.then=="function")&&i.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(n){var i=this||e;return n._unlocked&&i._html5AudioPool.push(n),i},_autoSuspend:function(){var n=this;if(!(!n.autoSuspend||!n.ctx||typeof n.ctx.suspend>"u"||!e.usingWebAudio)){for(var i=0;i<n._howls.length;i++)if(n._howls[i]._webAudio){for(var a=0;a<n._howls[i]._sounds.length;a++)if(!n._howls[i]._sounds[a]._paused)return n}return n._suspendTimer&&clearTimeout(n._suspendTimer),n._suspendTimer=setTimeout(function(){if(!!n.autoSuspend){n._suspendTimer=null,n.state="suspending";var u=function(){n.state="suspended",n._resumeAfterSuspend&&(delete n._resumeAfterSuspend,n._autoResume())};n.ctx.suspend().then(u,u)}},3e4),n}},_autoResume:function(){var n=this;if(!(!n.ctx||typeof n.ctx.resume>"u"||!e.usingWebAudio))return n.state==="running"&&n.ctx.state!=="interrupted"&&n._suspendTimer?(clearTimeout(n._suspendTimer),n._suspendTimer=null):n.state==="suspended"||n.state==="running"&&n.ctx.state==="interrupted"?(n.ctx.resume().then(function(){n.state="running";for(var i=0;i<n._howls.length;i++)n._howls[i]._emit("resume")}),n._suspendTimer&&(clearTimeout(n._suspendTimer),n._suspendTimer=null)):n.state==="suspending"&&(n._resumeAfterSuspend=!0),n}};var e=new t,o=function(n){var i=this;if(!n.src||n.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}i.init(n)};o.prototype={init:function(n){var i=this;return e.ctx||_(),i._autoplay=n.autoplay||!1,i._format=typeof n.format!="string"?n.format:[n.format],i._html5=n.html5||!1,i._muted=n.mute||!1,i._loop=n.loop||!1,i._pool=n.pool||5,i._preload=typeof n.preload=="boolean"||n.preload==="metadata"?n.preload:!0,i._rate=n.rate||1,i._sprite=n.sprite||{},i._src=typeof n.src!="string"?n.src:[n.src],i._volume=n.volume!==void 0?n.volume:1,i._xhr={method:n.xhr&&n.xhr.method?n.xhr.method:"GET",headers:n.xhr&&n.xhr.headers?n.xhr.headers:null,withCredentials:n.xhr&&n.xhr.withCredentials?n.xhr.withCredentials:!1},i._duration=0,i._state="unloaded",i._sounds=[],i._endTimers={},i._queue=[],i._playLock=!1,i._onend=n.onend?[{fn:n.onend}]:[],i._onfade=n.onfade?[{fn:n.onfade}]:[],i._onload=n.onload?[{fn:n.onload}]:[],i._onloaderror=n.onloaderror?[{fn:n.onloaderror}]:[],i._onplayerror=n.onplayerror?[{fn:n.onplayerror}]:[],i._onpause=n.onpause?[{fn:n.onpause}]:[],i._onplay=n.onplay?[{fn:n.onplay}]:[],i._onstop=n.onstop?[{fn:n.onstop}]:[],i._onmute=n.onmute?[{fn:n.onmute}]:[],i._onvolume=n.onvolume?[{fn:n.onvolume}]:[],i._onrate=n.onrate?[{fn:n.onrate}]:[],i._onseek=n.onseek?[{fn:n.onseek}]:[],i._onunlock=n.onunlock?[{fn:n.onunlock}]:[],i._onresume=[],i._webAudio=e.usingWebAudio&&!i._html5,typeof e.ctx<"u"&&e.ctx&&e.autoUnlock&&e._unlockAudio(),e._howls.push(i),i._autoplay&&i._queue.push({event:"play",action:function(){i.play()}}),i._preload&&i._preload!=="none"&&i.load(),i},load:function(){var n=this,i=null;if(e.noAudio){n._emit("loaderror",null,"No audio support.");return}typeof n._src=="string"&&(n._src=[n._src]);for(var a=0;a<n._src.length;a++){var u,f;if(n._format&&n._format[a])u=n._format[a];else{if(f=n._src[a],typeof f!="string"){n._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}u=/^data:audio\/([^;,]+);/i.exec(f),u||(u=/\.([^.]+)$/.exec(f.split("?",1)[0])),u&&(u=u[1].toLowerCase())}if(u||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),u&&e.codecs(u)){i=n._src[a];break}}if(!i){n._emit("loaderror",null,"No codec support for selected audio sources.");return}return n._src=i,n._state="loading",window.location.protocol==="https:"&&i.slice(0,5)==="http:"&&(n._html5=!0,n._webAudio=!1),new s(n),n._webAudio&&c(n),n},play:function(n,i){var a=this,u=null;if(typeof n=="number")u=n,n=null;else{if(typeof n=="string"&&a._state==="loaded"&&!a._sprite[n])return null;if(typeof n>"u"&&(n="__default",!a._playLock)){for(var f=0,p=0;p<a._sounds.length;p++)a._sounds[p]._paused&&!a._sounds[p]._ended&&(f++,u=a._sounds[p]._id);f===1?n=null:u=null}}var g=u?a._soundById(u):a._inactiveSound();if(!g)return null;if(u&&!n&&(n=g._sprite||"__default"),a._state!=="loaded"){g._sprite=n,g._ended=!1;var $=g._id;return a._queue.push({event:"play",action:function(){a.play($)}}),$}if(u&&!g._paused)return i||a._loadQueue("play"),g._id;a._webAudio&&e._autoResume();var y=Math.max(0,g._seek>0?g._seek:a._sprite[n][0]/1e3),k=Math.max(0,(a._sprite[n][0]+a._sprite[n][1])/1e3-y),P=k*1e3/Math.abs(g._rate),M=a._sprite[n][0]/1e3,D=(a._sprite[n][0]+a._sprite[n][1])/1e3;g._sprite=n,g._ended=!1;var Y=function(){g._paused=!1,g._seek=y,g._start=M,g._stop=D,g._loop=!!(g._loop||a._sprite[n][2])};if(y>=D){a._ended(g);return}var L=g._node;if(a._webAudio){var ne=function(){a._playLock=!1,Y(),a._refreshBuffer(g);var _e=g._muted||a._muted?0:g._volume;L.gain.setValueAtTime(_e,e.ctx.currentTime),g._playStart=e.ctx.currentTime,typeof L.bufferSource.start>"u"?g._loop?L.bufferSource.noteGrainOn(0,y,86400):L.bufferSource.noteGrainOn(0,y,k):g._loop?L.bufferSource.start(0,y,86400):L.bufferSource.start(0,y,k),P!==1/0&&(a._endTimers[g._id]=setTimeout(a._ended.bind(a,g),P)),i||setTimeout(function(){a._emit("play",g._id),a._loadQueue()},0)};e.state==="running"&&e.ctx.state!=="interrupted"?ne():(a._playLock=!0,a.once("resume",ne),a._clearTimer(g._id))}else{var pe=function(){L.currentTime=y,L.muted=g._muted||a._muted||e._muted||L.muted,L.volume=g._volume*e.volume(),L.playbackRate=g._rate;try{var _e=L.play();if(_e&&typeof Promise<"u"&&(_e instanceof Promise||typeof _e.then=="function")?(a._playLock=!0,Y(),_e.then(function(){a._playLock=!1,L._unlocked=!0,i?a._loadQueue():a._emit("play",g._id)}).catch(function(){a._playLock=!1,a._emit("playerror",g._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),g._ended=!0,g._paused=!0})):i||(a._playLock=!1,Y(),a._emit("play",g._id)),L.playbackRate=g._rate,L.paused){a._emit("playerror",g._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}n!=="__default"||g._loop?a._endTimers[g._id]=setTimeout(a._ended.bind(a,g),P):(a._endTimers[g._id]=function(){a._ended(g),L.removeEventListener("ended",a._endTimers[g._id],!1)},L.addEventListener("ended",a._endTimers[g._id],!1))}catch(Te){a._emit("playerror",g._id,Te)}};L.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(L.src=a._src,L.load());var Oe=window&&window.ejecta||!L.readyState&&e._navigator.isCocoonJS;if(L.readyState>=3||Oe)pe();else{a._playLock=!0,a._state="loading";var me=function(){a._state="loaded",pe(),L.removeEventListener(e._canPlayEvent,me,!1)};L.addEventListener(e._canPlayEvent,me,!1),a._clearTimer(g._id)}}return g._id},pause:function(n){var i=this;if(i._state!=="loaded"||i._playLock)return i._queue.push({event:"pause",action:function(){i.pause(n)}}),i;for(var a=i._getSoundIds(n),u=0;u<a.length;u++){i._clearTimer(a[u]);var f=i._soundById(a[u]);if(f&&!f._paused&&(f._seek=i.seek(a[u]),f._rateSeek=0,f._paused=!0,i._stopFade(a[u]),f._node))if(i._webAudio){if(!f._node.bufferSource)continue;typeof f._node.bufferSource.stop>"u"?f._node.bufferSource.noteOff(0):f._node.bufferSource.stop(0),i._cleanBuffer(f._node)}else(!isNaN(f._node.duration)||f._node.duration===1/0)&&f._node.pause();arguments[1]||i._emit("pause",f?f._id:null)}return i},stop:function(n,i){var a=this;if(a._state!=="loaded"||a._playLock)return a._queue.push({event:"stop",action:function(){a.stop(n)}}),a;for(var u=a._getSoundIds(n),f=0;f<u.length;f++){a._clearTimer(u[f]);var p=a._soundById(u[f]);p&&(p._seek=p._start||0,p._rateSeek=0,p._paused=!0,p._ended=!0,a._stopFade(u[f]),p._node&&(a._webAudio?p._node.bufferSource&&(typeof p._node.bufferSource.stop>"u"?p._node.bufferSource.noteOff(0):p._node.bufferSource.stop(0),a._cleanBuffer(p._node)):(!isNaN(p._node.duration)||p._node.duration===1/0)&&(p._node.currentTime=p._start||0,p._node.pause(),p._node.duration===1/0&&a._clearSound(p._node))),i||a._emit("stop",p._id))}return a},mute:function(n,i){var a=this;if(a._state!=="loaded"||a._playLock)return a._queue.push({event:"mute",action:function(){a.mute(n,i)}}),a;if(typeof i>"u")if(typeof n=="boolean")a._muted=n;else return a._muted;for(var u=a._getSoundIds(i),f=0;f<u.length;f++){var p=a._soundById(u[f]);p&&(p._muted=n,p._interval&&a._stopFade(p._id),a._webAudio&&p._node?p._node.gain.setValueAtTime(n?0:p._volume,e.ctx.currentTime):p._node&&(p._node.muted=e._muted?!0:n),a._emit("mute",p._id))}return a},volume:function(){var n=this,i=arguments,a,u;if(i.length===0)return n._volume;if(i.length===1||i.length===2&&typeof i[1]>"u"){var f=n._getSoundIds(),p=f.indexOf(i[0]);p>=0?u=parseInt(i[0],10):a=parseFloat(i[0])}else i.length>=2&&(a=parseFloat(i[0]),u=parseInt(i[1],10));var g;if(typeof a<"u"&&a>=0&&a<=1){if(n._state!=="loaded"||n._playLock)return n._queue.push({event:"volume",action:function(){n.volume.apply(n,i)}}),n;typeof u>"u"&&(n._volume=a),u=n._getSoundIds(u);for(var $=0;$<u.length;$++)g=n._soundById(u[$]),g&&(g._volume=a,i[2]||n._stopFade(u[$]),n._webAudio&&g._node&&!g._muted?g._node.gain.setValueAtTime(a,e.ctx.currentTime):g._node&&!g._muted&&(g._node.volume=a*e.volume()),n._emit("volume",g._id))}else return g=u?n._soundById(u):n._sounds[0],g?g._volume:0;return n},fade:function(n,i,a,u){var f=this;if(f._state!=="loaded"||f._playLock)return f._queue.push({event:"fade",action:function(){f.fade(n,i,a,u)}}),f;n=Math.min(Math.max(0,parseFloat(n)),1),i=Math.min(Math.max(0,parseFloat(i)),1),a=parseFloat(a),f.volume(n,u);for(var p=f._getSoundIds(u),g=0;g<p.length;g++){var $=f._soundById(p[g]);if($){if(u||f._stopFade(p[g]),f._webAudio&&!$._muted){var y=e.ctx.currentTime,k=y+a/1e3;$._volume=n,$._node.gain.setValueAtTime(n,y),$._node.gain.linearRampToValueAtTime(i,k)}f._startFadeInterval($,n,i,a,p[g],typeof u>"u")}}return f},_startFadeInterval:function(n,i,a,u,f,p){var g=this,$=i,y=a-i,k=Math.abs(y/.01),P=Math.max(4,k>0?u/k:u),M=Date.now();n._fadeTo=a,n._interval=setInterval(function(){var D=(Date.now()-M)/u;M=Date.now(),$+=y*D,$=Math.round($*100)/100,y<0?$=Math.max(a,$):$=Math.min(a,$),g._webAudio?n._volume=$:g.volume($,n._id,!0),p&&(g._volume=$),(a<i&&$<=a||a>i&&$>=a)&&(clearInterval(n._interval),n._interval=null,n._fadeTo=null,g.volume(a,n._id),g._emit("fade",n._id))},P)},_stopFade:function(n){var i=this,a=i._soundById(n);return a&&a._interval&&(i._webAudio&&a._node.gain.cancelScheduledValues(e.ctx.currentTime),clearInterval(a._interval),a._interval=null,i.volume(a._fadeTo,n),a._fadeTo=null,i._emit("fade",n)),i},loop:function(){var n=this,i=arguments,a,u,f;if(i.length===0)return n._loop;if(i.length===1)if(typeof i[0]=="boolean")a=i[0],n._loop=a;else return f=n._soundById(parseInt(i[0],10)),f?f._loop:!1;else i.length===2&&(a=i[0],u=parseInt(i[1],10));for(var p=n._getSoundIds(u),g=0;g<p.length;g++)f=n._soundById(p[g]),f&&(f._loop=a,n._webAudio&&f._node&&f._node.bufferSource&&(f._node.bufferSource.loop=a,a&&(f._node.bufferSource.loopStart=f._start||0,f._node.bufferSource.loopEnd=f._stop,n.playing(p[g])&&(n.pause(p[g],!0),n.play(p[g],!0)))));return n},rate:function(){var n=this,i=arguments,a,u;if(i.length===0)u=n._sounds[0]._id;else if(i.length===1){var f=n._getSoundIds(),p=f.indexOf(i[0]);p>=0?u=parseInt(i[0],10):a=parseFloat(i[0])}else i.length===2&&(a=parseFloat(i[0]),u=parseInt(i[1],10));var g;if(typeof a=="number"){if(n._state!=="loaded"||n._playLock)return n._queue.push({event:"rate",action:function(){n.rate.apply(n,i)}}),n;typeof u>"u"&&(n._rate=a),u=n._getSoundIds(u);for(var $=0;$<u.length;$++)if(g=n._soundById(u[$]),g){n.playing(u[$])&&(g._rateSeek=n.seek(u[$]),g._playStart=n._webAudio?e.ctx.currentTime:g._playStart),g._rate=a,n._webAudio&&g._node&&g._node.bufferSource?g._node.bufferSource.playbackRate.setValueAtTime(a,e.ctx.currentTime):g._node&&(g._node.playbackRate=a);var y=n.seek(u[$]),k=(n._sprite[g._sprite][0]+n._sprite[g._sprite][1])/1e3-y,P=k*1e3/Math.abs(g._rate);(n._endTimers[u[$]]||!g._paused)&&(n._clearTimer(u[$]),n._endTimers[u[$]]=setTimeout(n._ended.bind(n,g),P)),n._emit("rate",g._id)}}else return g=n._soundById(u),g?g._rate:n._rate;return n},seek:function(){var n=this,i=arguments,a,u;if(i.length===0)n._sounds.length&&(u=n._sounds[0]._id);else if(i.length===1){var f=n._getSoundIds(),p=f.indexOf(i[0]);p>=0?u=parseInt(i[0],10):n._sounds.length&&(u=n._sounds[0]._id,a=parseFloat(i[0]))}else i.length===2&&(a=parseFloat(i[0]),u=parseInt(i[1],10));if(typeof u>"u")return 0;if(typeof a=="number"&&(n._state!=="loaded"||n._playLock))return n._queue.push({event:"seek",action:function(){n.seek.apply(n,i)}}),n;var g=n._soundById(u);if(g)if(typeof a=="number"&&a>=0){var $=n.playing(u);$&&n.pause(u,!0),g._seek=a,g._ended=!1,n._clearTimer(u),!n._webAudio&&g._node&&!isNaN(g._node.duration)&&(g._node.currentTime=a);var y=function(){$&&n.play(u,!0),n._emit("seek",u)};if($&&!n._webAudio){var k=function(){n._playLock?setTimeout(k,0):y()};setTimeout(k,0)}else y()}else if(n._webAudio){var P=n.playing(u)?e.ctx.currentTime-g._playStart:0,M=g._rateSeek?g._rateSeek-g._seek:0;return g._seek+(M+P*Math.abs(g._rate))}else return g._node.currentTime;return n},playing:function(n){var i=this;if(typeof n=="number"){var a=i._soundById(n);return a?!a._paused:!1}for(var u=0;u<i._sounds.length;u++)if(!i._sounds[u]._paused)return!0;return!1},duration:function(n){var i=this,a=i._duration,u=i._soundById(n);return u&&(a=i._sprite[u._sprite][1]/1e3),a},state:function(){return this._state},unload:function(){for(var n=this,i=n._sounds,a=0;a<i.length;a++)i[a]._paused||n.stop(i[a]._id),n._webAudio||(n._clearSound(i[a]._node),i[a]._node.removeEventListener("error",i[a]._errorFn,!1),i[a]._node.removeEventListener(e._canPlayEvent,i[a]._loadFn,!1),i[a]._node.removeEventListener("ended",i[a]._endFn,!1),e._releaseHtml5Audio(i[a]._node)),delete i[a]._node,n._clearTimer(i[a]._id);var u=e._howls.indexOf(n);u>=0&&e._howls.splice(u,1);var f=!0;for(a=0;a<e._howls.length;a++)if(e._howls[a]._src===n._src||n._src.indexOf(e._howls[a]._src)>=0){f=!1;break}return l&&f&&delete l[n._src],e.noAudio=!1,n._state="unloaded",n._sounds=[],n=null,null},on:function(n,i,a,u){var f=this,p=f["_on"+n];return typeof i=="function"&&p.push(u?{id:a,fn:i,once:u}:{id:a,fn:i}),f},off:function(n,i,a){var u=this,f=u["_on"+n],p=0;if(typeof i=="number"&&(a=i,i=null),i||a)for(p=0;p<f.length;p++){var g=a===f[p].id;if(i===f[p].fn&&g||!i&&g){f.splice(p,1);break}}else if(n)u["_on"+n]=[];else{var $=Object.keys(u);for(p=0;p<$.length;p++)$[p].indexOf("_on")===0&&Array.isArray(u[$[p]])&&(u[$[p]]=[])}return u},once:function(n,i,a){var u=this;return u.on(n,i,a,1),u},_emit:function(n,i,a){for(var u=this,f=u["_on"+n],p=f.length-1;p>=0;p--)(!f[p].id||f[p].id===i||n==="load")&&(setTimeout(function(g){g.call(this,i,a)}.bind(u,f[p].fn),0),f[p].once&&u.off(n,f[p].fn,f[p].id));return u._loadQueue(n),u},_loadQueue:function(n){var i=this;if(i._queue.length>0){var a=i._queue[0];a.event===n&&(i._queue.shift(),i._loadQueue()),n||a.action()}return i},_ended:function(n){var i=this,a=n._sprite;if(!i._webAudio&&n._node&&!n._node.paused&&!n._node.ended&&n._node.currentTime<n._stop)return setTimeout(i._ended.bind(i,n),100),i;var u=!!(n._loop||i._sprite[a][2]);if(i._emit("end",n._id),!i._webAudio&&u&&i.stop(n._id,!0).play(n._id),i._webAudio&&u){i._emit("play",n._id),n._seek=n._start||0,n._rateSeek=0,n._playStart=e.ctx.currentTime;var f=(n._stop-n._start)*1e3/Math.abs(n._rate);i._endTimers[n._id]=setTimeout(i._ended.bind(i,n),f)}return i._webAudio&&!u&&(n._paused=!0,n._ended=!0,n._seek=n._start||0,n._rateSeek=0,i._clearTimer(n._id),i._cleanBuffer(n._node),e._autoSuspend()),!i._webAudio&&!u&&i.stop(n._id,!0),i},_clearTimer:function(n){var i=this;if(i._endTimers[n]){if(typeof i._endTimers[n]!="function")clearTimeout(i._endTimers[n]);else{var a=i._soundById(n);a&&a._node&&a._node.removeEventListener("ended",i._endTimers[n],!1)}delete i._endTimers[n]}return i},_soundById:function(n){for(var i=this,a=0;a<i._sounds.length;a++)if(n===i._sounds[a]._id)return i._sounds[a];return null},_inactiveSound:function(){var n=this;n._drain();for(var i=0;i<n._sounds.length;i++)if(n._sounds[i]._ended)return n._sounds[i].reset();return new s(n)},_drain:function(){var n=this,i=n._pool,a=0,u=0;if(!(n._sounds.length<i)){for(u=0;u<n._sounds.length;u++)n._sounds[u]._ended&&a++;for(u=n._sounds.length-1;u>=0;u--){if(a<=i)return;n._sounds[u]._ended&&(n._webAudio&&n._sounds[u]._node&&n._sounds[u]._node.disconnect(0),n._sounds.splice(u,1),a--)}}},_getSoundIds:function(n){var i=this;if(typeof n>"u"){for(var a=[],u=0;u<i._sounds.length;u++)a.push(i._sounds[u]._id);return a}else return[n]},_refreshBuffer:function(n){var i=this;return n._node.bufferSource=e.ctx.createBufferSource(),n._node.bufferSource.buffer=l[i._src],n._panner?n._node.bufferSource.connect(n._panner):n._node.bufferSource.connect(n._node),n._node.bufferSource.loop=n._loop,n._loop&&(n._node.bufferSource.loopStart=n._start||0,n._node.bufferSource.loopEnd=n._stop||0),n._node.bufferSource.playbackRate.setValueAtTime(n._rate,e.ctx.currentTime),i},_cleanBuffer:function(n){var i=this,a=e._navigator&&e._navigator.vendor.indexOf("Apple")>=0;if(e._scratchBuffer&&n.bufferSource&&(n.bufferSource.onended=null,n.bufferSource.disconnect(0),a))try{n.bufferSource.buffer=e._scratchBuffer}catch{}return n.bufferSource=null,i},_clearSound:function(n){var i=/MSIE |Trident\//.test(e._navigator&&e._navigator.userAgent);i||(n.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var s=function(n){this._parent=n,this.init()};s.prototype={init:function(){var n=this,i=n._parent;return n._muted=i._muted,n._loop=i._loop,n._volume=i._volume,n._rate=i._rate,n._seek=0,n._paused=!0,n._ended=!0,n._sprite="__default",n._id=++e._counter,i._sounds.push(n),n.create(),n},create:function(){var n=this,i=n._parent,a=e._muted||n._muted||n._parent._muted?0:n._volume;return i._webAudio?(n._node=typeof e.ctx.createGain>"u"?e.ctx.createGainNode():e.ctx.createGain(),n._node.gain.setValueAtTime(a,e.ctx.currentTime),n._node.paused=!0,n._node.connect(e.masterGain)):e.noAudio||(n._node=e._obtainHtml5Audio(),n._errorFn=n._errorListener.bind(n),n._node.addEventListener("error",n._errorFn,!1),n._loadFn=n._loadListener.bind(n),n._node.addEventListener(e._canPlayEvent,n._loadFn,!1),n._endFn=n._endListener.bind(n),n._node.addEventListener("ended",n._endFn,!1),n._node.src=i._src,n._node.preload=i._preload===!0?"auto":i._preload,n._node.volume=a*e.volume(),n._node.load()),n},reset:function(){var n=this,i=n._parent;return n._muted=i._muted,n._loop=i._loop,n._volume=i._volume,n._rate=i._rate,n._seek=0,n._rateSeek=0,n._paused=!0,n._ended=!0,n._sprite="__default",n._id=++e._counter,n},_errorListener:function(){var n=this;n._parent._emit("loaderror",n._id,n._node.error?n._node.error.code:0),n._node.removeEventListener("error",n._errorFn,!1)},_loadListener:function(){var n=this,i=n._parent;i._duration=Math.ceil(n._node.duration*10)/10,Object.keys(i._sprite).length===0&&(i._sprite={__default:[0,i._duration*1e3]}),i._state!=="loaded"&&(i._state="loaded",i._emit("load"),i._loadQueue()),n._node.removeEventListener(e._canPlayEvent,n._loadFn,!1)},_endListener:function(){var n=this,i=n._parent;i._duration===1/0&&(i._duration=Math.ceil(n._node.duration*10)/10,i._sprite.__default[1]===1/0&&(i._sprite.__default[1]=i._duration*1e3),i._ended(n)),n._node.removeEventListener("ended",n._endFn,!1)}};var l={},c=function(n){var i=n._src;if(l[i]){n._duration=l[i].duration,b(n);return}if(/^data:[^;]+;base64,/.test(i)){for(var a=atob(i.split(",")[1]),u=new Uint8Array(a.length),f=0;f<a.length;++f)u[f]=a.charCodeAt(f);d(u.buffer,n)}else{var p=new XMLHttpRequest;p.open(n._xhr.method,i,!0),p.withCredentials=n._xhr.withCredentials,p.responseType="arraybuffer",n._xhr.headers&&Object.keys(n._xhr.headers).forEach(function(g){p.setRequestHeader(g,n._xhr.headers[g])}),p.onload=function(){var g=(p.status+"")[0];if(g!=="0"&&g!=="2"&&g!=="3"){n._emit("loaderror",null,"Failed loading audio file with status: "+p.status+".");return}d(p.response,n)},p.onerror=function(){n._webAudio&&(n._html5=!0,n._webAudio=!1,n._sounds=[],delete l[i],n.load())},h(p)}},h=function(n){try{n.send()}catch{n.onerror()}},d=function(n,i){var a=function(){i._emit("loaderror",null,"Decoding audio data failed.")},u=function(f){f&&i._sounds.length>0?(l[i._src]=f,b(i,f)):a()};typeof Promise<"u"&&e.ctx.decodeAudioData.length===1?e.ctx.decodeAudioData(n).then(u).catch(a):e.ctx.decodeAudioData(n,u,a)},b=function(n,i){i&&!n._duration&&(n._duration=i.duration),Object.keys(n._sprite).length===0&&(n._sprite={__default:[0,n._duration*1e3]}),n._state!=="loaded"&&(n._state="loaded",n._emit("load"),n._loadQueue())},_=function(){if(!!e.usingWebAudio){try{typeof AudioContext<"u"?e.ctx=new AudioContext:typeof webkitAudioContext<"u"?e.ctx=new webkitAudioContext:e.usingWebAudio=!1}catch{e.usingWebAudio=!1}e.ctx||(e.usingWebAudio=!1);var n=/iP(hone|od|ad)/.test(e._navigator&&e._navigator.platform),i=e._navigator&&e._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),a=i?parseInt(i[1],10):null;if(n&&a&&a<9){var u=/safari/.test(e._navigator&&e._navigator.userAgent.toLowerCase());e._navigator&&!u&&(e.usingWebAudio=!1)}e.usingWebAudio&&(e.masterGain=typeof e.ctx.createGain>"u"?e.ctx.createGainNode():e.ctx.createGain(),e.masterGain.gain.setValueAtTime(e._muted?0:e._volume,e.ctx.currentTime),e.masterGain.connect(e.ctx.destination)),e._setup()}};r.Howler=e,r.Howl=o,typeof Qe<"u"?(Qe.HowlerGlobal=t,Qe.Howler=e,Qe.Howl=o,Qe.Sound=s):typeof window<"u"&&(window.HowlerGlobal=t,window.Howler=e,window.Howl=o,window.Sound=s)})();/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){var o=this;if(!o.ctx||!o.ctx.listener)return o;for(var s=o._howls.length-1;s>=0;s--)o._howls[s].stereo(e);return o},HowlerGlobal.prototype.pos=function(e,o,s){var l=this;if(!l.ctx||!l.ctx.listener)return l;if(o=typeof o!="number"?l._pos[1]:o,s=typeof s!="number"?l._pos[2]:s,typeof e=="number")l._pos=[e,o,s],typeof l.ctx.listener.positionX<"u"?(l.ctx.listener.positionX.setTargetAtTime(l._pos[0],Howler.ctx.currentTime,.1),l.ctx.listener.positionY.setTargetAtTime(l._pos[1],Howler.ctx.currentTime,.1),l.ctx.listener.positionZ.setTargetAtTime(l._pos[2],Howler.ctx.currentTime,.1)):l.ctx.listener.setPosition(l._pos[0],l._pos[1],l._pos[2]);else return l._pos;return l},HowlerGlobal.prototype.orientation=function(e,o,s,l,c,h){var d=this;if(!d.ctx||!d.ctx.listener)return d;var b=d._orientation;if(o=typeof o!="number"?b[1]:o,s=typeof s!="number"?b[2]:s,l=typeof l!="number"?b[3]:l,c=typeof c!="number"?b[4]:c,h=typeof h!="number"?b[5]:h,typeof e=="number")d._orientation=[e,o,s,l,c,h],typeof d.ctx.listener.forwardX<"u"?(d.ctx.listener.forwardX.setTargetAtTime(e,Howler.ctx.currentTime,.1),d.ctx.listener.forwardY.setTargetAtTime(o,Howler.ctx.currentTime,.1),d.ctx.listener.forwardZ.setTargetAtTime(s,Howler.ctx.currentTime,.1),d.ctx.listener.upX.setTargetAtTime(l,Howler.ctx.currentTime,.1),d.ctx.listener.upY.setTargetAtTime(c,Howler.ctx.currentTime,.1),d.ctx.listener.upZ.setTargetAtTime(h,Howler.ctx.currentTime,.1)):d.ctx.listener.setOrientation(e,o,s,l,c,h);else return b;return d},Howl.prototype.init=function(e){return function(o){var s=this;return s._orientation=o.orientation||[1,0,0],s._stereo=o.stereo||null,s._pos=o.pos||null,s._pannerAttr={coneInnerAngle:typeof o.coneInnerAngle<"u"?o.coneInnerAngle:360,coneOuterAngle:typeof o.coneOuterAngle<"u"?o.coneOuterAngle:360,coneOuterGain:typeof o.coneOuterGain<"u"?o.coneOuterGain:0,distanceModel:typeof o.distanceModel<"u"?o.distanceModel:"inverse",maxDistance:typeof o.maxDistance<"u"?o.maxDistance:1e4,panningModel:typeof o.panningModel<"u"?o.panningModel:"HRTF",refDistance:typeof o.refDistance<"u"?o.refDistance:1,rolloffFactor:typeof o.rolloffFactor<"u"?o.rolloffFactor:1},s._onstereo=o.onstereo?[{fn:o.onstereo}]:[],s._onpos=o.onpos?[{fn:o.onpos}]:[],s._onorientation=o.onorientation?[{fn:o.onorientation}]:[],e.call(this,o)}}(Howl.prototype.init),Howl.prototype.stereo=function(e,o){var s=this;if(!s._webAudio)return s;if(s._state!=="loaded")return s._queue.push({event:"stereo",action:function(){s.stereo(e,o)}}),s;var l=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof o>"u")if(typeof e=="number")s._stereo=e,s._pos=[e,0,0];else return s._stereo;for(var c=s._getSoundIds(o),h=0;h<c.length;h++){var d=s._soundById(c[h]);if(d)if(typeof e=="number")d._stereo=e,d._pos=[e,0,0],d._node&&(d._pannerAttr.panningModel="equalpower",(!d._panner||!d._panner.pan)&&t(d,l),l==="spatial"?typeof d._panner.positionX<"u"?(d._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),d._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),d._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):d._panner.setPosition(e,0,0):d._panner.pan.setValueAtTime(e,Howler.ctx.currentTime)),s._emit("stereo",d._id);else return d._stereo}return s},Howl.prototype.pos=function(e,o,s,l){var c=this;if(!c._webAudio)return c;if(c._state!=="loaded")return c._queue.push({event:"pos",action:function(){c.pos(e,o,s,l)}}),c;if(o=typeof o!="number"?0:o,s=typeof s!="number"?-.5:s,typeof l>"u")if(typeof e=="number")c._pos=[e,o,s];else return c._pos;for(var h=c._getSoundIds(l),d=0;d<h.length;d++){var b=c._soundById(h[d]);if(b)if(typeof e=="number")b._pos=[e,o,s],b._node&&((!b._panner||b._panner.pan)&&t(b,"spatial"),typeof b._panner.positionX<"u"?(b._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),b._panner.positionY.setValueAtTime(o,Howler.ctx.currentTime),b._panner.positionZ.setValueAtTime(s,Howler.ctx.currentTime)):b._panner.setPosition(e,o,s)),c._emit("pos",b._id);else return b._pos}return c},Howl.prototype.orientation=function(e,o,s,l){var c=this;if(!c._webAudio)return c;if(c._state!=="loaded")return c._queue.push({event:"orientation",action:function(){c.orientation(e,o,s,l)}}),c;if(o=typeof o!="number"?c._orientation[1]:o,s=typeof s!="number"?c._orientation[2]:s,typeof l>"u")if(typeof e=="number")c._orientation=[e,o,s];else return c._orientation;for(var h=c._getSoundIds(l),d=0;d<h.length;d++){var b=c._soundById(h[d]);if(b)if(typeof e=="number")b._orientation=[e,o,s],b._node&&(b._panner||(b._pos||(b._pos=c._pos||[0,0,-.5]),t(b,"spatial")),typeof b._panner.orientationX<"u"?(b._panner.orientationX.setValueAtTime(e,Howler.ctx.currentTime),b._panner.orientationY.setValueAtTime(o,Howler.ctx.currentTime),b._panner.orientationZ.setValueAtTime(s,Howler.ctx.currentTime)):b._panner.setOrientation(e,o,s)),c._emit("orientation",b._id);else return b._orientation}return c},Howl.prototype.pannerAttr=function(){var e=this,o=arguments,s,l,c;if(!e._webAudio)return e;if(o.length===0)return e._pannerAttr;if(o.length===1)if(typeof o[0]=="object")s=o[0],typeof l>"u"&&(s.pannerAttr||(s.pannerAttr={coneInnerAngle:s.coneInnerAngle,coneOuterAngle:s.coneOuterAngle,coneOuterGain:s.coneOuterGain,distanceModel:s.distanceModel,maxDistance:s.maxDistance,refDistance:s.refDistance,rolloffFactor:s.rolloffFactor,panningModel:s.panningModel}),e._pannerAttr={coneInnerAngle:typeof s.pannerAttr.coneInnerAngle<"u"?s.pannerAttr.coneInnerAngle:e._coneInnerAngle,coneOuterAngle:typeof s.pannerAttr.coneOuterAngle<"u"?s.pannerAttr.coneOuterAngle:e._coneOuterAngle,coneOuterGain:typeof s.pannerAttr.coneOuterGain<"u"?s.pannerAttr.coneOuterGain:e._coneOuterGain,distanceModel:typeof s.pannerAttr.distanceModel<"u"?s.pannerAttr.distanceModel:e._distanceModel,maxDistance:typeof s.pannerAttr.maxDistance<"u"?s.pannerAttr.maxDistance:e._maxDistance,refDistance:typeof s.pannerAttr.refDistance<"u"?s.pannerAttr.refDistance:e._refDistance,rolloffFactor:typeof s.pannerAttr.rolloffFactor<"u"?s.pannerAttr.rolloffFactor:e._rolloffFactor,panningModel:typeof s.pannerAttr.panningModel<"u"?s.pannerAttr.panningModel:e._panningModel});else return c=e._soundById(parseInt(o[0],10)),c?c._pannerAttr:e._pannerAttr;else o.length===2&&(s=o[0],l=parseInt(o[1],10));for(var h=e._getSoundIds(l),d=0;d<h.length;d++)if(c=e._soundById(h[d]),c){var b=c._pannerAttr;b={coneInnerAngle:typeof s.coneInnerAngle<"u"?s.coneInnerAngle:b.coneInnerAngle,coneOuterAngle:typeof s.coneOuterAngle<"u"?s.coneOuterAngle:b.coneOuterAngle,coneOuterGain:typeof s.coneOuterGain<"u"?s.coneOuterGain:b.coneOuterGain,distanceModel:typeof s.distanceModel<"u"?s.distanceModel:b.distanceModel,maxDistance:typeof s.maxDistance<"u"?s.maxDistance:b.maxDistance,refDistance:typeof s.refDistance<"u"?s.refDistance:b.refDistance,rolloffFactor:typeof s.rolloffFactor<"u"?s.rolloffFactor:b.rolloffFactor,panningModel:typeof s.panningModel<"u"?s.panningModel:b.panningModel};var _=c._panner;_?(_.coneInnerAngle=b.coneInnerAngle,_.coneOuterAngle=b.coneOuterAngle,_.coneOuterGain=b.coneOuterGain,_.distanceModel=b.distanceModel,_.maxDistance=b.maxDistance,_.refDistance=b.refDistance,_.rolloffFactor=b.rolloffFactor,_.panningModel=b.panningModel):(c._pos||(c._pos=e._pos||[0,0,-.5]),t(c,"spatial"))}return e},Sound.prototype.init=function(e){return function(){var o=this,s=o._parent;o._orientation=s._orientation,o._stereo=s._stereo,o._pos=s._pos,o._pannerAttr=s._pannerAttr,e.call(this),o._stereo?s.stereo(o._stereo):o._pos&&s.pos(o._pos[0],o._pos[1],o._pos[2],o._id)}}(Sound.prototype.init),Sound.prototype.reset=function(e){return function(){var o=this,s=o._parent;return o._orientation=s._orientation,o._stereo=s._stereo,o._pos=s._pos,o._pannerAttr=s._pannerAttr,o._stereo?s.stereo(o._stereo):o._pos?s.pos(o._pos[0],o._pos[1],o._pos[2],o._id):o._panner&&(o._panner.disconnect(0),o._panner=void 0,s._refreshBuffer(o)),e.call(this)}}(Sound.prototype.reset);var t=function(e,o){o=o||"spatial",o==="spatial"?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.panningModel=e._pannerAttr.panningModel,typeof e._panner.positionX<"u"?(e._panner.positionX.setValueAtTime(e._pos[0],Howler.ctx.currentTime),e._panner.positionY.setValueAtTime(e._pos[1],Howler.ctx.currentTime),e._panner.positionZ.setValueAtTime(e._pos[2],Howler.ctx.currentTime)):e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),typeof e._panner.orientationX<"u"?(e._panner.orientationX.setValueAtTime(e._orientation[0],Howler.ctx.currentTime),e._panner.orientationY.setValueAtTime(e._orientation[1],Howler.ctx.currentTime),e._panner.orientationZ.setValueAtTime(e._orientation[2],Howler.ctx.currentTime)):e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2])):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.setValueAtTime(e._stereo,Howler.ctx.currentTime)),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id,!0)}})()})(le);const se={move:new le.Howl({src:["/sfx/move.mp3"],volume:.3}),take:new le.Howl({src:["/sfx/take.mp3"],volume:.9}),swap:new le.Howl({src:["/sfx/swap.mp3"],volume:.6}),snap:new le.Howl({src:["/sfx/snap.mp3"],volume:.6}),rewind:new le.Howl({src:["/sfx/rewind.mp3"],volume:1}),enPassant:new le.Howl({src:["/sfx/anarchy/en-passant.mp3"],volume:.5}),horsyMove:new le.Howl({src:["/sfx/anarchy/horsy-move.mp3"],volume:.5}),horsyTake:new le.Howl({src:["/sfx/anarchy/horsy-take.mp3"],volume:.5}),brickMove:new le.Howl({src:["/sfx/anarchy/brick-move.mp3"],volume:.3}),brickTake:new le.Howl({src:["/sfx/anarchy/brick-take.mp3"],volume:.2}),brickCastle:new le.Howl({src:["/sfx/anarchy/brick-castle.mp3"],volume:.3}),coneMove:new le.Howl({src:["/sfx/anarchy/cone-move.mp3"],volume:1}),coneTake:new le.Howl({src:["/sfx/anarchy/cone-take.mp3"],volume:.3}),pipiMove:new le.Howl({src:["/sfx/anarchy/pipi-move.mp3"],volume:.2}),pipiTake:new le.Howl({src:["/sfx/anarchy/pipi-take.mp3"],volume:.4}),toyMove:new le.Howl({src:["/sfx/anarchy/toy-move.mp3"],volume:.9}),toyTake:new le.Howl({src:["/sfx/anarchy/toy-take.mp3"],volume:.8}),deathMove:new le.Howl({src:["/sfx/anarchy/death-move.mp3"],volume:.4}),deathTake:new le.Howl({src:["/sfx/anarchy/death-take.mp3"],volume:.25}),death:new le.Howl({src:["/sfx/anarchy/checkmate.mp3"],volume:1}),hit:new le.Howl({src:["/sfx/anarchy/hit.mp3"],volume:.25})},kn={x:" takes ","+":" check!","#":" mate!","=":" promotes to a ",P:"pawn ",R:"rook ",B:"bishop ",N:"knight ",Q:"queen ",K:"king ","O-O":"short castle","O-O-O":"long castle"},wt={volume:50,rate:1,lang:"en-US"},xi=r=>{if(r==="O-O"||r==="O-O-O")r=kn[r];else{const t=r.match(/[a-h1-8][a-h][1-8]/);t&&(r=r.replace(t[0],`${t[0][0]} ${t[0][1]}${t[0][2]}`)),r=r.split("").map(e=>kn[e]??e).join("").replace(/\s{2,}/g," ")}return r};class Ti{voice;constructor(){window.speechSynthesis?(this.setVoice(),window.speechSynthesis.onvoiceschanged=this.setVoice.bind(this)):this.voice=void 0}setVoice(){const t=speechSynthesis.getVoices();this.voice=t.length>0?t.find(e=>e.lang===wt.lang):void 0}say(t){const e=new SpeechSynthesisUtterance(t);e.volume=wt.volume/100,e.lang=wt.lang,this.voice&&(e.voice=this.voice),e.rate=1+wt.rate/10,speechSynthesis.speak(e)}}const Ci=r=>new Promise(t=>setTimeout(t,r));class Ei{constructor(t,e){this.board=t,this.config=e,this.speech=new Ti}interval=1e3;game=new ot;ply=0;callback=()=>{};speech;playing=!1;async init(){await this.board.frame(this.game.getPosition(0),this.game.header).then(t=>this.board.render())}watch(t){this.callback=t}updateConfig(t){this.config={...this.config,...t}}getPosition(){const t=this.game.getPosition(this.ply);return E({ply:t.ply}),E({fen:t.fen}),t}async load(t){this.pause(),this.game=t,this.ply=0,await this.board.frame(this.getPosition(),this.game.header),this.board.render()}async play(){for(this.playing=!0,this.callback(this.playing,this.ply),this.ply===this.game.getMoves().length&&this.first();await Ci(this.interval),!!this.playing;)this.next()}pause(){this.playing=!1,this.callback(this.playing,this.ply)}async prev(){const t=this.ply-1;if(!(t<-1||t<0&&this.config.titleScreen===!1)){if(this.ply=t,t===-1){await this.board.titleFrame(this.game.header),this.board.render();return}await this.board.frame(this.getPosition(),this.game.header),this.board.render(),v.siteConfig.sounds&&se.rewind.play()}}playSFX(t){t.mate?se.snap.play():/[ce]/.test(t.move?.flags)?se.take.play():/[kqp]/.test(t.move?.flags)?se.swap.play():se.move.play()}playAnarchySFX(t){if(t.move?.flags&&t.move.flags.includes("e")?se.enPassant.play():t.mate&&se.death.play(),t.move?.flags&&t.move.flags.includes("p")&&se.brickCastle.play(),t.move?.flags&&t.move.flags.includes("c"))switch(t.move.piece){case"p":se.coneTake.play();break;case"r":se.brickTake.play();break;case"n":se.hit.play(),se.horsyTake.play();break;case"k":se.pipiTake.play();break;case"q":se.deathTake.play();break;case"b":se.toyTake.play();break;default:se.take.play()}else if(/[kq]/.test(t.move?.flags))se.brickCastle.play();else switch(t.move?.piece){case"p":se.coneMove.play();break;case"r":se.brickMove.play();break;case"n":se.horsyMove.play();break;case"k":se.pipiMove.play();break;case"q":se.deathMove.play();break;case"b":se.toyMove.play();break;default:se.move.play()}}async next(){const t=this.ply+1;if(t>=this.game.length){this.pause();return}this.ply=t;const e=this.getPosition();if(await this.board.frame(e,this.game.header),this.board.render(),window.speechSynthesis&&v.siteConfig.speech&&(this.ply>0&&this.speech.say(xi(e.move?.san)),e.end===0)){const o=this.game.header.Result;o&&this.speech.say(o==="1-0"?"White wins!":o==="0-1"?"Black wins!":"Draw!")}this.ply>0&&v.siteConfig.sounds&&(v.boardConfig.piecesStyle.includes("anarchy")?this.playAnarchySFX(e):this.playSFX(e))}async first(){this.ply=0,await this.board.frame(this.getPosition(),this.game.header),this.board.render()}async last(){this.ply=this.game.length-1,await this.board.frame(this.getPosition(),this.game.header),this.board.render()}async goto(t){this.ply=t,await this.board.frame(this.getPosition(),this.game.header),this.board.render()}}const Pi=I('<div class="header__options-ico"><i class="las"></i></div>'),Ii=I('<div class="header__options-ico" title="SUPPORT"><i class="las la-heart"></i></div>'),Ni=I('<a href="" class="header__support"><i class="las la-heart header__support-ico"></i> &nbsp;Support the project</a>'),Oi=I('<header class="header-box"><div class="header__logo"><a href="/"><div class="header__logo-pic"></div></a></div><div class="header__options"><div class="header__options-ico"><i class="las"></i></div><div class="header__options-ico"><i class="las"></i></div><div class="header__options-ico" title="VISIT SUBREDDIT"><a href="https://www.reddit.com/r/sharechess" target="_blank"><i class="lab la-reddit-alien"></i></a></div><div class="header__options-ico" title="SOURCE CODE"><a href="https://github.com/sharechess/sharechess" target="_blank"><i class="lab la-github"></i></a></div><div class="header__options-ico" title="ABOUT"><i class="las la-question-circle"></i></div></div></header>'),Li=r=>(()=>{const t=Oi.cloneNode(!0),e=t.firstChild,o=e.nextSibling,s=o.firstChild,l=s.firstChild,c=s.nextSibling,h=c.firstChild,d=c.nextSibling,b=d.nextSibling,_=b.nextSibling;return ue(s,"click",r.handlers.toggleDarkMode,!0),ue(c,"click",r.handlers.toggleSound,!0),N(o,T(U,{get when(){return window.speechSynthesis},get children(){const n=Pi.cloneNode(!0),i=n.firstChild;return ue(n,"click",r.handlers.toggleSpeech,!0),Z(a=>{const u=v.siteConfig.speech?"SPEECH OFF":"SPEECH ON",f=!v.siteConfig.speech,p=!!v.siteConfig.speech;return u!==a._v$&&oe(n,"title",a._v$=u),f!==a._v$2&&i.classList.toggle("la-deaf",a._v$2=f),p!==a._v$3&&i.classList.toggle("la-assistive-listening-systems",a._v$3=p),a},{_v$:void 0,_v$2:void 0,_v$3:void 0}),n}}),d),_.$$click=()=>{E("fullscreenPopup",v.fullscreenPopup==="about"?null:"about")},N(o,T(U,{get when(){return v.mobile},get children(){const n=Ii.cloneNode(!0);return n.$$click=()=>{E("fullscreenPopup",v.fullscreenPopup==="support"?null:"support")},n}}),null),N(t,T(U,{get when(){return!v.mobile},get children(){const n=Ni.cloneNode(!0);return n.$$click=i=>{i.preventDefault(),E("fullscreenPopup","support")},n}}),null),Z(n=>{const i=v.siteConfig.darkMode?"SWITCH TO LIGHT MODE":"SWITCH TO DARK MODE",a=!!v.siteConfig.darkMode,u=!v.siteConfig.darkMode,f=v.siteConfig.sounds?"MUTE":"SOUND ON",p=!v.siteConfig.sounds,g=!!v.siteConfig.sounds;return i!==n._v$4&&oe(s,"title",n._v$4=i),a!==n._v$5&&l.classList.toggle("la-sun",n._v$5=a),u!==n._v$6&&l.classList.toggle("la-moon",n._v$6=u),f!==n._v$7&&oe(c,"title",n._v$7=f),p!==n._v$8&&h.classList.toggle("la-volume-mute",n._v$8=p),g!==n._v$9&&h.classList.toggle("la-volume-up",n._v$9=g),n},{_v$4:void 0,_v$5:void 0,_v$6:void 0,_v$7:void 0,_v$8:void 0,_v$9:void 0}),t})();Pe(["click"]);var Bt={},Mt={};Object.defineProperty(Mt,"__esModule",{value:!0});const on=(r,t=[])=>r.length<2?r:(...e)=>(o=>o.length>=r.length?r(...o):on(r,o))([...t,...e]);Mt.curry=on;Mt.default=on;Object.defineProperty(Bt,"__esModule",{value:!0});Bt.chunk_=void 0;const Ri=Mt,Bi=(r,t)=>{if(r<=0)throw new Error("Chunk size has to be greater than 0.");const e=new Array(Math.ceil(t.length/r));for(let o=0,s=0;o<t.length;o=o+r,s++)e[s]=t.slice(o,o+r);return e},Kn=Ri.curry(Bi);Bt.chunk_=Kn;var Mi=Bt.default=Kn;const zi=I('<div><div class="scrollable__content"></div></div>'),bt=r=>(()=>{const t=zi.cloneNode(!0),e=t.firstChild;return N(e,()=>r.children),Z(()=>mt(t,`scrollable ${r.class}`)),t})();const Di=I('<p class="moves__turn"></p>'),Fi=I('<div class="move"><span class="move__id">.</span><span class="move__ply"></span><span class="move__ply"></span></div>'),Hi=r=>(lr(()=>{v.mobile||document.querySelector(`[data-ply="${v.ply}"]`)?.scrollIntoView()}),T(bt,{get class(){return"moves"+(r.class?` ${r.class}`:"")},get children(){return[T(U,{get when(){return r.moves.length===0},get children(){const t=Di.cloneNode(!0);return N(t,(()=>{const e=Nt(()=>!!v.game.getPosition(0).mate,!0);return()=>e()?"Checkmate.":v.game.getPosition(0).turn==="w"?"White to move.":"Black to move."})()),t}}),T(gt,{get each(){return Mi(2,r.moves)},children:(t,e)=>{const[o,s]=t;return(()=>{const l=Fi.cloneNode(!0),c=l.firstChild,h=c.firstChild,d=c.nextSibling,b=d.nextSibling;return N(c,()=>e()+1,h),d.$$click=()=>r.handlers.goto(e()*2+1),N(d,o),b.$$click=()=>r.handlers.goto(e()*2+2),N(b,s),Z(_=>{const n=v.ply===e()*2+1,i=e()*2+1,a=v.ply===e()*2+2,u=e()*2+2;return n!==_._v$&&d.classList.toggle("move__ply--current",_._v$=n),i!==_._v$2&&oe(d,"data-ply",_._v$2=i),a!==_._v$3&&b.classList.toggle("move__ply--current",_._v$3=a),u!==_._v$4&&oe(b,"data-ply",_._v$4=u),_},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),l})()}})]}}));Pe(["click"]);const qi=I('<i class="las la-play"></i>'),Gi=I('<div class="controls"><button class="controls__button controls__button--first" title="FIRST"><i class="las la-angle-double-left"></i></button><button class="controls__button" title="PREV"><i class="las la-angle-left"></i></button><button class="controls__button"></button><button class="controls__button controls__button--next" title="NEXT"><i class="las la-angle-right"></i></button><button class="controls__button controls__button--last" title="LAST"><i class="las la-angle-double-right"></i></button><button title="FLIP" class="flip__button"><i class="las la-sync rotatable"></i></button></div>'),ji=I('<i class="las la-pause"></i>'),Yn=r=>(()=>{const t=Gi.cloneNode(!0),e=t.firstChild,o=e.nextSibling,s=o.nextSibling,l=s.nextSibling,c=l.nextSibling,h=c.nextSibling,d=h.firstChild;return ue(e,"click",r.handlers.first,!0),ue(o,"click",r.handlers.prev,!0),ue(s,"click",r.handlers.togglePlay,!0),N(s,T(U,{get when(){return!v.playing},get fallback(){return ji.cloneNode(!0)},get children(){return qi.cloneNode(!0)}})),ue(l,"click",r.handlers.next,!0),ue(c,"click",r.handlers.last,!0),ue(h,"click",r.handlers.flip,!0),Z(b=>{const _=v.playing?"PAUSE":"PLAY",n=!!v.boardConfig.flipped;return _!==b._v$&&oe(s,"title",b._v$=_),n!==b._v$2&&d.classList.toggle("rotated",b._v$2=n),b},{_v$:void 0,_v$2:void 0}),t})();Pe(["click"]);const Qn=r=>{if(r===null)return!1;try{return new URL(r).protocol==="https:"}catch{return!1}},An=I("<span></span>"),xn=I('<span class="info__rating"> (<!>)</span>'),Ft=I("<p></p>"),Wi=I("<p>Round </p>"),Ui=I("<a></a>"),Vi=I('<div class="info"><div class="info__header"><div class="info__players"><div class="info__player"><div class="info__left"><button class="info__color info__color--white"></button></div><div class="info__right"><span class="info__score"></span></div></div><div class="info__player"><div class="info__left"><button class="info__color info__color--black"></button></div><div class="info__right"><span class="info__score"></span></div></div></div><div class="info__event"></div><div class="info__site"></div></div><div class="info__analyze"><button><i class="las la-vial"></i> </button></div></div>'),Xi=r=>{const[t,e]=De(!1);return(()=>{const o=Vi.cloneNode(!0),s=o.firstChild,l=s.firstChild,c=l.firstChild,h=c.firstChild;h.firstChild;const d=h.nextSibling,b=d.firstChild,_=c.nextSibling,n=_.firstChild;n.firstChild;const i=n.nextSibling,a=i.firstChild,u=l.nextSibling,f=u.nextSibling,p=s.nextSibling,g=p.firstChild;return g.firstChild.nextSibling,N(h,T(U,{get when(){return!v.anonymous},fallback:"Anonymous",get children(){return[(()=>{const y=An.cloneNode(!0);return oe(y,"contenteditable",!1),N(y,()=>v.game.header.WhitePretty),y})()," "]}}),null),N(h,T(U,{get when(){return v.game.header.WhiteElo},get children(){const y=xn.cloneNode(!0),k=y.firstChild,P=k.nextSibling;return P.nextSibling,N(y,()=>v.game.header.WhiteElo,P),y}}),null),N(b,()=>v.game.header.Result==="1-0"?"1":v.game.header.Result==="0-1"?"0":v.game.header.Result==="1/2-1/2"?"1/2":""),N(n,T(U,{get when(){return!v.anonymous},fallback:"Anonymous",get children(){return[(()=>{const y=An.cloneNode(!0);return oe(y,"contenteditable",!1),N(y,()=>v.game.header.BlackPretty),y})()," "]}}),null),N(n,T(U,{get when(){return v.game.header.BlackElo},get children(){const y=xn.cloneNode(!0),k=y.firstChild,P=k.nextSibling;return P.nextSibling,N(y,()=>v.game.header.BlackElo,P),y}}),null),N(a,()=>v.game.header.Result==="1-0"?"0":v.game.header.Result==="0-1"?"1":v.game.header.Result==="1/2-1/2"?"1/2":""),N(u,T(U,{get when(){return v.game.header.Event},get children(){const y=Ft.cloneNode(!0);return N(y,()=>v.game.header.Event),y}}),null),N(u,T(U,{get when(){return v.game.header.Round},get children(){const y=Wi.cloneNode(!0);return y.firstChild,N(y,()=>v.game.header.Round,null),y}}),null),N(f,T(U,{get when(){return v.game.header.Site},get children(){const y=Ft.cloneNode(!0);return N(y,T(U,{get when(){return!v.anonymous||!Ct(v.game.header.Site)},get children(){return T(U,{get when(){return Qn(v.game.header.Site)},get fallback(){return v.game.header.Site},get children(){const k=Ui.cloneNode(!0);return N(k,()=>v.game.header.Site?.replace(/^https:\/\//,"")),Z(()=>oe(k,"href",v.game.header.Site??"")),k}})}})),y}}),null),N(f,T(U,{get when(){return v.game.header.DatePretty},get children(){const y=Ft.cloneNode(!0);return N(y,()=>v.game.header.DatePretty),y}}),null),g.$$click=async()=>{await r.handlers.openOnLichess()||(e(!0),setTimeout(()=>e(!1),1e3))},N(g,()=>t()?"Cannot import to lichess":"Analyze on Lichess",null),Z(()=>g.classList.toggle("btn--error",!!t())),o})()};Pe(["click"]);const Zn=r=>new Promise((t,e)=>{const o=new FileReader;o.onload=()=>{t(o.result)},o.onerror=e,o.readAsText(r)});const Ki=I('<button class="load__game-btn"><i class="las la-paste"></i> </button>'),Ht=I("<hr>"),Yi=I('<textarea class="load__game-input" name="load-game" placeholder="Paste PGN, FEN or Lichess link..."></textarea>'),Qi=I('<button class="load__game-btn"></button>'),Zi=I('<input type="file" accept="application/vnd.chess-pgn,application/x-chess-pgn,.pgn">'),Ji=I('<button class="load__pgn-btn load__pgn-file">Upload PGN file</button>'),eo=I('<div class="load__pgn-file-info"><p>or</p><p>drop the PGN file anywhere on the page</p></div>'),to=I('<p class="load__daily-game"><a href="">Load game of the day</a></p>'),no=I("<h2>Recent:</h2>"),ro=I('<ul class="load__recent"></ul>'),io=I('<a href=""></a>'),oo=I('<p class="load__recent-options"><a href="">clear all</a></p>'),so=I('<li class="load__recent-item"><a></a> <i class="las la-trash-alt load__recent-delete-item"></i></li>'),ao=r=>{const[t,e]=De(""),[o,s]=De(!1),[l,c]=De(!1),[h,d]=De(!1);let b;return T(bt,{get class(){return"load"+(r.class?` ${r.class}`:"")},get children(){return[(()=>{const _=Ki.cloneNode(!0);return _.firstChild.nextSibling,_.$$click=async()=>{await r.handlers.loadFromClipboard()||(s(!0),setTimeout(()=>s(!1),1e3))},N(_,()=>o()?"Incorrect data":"Load from clipboard",null),Z(()=>_.classList.toggle("btn--error",!!o())),_})(),Ht.cloneNode(!0),(()=>{const _=Yi.cloneNode(!0);return _.$$input=n=>e(n.currentTarget.value),oe(_,"spellcheck",!1),Z(()=>_.value=t()),_})(),(()=>{const _=Qi.cloneNode(!0);return _.$$click=async()=>{await r.handlers.load(t())||(c(!0),setTimeout(()=>c(!1),1e3)),e("")},N(_,()=>l()?"Incorrect data":"LOAD"),Z(()=>_.classList.toggle("btn--error",!!l())),_})(),Ht.cloneNode(!0),(()=>{const _=Zi.cloneNode(!0);_.addEventListener("change",async i=>{const a=i.target;if(a?.files&&a.files.length>0){const u=await Zn(a.files[0]);E("refreshHash",!1),r.handlers.loadPGN(u)}});const n=b;return typeof n=="function"?wr(n,_):b=_,_.style.setProperty("display","none"),_})(),(()=>{const _=Ji.cloneNode(!0);return _.$$click=()=>{b&&b.click()},_})(),T(U,{get when(){return!v.mobile},get children(){return eo.cloneNode(!0)}}),Ht.cloneNode(!0),(()=>{const _=to.cloneNode(!0),n=_.firstChild;return n.$$click=i=>{i.preventDefault(),r.handlers.loadGameOfTheDay()},_})(),T(U,{get when(){return v.recent.filter(_=>_.hash!==location.hash).length>0},get children(){return[no.cloneNode(!0),(()=>{const _=ro.cloneNode(!0);return N(_,T(gt,{get each(){return v.recent.filter(n=>n.hash!==location.hash).slice(0,h()?void 0:5)},children:n=>(()=>{const i=so.cloneNode(!0),a=i.firstChild,u=a.nextSibling,f=u.nextSibling;return N(a,()=>n.title.split(" | ")[0]),f.$$click=()=>r.handlers.deleteRecent(n.hash),Z(()=>oe(a,"href",n.hash)),i})()})),_})(),(()=>{const _=oo.cloneNode(!0),n=_.firstChild;return N(_,T(U,{get when(){return v.recent.filter(i=>i.hash!==location.hash).length>5},get children(){return[(()=>{const i=io.cloneNode(!0);return i.$$click=a=>{a.preventDefault(),d(!h())},N(i,()=>h()?"show less":"show more"),i})()," ","|"," "]}}),n),ue(n,"click",r.handlers.clearRecent,!0),_})()]}})]}})};Pe(["click","input"]);const Qt=(r,t,e)=>{const o=typeof r=="string"?r:URL.createObjectURL(r),s=document.createElement("a");s.href=o,s.download=`${t}.${e}`,s.target="_blank",s.click(),URL.revokeObjectURL(o)},Jn=async r=>{const[t,e]=r.pathname.replace(/^\//,"").split("/").map(o=>o.trim());if(/^(([a-z0-9]{8})|([a-z0-9]{12}))$/i.test(t)){const o=t.slice(0,8),s=await fetch(`https://lichess.org/game/export/${o}?evals=0&clocks=0`);if(!String(s.status).startsWith("2"))return{error:!0,errorType:"SERVER_ERROR"};const l=await s.text();return{error:!1,pgn:l,side:String(e).startsWith("black")||r.hash.startsWith("black")?"b":"w"}}return{error:!0,errorType:"INCORRECT_LINK"}},lo=async r=>{let t;try{t=new URL(r)}catch{return{error:!0,errorType:"INCORRECT_LINK"}}return/^(www\.)*lichess\.org/.test(t.hostname)?Jn(t):{error:!0,errorType:"INCORRECT_LINK"}},St={pgn:"",fen:"",side:"w",ply:0};let re={...St};const it={set(r){if(r.fen){re={...St},re.fen=r.fen,location.hash=`fen/${re.fen.replace(/ /g,"_")}`;return}r.pgn&&(re={...St},re.pgn=yn(r.pgn)),r.side&&(re.side=r.side),r.ply!==void 0&&(re.ply=r.ply),location.hash=`pgn/${re.side}/${re.ply}/${re.pgn}`},get(){return location.href},getFENLink(r){return`${location.origin}/#fen/${r.replace(/ /g,"_")}`},async read(){const r=new URL(location.href),[t,...e]=location.hash.split("/");if(/fen/.test(t))re={...St},re.fen=decodeURI(e.join("/")).replace(/_/g," ");else if(/pgn/.test(t)){const[o,s,...l]=e;re.side=o,re.ply=Number(s),re.pgn=l.join("/"),re.fen=""}else if(/lid/.test(t)){const[o,s,...l]=e;re.side=o,re.ply=Number(s);const c=await Jn(new URL(`https://lichess.org/${l[0]}`));c.error?(re.pgn="",re.fen=""):(re.pgn=yn(jn(c.pgn)),re.fen="")}return{pgn:re.pgn?ii(re.pgn):"",fen:re.fen,side:re.side,ply:re.ply,boardStyle:r.searchParams.get("b"),piecesStyle:r.searchParams.get("p")}},entries(){return{...re}}},co=I('<div class="share__view"><h2 class="header--first">Board options</h2><button class="options__button" title="TOGGLE ANONYMOUS"><i class="las la-user-secret"></i></button><button class="options__button"><i class="las la-expand"></i></button><button class="options__button"><i class="las la-info-circle"></i></button><button class="options__button"><i class="las la-heading"></i></button><button class="options__button"><i class="las la-cloud"></i></button><button class="options__button" title="RENDER AS PUZZLE"><i class="las la-puzzle-piece"></i></button><button class="options__button options__button--last options__button--active" title="RANDOM STYLE"><i class="las la-dice-three"></i></button></div>'),qt=I("<hr>"),uo=I('<div class="share__fen"><h2>Current position</h2><input type="text" name="current_fen" readonly placeholder="Current FEN..."><div class="double"><button class="share__btn share__btn--left"></button><button class="share__btn share__btn--right"></button></div><hr class="invisible"><button class="share__size share__size--first" title="360px">XS</button><button class="share__size" title="512px">S</button><button class="share__size" title="720px">M</button><button class="share__size" title="1024px">L</button><button class="share__size share__size--last" title="1440px">XL</button><button class="share__btn"></button></div>'),fo=I('<div class="share__pgn"><h2>Game</h2><div class="double"><button class="share__btn"></button><button class="share__btn"></button></div><div class="double"><button class="share__btn">Export PGN</button><button class="share__btn"></button></div></div>'),ho=I('<div class="share__animation"><hr class="invisible"><button class="share__size share__size--first" title="360px">XS</button><button class="share__size" title="512px">S</button><button class="share__size" title="720px">M</button><button class="share__size" title="1024px">L</button><button class="share__size share__size--last" title="1440px">XL</button><button class="share__format share__format--first">GIF</button><button class="share__format">MP4</button><button class="share__format share__format--last">WebM</button><button class="share__create-animation"></button></div>'),_o=I('<button class="share__stylus">INSTALL STYLES<br><span>for lichess.org, chess.com & more</span></button>'),er=r=>{const[t,e]=De(""),[o,s]=De(!1),[l,c]=De(!1),h=d=>{e(d),setTimeout(()=>e(""),1e3)};return T(bt,{get class(){return"share"+(r.class?` ${r.class}`:"")},get children(){return[(()=>{const d=co.cloneNode(!0),b=d.firstChild,_=b.nextSibling,n=_.nextSibling,i=n.nextSibling,a=i.nextSibling,u=a.nextSibling,f=u.nextSibling,p=f.nextSibling;return ue(_,"click",r.handlers.toggleAnonymous,!0),ue(n,"click",r.handlers.toggleBorder,!0),ue(i,"click",r.handlers.toggleExtraInfo,!0),ue(a,"click",r.handlers.toggleTitleScreen,!0),ue(u,"click",r.handlers.toggleShadows,!0),ue(f,"click",r.handlers.togglePuzzle,!0),ue(p,"click",r.handlers.randomStyle,!0),Z(g=>{const $=!!v.anonymous,y=!!v.boardConfig.showBorder,k=v.boardConfig.showBorder?"HIDE BORDER":"SHOW BORDER",P=!!v.boardConfig.showExtraInfo,M=v.boardConfig.showExtraInfo?"HIDE EXTRA INFO":"SHOW EXTRA INFO",D=!!v.gameConfig.titleScreen,Y=v.gameConfig.titleScreen?"EXCLUDE TITLE SCREEN":"INCLUDE TITLE SCREEN",L=!!v.boardConfig.showShadows,ne=v.boardConfig.showShadows?"HIDE SHADOWS":"SHOW SHADOWS",pe=!!v.boardConfig.puzzle;return $!==g._v$&&_.classList.toggle("options__button--active",g._v$=$),y!==g._v$2&&n.classList.toggle("options__button--active",g._v$2=y),k!==g._v$3&&oe(n,"title",g._v$3=k),P!==g._v$4&&i.classList.toggle("options__button--active",g._v$4=P),M!==g._v$5&&oe(i,"title",g._v$5=M),D!==g._v$6&&a.classList.toggle("options__button--active",g._v$6=D),Y!==g._v$7&&oe(a,"title",g._v$7=Y),L!==g._v$8&&u.classList.toggle("options__button--active",g._v$8=L),ne!==g._v$9&&oe(u,"title",g._v$9=ne),pe!==g._v$10&&f.classList.toggle("options__button--active",g._v$10=pe),g},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0,_v$5:void 0,_v$6:void 0,_v$7:void 0,_v$8:void 0,_v$9:void 0,_v$10:void 0}),d})(),qt.cloneNode(!0),(()=>{const d=uo.cloneNode(!0),b=d.firstChild,_=b.nextSibling,n=_.nextSibling,i=n.firstChild,a=i.nextSibling,u=n.nextSibling,f=u.nextSibling,p=f.nextSibling,g=p.nextSibling,$=g.nextSibling,y=$.nextSibling,k=y.nextSibling;return _.$$click=P=>{P.target.select()},i.$$click=()=>{navigator.clipboard.writeText(v.fen),h("fen")},N(i,()=>t()==="fen"?"Copied!":"Copy FEN"),a.$$click=()=>{navigator.clipboard.writeText(it.getFENLink(v.fen)),h("fen-link")},N(a,()=>t()==="fen-link"?"Copied!":"Copy link"),f.$$click=()=>E("gameConfig","picSize","XS"),p.$$click=()=>E("gameConfig","picSize","S"),g.$$click=()=>E("gameConfig","picSize","M"),$.$$click=()=>E("gameConfig","picSize","L"),y.$$click=()=>E("gameConfig","picSize","XL"),k.$$click=async()=>{s(!0),await r.handlers.downloadImage(),s(!1)},N(k,()=>o()?"Please wait...":"Save as image"),Z(P=>{const M=v.gameConfig.picSize==="XS",D=v.gameConfig.picSize==="S",Y=v.gameConfig.picSize==="M",L=v.gameConfig.picSize==="L",ne=v.gameConfig.picSize==="XL";return M!==P._v$11&&f.classList.toggle("share__size--active",P._v$11=M),D!==P._v$12&&p.classList.toggle("share__size--active",P._v$12=D),Y!==P._v$13&&g.classList.toggle("share__size--active",P._v$13=Y),L!==P._v$14&&$.classList.toggle("share__size--active",P._v$14=L),ne!==P._v$15&&y.classList.toggle("share__size--active",P._v$15=ne),P},{_v$11:void 0,_v$12:void 0,_v$13:void 0,_v$14:void 0,_v$15:void 0}),Z(()=>_.value=v.fen),d})(),T(U,{get when(){return v.pgn},get children(){return[qt.cloneNode(!0),(()=>{const d=fo.cloneNode(!0),b=d.firstChild,_=b.nextSibling,n=_.firstChild,i=n.nextSibling,a=_.nextSibling,u=a.firstChild,f=u.nextSibling;return n.$$click=()=>{navigator.clipboard.writeText(v.anonymous?v.game.anonymousPGN:v.pgn),h("pgn")},N(n,()=>t()==="pgn"?"Copied!":"Copy PGN"),i.$$click=()=>{navigator.clipboard.writeText(window.location.href),h("pgn-link")},N(i,()=>t()==="pgn-link"?"Copied!":"Copy link"),u.$$click=()=>{const p=new Blob([v.pgn],{type:"application/vnd.chess-pgn;charset=utf-8"}),g=v.game.getFileName(v.anonymous);Qt(p,g,"pgn")},f.$$click=()=>{const g=`[${v.game.getTitle({anonymous:v.anonymous})}](${window.location.href})`;navigator.clipboard.writeText(g),h("markdown")},N(f,()=>t()==="markdown"?"Copied!":"Copy markdown"),d})(),(()=>{const d=ho.cloneNode(!0),b=d.firstChild,_=b.nextSibling,n=_.nextSibling,i=n.nextSibling,a=i.nextSibling,u=a.nextSibling,f=u.nextSibling,p=f.nextSibling,g=p.nextSibling,$=g.nextSibling;return _.$$click=()=>E("gameConfig","animationSize","XS"),n.$$click=()=>E("gameConfig","animationSize","S"),i.$$click=()=>E("gameConfig","animationSize","M"),a.$$click=()=>E("gameConfig","animationSize","L"),u.$$click=()=>E("gameConfig","animationSize","XL"),f.$$click=()=>E("gameConfig","format","GIF"),p.$$click=()=>E("gameConfig","format","MP4"),g.$$click=()=>E("gameConfig","format","WebM"),$.$$click=async()=>{c(!0),await r.handlers.downloadAnimation(),c(!1)},N($,()=>l()?"Please wait...":"Save animation"),Z(y=>{const k=v.gameConfig.animationSize==="XS",P=v.gameConfig.animationSize==="S",M=v.gameConfig.animationSize==="M",D=v.gameConfig.animationSize==="L",Y=v.gameConfig.animationSize==="XL",L=v.gameConfig.format==="GIF",ne=v.gameConfig.format==="MP4",pe=v.gameConfig.format==="WebM";return k!==y._v$16&&_.classList.toggle("share__size--active",y._v$16=k),P!==y._v$17&&n.classList.toggle("share__size--active",y._v$17=P),M!==y._v$18&&i.classList.toggle("share__size--active",y._v$18=M),D!==y._v$19&&a.classList.toggle("share__size--active",y._v$19=D),Y!==y._v$20&&u.classList.toggle("share__size--active",y._v$20=Y),L!==y._v$21&&f.classList.toggle("share__format--active",y._v$21=L),ne!==y._v$22&&p.classList.toggle("share__format--active",y._v$22=ne),pe!==y._v$23&&g.classList.toggle("share__format--active",y._v$23=pe),y},{_v$16:void 0,_v$17:void 0,_v$18:void 0,_v$19:void 0,_v$20:void 0,_v$21:void 0,_v$22:void 0,_v$23:void 0}),d})()]}}),T(U,{get when(){return Nt(()=>!v.mobile,!0)()&&["Chrome","Firefox","Opera"].includes(v.browser)},get children(){return[qt.cloneNode(!0),(()=>{const d=_o.cloneNode(!0);return d.$$click=()=>E("fullscreenPopup","styles"),d})()]}})]}})};Pe(["click"]);const po=I('<p class="switch"><button class="switch__btn switch__btn--left">All</button><button class="switch__btn switch__btn--right">Favorite</button></p>'),go=I('<a target="_blank" class="collection__action collection__stylus" title="Install via Stylus"></a>'),mo=I('<a target="_blank" class="collection__action collection__download" title="Download"></a>'),bo=I('<div class="collection__card"><div></div><div class="collection__actions"><a href="" class="collection__action collection__favorite" title="Add to favorites"></a></div></div>'),Tn=Rt.map(r=>({key:r,img:`/boards/ico/${r}_ico.png`})),tr=r=>T(bt,{get class(){return"collection"+(r.class?` ${r.class}`:"")},get children(){return[(()=>{const t=po.cloneNode(!0),e=t.firstChild,o=e.nextSibling;return e.$$click=()=>E("showFavoriteBoards",!1),o.$$click=()=>E("showFavoriteBoards",!0),Z(s=>{const l=!v.showFavoriteBoards,c=!!v.showFavoriteBoards;return l!==s._v$&&e.classList.toggle("switch__btn--active",s._v$=l),c!==s._v$2&&o.classList.toggle("switch__btn--active",s._v$2=c),s},{_v$:void 0,_v$2:void 0}),t})(),T(gt,{get each(){return Nt(()=>!!v.showFavoriteBoards,!0)()?Tn.filter(({key:t})=>v.favoriteBoards.has(t)):Tn},children:t=>(()=>{const e=bo.cloneNode(!0),o=e.firstChild,s=o.nextSibling,l=s.firstChild;return o.$$click=()=>{E("boardConfig","boardStyle",t.key),r.handlers.changeBoardStyle(t.key)},oe(o,"draggable",!1),l.$$click=c=>{c.preventDefault(),r.handlers.toggleFavoriteBoard(t.key)},N(s,T(U,{get when(){return!v.mobile},get children(){return[(()=>{const c=go.cloneNode(!0);return Z(()=>oe(c,"href",`stylus/boards/${t.key}.user.css`)),c})(),(()=>{const c=mo.cloneNode(!0);return Z(()=>oe(c,"href",`download/boards/${t.key}.zip`)),c})()]}}),null),Z(c=>{const h="collection__ico boards__ico"+(v.boardConfig.boardStyle===t.key?" collection__ico--active":""),d=`url(${t.img})`,b=t.key,_=!!v.favoriteBoards.has(t.key);return h!==c._v$3&&mt(o,c._v$3=h),d!==c._v$4&&o.style.setProperty("background-image",c._v$4=d),b!==c._v$5&&oe(o,"title",c._v$5=b),_!==c._v$6&&l.classList.toggle("collection__favorite--active",c._v$6=_),c},{_v$3:void 0,_v$4:void 0,_v$5:void 0,_v$6:void 0}),e})()})]}});Pe(["click"]);const vo=I('<p class="switch"><button class="switch__btn switch__btn--left">All</button><button class="switch__btn switch__btn--right">Favorite</button></p>'),wo=I('<a target="_blank" class="collection__action collection__stylus" title="Install via Stylus"></a>'),yo=I('<a class="collection__action collection__download" title="Download"></a>'),So=I('<div class="collection__card"><div></div><div class="collection__actions"><a href="" class="collection__action collection__favorite" title="Add to favorites"></a></div></div>'),Cn=Ot.map(r=>({key:r,img:`/pieces/${r}/nw.svg`})),nr=r=>T(bt,{get class(){return"collection"+(r.class?` ${r.class}`:"")},get children(){return[(()=>{const t=vo.cloneNode(!0),e=t.firstChild,o=e.nextSibling;return e.$$click=()=>E("showFavoritePieces",!1),o.$$click=()=>E("showFavoritePieces",!0),Z(s=>{const l=!v.showFavoritePieces,c=!!v.showFavoritePieces;return l!==s._v$&&e.classList.toggle("switch__btn--active",s._v$=l),c!==s._v$2&&o.classList.toggle("switch__btn--active",s._v$2=c),s},{_v$:void 0,_v$2:void 0}),t})(),T(gt,{get each(){return Nt(()=>!!v.showFavoritePieces,!0)()?Cn.filter(({key:t})=>v.favoritePieces.has(t)):Cn},children:t=>(()=>{const e=So.cloneNode(!0),o=e.firstChild,s=o.nextSibling,l=s.firstChild;return o.$$click=()=>{E("boardConfig","piecesStyle",t.key),r.handlers.changePiecesStyle(t.key)},oe(o,"draggable",!1),l.$$click=c=>{c.preventDefault(),r.handlers.toggleFavoritePieces(t.key)},N(s,T(U,{get when(){return!v.mobile},get children(){return[(()=>{const c=wo.cloneNode(!0);return Z(()=>oe(c,"href",`stylus/pieces/${t.key}${v.boardConfig.showShadows?"_shadows":""}.user.css`)),c})(),(()=>{const c=yo.cloneNode(!0);return Z(()=>oe(c,"href",`download/pieces/${t.key}.zip`)),c})()]}}),null),Z(c=>{const h="collection__ico"+(v.boardConfig.piecesStyle===t.key?" collection__ico--active":""),d=`url(${t.img})`,b=t.key,_=!!v.favoritePieces.has(t.key);return h!==c._v$3&&mt(o,c._v$3=h),d!==c._v$4&&o.style.setProperty("background-image",c._v$4=d),b!==c._v$5&&oe(o,"title",c._v$5=b),_!==c._v$6&&l.classList.toggle("collection__favorite--active",c._v$6=_),c},{_v$3:void 0,_v$4:void 0,_v$5:void 0,_v$6:void 0}),e})()})]}});Pe(["click"]);const $o=I("<button></button>"),Ve=r=>(()=>{const t=$o.cloneNode(!0);return t.$$click=()=>r.setTab(r.name),N(t,()=>r.children),Z(()=>mt(t,"tab"+(r.isActive?" tab--active":""))),t})();Pe(["click"]);const ko=I('<i class="las la-chess-board"></i>'),Ao=I('<i class="las la-chess"></i>'),xo=I('<div class="game"><div class="game-tabs"></div></div>'),ut=r=>{E("activeTab",r)},To=r=>(()=>{const t=xo.cloneNode(!0),e=t.firstChild;return N(e,T(Ve,{name:"game",setTab:ut,get isActive(){return v.activeTab==="game"},children:"GAME"}),null),N(e,T(Ve,{name:"load",setTab:ut,get isActive(){return v.activeTab==="load"},children:"LOAD"}),null),N(e,T(U,{get when(){return v.layout!=="triple"},get children(){return[T(Ve,{name:"share",setTab:ut,get isActive(){return v.activeTab==="share"},children:"SHARE"}),T(Ve,{name:"boards",setTab:ut,get isActive(){return v.activeTab==="boards"},get children(){return ko.cloneNode(!0)}}),T(Ve,{name:"pieces",setTab:ut,get isActive(){return v.activeTab==="pieces"},get children(){return Ao.cloneNode(!0)}})]}}),null),N(t,T(Fn,{get children(){return[T(We,{get when(){return v.activeTab==="game"},get children(){return[T(Xi,{get handlers(){return r.handlers}}),T(Hi,{get moves(){return r.moves},get handlers(){return r.handlers},get class(){return v.layout==="single"?"span2":void 0}}),T(U,{get when(){return v.layout!=="single"},get children(){return T(Yn,{get handlers(){return r.handlers}})}})]}}),T(We,{get when(){return v.activeTab==="load"},get children(){return T(ao,{get handlers(){return r.handlers},class:"span3"})}}),T(U,{get when(){return v.layout!=="triple"},get children(){return[T(We,{get when(){return v.activeTab==="share"},get children(){return T(er,{get handlers(){return r.handlers},class:"span3"})}}),T(We,{get when(){return v.activeTab==="boards"},get children(){return T(tr,{get handlers(){return r.handlers},class:"span3"})}}),T(We,{get when(){return v.activeTab==="pieces"},get children(){return T(nr,{get handlers(){return r.handlers},class:"span3"})}})]}})]}}),null),Z(()=>e.classList.toggle("game-tabs--condensed",v.layout!=="triple")),t})();const Co=I('<i class="las la-share"></i>'),Eo=I('<i class="las la-chess-board"></i>'),Po=I('<i class="las la-chess"></i>'),Io=I('<div class="setup"><div class="setup-tabs"></div></div>'),Gt=r=>E("activeLeftTab",r),No=r=>(()=>{const t=Io.cloneNode(!0),e=t.firstChild;return N(e,T(Ve,{name:"share",setTab:Gt,get isActive(){return v.activeLeftTab==="share"},get children(){return[Co.cloneNode(!0)," SHARE"]}}),null),N(e,T(Ve,{name:"boards",setTab:Gt,get isActive(){return v.activeLeftTab==="boards"},get children(){return[Eo.cloneNode(!0)," BOARDS"]}}),null),N(e,T(Ve,{name:"pieces",setTab:Gt,get isActive(){return v.activeLeftTab==="pieces"},get children(){return[Po.cloneNode(!0)," PIECES"]}}),null),N(t,T(Fn,{get children(){return[T(We,{get when(){return v.activeLeftTab==="share"},get children(){return T(er,{get handlers(){return r.handlers}})}}),T(We,{get when(){return v.activeLeftTab==="boards"},get children(){return T(tr,{get handlers(){return r.handlers}})}}),T(We,{get when(){return v.activeLeftTab==="pieces"},get children(){return T(nr,{get handlers(){return r.handlers}})}})]}}),null),t})();const Oo=I('<div class="popup"><div class="popup__box"><button class="popup__close"><i class="las la-times"></i></button><h2 class="popup__title"></h2><div class="popup__content"></div></div></div>'),sn=r=>(()=>{const t=Oo.cloneNode(!0),e=t.firstChild,o=e.firstChild,s=o.nextSibling,l=s.nextSibling;return ue(o,"click",r.onClose,!0),N(s,()=>r.title),N(l,()=>r.children),t})();Pe(["click"]);const ce=r=>{switch(r){case"board":localStorage.setItem("boardConfig",JSON.stringify(v.boardConfig));break;case"game":localStorage.setItem("gameConfig",JSON.stringify(v.gameConfig));break;case"site":localStorage.setItem("siteConfig",JSON.stringify(v.siteConfig));break;case"recent":localStorage.setItem("recent",JSON.stringify(v.recent));break;case"pieces":localStorage.setItem("pieces",JSON.stringify([...v.favoritePieces]));break;case"boards":localStorage.setItem("boards",JSON.stringify([...v.favoriteBoards]));break}},Lo=I("<p>Saving files may not work correctly in this browser.</p>"),Ro=I("<p>To enjoy the full functionality of the website, please open it in <u><b>Safari</b></u>.</p>"),Bo=()=>T(U,{get when(){return!v.siteConfig.iOSAppPopup&&v.siteConfig.wrongBrowserPopup&&v.os==="iOS"&&!v.browser?.includes("Safari")},get children(){return T(sn,{onClose:()=>{E("siteConfig","wrongBrowserPopup",!1),ce("site")},title:"Note",get children(){return[Lo.cloneNode(!0),Ro.cloneNode(!0)]}})}}),Mo=I("<p>For easy access, you can install this website as a standalone app.</p>"),zo=I("<ul>To do that:<li>open the website in Chrome,</li><li>tap the menu icon (3 dots in the corner),</li><li>tap <u><b>Add to Home screen</b></u>.</li></ul>"),Do=()=>T(U,{get when(){return v.siteConfig.androidAppPopup&&v.os?.includes("Android")},get children(){return T(sn,{onClose:()=>{E("siteConfig","androidAppPopup",!1),ce("site")},title:"Tip",get children(){return[Mo.cloneNode(!0),zo.cloneNode(!0)]}})}}),Fo=I("<p>For easy access, you can install this website as a standalone app.</p>"),Ho=I("<ul>To do that:<li>open the website in Safari,</li><li>tap the Share icon,</li><li>tap <u><b>Add to Home Screen</b></u>.</li></ul>"),qo=()=>T(U,{get when(){return v.siteConfig.iOSAppPopup&&v.os?.includes("iOS")},get children(){return T(sn,{onClose:()=>{E("siteConfig","iOSAppPopup",!1),ce("site")},title:"Tip",get children(){return[Fo.cloneNode(!0),Ho.cloneNode(!0)]}})}});const Go=I('<div class="fs-popup"><div class="fs-popup__box"><button class="fs-popup__close"><i class="las la-times"></i></button><div></div></div></div>'),an=r=>(()=>{const t=Go.cloneNode(!0),e=t.firstChild,o=e.firstChild,s=o.nextSibling;return ue(o,"click",r.onCLose,!0),N(s,()=>r.children),Z(()=>mt(s,`fs-popup__content ${r.class}`)),t})();Pe(["click"]);const jo=I("<h2>About</h2>"),Wo=I("<p><b>ShareChess</b> is a free, open-source website that allows you to:</p>"),Uo=I('<ul class="about__features"><li>share chess games as self-contained replay links (the whole game is stored in the URL),</li><li>create images and animations of chess games and positions,</li><li>install additional chessboard styles and piece sets for major chess websites!</li></ul>'),Vo=I('<p>You can find the complete source code on my <a href="https://github.com/sharechess/sharechess">GitHub page</a>.</p>'),Xo=I('<p>Follow my <a href="https://www.reddit.com/r/sharechess/" target="_blank">subreddit</a> for news, updates, and chess-related content!</p>'),Ko=I("<hr>"),Yo=I("<h2>Keyboard Shortcuts</h2>"),Qo=I('<div class="about__shortcuts"><ul><li><kbd>\u2192</kbd> Next move</li><li><kbd>\u2190</kbd> Previous move</li><li><kbd>\u2191</kbd> Start position</li><li><kbd>\u2193</kbd> Final position</li><li><kbd>f</kbd> Flip the board</li><li><kbd>Space</kbd> Play / Pause</li><li><kbd>Enter</kbd> Analyze on Lichess</li></ul><ul><li><kbd>l</kbd> Load from clipboard</li><li><kbd>a</kbd> Toggle anonymous</li><li><kbd>b</kbd> Toggle border</li><li><kbd>i</kbd> Toggle extra info</li><li><kbd>h</kbd> Toggle header (title screen)</li><li><kbd>s</kbd> Toggle shadows</li><li><kbd>p</kbd> Toggle puzzle view</li></ul></div>'),Zo=()=>T(U,{get when(){return v.fullscreenPopup==="about"},get children(){return T(an,{class:"about",onCLose:()=>E("fullscreenPopup",null),get children(){return[jo.cloneNode(!0),Wo.cloneNode(!0),Uo.cloneNode(!0),Vo.cloneNode(!0),Xo.cloneNode(!0),T(U,{get when(){return!v.mobile},get children(){return[Ko.cloneNode(!0),Yo.cloneNode(!0),Qo.cloneNode(!0)]}})]}})}});const Jo=I('<p class="us-info__intro">You can install any chessboard and piece styles from this website for <!>by following the instructions below.</p>'),es=I('<div class="us-info__steps"><div class="us-info__step"><h2 class="us-info__step-num">1</h2><h3 class="us-info__step-title">Install Stylus</h3><p class="us-info__description">Get the Stylus extension for your browser, that allows you to use custom styles on other websites.</p><p class="us-info__install-stylus"><a class="btn" target="_blank">Install the extension</a></p></div><div class="us-info__step"><h2 class="us-info__step-num">2</h2><h3 class="us-info__step-title">Choose your chessboard and pieces</h3><p class="us-info__description">Install any of the piece or chessboard styles by clicking the <img class="us-info__text-ico" src="img/stylus.svg" alt=""> icon on the chessboard / piece set card.</p><p class="us-info__description">This will open a stylesheet, click <strong>"Install / Reinstall style"</strong> button in the top left corner.</p><p class="us-info__browse"><button>Browse Chessboards</button><button>Browse Pieces</button></p></div><div class="us-info__step"><h2 class="us-info__step-num">3</h2><h3 class="us-info__step-title">Manage your styles</h3><p class="us-info__description">Toggle installed styles via Stylus extension menu. Pin the extension for easy access.</p><p class="us-info__manage-stylus"><img src="img/stylus-popup.png" alt=""></p></div></div>'),ts=I('<a target="_blank">, </a>'),En=r=>()=>{E("fullscreenPopup",null),v.layout==="triple"?E("activeLeftTab",r):E("activeTab",r)},ns=["lichess.org","chess.com","openingtree.com","chessgames.com","chess24.com","chesstempo.com","listudy.org","chesspecker.com","chessbase.com","wikipedia.org","aimchess.com","chessable.com"],rs=()=>T(U,{get when(){return v.fullscreenPopup==="styles"},get children(){return T(an,{class:"us-info",onCLose:()=>E("fullscreenPopup",null),get children(){return[(()=>{const r=Jo.cloneNode(!0),t=r.firstChild,e=t.nextSibling;return e.nextSibling,N(r,T(gt,{each:ns,children:o=>(()=>{const s=ts.cloneNode(!0),l=s.firstChild;return oe(s,"href",`https://${o}`),N(s,o,l),s})()}),e),r})(),(()=>{const r=es.cloneNode(!0),t=r.firstChild,e=t.firstChild,o=e.nextSibling,s=o.nextSibling,l=s.nextSibling,c=l.firstChild,h=t.nextSibling,d=h.firstChild,b=d.nextSibling,_=b.nextSibling,n=_.nextSibling,i=n.nextSibling,a=i.firstChild,u=a.nextSibling;return ue(a,"click",En("boards"),!0),ue(u,"click",En("pieces"),!0),Z(()=>oe(c,"href",v.browser==="Chrome"?"https://chrome.google.com/webstore/detail/stylus/clngdbkpkpeebahjckkjfobafhncgmne":v.browser==="Firefox"?"https://addons.mozilla.org/pl/firefox/addon/styl-us/":"https://addons.opera.com/pl/extensions/details/stylus/")),r})()]}})}});Pe(["click"]);const is=I(`<p class="support__intro">If you like what I'm doing, you can support the project financially, contribute your work and ideas, and share the projects with others.</p>`),os=I(`<div class="support__methods"><div class="support__method"><img class="support__ico" src="img/github.svg" alt="contribute"><h2 class="support__title">Help improve the website</h2><p class="support__description">You can suggest improvements and report bugs via <a href="https://github.com/sharechess/sharechess/issues" target="_blank">GitHub Issues</a> or by messaging me on <a href="https://www.reddit.com/message/compose/?to=kap89&amp;subject=ShareChess%20issue" target="_blank">Reddit.</a></p><p class="support__description">If you are a programmer, you can contribute to the project directly. Yu can find the source code on my <a href="https://github.com/sharechess/sharechess" target="_blank">GitHub Page.</a></p></div><div class="support__method"><img class="support__ico support__ico--coffee" src="img/donate.svg" alt="donate"><h2 class="support__title">Buy me a coffee</h2><p class="support__description">The project is free for everyone, but improving the website and creating new boards and piece sets takes a lot of time and effort.</p><p class="support__description">I don't use ads or trackers, and the only source to fund the project is your generosity.</p><p class="support__description">Help fuel the development of the project by buying me a symbolic coffee!</p><a href="https://www.buymeacoffee.com/maciejcaderek" target="_blank" class="support__donate-btn btn">DONATE</a></div><div class="support__method"><img class="support__ico" src="img/artists.svg" alt="design"><h2 class="support__title">Design a chessboard or piece set</h2><p class="support__description">If you are an artist, or just like to create stuff, you can submit a new board design or a piece set.</p><p class="support__description">You can find instructions on how to prepare the assets on my <a href="https://github.com/sharechess/sharechess#designing-new-boards-and-piece-sets" target="_blank">GitHub page.</a></p><p class="support__description">Message me on <a href="https://www.reddit.com/message/compose/?to=kap89&amp;subject=ShareChess%20design" target="_blank">Reddit</a> or open a <a href="https://github.com/sharechess/sharechess/issues" target="_blank">GitHub issue</a> to coordinate the details.</p></div></div>`),ss=I("<hr>"),as=I('<div class="support__share"><p class="support__subreddit">Follow my <a href="https://www.reddit.com/r/sharechess/" target="_blank">subreddit</a> for news, updates, and chess-related content!</p><p class="support__share-intro">Share the project with others, to help it grow!</p><div class="share__targets"><a class="resp-sharing-button__link" href="https://facebook.com/sharer/sharer.php?u=https%3A%2F%2Fsharechess.github.io" target="_blank" rel="noopener" aria-label="Facebook"><div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18.77 7.46H14.5v-1.9c0-.9.6-1.1 1-1.1h3V.5h-4.33C10.24.5 9.5 3.44 9.5 5.32v2.15h-3v4h3v12h5v-12h3.85l.42-4z"></path></svg></div>Facebook</div></a><a class="resp-sharing-button__link" href="https://twitter.com/intent/tweet/?text=ShareChess%20-%20chess%20with%20style!&amp;url=https%3A%2F%2Fsharechess.github.io" target="_blank" rel="noopener" aria-label="Twitter"><div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M23.44 4.83c-.8.37-1.5.38-2.22.02.93-.56.98-.96 1.32-2.02-.88.52-1.86.9-2.9 1.1-.82-.88-2-1.43-3.3-1.43-2.5 0-4.55 2.04-4.55 4.54 0 .36.03.7.1 1.04-3.77-.2-7.12-2-9.36-4.75-.4.67-.6 1.45-.6 2.3 0 1.56.8 2.95 2 3.77-.74-.03-1.44-.23-2.05-.57v.06c0 2.2 1.56 4.03 3.64 4.44-.67.2-1.37.2-2.06.08.58 1.8 2.26 3.12 4.25 3.16C5.78 18.1 3.37 18.74 1 18.46c2 1.3 4.4 2.04 6.97 2.04 8.35 0 12.92-6.92 12.92-12.93 0-.2 0-.4-.02-.6.9-.63 1.96-1.22 2.56-2.14z"></path></svg></div>Twitter</div></a><a class="resp-sharing-button__link" href="mailto:?subject=ShareChess%20-%20chess%20with%20style!&amp;body=https%3A%2F%2Fsharechess.github.io" target="_self" rel="noopener" aria-label="E-Mail"><div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22 4H2C.9 4 0 4.9 0 6v12c0 1.1.9 2 2 2h20c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zM7.25 14.43l-3.5 2c-.08.05-.17.07-.25.07-.17 0-.34-.1-.43-.25-.14-.24-.06-.55.18-.68l3.5-2c.24-.14.55-.06.68.18.14.24.06.55-.18.68zm4.75.07c-.1 0-.2-.03-.27-.08l-8.5-5.5c-.23-.15-.3-.46-.15-.7.15-.22.46-.3.7-.14L12 13.4l8.23-5.32c.23-.15.54-.08.7.15.14.23.07.54-.16.7l-8.5 5.5c-.08.04-.17.07-.27.07zm8.93 1.75c-.1.16-.26.25-.43.25-.08 0-.17-.02-.25-.07l-3.5-2c-.24-.13-.32-.44-.18-.68s.44-.32.68-.18l3.5 2c.24.13.32.44.18.68z"></path></svg></div>E-Mail</div></a><a class="resp-sharing-button__link" href="https://reddit.com/submit/?url=https%3A%2F%2Fsharechess.github.io&amp;resubmit=true&amp;title=ShareChess%20-%20chess%20with%20style!" target="_blank" rel="noopener" aria-label="Reddit"><div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M24 11.5c0-1.65-1.35-3-3-3-.96 0-1.86.48-2.42 1.24-1.64-1-3.75-1.64-6.07-1.72.08-1.1.4-3.05 1.52-3.7.72-.4 1.73-.24 3 .5C17.2 6.3 18.46 7.5 20 7.5c1.65 0 3-1.35 3-3s-1.35-3-3-3c-1.38 0-2.54.94-2.88 2.22-1.43-.72-2.64-.8-3.6-.25-1.64.94-1.95 3.47-2 4.55-2.33.08-4.45.7-6.1 1.72C4.86 8.98 3.96 8.5 3 8.5c-1.65 0-3 1.35-3 3 0 1.32.84 2.44 2.05 2.84-.03.22-.05.44-.05.66 0 3.86 4.5 7 10 7s10-3.14 10-7c0-.22-.02-.44-.05-.66 1.2-.4 2.05-1.54 2.05-2.84zM2.3 13.37C1.5 13.07 1 12.35 1 11.5c0-1.1.9-2 2-2 .64 0 1.22.32 1.6.82-1.1.85-1.92 1.9-2.3 3.05zm3.7.13c0-1.1.9-2 2-2s2 .9 2 2-.9 2-2 2-2-.9-2-2zm9.8 4.8c-1.08.63-2.42.96-3.8.96-1.4 0-2.74-.34-3.8-.95-.24-.13-.32-.44-.2-.68.15-.24.46-.32.7-.18 1.83 1.06 4.76 1.06 6.6 0 .23-.13.53-.05.67.2.14.23.06.54-.18.67zm.2-2.8c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm5.7-2.13c-.38-1.16-1.2-2.2-2.3-3.05.38-.5.97-.82 1.6-.82 1.1 0 2 .9 2 2 0 .84-.53 1.57-1.3 1.87z"></path></svg></div>Reddit</div></a><a class="resp-sharing-button__link" href="whatsapp://send?text=ShareChess%20-%20chess%20with%20style!%20https%3A%2F%2Fsharechess.github.io" target="_blank" rel="noopener" aria-label="WhatsApp"><div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.1 3.9C17.9 1.7 15 .5 12 .5 5.8.5.7 5.6.7 11.9c0 2 .5 3.9 1.5 5.6L.6 23.4l6-1.6c1.6.9 3.5 1.3 5.4 1.3 6.3 0 11.4-5.1 11.4-11.4-.1-2.8-1.2-5.7-3.3-7.8zM12 21.4c-1.7 0-3.3-.5-4.8-1.3l-.4-.2-3.5 1 1-3.4L4 17c-1-1.5-1.4-3.2-1.4-5.1 0-5.2 4.2-9.4 9.4-9.4 2.5 0 4.9 1 6.7 2.8 1.8 1.8 2.8 4.2 2.8 6.7-.1 5.2-4.3 9.4-9.5 9.4zm5.1-7.1c-.3-.1-1.7-.9-1.9-1-.3-.1-.5-.1-.7.1-.2.3-.8 1-.9 1.1-.2.2-.3.2-.6.1s-1.2-.5-2.3-1.4c-.9-.8-1.4-1.7-1.6-2-.2-.3 0-.5.1-.6s.3-.3.4-.5c.2-.1.3-.3.4-.5.1-.2 0-.4 0-.5C10 9 9.3 7.6 9 7c-.1-.4-.4-.3-.5-.3h-.6s-.4.1-.7.3c-.3.3-1 1-1 2.4s1 2.8 1.1 3c.1.2 2 3.1 4.9 4.3.7.3 1.2.5 1.6.6.7.2 1.3.2 1.8.1.6-.1 1.7-.7 1.9-1.3.2-.7.2-1.2.2-1.3-.1-.3-.3-.4-.6-.5z"></path></svg></div>WhatsApp</div></a><a class="resp-sharing-button__link" href="https://telegram.me/share/url?text=ShareChess%20-%20chess%20with%20style!&amp;url=https%3A%2F%2Fsharechess.github.io" target="_blank" rel="noopener" aria-label="Telegram"><div class="resp-sharing-button resp-sharing-button--telegram resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M.707 8.475C.275 8.64 0 9.508 0 9.508s.284.867.718 1.03l5.09 1.897 1.986 6.38a1.102 1.102 0 0 0 1.75.527l2.96-2.41a.405.405 0 0 1 .494-.013l5.34 3.87a1.1 1.1 0 0 0 1.046.135 1.1 1.1 0 0 0 .682-.803l3.91-18.795A1.102 1.102 0 0 0 22.5.075L.706 8.475z"></path></svg></div>Telegram</div></a></div></div>'),ls=()=>T(U,{get when(){return v.fullscreenPopup==="support"},get children(){return T(an,{class:"support",onCLose:()=>E("fullscreenPopup",null),get children(){return[is.cloneNode(!0),os.cloneNode(!0),ss.cloneNode(!0),as.cloneNode(!0)]}})}}),cs=I('<div id="setup" class="setup-box"></div>'),us=I('<div><div class="layout"><div id="board" class="board-box"><canvas class="board" id="canvas"></canvas></div><div id="moves" class="game-box"></div></div></div>'),fs=r=>(()=>{const t=us.cloneNode(!0),e=t.firstChild,o=e.firstChild;o.firstChild;const s=o.nextSibling;return N(t,T(Li,{get handlers(){return r.handlers}}),e),N(e,T(U,{get when(){return v.layout==="triple"},get children(){const l=cs.cloneNode(!0);return N(l,T(No,{get handlers(){return r.handlers}})),l}}),o),N(o,T(U,{get when(){return v.layout==="single"},get children(){return T(Yn,{get handlers(){return r.handlers}})}}),null),N(s,T(To,{get moves(){return r.state.moves},get handlers(){return r.handlers}})),N(t,T(Zo,{}),null),N(t,T(rs,{}),null),N(t,T(ls,{}),null),N(t,T(Bo,{}),null),N(t,T(Do,{}),null),N(t,T(qo,{}),null),Z(l=>{const c=!v.siteConfig.darkMode,h=v.layout==="double";return c!==l._v$&&t.classList.toggle("light",l._v$=c),h!==l._v$2&&o.classList.toggle("board-box--left",l._v$2=h),l},{_v$:void 0,_v$2:void 0}),t})(),rr={XS:360,S:512,M:720,L:1024,XL:1440},ds=async(r,t,e=0,o,s)=>{const l=new ot;t?l.loadPGN(t):l.loadFEN(r);const c=new tn;await c.init({...o,size:rr[s]});const h=l.getPosition(e);return await c.frame(h,l.header),c.render(),c.toImgUrl()},hs="modulepreload",Pn={},_s="/",jt=function(t,e){return!e||e.length===0?t():Promise.all(e.map(o=>{if(o=`${_s}${o}`,o in Pn)return;Pn[o]=!0;const s=o.endsWith(".css"),l=s?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${o}"]${l}`))return;const c=document.createElement("link");if(c.rel=s?"stylesheet":hs,s||(c.as="script",c.crossOrigin=""),c.href=o,document.head.appendChild(c),s)return new Promise((h,d)=>{c.addEventListener("load",h),c.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>t())},ps=async(r,t,e,o,s)=>{const l=new ot().loadPGN(r),c=new tn;await c.init({...t,size:rr[o]});const h=(await jt(e==="GIF"?()=>import("./GIF.290adede.js"):e==="MP4"?()=>import("./MP4.0b9c1ccb.js"):()=>import("./WebM.13faa943.js"),[])).default,d=new h(c.width,c.height,!0),b=l.header;s&&(await c.titleFrame(b),c.render(),await d.add(c,4));for(let _=0;_<l.length;_++){const n=l.getPosition(_);await c.frame(n,b),c.render();const i=n.end===0?5:n.ply===0&&!s?2:1;await d.add(c,i)}return await d.render()},gs=/^([1-8kqrbnp]+\/)+[1-8kqrbnp]+ [wb] ([kq]+|-) ([a-h1-8]{2}|-) \d+ \d+$/i,ms=r=>gs.test(r.trim()),bs=/((\[[a-z0-9]+ +"[^"\n\r]+"](\r\n|\r|\n))*(\r\n|\r|\n)+){0,1}\d+\. *[a-h1-8x+#=.]+/i,vs=r=>bs.test(r),ws=async(r,t)=>{if(t&&/^https:\/\/lichess\.org\/.{8}/.test(t))return t;const e=new URLSearchParams({pgn:r}).toString();try{const o=await fetch("https://lichess.org/api/import",{headers:{"content-type":"application/x-www-form-urlencoded"},body:e,method:"POST"});if(o.status===200)return(await o.json()).url;throw new Error("Cannot import to lichess")}catch{throw new Error("Cannot import to lichess")}},ys=(r,t)=>Math.round(Math.random()*(r-t))+t,In=r=>{const t=ys(0,r.length-1);return r[t]},Ss=20,$s=(r,t)=>({prev(){r.pause(),r.prev()},next(){r.pause(),r.next()},first(){r.pause(),r.first()},last(){r.pause(),r.last()},togglePlay(){r.playing?r.pause():r.play()},goto(e){r.pause(),r.goto(e)},toggleBorder(){t.toggleBorder(),E("boardConfig","showBorder",!v.boardConfig.showBorder),ce("board")},showBorder(){t.showBorder(),E("boardConfig","showBorder",!0),ce("board")},hideBorder(){t.hideBorder(),E("boardConfig","showBorder",!1),ce("board")},toggleExtraInfo(){t.toggleExtraInfo(),E("boardConfig","showExtraInfo",!v.boardConfig.showExtraInfo),ce("board")},toggleAnonymous(){if(E("anonymous",!v.anonymous),t.anonymous=v.anonymous,v.pgn!==""){const e=v.anonymous?v.game.anonymousPGN:v.game.pgn;it.set({pgn:e}),E("refreshHash",!1)}},toggleTitleScreen(){E("gameConfig","titleScreen",!v.gameConfig.titleScreen),ce("game")},toggleShadows(){t.toggleShadows(),E("boardConfig","showShadows",!v.boardConfig.showShadows),ce("board")},flip(){const e=v.recent.findIndex(o=>o.hash===location.hash);t.flip(),E("boardConfig","flipped",!v.boardConfig.flipped),E("refreshHash",!1),it.set({side:v.boardConfig.flipped?"b":"w"}),e!==-1&&(E("recent",e,"hash",location.hash),ce("recent"))},changeBoardStyle(e){t.setStyle(e),E("boardConfig","boardStyle",e),ce("board")},changePiecesStyle(e){t.setPiecesStyle(e),E("boardConfig","piecesStyle",e),ce("board")},async loadPGN(e,o="w",s=0){const l=new ot().loadPGN(e);E({pgn:l.pgn,fen:"",moves:l.getMoves(),ply:0,game:l}),it.set({pgn:l.pgn,side:o,ply:s}),await r.load(l),E("activeTab","game"),o==="w"?t.flipWhite():t.flipBlack(),E("boardConfig","flipped",o==="b"),document.title=`ShareChess - ${l.getTitle({anonymous:!1})}`,location.hash!==""&&(E("recent",c=>{const h=c.filter(({hash:d})=>d!==location.hash);return h.unshift({hash:location.hash,title:l.getShortTitle({anonymous:v.anonymous})}),h.slice(0,Ss)}),ce("recent"))},async loadFEN(e,o=!0){const s=new ot().loadFEN(e);E({pgn:"",fen:e,moves:s.getMoves(),ply:0,game:s}),await r.load(s),o&&(it.set({fen:v.fen}),E("activeTab","game"));const l=s.getPosition(0).turn;l==="w"?t.flipWhite():t.flipBlack(),E("boardConfig","flipped",l==="b"),document.title=e==="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1"?"ShareChess - Chess With Style":`ShareChess - FEN ${e}`},async load(e){return E("refreshHash",!1),ms(e)?(await this.loadFEN(e),!0):vs(e)?(await this.loadPGN(e),!0):Qn(e)?(await this.importPGN(e),!0):!1},async loadFromClipboard(){const e=await navigator.clipboard.readText();return this.load(e)},async importPGN(e){const o=await lo(e);o.error||await this.loadPGN(o.pgn,o.side)},async downloadImage(){await new Promise(o=>setTimeout(o,0));const e=await ds(v.fen,v.pgn,v.ply,v.boardConfig,v.gameConfig.picSize);Qt(e,`fen_${Date.now()}`,"png")},async downloadAnimation(){await new Promise(s=>setTimeout(s,0));const e=await ps(v.pgn,v.boardConfig,v.gameConfig.format,v.gameConfig.animationSize,v.gameConfig.titleScreen),o=v.game.getFileName(v.anonymous);Qt(e,o,v.gameConfig.format.toLowerCase())},toggleSound(){E("siteConfig","sounds",!v.siteConfig.sounds),ce("site")},toggleSpeech(){E("siteConfig","speech",!v.siteConfig.speech),ce("site")},toggleDarkMode(){E("siteConfig","darkMode",!v.siteConfig.darkMode),ce("site")},async openOnLichess(){if(v.pgn==="")return window.open(`https://lichess.org/analysis/${v.fen.replace(/\s+/g,"_")}`),!0;try{const e=await ws(v.pgn,v.game.header.Site);return window.open(`${e}/${v.boardConfig.flipped?"black":""}`),!0}catch{return!1}},toggleFavoritePieces(e){v.favoritePieces.has(e)?E("favoritePieces",o=>{const s=new Set([...o]);return s.delete(e),s}):E("favoritePieces",o=>{const s=new Set([...o]);return s.add(e),s}),ce("pieces")},toggleFavoriteBoard(e){v.favoriteBoards.has(e)?E("favoriteBoards",o=>{const s=new Set([...o]);return s.delete(e),s}):E("favoriteBoards",o=>{const s=new Set([...o]);return s.add(e),s}),ce("boards")},clearRecent(e){e.preventDefault(),E("recent",v.recent.filter(o=>o.hash===location.hash)),ce("recent")},deleteRecent(e){E("recent",o=>o.filter(l=>l.hash!==e)),ce("recent")},async loadGameOfTheDay(){const e=new Date,o=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),l=String(e.getDate()).padStart(2,"0"),c=`daily-games/${s}.${l}.json`,d=await(await fetch(c)).json(),b=o%d.length,_=d[b];location.hash=`#pgn/w/0/${_}`},async randomStyle(){const e=In(Rt),o=In(Ot);await t.setAllStyles(o,e),E("boardConfig","boardStyle",e),E("boardConfig","piecesStyle",o),ce("board")},togglePuzzle(){t.togglePuzzle(),E("boardConfig","puzzle",!v.boardConfig.puzzle),ce("board")}}),ir=async(r,t,e)=>{E("refreshHash",r);const{pgn:o,fen:s,side:l,ply:c,boardStyle:h,piecesStyle:d}=await it.read();await(o?t.loadPGN(o,l,c):s?t.loadFEN(s):t.loadFEN("rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",!1)),c!==0&&t.goto(c),h&&Rt.includes(h)&&(E("boardConfig","boardStyle",h),e.setStyle(h)),d&&Ot.includes(d)&&(E("boardConfig","piecesStyle",d),e.setPiecesStyle(d)),E("refreshHash",!0)},ks=(r,t)=>{if(document.addEventListener("dblclick",function(e){e.preventDefault()}),window.addEventListener("resize",()=>{E("layout",window.innerWidth<window.innerHeight?"single":window.innerWidth<1366?"double":"triple")}),window.addEventListener("hashchange",()=>{if(!v.refreshHash){E("refreshHash",!0);return}ir(!0,r,t)}),!v.mobile){const e={ArrowLeft:r.prev,ArrowRight:r.next,ArrowUp:r.first,ArrowDown:r.last,f:r.flip," ":r.togglePlay,Enter:r.openOnLichess,l:r.loadFromClipboard.bind(r),a:r.toggleAnonymous,b:r.toggleBorder,i:r.toggleExtraInfo,h:r.toggleTitleScreen,s:r.toggleShadows,p:r.togglePuzzle};document.addEventListener("keydown",s=>{const l=s.target;e[s.key]&&l?.nodeName!=="INPUT"&&l?.nodeName!=="TEXTAREA"&&(s.preventDefault(),e[s.key]())});const o=s=>{s.preventDefault(),s.stopPropagation()};["dragenter","dragover","dragleave","drop"].forEach(s=>{document.addEventListener(s,o,!1)}),document.addEventListener("drop",async s=>{if(s.dataTransfer?.files&&s.dataTransfer.files.length>0){const l=await Zn(s.dataTransfer.files[0]);E("refreshHash",!1),r.loadPGN(l)}})}},As=async()=>{const r=new tn;await r.init(),console.log(v.boardConfig),await r.init(v.boardConfig);const t=new Ei(r,v.gameConfig);t.watch(s=>E("playing",s));const e=$s(t,r);vr(()=>T(fs,{handlers:e,state:v}),document.getElementById("root"));const o=document.getElementById("canvas");await r.setCanvas(o),await t.init(),await ir(!1,e,r),ks(e,r)};As();export{xs as __vite_legacy_guard,Cs as c,Ts as g};
