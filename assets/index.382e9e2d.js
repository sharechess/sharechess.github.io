function Ia(){import("data:text/javascript,")}const ar=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function e(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerpolicy&&(s.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?s.credentials="include":a.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(a){if(a.ep)return;a.ep=!0;const s=e(a);fetch(a.href,s)}};ar();const ze={};function sr(n){ze.context=n}const lr=(n,t)=>n===t,tt=Symbol("solid-proxy"),Wt=Symbol("solid-track"),kt={equals:lr};let In=Mn;const Ke=1,At=2,On={owned:null,cleanups:null,context:null,owner:null};var ye=null;let et=null,he=null,Se=null,He=null,Zt=0;function St(n,t){const e=he,o=ye,a=n.length===0,s=a?On:{owned:null,cleanups:null,context:null,owner:t||o},c=a?n:()=>n(()=>nt(()=>en(s)));ye=s,he=null;try{return lt(c,!0)}finally{he=e,ye=o}}function Fe(n,t){t=t?Object.assign({},kt,t):kt;const e={value:n,observers:null,observerSlots:null,comparator:t.equals||void 0},o=a=>(typeof a=="function"&&(a=a(e.value)),Bn(e,a));return[Rn.bind(e),o]}function Z(n,t,e){const o=Jt(n,t,!1,Ke);mt(o)}function cr(n,t,e){In=pr;const o=Jt(n,t,!1,Ke);o.user=!0,He?He.push(o):mt(o)}function Xe(n,t,e){e=e?Object.assign({},kt,e):kt;const o=Jt(n,t,!0,0);return o.observers=null,o.observerSlots=null,o.comparator=e.equals||void 0,mt(o),Rn.bind(o)}function ur(n){return lt(n,!1)}function nt(n){let t,e=he;return he=null,t=n(),he=e,t}function dr(n){return ye===null||(ye.cleanups===null?ye.cleanups=[n]:ye.cleanups.push(n)),n}function Ln(){return he}function fr(n){const t=Xe(n),e=Xe(()=>Ut(t()));return e.toArray=()=>{const o=e();return Array.isArray(o)?o:o!=null?[o]:[]},e}function Rn(){const n=et;if(this.sources&&(this.state||n))if(this.state===Ke||n)mt(this);else{const t=Se;Se=null,lt(()=>Tt(this),!1),Se=t}if(he){const t=this.observers?this.observers.length:0;he.sources?(he.sources.push(this),he.sourceSlots.push(t)):(he.sources=[this],he.sourceSlots=[t]),this.observers?(this.observers.push(he),this.observerSlots.push(he.sources.length-1)):(this.observers=[he],this.observerSlots=[he.sources.length-1])}return this.value}function Bn(n,t,e){let o=n.value;return(!n.comparator||!n.comparator(o,t))&&(n.value=t,n.observers&&n.observers.length&&lt(()=>{for(let a=0;a<n.observers.length;a+=1){const s=n.observers[a],c=et&&et.running;c&&et.disposed.has(s),(c&&!s.tState||!c&&!s.state)&&(s.pure?Se.push(s):He.push(s),s.observers&&zn(s)),c||(s.state=Ke)}if(Se.length>1e6)throw Se=[],new Error},!1)),t}function mt(n){if(!n.fn)return;en(n);const t=ye,e=he,o=Zt;he=ye=n,hr(n,n.value,o),he=e,ye=t}function hr(n,t,e){let o;try{o=n.fn(t)}catch(a){n.pure&&(n.state=Ke),Fn(a)}(!n.updatedAt||n.updatedAt<=e)&&(n.updatedAt!=null&&"observers"in n?Bn(n,o):n.value=o,n.updatedAt=e)}function Jt(n,t,e,o=Ke,a){const s={fn:n,state:o,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:ye,context:null,pure:e};return ye===null||ye!==On&&(ye.owned?ye.owned.push(s):ye.owned=[s]),s}function xt(n){const t=et;if(n.state===0||t)return;if(n.state===At||t)return Tt(n);if(n.suspense&&nt(n.suspense.inFallback))return n.suspense.effects.push(n);const e=[n];for(;(n=n.owner)&&(!n.updatedAt||n.updatedAt<Zt);)(n.state||t)&&e.push(n);for(let o=e.length-1;o>=0;o--)if(n=e[o],n.state===Ke||t)mt(n);else if(n.state===At||t){const a=Se;Se=null,lt(()=>Tt(n,e[0]),!1),Se=a}}function lt(n,t){if(Se)return n();let e=!1;t||(Se=[]),He?e=!0:He=[],Zt++;try{const o=n();return _r(e),o}catch(o){Se||(He=null),Fn(o)}}function _r(n){if(Se&&(Mn(Se),Se=null),n)return;const t=He;He=null,t.length&&lt(()=>In(t),!1)}function Mn(n){for(let t=0;t<n.length;t++)xt(n[t])}function pr(n){let t,e=0;for(t=0;t<n.length;t++){const o=n[t];o.user?n[e++]=o:xt(o)}for(ze.context&&sr(),t=0;t<e;t++)xt(n[t])}function Tt(n,t){const e=et;n.state=0;for(let o=0;o<n.sources.length;o+=1){const a=n.sources[o];a.sources&&(a.state===Ke||e?a!==t&&xt(a):(a.state===At||e)&&Tt(a,t))}}function zn(n){const t=et;for(let e=0;e<n.observers.length;e+=1){const o=n.observers[e];(!o.state||t)&&(o.state=At,o.pure?Se.push(o):He.push(o),o.observers&&zn(o))}}function en(n){let t;if(n.sources)for(;n.sources.length;){const e=n.sources.pop(),o=n.sourceSlots.pop(),a=e.observers;if(a&&a.length){const s=a.pop(),c=e.observerSlots.pop();o<a.length&&(s.sourceSlots[c]=o,a[o]=s,e.observerSlots[o]=c)}}if(n.owned){for(t=0;t<n.owned.length;t++)en(n.owned[t]);n.owned=null}if(n.cleanups){for(t=0;t<n.cleanups.length;t++)n.cleanups[t]();n.cleanups=null}n.state=0,n.context=null}function gr(n){return n instanceof Error||typeof n=="string"?n:new Error("Unknown error")}function Fn(n){throw n=gr(n),n}function Ut(n){if(typeof n=="function"&&!n.length)return Ut(n());if(Array.isArray(n)){const t=[];for(let e=0;e<n.length;e++){const o=Ut(n[e]);Array.isArray(o)?t.push.apply(t,o):t.push(o)}return t}return n}const mr=Symbol("fallback");function ln(n){for(let t=0;t<n.length;t++)n[t]()}function br(n,t,e={}){let o=[],a=[],s=[],c=0,h=t.length>1?[]:null;return dr(()=>ln(s)),()=>{let f=n()||[],b,p;return f[Wt],nt(()=>{let i=f.length,l,u,d,_,g,$,y,k,N;if(i===0)c!==0&&(ln(s),s=[],o=[],a=[],c=0,h&&(h=[])),e.fallback&&(o=[mr],a[0]=St(M=>(s[0]=M,e.fallback())),c=1);else if(c===0){for(a=new Array(i),p=0;p<i;p++)o[p]=f[p],a[p]=St(r);c=i}else{for(d=new Array(i),_=new Array(i),h&&(g=new Array(i)),$=0,y=Math.min(c,i);$<y&&o[$]===f[$];$++);for(y=c-1,k=i-1;y>=$&&k>=$&&o[y]===f[k];y--,k--)d[k]=a[y],_[k]=s[y],h&&(g[k]=h[y]);for(l=new Map,u=new Array(k+1),p=k;p>=$;p--)N=f[p],b=l.get(N),u[p]=b===void 0?-1:b,l.set(N,p);for(b=$;b<=y;b++)N=o[b],p=l.get(N),p!==void 0&&p!==-1?(d[p]=a[b],_[p]=s[b],h&&(g[p]=h[b]),p=u[p],l.set(N,p)):s[b]();for(p=$;p<i;p++)p in d?(a[p]=d[p],s[p]=_[p],h&&(h[p]=g[p],h[p](p))):a[p]=St(r);a=a.slice(0,c=i),o=f.slice(0)}return a});function r(i){if(s[p]=i,h){const[l,u]=Fe(p);return h[p]=u,t(f[p],l)}return t(f[p])}}}function x(n,t){return nt(()=>n(t||{}))}function qe(n){const t="fallback"in n&&{fallback:()=>n.fallback};return Xe(br(()=>n.each,n.children,t||void 0))}function G(n){let t=!1;const e=n.keyed,o=Xe(()=>n.when,void 0,{equals:(a,s)=>t?a===s:!a==!s});return Xe(()=>{const a=o();if(a){const s=n.children,c=typeof s=="function"&&s.length>0;return t=e||c,c?nt(()=>s(a)):s}return n.fallback})}function Dn(n){let t=!1,e=!1;const o=fr(()=>n.children),a=Xe(()=>{let s=o();Array.isArray(s)||(s=[s]);for(let c=0;c<s.length;c++){const h=s[c].when;if(h)return e=!!s[c].keyed,[c,h,s[c]]}return[-1]},void 0,{equals:(s,c)=>s[0]===c[0]&&(t?s[1]===c[1]:!s[1]==!c[1])&&s[2]===c[2]});return Xe(()=>{const[s,c,h]=a();if(s<0)return n.fallback;const f=h.children,b=typeof f=="function"&&f.length>0;return t=e||b,b?nt(()=>f(c)):f})}function We(n){return n}function Hn(n,t){return Xe(n,void 0,t?void 0:{equals:t})}function vr(n,t,e){let o=e.length,a=t.length,s=o,c=0,h=0,f=t[a-1].nextSibling,b=null;for(;c<a||h<s;){if(t[c]===e[h]){c++,h++;continue}for(;t[a-1]===e[s-1];)a--,s--;if(a===c){const p=s<o?h?e[h-1].nextSibling:e[s-h]:f;for(;h<s;)n.insertBefore(e[h++],p)}else if(s===h)for(;c<a;)(!b||!b.has(t[c]))&&t[c].remove(),c++;else if(t[c]===e[s-1]&&e[h]===t[a-1]){const p=t[--a].nextSibling;n.insertBefore(e[h++],t[c++].nextSibling),n.insertBefore(e[--s],p),t[a]=e[s]}else{if(!b){b=new Map;let r=h;for(;r<s;)b.set(e[r],r++)}const p=b.get(t[c]);if(p!=null)if(h<p&&p<s){let r=c,i=1,l;for(;++r<a&&r<s&&!((l=b.get(t[r]))==null||l!==p+i);)i++;if(i>p-h){const u=t[c];for(;h<p;)n.insertBefore(e[h++],u)}else n.replaceChild(e[h++],t[c++])}else c++;else t[c++].remove()}}}const cn="_$DX_DELEGATE";function wr(n,t,e){let o;return St(a=>{o=a,t===document?n():I(t,n(),t.firstChild?null:void 0,e)}),()=>{o(),t.textContent=""}}function E(n,t,e){const o=document.createElement("template");o.innerHTML=n;let a=o.content.firstChild;return e&&(a=a.firstChild),a}function xe(n,t=window.document){const e=t[cn]||(t[cn]=new Set);for(let o=0,a=n.length;o<a;o++){const s=n[o];e.has(s)||(e.add(s),t.addEventListener(s,Sr))}}function oe(n,t,e){e==null?n.removeAttribute(t):n.setAttribute(t,e)}function bt(n,t){t==null?n.removeAttribute("class"):n.className=t}function ue(n,t,e,o){if(o)Array.isArray(e)?(n[`$$${t}`]=e[0],n[`$$${t}Data`]=e[1]):n[`$$${t}`]=e;else if(Array.isArray(e)){const a=e[0];n.addEventListener(t,e[0]=s=>a.call(n,e[1],s))}else n.addEventListener(t,e)}function yr(n,t,e){return nt(()=>n(t,e))}function I(n,t,e,o){if(e!==void 0&&!o&&(o=[]),typeof t!="function")return Ct(n,t,o,e);Z(a=>Ct(n,t(),a,e),o)}function Sr(n){const t=`$$${n.type}`;let e=n.composedPath&&n.composedPath()[0]||n.target;for(n.target!==e&&Object.defineProperty(n,"target",{configurable:!0,value:e}),Object.defineProperty(n,"currentTarget",{configurable:!0,get(){return e||document}}),ze.registry&&!ze.done&&(ze.done=!0,document.querySelectorAll("[id^=pl-]").forEach(o=>o.remove()));e!==null;){const o=e[t];if(o&&!e.disabled){const a=e[`${t}Data`];if(a!==void 0?o.call(e,a,n):o.call(e,n),n.cancelBubble)return}e=e.host&&e.host!==e&&e.host instanceof Node?e.host:e.parentNode}}function Ct(n,t,e,o,a){for(ze.context&&!e&&(e=[...n.childNodes]);typeof e=="function";)e=e();if(t===e)return e;const s=typeof t,c=o!==void 0;if(n=c&&e[0]&&e[0].parentNode||n,s==="string"||s==="number"){if(ze.context)return e;if(s==="number"&&(t=t.toString()),c){let h=e[0];h&&h.nodeType===3?h.data=t:h=document.createTextNode(t),e=rt(n,e,o,h)}else e!==""&&typeof e=="string"?e=n.firstChild.data=t:e=n.textContent=t}else if(t==null||s==="boolean"){if(ze.context)return e;e=rt(n,e,o)}else{if(s==="function")return Z(()=>{let h=t();for(;typeof h=="function";)h=h();e=Ct(n,h,e,o)}),()=>e;if(Array.isArray(t)){const h=[],f=e&&Array.isArray(e);if(Vt(h,t,e,a))return Z(()=>e=Ct(n,h,e,o,!0)),()=>e;if(ze.context){if(!h.length)return e;for(let b=0;b<h.length;b++)if(h[b].parentNode)return e=h}if(h.length===0){if(e=rt(n,e,o),c)return e}else f?e.length===0?un(n,h,o):vr(n,e,h):(e&&rt(n),un(n,h));e=h}else if(t instanceof Node){if(ze.context&&t.parentNode)return e=c?[t]:t;if(Array.isArray(e)){if(c)return e=rt(n,e,o,t);rt(n,e,null,t)}else e==null||e===""||!n.firstChild?n.appendChild(t):n.replaceChild(t,n.firstChild);e=t}}return e}function Vt(n,t,e,o){let a=!1;for(let s=0,c=t.length;s<c;s++){let h=t[s],f=e&&e[s];if(h instanceof Node)n.push(h);else if(!(h==null||h===!0||h===!1))if(Array.isArray(h))a=Vt(n,h,f)||a;else if(typeof h=="function")if(o){for(;typeof h=="function";)h=h();a=Vt(n,Array.isArray(h)?h:[h],Array.isArray(f)?f:[f])||a}else n.push(h),a=!0;else{const b=String(h);f&&f.nodeType===3&&f.data===b?n.push(f):n.push(document.createTextNode(b))}}return a}function un(n,t,e){for(let o=0,a=t.length;o<a;o++)n.insertBefore(t[o],e)}function rt(n,t,e,o){if(e===void 0)return n.textContent="";const a=o||document.createTextNode("");if(t.length){let s=!1;for(let c=t.length-1;c>=0;c--){const h=t[c];if(a!==h){const f=h.parentNode===n;!s&&!c?f?n.replaceChild(a,h):n.insertBefore(a,e):f&&h.remove()}else s=!0}}else n.insertBefore(a,e);return[a]}const $r={horizontal:[0,0,1,0],vertical:[0,0,0,1],"diagonal-top":[0,0,1,1],"diagonal-bottom":[0,1,1,0]},kr=(n,t,e,o,a,s)=>{let c;if(t.dir==="radial"){const f=Math.sqrt((e/2)**2+(o/2)**2);c=n.createRadialGradient(a+e/2,s+o/2,f,a+e/2,s+o/2,0)}else{const[f,b,p,r]=$r[t.dir];c=n.createLinearGradient(a+f*e,s+b*o,a+p*e,s+r*o)}const h=t.colors.length-1;return t.colors.forEach((f,b)=>{c.addColorStop(b/h,f)}),c},De=async(n,t,e,o,a,s,c,h=8)=>{const f=Array.isArray(s)?s:[s];for(const b of f){if(b.type==="image"){const r=await c(b.data.src);h<8?n.drawImage(r,0,0,r.width*(h/8),r.height*(h/8),o,a,t,e):n.drawImage(r,o,a,t,e);continue}const p=await(b.type==="solid"?b.data.color:kr(n,b.data,t,e,o,a));if(p===null)throw new Error("Cannot create canvas fill style");n.fillStyle=p,n.fillRect(o,a,t,e)}},Ar=22,xr="Fira Mono",dn=(n,t,e,o,a=!1,s,c,h,f)=>{const b=c/1024;if(b<=.32)return;const p=Ar*b,r=6*b,i=4*b,l="1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26".split(",").slice(0,o),u=a?l:l.reverse();n.font=`${p}px ${xr}`,n.textBaseline=h?"middle":"top",u.forEach((g,$)=>{n.fillStyle=s>0?t.onBorder:$%2===0?t.onLight:t.onDark;const y=h?s/2:r,k=(h?e*$+s+e/2:e*$+r)+f;n.textAlign=h?"center":"left",n.fillText(g,y,k)});const d="abcdefghijklmnopqrstuwvxyz".split("").slice(0,o),_=a?d.reverse():d;n.textBaseline=h?"middle":"bottom",_.forEach((g,$)=>{n.fillStyle=s>0?t.onBorder:$%2===0?t.onDark:t.onLight;const y=h?e*$+s+e/2:e*$+r,k=(h?c-s/2:c-i)+f;n.textAlign=h?"center":"left",n.fillText(g,y,k)})},Tr="abcdefghijklmnopqrstuwvxyz",fn=(n,t,e)=>{const o=Tr.indexOf(n[0]),a=Number(n[1])-1;return[t?e-o-1:o,t?a:e-a-1]},Cr=async(n,t,e,{moveIndicator:o},a,s,c,h,f)=>{const[b,p]=fn(t.from,c,s),[r,i]=fn(t.to,c,s),[l,u,d,_]=[b,p,r,i].map($=>$*e+a),g={type:"solid",data:{color:o.color}};De(n,e,e,l,u+h,g,f),De(n,e,e,d,_+h,g,f)},Qe={hidden:["tagged","anarchy-plug","anarchy-plug_candy","anarchy-plug_fresh","anarchy-plug_sepia"],modern:["tatiana","tatiana_wood","tatiana_calm","tatiana_sweet","staunty","staunty_wood","staunty_blue","staunty_lila","libra","libra_wood","libra_plum","libra_sea","governor_bw","governor","governor_patina","governor_purple","riohacha","riohacha_spring","riohacha_winter","riohacha_cute","gioco","gioco_wood","gioco_metal","gioco_purple","pirouetti","pirouetti_mint","pirouetti_summer","pirouetti_dream","pirouetti_border","pirouetti_border_winter","pirouetti_border_coral","pirouetti_border_grass","kosal","kosal_blue","kosal_violet","kosal_red","dubrovny_bw","dubrovny","dubrovny_brown","dubrovny_green","alfarishy","alfarishy_blue","alfarishy_pink","alfarishy_berry","dmuysi","dmuysi_marzipan","dmuysi_kournikova","dmuysi_cotton","icon54","icon54_gray","icon54_brown","icon54_neon","saakyan","saakyan_blue","saakyan_grape","saakyan_coco","trendy","trendy_ink","trendy_brown","trendy_fresh","vecon","vecon_baltic","vecon_hemlock","vecon_cute","echiquier","echiquier_ink","echiquier_flesh","echiquier_grape"],classic:["merida","merida_ink","merida_cyan","merida_traffic","cburnett","cburnett_brown","cburnett_blue","cburnett_purple","alpha","alpha_ink","alpha_wood","alpha_mint","cases","cases_cocoa","cases_gray","cases_forest","chessnut","chessnut_blue","chessnut_brown","chessnut_burgundy","maestro","maestro_blue","maestro_pink","maestro_brown","cardinal","cardinal_blue","cardinal_brown","cardinal_green","companion","companion_red","companion_cyan","companion_eggplant","fresca","fresca_matisse","fresca_zucchini","fresca_camelot","magnetic","magnetic_brown","magnetic_lila","magnetic_orange","maya","maya_brown","maya_warm","maya_cold","fantasy","fantasy_calm","fantasy_warm","fantasy_cold","chess7","chess7_pink","chess7_calm","chess7_yellow","regular","regular_ink","regular_green","regular_purple","condal","condal_cold","condal_warm","condal_mustard","mediaeval","mediaeval_brown","mediaeval_green","mediaeval_orange","reillycraig","reillycraig_tamarind","reillycraig_lawn","reillycraig_dixie","smart","smart_apricot","smart_blue","smart_cocoa","icpieces","icpieces_blue","icpieces_maroon","icpieces_brown","leipzig","leipzig_niagara","leipzig_berry","leipzig_nature","motif","motif_maroon","motif_purple","motif_green","marroquin","marroquin_rajah","marroquin_eggplant","marroquin_toy","harlequin","harlequin_gold","harlequin_peach","harlequin_neon","lucena","lucena_brown","lucena_blue","lucena_pink","adventurer","adventurer_brown","adventurer_grass","adventurer_berry","kingdom","kingdom_blue","kingdom_brown","kingdom_sulu","traveller","traveller_brown","traveller_blue","traveller_green","oldstyle","oldstyle_bondi","oldstyle_brown","oldstyle_gossip"],fun:["anarchy","anarchy_candy","anarchy_fresh","anarchy_sepia","qootee","qootee_summer","qootee_pink","qootee_grape","horsey","horsey_blue","horsey_purple","horsey_pink","caliente","caliente_wood","caliente_blue","caliente_pink","california","california_brown","california_green","california_red","pixel","pixel_spring","pixel_neon","pixel_juicy","checkers","checkers_wood","checkers_grape","checkers_cute"],unusual:["alfonso-x","alfonso-x_brown","alfonso-x_grape","alfonso-x_toy","mark","mark_brown","mark_grape","mark_green","berlin","berlin_blue","berlin_maroon","berlin_loulou","line","line_berry","line_purple","line_toy","spatial","spatial_blue","spatial_salmon","spatial_summer","pirat","pirat_sea","pirat_maroon","pirat_peach","tfb","tfb_brown","tfb_green","tfb_purple","wisdom","wisdom_brown","wisdom_blue","wisdom_grape","utrecht","utrecht_mirage","utrecht_violet","utrecht_crimson","symmetric","symmetric_blue","symmetric_brown","symmetric_purple","millennia","millennia_blue","millennia_sand","millennia_green","shapes","shapes_blue","shapes_brown","shapes_cute","letters","letters_warm","letters_cold","letters_dim"],seasonal:["anarchy_halloween","condal_halloween"]},Ot=[...Qe.hidden,...Qe.modern,...Qe.classic,...Qe.fun,...Qe.unusual,...Qe.seasonal],Er=["bb","bw","kb","kw","nb","nw","pb","pw","qb","qw","rb","rw"];let hn=null,_n=new Map;const Pr={async load(n,t){await Promise.all(Er.map(e=>{const o=`/pieces/${n}/${e}.svg`;return t(o).then(a=>{_n.set(e,a)})}))},async get(n,t,e,o){hn!==n&&(await this.load(n,o),hn=n);const a=`${t}${e}`;return _n.get(a)}},Nr=async(n,t,e,o,a,s,c,h=!0,f)=>{const{placement:b,check:p,mate:r,turn:i}=t;n.shadowColor="rgba(0, 0, 0, 0)",n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0;for(const{x:l,y:u,type:d,color:_}of b){const g=await Pr.get(c,d,_,f),$=a?8-1-u:u,y=a?8-1-l:l;if((p||r)&&d==="k"&&_===i){const k=r?"#ff002f":"#ffa600";n.shadowColor=k,n.shadowBlur=e*.15,n.shadowOffsetX=0,n.shadowOffsetY=0,n.drawImage(g,o+y*e,o+$*e+s,e,e)}else h&&(n.shadowColor="rgba(0, 0, 0, 0.5)",n.shadowOffsetX=e*.07,n.shadowOffsetY=e*.07,n.shadowBlur=e*.1);n.drawImage(g,o+y*e,o+$*e+s,e,e),n.shadowColor="rgba(0, 0, 0, 0)",n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0}};var Ze=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ir(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function Oa(n){if(n.__esModule)return n;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(n).forEach(function(e){var o=Object.getOwnPropertyDescriptor(n,e);Object.defineProperty(t,e,o.get?o:{enumerable:!0,get:function(){return n[e]}})}),t}function La(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var qn={exports:{}};/*!
 * 
 *   canvas-txt v3.0.0
 *   https://github.com/geongeorge/Canvas-Txt
 * 
 *   Copyright (c) Geon George (https://geongeorge.com)
 * 
 *   This source code is licensed under the MIT license found in the
 *   LICENSE file in the root directory of this source tree.
 * 
 */(function(n,t){(function(e,o){n.exports=o()})(typeof self<"u"?self:Ze,function(){return function(e){var o={};function a(s){if(o[s])return o[s].exports;var c=o[s]={i:s,l:!1,exports:{}};return e[s].call(c.exports,c,c.exports,a),c.l=!0,c.exports}return a.m=e,a.c=o,a.d=function(s,c,h){a.o(s,c)||Object.defineProperty(s,c,{enumerable:!0,get:h})},a.r=function(s){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},a.t=function(s,c){if(1&c&&(s=a(s)),8&c||4&c&&typeof s=="object"&&s&&s.__esModule)return s;var h=Object.create(null);if(a.r(h),Object.defineProperty(h,"default",{enumerable:!0,value:s}),2&c&&typeof s!="string")for(var f in s)a.d(h,f,function(b){return s[b]}.bind(null,f));return h},a.n=function(s){var c=s&&s.__esModule?function(){return s.default}:function(){return s};return a.d(c,"a",c),c},a.o=function(s,c){return Object.prototype.hasOwnProperty.call(s,c)},a.p="",a(a.s=0)}([function(e,o,a){function s(f,b){return function(p){if(Array.isArray(p))return p}(f)||function(p,r){if(typeof Symbol<"u"&&Symbol.iterator in Object(p)){var i=[],l=!0,u=!1,d=void 0;try{for(var _,g=p[Symbol.iterator]();!(l=(_=g.next()).done)&&(i.push(_.value),!r||i.length!==r);l=!0);}catch($){u=!0,d=$}finally{try{l||g.return==null||g.return()}finally{if(u)throw d}}return i}}(f,b)||function(p,r){if(p){if(typeof p=="string")return c(p,r);var i=Object.prototype.toString.call(p).slice(8,-1);return i==="Object"&&p.constructor&&(i=p.constructor.name),i==="Map"||i==="Set"?Array.from(i):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?c(p,r):void 0}}(f,b)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function c(f,b){(b==null||b>f.length)&&(b=f.length);for(var p=0,r=Array(b);p<b;p++)r[p]=f[p];return r}a.r(o);var h={debug:!1,align:"center",vAlign:"middle",fontSize:14,fontWeight:"",fontStyle:"",fontVariant:"",font:"Arial",lineHeight:null,justify:!1,drawText:function(f,b,p,r,i,l){var u=this,d=s([p,r,i,l].map(function(ve){return parseInt(ve)}),4);if(p=d[0],r=d[1],i=d[2],l=d[3],!(0>=i||0>=l||0>=this.fontSize)){var _=p+i,g=r+l;this.textSize&&console.error("%cCanvas-Txt:","font-weight: bold;","textSize is depricated and has been renamed to fontSize");var $=this.fontStyle,y=this.fontVariant,k=this.fontWeight,N=this.fontSize,M=this.font,F="".concat($," ").concat(y," ").concat(k," ").concat(N,"px ").concat(M);f.font=F;var Y,L=r+l/2+parseInt(this.fontSize)/2;this.align==="right"?(Y=_,f.textAlign="right"):this.align==="left"?(Y=p,f.textAlign="left"):(Y=p+i/2,f.textAlign="center");var ne=[],pe=b.split(`
`),Oe=this.justify?f.measureText("\u200A").width:0;pe.forEach(function(ve){var de=f.measureText(ve).width;if(de<=i)ne.push(ve);else{var ie,Le,ge,we=ve,m=i;for(de=f.measureText(we).width;de>m;){for(ie=0,Le=0,ge="";Le<m;)ie++,ge=we.substr(0,ie),Le=f.measureText(we.substr(0,ie)).width;ie--,ge=ge.substr(0,ie);var w=ie;if(we.substr(ie,1)!=" "){for(;we.substr(ie,1)!=" "&&ie!=0;)ie--;ie==0&&(ie=w),ge=we.substr(0,ie)}ge=u.justify?u.justifyLine(f,ge,Oe,"\u200A",i):ge,we=we.substr(ie),de=f.measureText(we).width,ne.push(ge)}0<de&&ne.push(we)}});var me=this.lineHeight?this.lineHeight:this.getTextHeight(f,b,F),_e=me*(ne.length-1),Ce=r;return this.vAlign==="top"?L=r+this.fontSize:this.vAlign==="bottom"?(L=g-_e,Ce=g):(Ce=r+l/2,L-=_e/2),ne.forEach(function(ve){ve=ve.trim(),f.fillText(ve,Y,L),L+=me}),this.debug&&(f.lineWidth=3,f.strokeStyle="#00909e",f.strokeRect(p,r,i,l),f.lineWidth=2,f.strokeStyle="#f6d743",f.beginPath(),f.moveTo(Y,r),f.lineTo(Y,g),f.stroke(),f.strokeStyle="#ff6363",f.beginPath(),f.moveTo(p,Ce),f.lineTo(_,Ce),f.stroke()),{height:_e+me}}},getTextHeight:function(f,b,p){var r=f.textBaseline,i=f.font;f.textBaseline="bottom",f.font=p;var l=f.measureText(b).actualBoundingBoxAscent;return f.textBaseline=r,f.font=i,l},justifyLine:function(f,b,p,r,i){var l=Math.floor,u=b.trim(),d=f.measureText(u).width,_=u.split(/\s+/).length-1,g=l((i-d)/p);if(0>=_||0>=g)return u;for(var $=l(g/_),y=g-_*$,k=[],N=0;N<$;N++)k.push(r);return k=k.join(""),u.replace(/\s+/g,function(M){var F=0<y?k+r:k;return y--,M+F})}};o.default=h}])})})(qn);var ut=Ir(qn.exports);const $e=(n,t,e,o,a,s,c,h,f)=>(n.font=`${a} ${o}px ${e}`,n.textAlign=h,n.textBaseline="middle",n.fillText(t,s,c,f),Math.ceil(n.measureText(t).width)),Or=async n=>{let t;t=await(await fetch("/img/logo-full-mono.svg")).text();const e=t.replace(/black/g,n);return`data:image/svg+xml;base64,${btoa(e)}`},Lr=async(n,t,e,o,a,s)=>{const c=s.PuzzleMotif??"Solve the Puzzle",h=s.PuzzleDescription??"";n.fillStyle=a.coords.onBorder,$e(n,c,"Ubuntu",42*e,700,t/2,(t*e+o)/4,"center"),ut.fontSize=30*e,ut.lineHeight=35*e,ut.align="left",ut.font="Ubuntu",ut.drawText(n,h,t*.1,0,t*.8,t+o*2)},Rr=async(n,t,e,o,a,s,c,h)=>{if(n.clearRect(0,0,t,t),await De(n,t,t+o*2,0,0,a.border,c),h)Lr(n,t,e,o,a,s);else{const i="Ubuntu",l=[{key:"WhitePretty",line:60*e,fontSize:42*e,n:0},{key:"BlackPretty",line:60*e,fontSize:42*e,n:2},{key:"Event",line:30*e,fontSize:20*e,n:4},{key:"Round",line:30*e,fontSize:20*e,n:5},{key:"DatePretty",line:30*e,fontSize:20*e,n:7},{key:"Site",line:30*e,fontSize:20*e,n:8}],u=new Set(Object.keys(s)),d=l.filter(({key:$})=>u.has($));if(s.WhitePretty&&s.BlackPretty&&d.push({key:"vs",line:50*e,fontSize:20*e,n:1}),(s.Event||s.Round)&&d.push({key:"margin",line:100*e,fontSize:0,n:3}),s.Date||s.Site){const $=s.Event||s.Round?20*e:100*e;d.push({key:"margin",line:$,fontSize:0,n:6})}const _=d.reduce(($,y)=>$+y.line,0);let g=(t+o*2-_)/2;n.fillStyle=a.coords.onBorder,d.sort(($,y)=>$.n-y.n).forEach(({key:$,line:y,fontSize:k})=>{if($==="vs"){const M=g+y/2;$e(n,"vs",i,k,700,t/2,M,"center"),g+=y;return}if($==="margin"){g+=y;return}const N=s[$];if(N){const M=$==="Round"?`Round ${N}`:N,F=g+y/2;$e(n,M,i,k,700,t/2,F,"center",t*.9)}g+=y})}const f=await Or(a.coords.onBorder),b=await c(f),p=t*.6,r=b.height*(p/b.width);n.drawImage(b,t*.2,o+t+o-r*2,p,r)},pn={k:"l",q:"w",r:"t",b:"n",n:"j",p:"o"},Br=async(n,t,e,o,a,s,c,h,f,b)=>{const p=Math.round(20*o);let r=(a-p)/2,i=a/2;const l=r;if(n.fillStyle=s.coords.onBorder,b)$e(n,`Find the best move for ${f.turn==="b"?"black":"white"}.`,"Ubuntu",p,700,l,e-i,"left"),$e(n,c.PuzzleTitle??"sharechess.github.io","Ubuntu",p,700,l,i,"left");else{{const k=$e(n,c.White==="Anonymous"?"White":c.White,"Ubuntu",p,700,l,h?i:e-i,"left"),N=c.WhiteElo?` ${c.WhiteElo}`:"";$e(n,N,"Fira Mono",p,500,l+k,h?i:e-i,"left")}{const k=$e(n,c.Black==="Anonymous"?"Black":c.Black,"Ubuntu",p,700,l,h?e-i:i,"left"),N=c.BlackElo?` ${c.BlackElo}`:"";$e(n,N,"Fira Mono",p,500,l+k,h?e-i:i,"left")}}let u=0,d=0;if(f.last&&c.Result){const[k,N]=c.Result.split("-"),M=k==="0"?"Lost":k==="1"?"Won":"Draw",F=N==="0"?"Lost":N==="1"?"Won":"Draw",Y=$e(n,M,"Ubuntu",p,700,t-r,h?i:e-i,"right"),L=$e(n,F,"Ubuntu",p,700,t-r,h?e-i:i,"right"),ne=Math.max(Y,L);u=ne+20*o,d=ne+20*o}const{diff:_,imbalance:g}=f.material,$=_>0?`+${Math.abs(_)}`:"";u+=$e(n,$,"Fira Mono",p,500,t-r-u,h?i:e-i,"right");const y=_<0?`+${Math.abs(_)}`:"";d+=$e(n,y,"Fira Mono",p,500,t-r-d,h?e-i:i,"right");for(const[k,N]of Object.entries(g.w))for(let M=0;M<N;M++){const F=$e(n,pn[k],"Chess",p,500,t-r-u,(h?i:e-i)-2*o,"right");u+=M===N-1?F*.85:k==="p"?F*.4:F*.6}for(const[k,N]of Object.entries(g.b))for(let M=0;M<N;M++){const F=$e(n,pn[k],"Chess",p,500,t-r-d,(h?e-i:i)-2*o,"right");d+=M===N-1?F*.85:k==="p"?F*.4:F*.6}},Et=n=>{if(n===null)return!1;try{return new URL(n),!0}catch{return!1}},Mr=n=>new Promise(t=>{const e=new Image;e.addEventListener("load",()=>t(e),{once:!0}),e.src=n}),zr={category:"solid",background:{type:"solid",data:{color:"transparent"}},dark:{type:"solid",data:{color:"#00ad88"}},light:{type:"solid",data:{color:"#9EE0BC"}},moveIndicator:{color:"#ffff0055"},border:{type:"solid",data:{color:"#00735a"}},coords:{onLight:"#00735a",onDark:"#d4fff5",onBorder:"#bbfaec"}},Fr={size:720,tiles:8,boardStyle:"standard",piecesStyle:"tatiana",showBorder:!0,showExtraInfo:!0,showMaterial:!0,showMoveIndicator:!0,showChecks:!0,showCoords:!0,showShadows:!1,flipped:!1,puzzle:!1},Dr={White:"White",Black:"Black",WhitePretty:"White",BlackPretty:"Black",WhiteElo:null,BlackElo:null,Date:null,DatePretty:null,Event:null,Round:null,Site:null,Result:null,PuzzleTitle:null,PuzzleMotif:null,PuzzleDescription:null},Hr=n=>fetch(`/board-templates/${n}.json`).then(t=>t.json());class tn{constructor(t=Mr,e=()=>document.createElement("canvas"),o=Hr){this.loadImage=t,this.createCanvas=e,this.loadStyle=o,this.canvas=this.createCanvas(),this.tempCanvas=this.createCanvas();const a=this.canvas.getContext("2d"),s=this.tempCanvas.getContext("2d");if(a===null||s===null)throw new Error("Cannot create canvas 2D context");this.ctx=a,this.tempCtx=s}cfg=Fr;_anonymous=!1;scale=1;borderScale=1;borderOnly=!1;hollow=!1;size=0;squareSize=0;innerSize=0;borderWidth=0;margin=0;style=zr;header=Dr;lastPosition=null;background=null;currentScreen="move";ctx;tempCtx;tempCanvas;canvas;async init(t={}){await this.updateConfig(t,!1)}async setCanvas(t){this.canvas=t,this.ctx=t.getContext("2d"),this.setSize(this.cfg.size),await this.refresh()}async updateConfig(t,e=!0){const o={...this.cfg,...t};this.cfg=o,this.setSize(o.size),await this.setStyle(o.boardStyle,e),e&&await this.refresh()}set anonymous(t){this._anonymous=t,this.refresh()}async refresh(){await this.renderBackground(),this.currentScreen==="title"?await this.titleFrame(this.header):this.lastPosition!==null&&await this.frame(this.lastPosition,this.header),await this.render()}setSize(t){this.size=t,this.scale=t/720,this.margin=this.cfg.showExtraInfo?Math.round(50*this.scale):0;const e=t+this.margin*2;(this.canvas.width!==t||this.canvas.height!==e)&&(this.canvas.width=t,this.canvas.height=e,this.tempCanvas.width=t,this.tempCanvas.height=e);const o=this.cfg.showBorder?this.size/32*this.borderScale:0,a=this.size-o*2;return this.squareSize=Math.floor(a/this.cfg.tiles),this.innerSize=this.squareSize*this.cfg.tiles,this.borderWidth=(this.size-this.innerSize)/2,this}getSize(){return this.size}setBorderScale(t){this.borderScale=t,this.setSize(this.cfg.size)}setBorderOnly(t){this.borderOnly=t}setHollow(t){this.hollow=t}async setStyle(t,e=!0){this.style=await this.loadStyle(t),this.cfg.boardStyle=t,e&&await this.refresh()}async setPiecesStyle(t){this.cfg.piecesStyle=t,await this.refresh()}async setAllStyles(t,e){this.cfg.piecesStyle=t,this.style=await this.loadStyle(e),this.cfg.boardStyle=e,await this.refresh()}async flip(){return this.cfg.flipped=!this.cfg.flipped,await this.refresh(),this}async flipWhite(){!this.cfg.flipped||(this.cfg.flipped=!1,await this.refresh())}async flipBlack(){this.cfg.flipped||(this.cfg.flipped=!0,await this.refresh())}async hideBorder(){this.cfg.showBorder=!1,this.setSize(this.size),await this.refresh()}async showBorder(){this.cfg.showBorder=!0,this.setSize(this.size),await this.refresh()}async toggleBorder(){this.cfg.showBorder=!this.cfg.showBorder,this.setSize(this.size),await this.refresh()}async toggleExtraInfo(){this.cfg.showExtraInfo=!this.cfg.showExtraInfo,this.setSize(this.size),await this.refresh()}async toggleShadows(){this.cfg.showShadows=!this.cfg.showShadows,await this.refresh()}async togglePuzzle(){this.cfg.puzzle=!this.cfg.puzzle,await this.refresh()}getFinalHeader(){return this._anonymous?{...this.header,White:"Anonymous",Black:"Anonymous",WhitePretty:"Anonymous",BlackPretty:"Anonymous",Site:Et(this.header.Site)?null:this.header.Site}:{...this.header,Site:Et(this.header.Site)?this.header.Site.replace(/^http[s]*:\/\//,""):this.header.Site}}async titleFrame(t){this.currentScreen="title",this.header=t,await Rr(this.tempCtx,this.size,this.scale,this.margin,this.style,this.getFinalHeader(),this.loadImage,this.cfg.puzzle)}async renderBackground(){const t=this.createCanvas(),e=t.getContext("2d");t.width=this.size,t.height=this.size+this.margin*2;const{background:o,dark:a,light:s,border:c,coords:h}=this.style;e.clearRect(0,0,this.canvas.width,this.canvas.height),await De(e,this.width,this.height,0,0,c,this.loadImage),await De(e,this.innerSize,this.innerSize,this.cfg.showBorder?this.borderWidth:0,(this.cfg.showBorder?this.borderWidth:0)+this.margin,o,this.loadImage,this.cfg.tiles);for(let f=0;f<this.cfg.tiles;f++)for(let b=0;b<this.cfg.tiles;b++){const p=b%2===0&&f%2===0||b%2!==0&&f%2!==0?s:a,r=b*this.squareSize+this.borderWidth,i=f*this.squareSize+this.borderWidth+this.margin;await De(e,this.squareSize,this.squareSize,r,i,p,this.loadImage)}this.cfg.showBorder&&this.cfg.showCoords&&dn(e,h,this.squareSize,this.cfg.tiles,this.cfg.flipped,this.borderWidth,this.size,this.cfg.showBorder,this.margin),this.background=t}async frame(t,e){this.currentScreen="move",this.lastPosition=t,this.header=e??this.header,this.tempCtx.clearRect(0,0,this.tempCanvas.width,this.tempCanvas.height),this.background===null&&await this.renderBackground(),this.tempCtx.drawImage(await this.background,0,0),this.lastPosition?.move&&this.cfg.showMoveIndicator&&await Cr(this.tempCtx,this.lastPosition.move,this.squareSize,this.style,this.borderWidth,this.cfg.tiles,this.cfg.flipped,this.margin,this.loadImage),!this.cfg.showBorder&&this.cfg.showCoords&&dn(this.tempCtx,this.style.coords,this.squareSize,this.cfg.tiles,this.cfg.flipped,this.borderWidth,this.size,this.cfg.showBorder,this.margin),this.lastPosition&&(await Nr(this.tempCtx,this.lastPosition,this.squareSize,this.borderWidth,this.cfg.flipped,this.margin,this.cfg.piecesStyle,this.cfg.showShadows,this.loadImage),this.cfg.showExtraInfo&&e&&await Br(this.tempCtx,this.width,this.height,this.scale,this.margin,this.style,this.getFinalHeader(),this.cfg.flipped,this.lastPosition,this.cfg.puzzle))}render(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.drawImage(this.tempCanvas,0,0)}async renderStatic(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);const{background:t,dark:e,light:o,border:a}=this.style;if(await De(this.ctx,this.width,this.height,0,0,a,this.loadImage),this.borderOnly){this.hollow&&this.ctx.clearRect(this.borderWidth,this.borderWidth+this.margin,this.innerSize,this.innerSize);return}await De(this.ctx,this.innerSize,this.innerSize,this.cfg.showBorder?this.borderWidth:0,(this.cfg.showBorder?this.borderWidth:0)+this.margin,t,this.loadImage,this.cfg.tiles);for(let s=0;s<this.cfg.tiles;s++)for(let c=0;c<this.cfg.tiles;c++){const h=c%2===0&&s%2===0||c%2!==0&&s%2!==0?o:e,f=c*this.squareSize+this.borderWidth,b=s*this.squareSize+this.borderWidth+this.margin;De(this.ctx,this.squareSize,this.squareSize,f,b,h,this.loadImage)}}toImgUrl(){return this.canvas.toDataURL()}toImageData(){return this.ctx.getImageData(0,0,this.width,this.height)}toClampedArray(){return this.ctx.getImageData(0,0,this.width,this.height).data}toImgElement(){const t=this.toImgUrl(),e=new Image;return e.classList.add("board"),e.src=t,e}get width(){return this.size}get height(){return this.size+this.margin*2}toGIF(){}}const qr="pnbrqkPNBRQK",zt="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",Gr=["1-0","0-1","1/2-1/2","*"],Ft={b:[16,32,17,15],w:[-16,-32,-17,-15]},gn={n:[-18,-33,-31,-14,18,33,31,14],b:[-17,-15,17,15],r:[-16,1,16,-1],q:[-17,-16,-15,1,17,16,15,-1],k:[-17,-16,-15,1,17,16,15,-1]},jr=[20,0,0,0,0,0,0,24,0,0,0,0,0,0,20,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,24,24,24,24,24,24,56,0,56,24,24,24,24,24,24,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,20,0,0,0,0,0,0,24,0,0,0,0,0,0,20],Wr=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,0,16,0,15,0,0,0,0,0,0,0,0,0,0,0,0,17,16,15,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,-15,-16,-17,0,0,0,0,0,0,0,0,0,0,0,0,-15,0,-16,0,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],Ur={p:0,n:1,b:2,r:3,q:4,k:5},D={NORMAL:1,CAPTURE:2,BIG_PAWN:4,EP_CAPTURE:8,PROMOTION:16,KSIDE_CASTLE:32,QSIDE_CASTLE:64},Vr=7,Xr=6,Kr=1,Yr=0,Q={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},Ge={w:[{square:Q.a1,flag:D.QSIDE_CASTLE},{square:Q.h1,flag:D.KSIDE_CASTLE}],b:[{square:Q.a8,flag:D.QSIDE_CASTLE},{square:Q.h8,flag:D.KSIDE_CASTLE}]},Qr=0,mn=1;function Zr(n,t){for(var e=n.from,o=n.to,a=n.piece,s=0,c=0,h=0,f=0,b=t.length;f<b;f++){var p=t[f].from,r=t[f].to,i=t[f].piece;a===i&&e!==p&&o===r&&(s++,Ue(e)===Ue(p)&&c++,_t(e)===_t(p)&&h++)}return s>0?c>0&&h>0?Ae(e):h>0?Ae(e).charAt(1):Ae(e).charAt(0):""}function Jr(n){var t=n.charAt(0);if(t>="a"&&t<="h"){var e=n.match(/[a-h]\d.*[a-h]\d/);return e?void 0:Be}return t=t.toLowerCase(),t==="o"?ot:t}function bn(n){return n.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}function Ue(n){return n>>4}function _t(n){return n&15}function Ae(n){var t=_t(n),e=Ue(n);return"abcdefgh".substring(t,t+1)+"87654321".substring(e,e+1)}function dt(n){return n===Me?je:Me}function ei(n){return"0123456789".indexOf(n)!==-1}function Gn(n){var t=n instanceof Array?[]:{};for(var e in n)typeof e=="object"?t[e]=Gn(n[e]):t[e]=n[e];return t}function vn(n){return n.replace(/^\s+|\s+$/g,"")}const je="b",Me="w",Ie=-1,Be="p",wn="n",wt="b",ti="r",ni="q",ot="k";(function(){for(var n=[],t=Q.a8;t<=Q.h1;t++){if(t&136){t+=7;continue}n.push(Ae(t))}return n})();const ri={NORMAL:"n",CAPTURE:"c",BIG_PAWN:"b",EP_CAPTURE:"e",PROMOTION:"p",KSIDE_CASTLE:"k",QSIDE_CASTLE:"q"},Je=function(n){var t=new Array(128),e={w:Ie,b:Ie},o=Me,a={w:0,b:0},s=Ie,c=0,h=1,f=[],b={},p={};u(typeof n>"u"?zt:n);function r(m){typeof m>"u"&&(m=!1),t=new Array(128),e={w:Ie,b:Ie},o=Me,a={w:0,b:0},s=Ie,c=0,h=1,f=[],m||(b={}),p={},$(_())}function i(){for(var m=[],w={},S=function(A){A in p&&(w[A]=p[A])};f.length>0;)m.push(ie());for(S(_());m.length>0;)de(m.pop()),S(_());p=w}function l(){u(zt)}function u(m,w){typeof w>"u"&&(w=!1);var S=m.split(/\s+/),A=S[0],C=0;if(!d(m).valid)return!1;r(w);for(var T=0;T<A.length;T++){var R=A.charAt(T);if(R==="/")C+=8;else if(ei(R))C+=parseInt(R,10);else{var q=R<"a"?Me:je;k({type:R.toLowerCase(),color:q},Ae(C)),C++}}return o=S[1],S[2].indexOf("K")>-1&&(a.w|=D.KSIDE_CASTLE),S[2].indexOf("Q")>-1&&(a.w|=D.QSIDE_CASTLE),S[2].indexOf("k")>-1&&(a.b|=D.KSIDE_CASTLE),S[2].indexOf("q")>-1&&(a.b|=D.QSIDE_CASTLE),s=S[3]==="-"?Ie:Q[S[3]],c=parseInt(S[4],10),h=parseInt(S[5],10),$(_()),!0}function d(m){var w={0:"No errors.",1:"FEN string must contain six space-delimited fields.",2:"6th field (move number) must be a positive integer.",3:"5th field (half move counter) must be a non-negative integer.",4:"4th field (en-passant square) is invalid.",5:"3rd field (castling availability) is invalid.",6:"2nd field (side to move) is invalid.",7:"1st field (piece positions) does not contain 8 '/'-delimited rows.",8:"1st field (piece positions) is invalid [consecutive numbers].",9:"1st field (piece positions) is invalid [invalid piece].",10:"1st field (piece positions) is invalid [row too large].",11:"Illegal en-passant square"},S=m.split(/\s+/);if(S.length!==6)return{valid:!1,error_number:1,error:w[1]};if(isNaN(parseInt(S[5]))||parseInt(S[5],10)<=0)return{valid:!1,error_number:2,error:w[2]};if(isNaN(parseInt(S[4]))||parseInt(S[4],10)<0)return{valid:!1,error_number:3,error:w[3]};if(!/^(-|[abcdefgh][36])$/.test(S[3]))return{valid:!1,error_number:4,error:w[4]};if(!/^(KQ?k?q?|Qk?q?|kq?|q|-)$/.test(S[2]))return{valid:!1,error_number:5,error:w[5]};if(!/^(w|b)$/.test(S[1]))return{valid:!1,error_number:6,error:w[6]};var A=S[0].split("/");if(A.length!==8)return{valid:!1,error_number:7,error:w[7]};for(var C=0;C<A.length;C++){for(var T=0,R=!1,q=0;q<A[C].length;q++)if(isNaN(A[C][q])){if(!/^[prnbqkPRNBQK]$/.test(A[C][q]))return{valid:!1,error_number:9,error:w[9]};T+=1,R=!1}else{if(R)return{valid:!1,error_number:8,error:w[8]};T+=parseInt(A[C][q],10),R=!0}if(T!==8)return{valid:!1,error_number:10,error:w[10]}}return S[3][1]=="3"&&S[1]=="w"||S[3][1]=="6"&&S[1]=="b"?{valid:!1,error_number:11,error:w[11]}:{valid:!0,error_number:0,error:w[0]}}function _(){for(var m=0,w="",S=Q.a8;S<=Q.h1;S++){if(t[S]==null)m++;else{m>0&&(w+=m,m=0);var A=t[S].color,C=t[S].type;w+=A===Me?C.toUpperCase():C.toLowerCase()}S+1&136&&(m>0&&(w+=m),S!==Q.h1&&(w+="/"),m=0,S+=8)}var T="";a[Me]&D.KSIDE_CASTLE&&(T+="K"),a[Me]&D.QSIDE_CASTLE&&(T+="Q"),a[je]&D.KSIDE_CASTLE&&(T+="k"),a[je]&D.QSIDE_CASTLE&&(T+="q"),T=T||"-";var R=s===Ie?"-":Ae(s);return[w,o,T,R,c,h].join(" ")}function g(m){for(var w=0;w<m.length;w+=2)typeof m[w]=="string"&&typeof m[w+1]=="string"&&(b[m[w]]=m[w+1]);return b}function $(m){f.length>0||(m!==zt?(b.SetUp="1",b.FEN=m):(delete b.SetUp,delete b.FEN))}function y(m){var w=t[Q[m]];return w?{type:w.type,color:w.color}:null}function k(m,w){if(!("type"in m&&"color"in m)||qr.indexOf(m.type.toLowerCase())===-1||!(w in Q))return!1;var S=Q[w];return m.type==ot&&!(e[m.color]==Ie||e[m.color]==S)?!1:(t[S]={type:m.type,color:m.color},m.type===ot&&(e[m.color]=S),$(_()),!0)}function N(m){var w=y(m);return t[Q[m]]=null,w&&w.type===ot&&(e[w.color]=Ie),$(_()),w}function M(m,w,S,A,C){var T={color:o,from:w,to:S,flags:A,piece:m[w].type};return C&&(T.flags|=D.PROMOTION,T.promotion=C),m[S]?T.captured=m[S].type:A&D.EP_CAPTURE&&(T.captured=Be),T}function F(m){function w(B,U,O,j,H){if(B[O].type===Be&&(Ue(j)===Yr||Ue(j)===Vr))for(var Re=[ni,ti,wt,wn],X=0,Ne=Re.length;X<Ne;X++)U.push(M(B,O,j,H,Re[X]));else U.push(M(B,O,j,H))}var S=[],A=o,C=dt(A),T={b:Kr,w:Xr},R=Q.a8,q=Q.h1,K=!1,J=typeof m<"u"&&"legal"in m?m.legal:!0,fe=typeof m<"u"&&"piece"in m&&typeof m.piece=="string"?m.piece.toLowerCase():!0;if(typeof m<"u"&&"square"in m)if(m.square in Q)R=q=Q[m.square],K=!0;else return[];for(var z=R;z<=q;z++){if(z&136){z+=7;continue}var V=t[z];if(!(V==null||V.color!==A)){if(V.type===Be&&(fe===!0||fe===Be)){var W=z+Ft[A][0];if(t[W]==null){w(t,S,z,W,D.NORMAL);var W=z+Ft[A][1];T[A]===Ue(z)&&t[W]==null&&w(t,S,z,W,D.BIG_PAWN)}for(ee=2;ee<4;ee++){var W=z+Ft[A][ee];W&136||(t[W]!=null&&t[W].color===C?w(t,S,z,W,D.CAPTURE):W===s&&w(t,S,z,s,D.EP_CAPTURE))}}else if(fe===!0||fe===V.type)for(var ee=0,se=gn[V.type].length;ee<se;ee++)for(var ke=gn[V.type][ee],W=z;W+=ke,!(W&136);){if(t[W]==null)w(t,S,z,W,D.NORMAL);else{if(t[W].color===A)break;w(t,S,z,W,D.CAPTURE);break}if(V.type==="n"||V.type==="k")break}}}if((fe===!0||fe===ot)&&(!K||q===e[A])){if(a[A]&D.KSIDE_CASTLE){var te=e[A],be=te+2;t[te+1]==null&&t[be]==null&&!L(C,e[A])&&!L(C,te+1)&&!L(C,be)&&w(t,S,e[A],be,D.KSIDE_CASTLE)}if(a[A]&D.QSIDE_CASTLE){var te=e[A],be=te-2;t[te-1]==null&&t[te-2]==null&&t[te-3]==null&&!L(C,e[A])&&!L(C,te-1)&&!L(C,be)&&w(t,S,e[A],be,D.QSIDE_CASTLE)}}if(!J)return S;for(var Ee=[],z=0,se=S.length;z<se;z++)de(S[z]),ne(A)||Ee.push(S[z]),ie();return Ee}function Y(m,w){var S="";if(m.flags&D.KSIDE_CASTLE)S="O-O";else if(m.flags&D.QSIDE_CASTLE)S="O-O-O";else{if(m.piece!==Be){var A=Zr(m,w);S+=m.piece.toUpperCase()+A}m.flags&(D.CAPTURE|D.EP_CAPTURE)&&(m.piece===Be&&(S+=Ae(m.from)[0]),S+="x"),S+=Ae(m.to),m.flags&D.PROMOTION&&(S+="="+m.promotion.toUpperCase())}return de(m),pe()&&(Oe()?S+="#":S+="+"),ie(),S}function L(m,w){for(var S=Q.a8;S<=Q.h1;S++){if(S&136){S+=7;continue}if(!(t[S]==null||t[S].color!==m)){var A=t[S],C=S-w,T=C+119;if(jr[T]&1<<Ur[A.type]){if(A.type===Be){if(C>0){if(A.color===Me)return!0}else if(A.color===je)return!0;continue}if(A.type==="n"||A.type==="k")return!0;for(var R=Wr[T],q=S+R,K=!1;q!==w;){if(t[q]!=null){K=!0;break}q+=R}if(!K)return!0}}}return!1}function ne(m){return L(dt(m),e[m])}function pe(){return ne(o)}function Oe(){return pe()&&F().length===0}function me(){return!pe()&&F().length===0}function _e(){for(var m={},w=[],S=0,A=0,C=Q.a8;C<=Q.h1;C++){if(A=(A+1)%2,C&136){C+=7;continue}var T=t[C];T&&(m[T.type]=T.type in m?m[T.type]+1:1,T.type===wt&&w.push(A),S++)}if(S===2)return!0;if(S===3&&(m[wt]===1||m[wn]===1))return!0;if(S===m[wt]+2){for(var R=0,q=w.length,C=0;C<q;C++)R+=w[C];if(R===0||R===q)return!0}return!1}function Ce(){for(var m=[],w={},S=!1;;){var A=ie();if(!A)break;m.push(A)}for(;;){var C=_().split(" ").slice(0,4).join(" ");if(w[C]=C in w?w[C]+1:1,w[C]>=3&&(S=!0),!m.length)break;de(m.pop())}return S}function ve(m){f.push({move:m,kings:{b:e.b,w:e.w},turn:o,castling:{b:a.b,w:a.w},ep_square:s,half_moves:c,move_number:h})}function de(m){var w=o,S=dt(w);if(ve(m),t[m.to]=t[m.from],t[m.from]=null,m.flags&D.EP_CAPTURE&&(o===je?t[m.to-16]=null:t[m.to+16]=null),m.flags&D.PROMOTION&&(t[m.to]={type:m.promotion,color:w}),t[m.to].type===ot){if(e[t[m.to].color]=m.to,m.flags&D.KSIDE_CASTLE){var A=m.to-1,C=m.to+1;t[A]=t[C],t[C]=null}else if(m.flags&D.QSIDE_CASTLE){var A=m.to+1,C=m.to-2;t[A]=t[C],t[C]=null}a[w]=""}if(a[w]){for(var T=0,R=Ge[w].length;T<R;T++)if(m.from===Ge[w][T].square&&a[w]&Ge[w][T].flag){a[w]^=Ge[w][T].flag;break}}if(a[S]){for(var T=0,R=Ge[S].length;T<R;T++)if(m.to===Ge[S][T].square&&a[S]&Ge[S][T].flag){a[S]^=Ge[S][T].flag;break}}m.flags&D.BIG_PAWN?o==="b"?s=m.to-16:s=m.to+16:s=Ie,m.piece===Be||m.flags&(D.CAPTURE|D.EP_CAPTURE)?c=0:c++,o===je&&h++,o=dt(o)}function ie(){var m=f.pop();if(m==null)return null;var w=m.move;e=m.kings,o=m.turn,a=m.castling,s=m.ep_square,c=m.half_moves,h=m.move_number;var S=o,A=dt(o);if(t[w.from]=t[w.to],t[w.from].type=w.piece,t[w.to]=null,w.flags&D.CAPTURE)t[w.to]={type:w.captured,color:A};else if(w.flags&D.EP_CAPTURE){var C;S===je?C=w.to-16:C=w.to+16,t[C]={type:Be,color:A}}if(w.flags&(D.KSIDE_CASTLE|D.QSIDE_CASTLE)){var T,R;w.flags&D.KSIDE_CASTLE?(T=w.to+1,R=w.to-1):w.flags&D.QSIDE_CASTLE&&(T=w.to-2,R=w.to+1),t[T]=t[R],t[R]=null}return w}function Le(m,w){for(var S=bn(m),A=0;A<2;A++){if(A==mn){if(!w)return null;var C=!1,T=S.match(/([pnbrqkPNBRQK])?([a-h][1-8])x?-?([a-h][1-8])([qrbnQRBN])?/);if(T){var R=T[1],q=T[2],K=T[3],J=T[4];q.length==1&&(C=!0)}else{var T=S.match(/([pnbrqkPNBRQK])?([a-h]?[1-8]?)x?-?([a-h][1-8])([qrbnQRBN])?/);if(T){var R=T[1],q=T[2],K=T[3],J=T[4];if(q.length==1)var C=!0}}}for(var fe=Jr(S),z=F({legal:!0,piece:R||fe}),V=0,W=z.length;V<W;V++)switch(A){case Qr:{if(S===bn(Y(z[V],z)))return z[V];break}case mn:if(T){if((!R||R.toLowerCase()==z[V].piece)&&Q[q]==z[V].from&&Q[K]==z[V].to&&(!J||J.toLowerCase()==z[V].promotion))return z[V];if(C){var ee=Ae(z[V].from);if((!R||R.toLowerCase()==z[V].piece)&&Q[K]==z[V].to&&(q==ee[0]||q==ee[1])&&(!J||J.toLowerCase()==z[V].promotion))return z[V]}}}}return null}function ge(m){var w=Gn(m);w.san=Y(w,F({legal:!0})),w.to=Ae(w.to),w.from=Ae(w.from);var S="";for(var A in D)D[A]&w.flags&&(S+=ri[A]);return w.flags=S,w}function we(m){for(var w=F({legal:!1}),S=0,A=o,C=0,T=w.length;C<T;C++){if(de(w[C]),!ne(A))if(m-1>0){var R=we(m-1);S+=R}else S++;ie()}return S}return{load:function(m){return u(m)},reset:function(){return l()},moves:function(m){for(var w=F(m),S=[],A=0,C=w.length;A<C;A++)typeof m<"u"&&"verbose"in m&&m.verbose?S.push(ge(w[A])):S.push(Y(w[A],F({legal:!0})));return S},in_check:function(){return pe()},in_checkmate:function(){return Oe()},in_stalemate:function(){return me()},in_draw:function(){return c>=100||me()||_e()||Ce()},insufficient_material:function(){return _e()},in_threefold_repetition:function(){return Ce()},game_over:function(){return c>=100||Oe()||me()||_e()||Ce()},validate_fen:function(m){return d(m)},fen:function(){return _()},board:function(){for(var m=[],w=[],S=Q.a8;S<=Q.h1;S++)t[S]==null?w.push(null):w.push({square:Ae(S),type:t[S].type,color:t[S].color}),S+1&136&&(m.push(w),w=[],S+=8);return m},pgn:function(m){var w=typeof m=="object"&&typeof m.newline_char=="string"?m.newline_char:`
`,S=typeof m=="object"&&typeof m.max_width=="number"?m.max_width:0,A=[],C=!1;for(var T in b)A.push("["+T+' "'+b[T]+'"]'+w),C=!0;C&&f.length&&A.push(w);for(var R=function(ee){var se=p[_()];if(typeof se<"u"){var ke=ee.length>0?" ":"";ee=`${ee}${ke}{${se}}`}return ee},q=[];f.length>0;)q.push(ie());var K=[],J="";for(q.length===0&&K.push(R(""));q.length>0;){J=R(J);var fe=q.pop();if(!f.length&&fe.color==="b"){const ee=`${h}. ...`;J=J?`${J} ${ee}`:ee}else fe.color==="w"&&(J.length&&K.push(J),J=h+".");J=J+" "+Y(fe,F({legal:!0})),de(fe)}if(J.length&&K.push(R(J)),typeof b.Result<"u"&&K.push(b.Result),S===0)return A.join("")+K.join(" ");for(var z=function(){return A.length>0&&A[A.length-1]===" "?(A.pop(),!0):!1},V=function(ee,se){for(var ke of se.split(" "))if(!!ke){if(ee+ke.length>S){for(;z();)ee--;A.push(w),ee=0}A.push(ke),ee+=ke.length,A.push(" "),ee++}return z()&&ee--,ee},W=0,T=0;T<K.length;T++){if(W+K[T].length>S&&K[T].includes("{")){W=V(W,K[T]);continue}W+K[T].length>S&&T!==0?(A[A.length-1]===" "&&A.pop(),A.push(w),W=0):T!==0&&(A.push(" "),W++),A.push(K[T]),W+=K[T].length}return A.join("")},load_pgn:function(m,w){var S=typeof w<"u"&&"sloppy"in w?w.sloppy:!1;function A(O){return O.replace(/\\/g,"\\")}function C(O,j){for(var H=typeof j=="object"&&typeof j.newline_char=="string"?j.newline_char:`\r?
`,Re={},X=O.split(new RegExp(A(H))),Ne="",Te="",Ye=0;Ye<X.length;Ye++){var ct=/^\s*\[([A-Za-z]+)\s*"(.*)"\s*\]\s*$/;Ne=X[Ye].replace(ct,"$1"),Te=X[Ye].replace(ct,"$2"),vn(Ne).length>0&&(Re[Ne]=Te)}return Re}m=m.trim();var T=typeof w=="object"&&typeof w.newline_char=="string"?w.newline_char:`\r?
`,R=new RegExp("^(\\[((?:"+A(T)+")|.)*\\])(?:\\s*"+A(T)+"){2}"),q=R.test(m)?R.exec(m)[1]:"";l();var K=C(q,w),J="";for(var fe in K)fe.toLowerCase()==="fen"&&(J=K[fe]),g([fe,K[fe]]);if(S){if(J&&!u(J,!0))return!1}else if(K.SetUp==="1"&&!("FEN"in K&&u(K.FEN,!0)))return!1;for(var z=function(O){return Array.from(O).map(function(j){return j.charCodeAt(0)<128?j.charCodeAt(0).toString(16):encodeURIComponent(j).replace(/\%/g,"").toLowerCase()}).join("")},V=function(O){return O.length==0?"":decodeURIComponent("%"+O.match(/.{1,2}/g).join("%"))},W=function(O){return O=O.replace(new RegExp(A(T),"g")," "),`{${z(O.slice(1,O.length-1))}}`},ee=function(O){if(O.startsWith("{")&&O.endsWith("}"))return V(O.slice(1,O.length-1))},se=m.replace(q,"").replace(new RegExp(`({[^}]*})+?|;([^${A(T)}]*)`,"g"),function(O,j,H){return j!==void 0?W(j):" "+W(`{${H.slice(1)}}`)}).replace(new RegExp(A(T),"g")," "),ke=/(\([^\(\)]+\))+?/g;ke.test(se);)se=se.replace(ke,"");se=se.replace(/\d+\.(\.\.)?/g,""),se=se.replace(/\.\.\./g,""),se=se.replace(/\$\d+/g,"");var te=vn(se).split(new RegExp(/\s+/));te=te.join(",").replace(/,,+/g,",").split(",");for(var be="",Ee="",B=0;B<te.length;B++){var U=ee(te[B]);if(U!==void 0){p[_()]=U;continue}if(be=Le(te[B],S),be==null)if(Gr.indexOf(te[B])>-1)Ee=te[B];else return!1;else Ee="",de(be)}return Ee&&Object.keys(b).length&&!b.Result&&g(["Result",Ee]),!0},header:function(){return g(arguments)},turn:function(){return o},move:function(m,w){var S=typeof w<"u"&&"sloppy"in w?w.sloppy:!1,A=null;if(typeof m=="string")A=Le(m,S);else if(typeof m=="object"){for(var C=F(),T=0,R=C.length;T<R;T++)if(m.from===Ae(C[T].from)&&m.to===Ae(C[T].to)&&(!("promotion"in C[T])||m.promotion===C[T].promotion)){A=C[T];break}}if(!A)return null;var q=ge(A);return de(A),q},undo:function(){var m=ie();return m?ge(m):null},clear:function(){return r()},put:function(m,w){return k(m,w)},get:function(m){return y(m)},ascii(){for(var m=`   +------------------------+
`,w=Q.a8;w<=Q.h1;w++){if(_t(w)===0&&(m+=" "+"87654321"[Ue(w)]+" |"),t[w]==null)m+=" . ";else{var S=t[w].type,A=t[w].color,C=A===Me?S.toUpperCase():S.toLowerCase();m+=" "+C+" "}w+1&136&&(m+=`|
`,w+=8)}return m+=`   +------------------------+
`,m+="     a  b  c  d  e  f  g  h",m},remove:function(m){return N(m)},perft:function(m){return we(m)},square_color:function(m){if(m in Q){var w=Q[m];return(Ue(w)+_t(w))%2===0?"light":"dark"}return null},history:function(m){for(var w=[],S=[],A=typeof m<"u"&&("verbose"in m)&&m.verbose;f.length>0;)w.push(ie());for(;w.length>0;){var C=w.pop();A?S.push(ge(C)):S.push(Y(C,F({legal:!0}))),de(C)}return S},get_comment:function(){return p[_()]},set_comment:function(m){p[_()]=m.replace("{","[").replace("}","]")},delete_comment:function(){var m=p[_()];return delete p[_()],m},get_comments:function(){return i(),Object.keys(p).map(function(m){return{fen:m,comment:p[m]}})},delete_comments:function(){return i(),Object.keys(p).map(function(m){var w=p[m];return delete p[m],{fen:m,comment:w}})}}},nn={Event:"E",Site:"S",Round:"N",White:"W",Black:"B",Date:"D",Result:"R",FEN:"F",SetUp:"SU",WhiteElo:"WE",BlackElo:"BE",PuzzleTitle:"PT",PuzzleMotif:"PM",PuzzleDescription:"PD"},jn=Object.keys(nn),ii=Object.fromEntries(Object.entries(nn).map(([n,t])=>[t,n])),Wn=n=>{const t=new Je;if(t.load_pgn(n),t.delete_comments(),!t.header().Result){const c=(n.trim().match(/(1-0)|(0-1)|(1\/2-1\/2)$/)||[])[0];c&&t.header("Result",c)}const e=Object.entries(t.header()),[o,a]=e.length>0?t.pgn().split(`

`):[void 0,t.pgn()];return[e.filter(([c,h])=>jn.includes(c)&&h!=="?").map(([c,h])=>`[${c} "${h}"]`).sort().join(`
`),a].join(`

`)},yn=n=>{const t=new Je;t.load_pgn(n);const e=t.history().join(" "),o=Object.entries(t.header()).filter(([a])=>jn.includes(a)).map(([a,s])=>`${nn[a]} ${s}`).sort().join(`
`);return btoa([o,e].join(`

`))},oi=n=>{const[t,e]=atob(n).split(`

`);let o;const a=t.split(`
`).map(c=>{const[h,...f]=c.split(" "),b=f.join(" ");return h==="R"&&(o=b),`[${ii[h]} "${b}"]`}).join(`
`),s=e.split(" ").map((c,h)=>h%2===0?`${h/2+1}. ${c}`:c).join(" ")+` ${o}`;return[a,s].join(`

`)},ai=["January","February","March","April","May","June","July","August","September","October","November","December"],si=n=>{const[t,e,o]=n.split(".").map(Number),a=Number.isNaN(e)?null:ai[e-1],s=Number.isNaN(o)||a===null?null:o,c=Number.isNaN(t)?null:t;return a&&s&&c?`${a} ${s}, ${c}`:a&&c?`${a} ${c}`:c?String(c):""},Sn=n=>n.split(",").map(t=>t.trim()).reverse().join(" "),li=new Map([["q",9],["r",5],["b",3],["n",3],["p",1]]),Pe=(n,t=null)=>!n||n==="?"?t:n;class st{positions=[];game=new Je;constructor(){}loadPGN(t){const e=new Je,o=new Je;e.load_pgn(Wn(t)),e.delete_comments();const a=e.history({verbose:!0}),s=e.header().FEN;return s&&o.load(s),this.positions=[{ply:0,move:null,end:a.length,fen:o.fen(),check:o.in_check(),mate:o.in_checkmate(),turn:o.turn(),material:this.materialInfo(o.board()),placement:this.getPlacement(o.fen()),last:a.length===0}],a.forEach((c,h)=>{o.move(c);const f=o.fen();this.positions.push({ply:h+1,move:c,end:a.length-1-h,fen:f,check:o.in_check(),mate:o.in_checkmate(),turn:o.turn(),material:this.materialInfo(o.board()),placement:this.getPlacement(f),last:h===a.length-1})}),this.game=e,this}loadFEN(t){return this.game=new Je(t),this.positions=[{ply:0,move:null,end:0,fen:t,check:this.game.in_check(),mate:this.game.in_checkmate(),turn:this.game.turn(),material:this.materialInfo(this.game.board()),placement:this.getPlacement(this.game.fen()),last:!0}],this}getPlacement(t){const e=new Je(t).board(),o=[];for(let a=0;a<8;a++)for(let s=0;s<8;s++)if(e[a][s]!==null){const{type:c,color:h}=e[a][s];o.push({x:s,y:a,type:c,color:h})}return o}materialInfo(t){const e=t.flat().filter(Boolean),o={w:0,b:0},a={w:{p:0,n:0,b:0,r:0,q:0},b:{p:0,n:0,b:0,r:0,q:0}},s={w:{p:0,n:0,b:0,r:0,q:0},b:{p:0,n:0,b:0,r:0,q:0}};for(const c of e)if(c!==null&&c.type!=="k"){o[c.color]+=li.get(c.type)??0,s[c.color][c.type]+=1;const h=c.color==="b"?"w":"b";a[h][c.type]===0?a[c.color][c.type]+=1:a[h][c.type]-=1}return{sum:o,imbalance:a,count:s,diff:o.w-o.b}}get length(){return this.positions.length}get header(){const t=this.game.header(),e=Pe(t.White,"Anonymous"),o=Pe(t.Black,"Anonymous"),a=Pe(t.Date);return{White:e,Black:o,WhitePretty:Sn(e),BlackPretty:Sn(o),WhiteElo:Pe(t.WhiteElo),BlackElo:Pe(t.BlackElo),Date:a,DatePretty:a===null?null:si(a),Event:Pe(t.Event),Round:Pe(t.Round),Site:Pe(t.Site),Result:Pe(t.Result),PuzzleTitle:Pe(t.PuzzleTitle),PuzzleMotif:Pe(t.PuzzleMotif),PuzzleDescription:Pe(t.PuzzleDescription)}}getTitle({anonymous:t}){const e=this.header,o=t?"Anonymous":e.WhitePretty,a=t?"Anonymous":e.BlackPretty;return`${o} vs ${a}`+(e.Event?` | ${e.Event}`:"")+(e.Round?`, Round ${e.Round}`:"")+(e.DatePretty?` | ${e.DatePretty}`:"")}getShortTitle({anonymous:t}){const e=this.header,o=t?"Anonymous":e.WhitePretty,a=t?"Anonymous":e.BlackPretty;return`${o} vs ${a}`+(e.Event?` | ${e.Event}`:"")}getFileName(t){const e=this.header,o=t?"Anonymous":e.WhitePretty,a=t?"Anonymous":e.BlackPretty;return((e.Date?`${e.Date.replace(/\?/g,"X").replace(/\./g,"-")}_`:"")+`${o}_${a}`+(e.Event?`_${e.Event}`:"")+(e.Round?`_R${e.Round}`:"")).replace(/\s+/g,"-")}get pgn(){return this.game.pgn()}get anonymousPGN(){const t=this.game.pgn().replace(/\[White .+\]/,'[White "Anonymous"]').replace(/\[Black .+\]/,'[Black "Anonymous"]');return Et(this.header.Site)?t.replace(/\[Site .+\]/,'[Site "?"]'):t}getPosition(t){return this.positions[t]??null}getMoves(){return this.positions.slice(1).map(({move:t})=>t?.san)}}var Lt={exports:{}};Lt.exports=rn;Lt.exports.isMobile=rn;Lt.exports.default=rn;const ci=/(android|bb\d+|meego).+mobile|armv7l|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|samsungbrowser|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,ui=/CrOS/,di=/android|ipad|playbook|silk/i;function rn(n){n||(n={});let t=n.ua;if(!t&&typeof navigator<"u"&&(t=navigator.userAgent),t&&t.headers&&typeof t.headers["user-agent"]=="string"&&(t=t.headers["user-agent"]),typeof t!="string")return!1;let e=ci.test(t)&&!ui.test(t)||!!n.tablet&&di.test(t);return!e&&n.tablet&&n.featureDetect&&navigator&&navigator.maxTouchPoints>1&&t.indexOf("Macintosh")!==-1&&t.indexOf("Safari")!==-1&&(e=!0),e}var fi=Lt.exports;const Xt=Symbol("store-raw"),pt=Symbol("store-node"),hi=Symbol("store-name");function Un(n,t){let e=n[tt];if(!e&&(Object.defineProperty(n,tt,{value:e=new Proxy(n,gi)}),!Array.isArray(n))){const o=Object.keys(n),a=Object.getOwnPropertyDescriptors(n);for(let s=0,c=o.length;s<c;s++){const h=o[s];if(a[h].get){const f=a[h].get.bind(e);Object.defineProperty(n,h,{get:f})}}}return e}function Pt(n){let t;return n!=null&&typeof n=="object"&&(n[tt]||!(t=Object.getPrototypeOf(n))||t===Object.prototype||Array.isArray(n))}function gt(n,t=new Set){let e,o,a,s;if(e=n!=null&&n[Xt])return e;if(!Pt(n)||t.has(n))return n;if(Array.isArray(n)){Object.isFrozen(n)?n=n.slice(0):t.add(n);for(let c=0,h=n.length;c<h;c++)a=n[c],(o=gt(a,t))!==a&&(n[c]=o)}else{Object.isFrozen(n)?n=Object.assign({},n):t.add(n);const c=Object.keys(n),h=Object.getOwnPropertyDescriptors(n);for(let f=0,b=c.length;f<b;f++)s=c[f],!h[s].get&&(a=n[s],(o=gt(a,t))!==a&&(n[s]=o))}return n}function Nt(n){let t=n[pt];return t||Object.defineProperty(n,pt,{value:t={}}),t}function Kt(n,t,e){return n[t]||(n[t]=Xn(e))}function _i(n,t){const e=Reflect.getOwnPropertyDescriptor(n,t);return!e||e.get||!e.configurable||t===tt||t===pt||t===hi||(delete e.value,delete e.writable,e.get=()=>n[tt][t]),e}function Vn(n){if(Ln()){const t=Nt(n);(t._||(t._=Xn()))()}}function pi(n){return Vn(n),Reflect.ownKeys(n)}function Xn(n){const[t,e]=Fe(n,{equals:!1,internal:!0});return t.$=e,t}const gi={get(n,t,e){if(t===Xt)return n;if(t===tt)return e;if(t===Wt)return Vn(n),e;const o=Nt(n),a=o.hasOwnProperty(t);let s=a?o[t]():n[t];if(t===pt||t==="__proto__")return s;if(!a){const c=Object.getOwnPropertyDescriptor(n,t);Ln()&&(typeof s!="function"||n.hasOwnProperty(t))&&!(c&&c.get)&&(s=Kt(o,t,s)())}return Pt(s)?Un(s):s},has(n,t){if(t===Xt||t===tt||t===Wt||t===pt||t==="__proto__")return!0;const e=Nt(n)[t];return e&&e(),t in n},set(){return!0},deleteProperty(){return!0},ownKeys:pi,getOwnPropertyDescriptor:_i};function It(n,t,e,o=!1){if(!o&&n[t]===e)return;const a=n[t],s=n.length;e===void 0?delete n[t]:n[t]=e;let c=Nt(n),h;(h=Kt(c,t,a))&&h.$(()=>e),Array.isArray(n)&&n.length!==s&&(h=Kt(c,"length",s))&&h.$(n.length),(h=c._)&&h.$()}function Kn(n,t){const e=Object.keys(t);for(let o=0;o<e.length;o+=1){const a=e[o];It(n,a,t[a])}}function mi(n,t){if(typeof t=="function"&&(t=t(n)),t=gt(t),Array.isArray(t)){if(n===t)return;let e=0,o=t.length;for(;e<o;e++){const a=t[e];n[e]!==a&&It(n,e,a)}It(n,"length",o)}else Kn(n,t)}function ht(n,t,e=[]){let o,a=n;if(t.length>1){o=t.shift();const c=typeof o,h=Array.isArray(n);if(Array.isArray(o)){for(let f=0;f<o.length;f++)ht(n,[o[f]].concat(t),e);return}else if(h&&c==="function"){for(let f=0;f<n.length;f++)o(n[f],f)&&ht(n,[f].concat(t),e);return}else if(h&&c==="object"){const{from:f=0,to:b=n.length-1,by:p=1}=o;for(let r=f;r<=b;r+=p)ht(n,[r].concat(t),e);return}else if(t.length>1){ht(n[o],t,[o].concat(e));return}a=n[o],e=[o].concat(e)}let s=t[0];typeof s=="function"&&(s=s(a,e),s===a)||o===void 0&&s==null||(s=gt(s),o===void 0||Pt(a)&&Pt(s)&&!Array.isArray(s)?Kn(a,s):It(n,o,s))}function bi(...[n,t]){const e=gt(n||{}),o=Array.isArray(e),a=Un(e);function s(...c){ur(()=>{o&&c.length===1?mi(e,c[0]):ht(e,c)})}return[a,s]}const Rt=["halloween_purple","halloween_web","halloween_green","halloween_swamp","standard","spring","azure","violet","rose","peach","clay","rock","lila","leko","patina","mud","spun","gulf","silk","nobel","qootee","qootee_summer","qootee_pink","qootee_grape","marino","bay","havelock","picont","oracle","rhino","mist","pigeon","oxford","mandy","copper","salmon","camelot","cadillac","mona","carnation","tangerine","sienna","fuzzy","flamingo","orange","jaffa","ronchi","conifer","olive","turmeric","bahia","husk","york","sulu","sushi","salad","meadow","observatory","keppel","casal","mule","russett","sirocco","nevada","danny","danny_green","danny_cyan","danny_blue","danny_purple","danny_pink","danny_red","danny_yellow","lichess","danya","botez","avocado","mono_chico","mono_mojo","mono_mahogany","mono_mulberry","mono_blue","mono_teal","mono_goblin","mono_sycamore","mono_coral","mono_flamingo","mono_rose","mono_heliotrope","mono_cornflower","mono_dodger","mono_meadow","mono_mantis","mono_coper","mono_contessa","mono_terracotta","mono_harvest","mono_kashmir","mono_affair","mono_cadillac","mono_beaver","mono_asparagus","mono_amazon","mono_nevada","mono_mobster","mono_bw","mono_bw2","mono_sharechess_dark","mono_sharechess_light","smooth_sunset","smooth_summer","smooth_spring","smooth_forest","smooth_laguna","smooth_sea","smooth_violet","smooth_mono","contrast_a","contrast_b","contrast_c","contrast_d","rainbow_light","rainbow","rainbow_dark","rainbow_night","clouds_bermuda","clouds_kimberly","clouds_wisteria","clouds_rose","clouds_sandal","clouds_gimblet","clouds_cucumber","clouds_acapulco","chessception_brown","chessception_green","chessception_pink","chessception_violet","wood1","wood2","wood3","wood4","wood5","wood6","wood7","wood8","wood9","wood10","wood11","wood12","wood13","wood14","wood15","wood16","lines_parchment","lines_alabaster","lines_paper","lines_cardboard","grass1","grass2","grass3","grass4","asphalt1","asphalt2","asphalt3","asphalt4","leather1","leather2","leather3","leather4"],vi={seasonal:["halloween_purple","halloween_web","halloween_green","halloween_swamp"],solid:["standard","spring","azure","violet","rose","peach","clay","rock","lila","leko","patina","mud","spun","gulf","silk","nobel","qootee","qootee_summer","qootee_pink","qootee_grape","marino","bay","havelock","picont","oracle","rhino","mist","pigeon","oxford","mandy","copper","salmon","camelot","cadillac","mona","carnation","tangerine","sienna","fuzzy","flamingo","orange","jaffa","ronchi","conifer","olive","turmeric","bahia","husk","york","sulu","sushi","salad","meadow","observatory","keppel","casal","mule","russett","sirocco","nevada","danny","danny_green","danny_cyan","danny_blue","danny_purple","danny_pink","danny_red","danny_yellow","lichess","danya","botez","avocado","mono_chico","mono_mojo","mono_mahogany","mono_mulberry","mono_blue","mono_teal","mono_goblin","mono_sycamore","mono_coral","mono_flamingo","mono_rose","mono_heliotrope","mono_cornflower","mono_dodger","mono_meadow","mono_mantis","mono_coper","mono_contessa","mono_terracotta","mono_harvest","mono_kashmir","mono_affair","mono_cadillac","mono_beaver","mono_asparagus","mono_amazon","mono_nevada","mono_mobster","mono_bw","mono_bw2","mono_sharechess_dark","mono_sharechess_light"],gradient:["smooth_sunset","smooth_summer","smooth_spring","smooth_forest","smooth_laguna","smooth_sea","smooth_violet","smooth_mono","contrast_a","contrast_b","contrast_c","contrast_d","rainbow_light","rainbow","rainbow_dark","rainbow_night"],texture:["clouds_bermuda","clouds_kimberly","clouds_wisteria","clouds_rose","clouds_sandal","clouds_gimblet","clouds_cucumber","clouds_acapulco","chessception_brown","chessception_green","chessception_pink","chessception_violet","wood1","wood2","wood3","wood4","wood5","wood6","wood7","wood8","wood9","wood10","wood11","wood12","wood13","wood14","wood15","wood16","lines_parchment","lines_alabaster","lines_paper","lines_cardboard","grass1","grass2","grass3","grass4","asphalt1","asphalt2","asphalt3","asphalt4","leather1","leather2","leather3","leather4"]},wi=n=>(Rt.includes(n.boardStyle)||delete n.boardStyle,Ot.includes(n.piecesStyle)||delete n.piecesStyle,n),yi=()=>{const n=localStorage.getItem("boardConfig"),t=localStorage.getItem("gameConfig"),e=localStorage.getItem("siteConfig"),o=localStorage.getItem("recent"),a=localStorage.getItem("pieces"),s=localStorage.getItem("boards");return{boardConfig:n===null?{}:wi(JSON.parse(n)),gameConfig:t===null?{}:JSON.parse(t),siteConfig:e===null?{}:JSON.parse(e),recent:o===null?[]:JSON.parse(o),pieces:a===null?new Set:new Set(JSON.parse(a)),boards:s===null?new Set:new Set(JSON.parse(s))}};var Yt={exports:{}};(function(n,t){(function(e,o){var a="1.0.2",s="",c="?",h="function",f="undefined",b="object",p="string",r="major",i="model",l="name",u="type",d="vendor",_="version",g="architecture",$="console",y="mobile",k="tablet",N="smarttv",M="wearable",F="embedded",Y=255,L="Amazon",ne="Apple",pe="ASUS",Oe="BlackBerry",me="Browser",_e="Chrome",Ce="Edge",ve="Firefox",de="Google",ie="Huawei",Le="LG",ge="Microsoft",we="Motorola",m="Opera",w="Samsung",S="Sony",A="Xiaomi",C="Zebra",T="Facebook",R=function(B,U){var O={};for(var j in B)U[j]&&U[j].length%2===0?O[j]=U[j].concat(B[j]):O[j]=B[j];return O},q=function(B){for(var U={},O=0;O<B.length;O++)U[B[O].toUpperCase()]=B[O];return U},K=function(B,U){return typeof B===p?J(U).indexOf(J(B))!==-1:!1},J=function(B){return B.toLowerCase()},fe=function(B){return typeof B===p?B.replace(/[^\d\.]/g,s).split(".")[0]:o},z=function(B,U){if(typeof B===p)return B=B.replace(/^\s\s*/,s).replace(/\s\s*$/,s),typeof U===f?B:B.substring(0,Y)},V=function(B,U){for(var O=0,j,H,Re,X,Ne,Te;O<U.length&&!Ne;){var Ye=U[O],ct=U[O+1];for(j=H=0;j<Ye.length&&!Ne;)if(Ne=Ye[j++].exec(B),Ne)for(Re=0;Re<ct.length;Re++)Te=Ne[++H],X=ct[Re],typeof X===b&&X.length>0?X.length===2?typeof X[1]==h?this[X[0]]=X[1].call(this,Te):this[X[0]]=X[1]:X.length===3?typeof X[1]===h&&!(X[1].exec&&X[1].test)?this[X[0]]=Te?X[1].call(this,Te,X[2]):o:this[X[0]]=Te?Te.replace(X[1],X[2]):o:X.length===4&&(this[X[0]]=Te?X[3].call(this,Te.replace(X[1],X[2])):o):this[X]=Te||o;O+=2}},W=function(B,U){for(var O in U)if(typeof U[O]===b&&U[O].length>0){for(var j=0;j<U[O].length;j++)if(K(U[O][j],B))return O===c?o:O}else if(K(U[O],B))return O===c?o:O;return B},ee={"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"},se={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},ke={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[_,[l,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[_,[l,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[l,_],[/opios[\/ ]+([\w\.]+)/i],[_,[l,m+" Mini"]],[/\bopr\/([\w\.]+)/i],[_,[l,m]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale|qqbrowserlite|qq)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[l,_],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[_,[l,"UC"+me]],[/\bqbcore\/([\w\.]+)/i],[_,[l,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[_,[l,"WeChat"]],[/konqueror\/([\w\.]+)/i],[_,[l,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[_,[l,"IE"]],[/yabrowser\/([\w\.]+)/i],[_,[l,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[l,/(.+)/,"$1 Secure "+me],_],[/\bfocus\/([\w\.]+)/i],[_,[l,ve+" Focus"]],[/\bopt\/([\w\.]+)/i],[_,[l,m+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[_,[l,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[_,[l,"Dolphin"]],[/coast\/([\w\.]+)/i],[_,[l,m+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[_,[l,"MIUI "+me]],[/fxios\/([-\w\.]+)/i],[_,[l,ve]],[/\bqihu|(qi?ho?o?|360)browser/i],[[l,"360 "+me]],[/(oculus|samsung|sailfish)browser\/([\w\.]+)/i],[[l,/(.+)/,"$1 "+me],_],[/(comodo_dragon)\/([\w\.]+)/i],[[l,/_/g," "],_],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[l,_],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i],[l],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[l,T],_],[/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[l,_],[/\bgsa\/([\w\.]+) .*safari\//i],[_,[l,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[_,[l,_e+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[l,_e+" WebView"],_],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[_,[l,"Android "+me]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[l,_],[/version\/([\w\.]+) .*mobile\/\w+ (safari)/i],[_,[l,"Mobile Safari"]],[/version\/([\w\.]+) .*(mobile ?safari|safari)/i],[_,l],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[l,[_,W,ee]],[/(webkit|khtml)\/([\w\.]+)/i],[l,_],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[l,"Netscape"],_],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[_,[l,ve+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[l,_]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[g,"amd64"]],[/(ia32(?=;))/i],[[g,J]],[/((?:i[346]|x)86)[;\)]/i],[[g,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[g,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[g,"armhf"]],[/windows (ce|mobile); ppc;/i],[[g,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[g,/ower/,s,J]],[/(sun4\w)[;\)]/i],[[g,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[g,J]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[pt]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[i,[d,w],[u,k]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[i,[d,w],[u,y]],[/\((ip(?:hone|od)[\w ]*);/i],[i,[d,ne],[u,y]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[i,[d,ne],[u,k]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[i,[d,ie],[u,k]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}-[atu]?[ln][01259x][012359][an]?)\b(?!.+d\/s)/i],[i,[d,ie],[u,y]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[i,/_/g," "],[d,A],[u,y]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[i,/_/g," "],[d,A],[u,k]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[i,[d,"OPPO"],[u,y]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[i,[d,"Vivo"],[u,y]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[i,[d,"Realme"],[u,y]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[i,[d,we],[u,y]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[i,[d,we],[u,k]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[i,[d,Le],[u,k]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[i,[d,Le],[u,y]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[i,[d,"Lenovo"],[u,k]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[i,/_/g," "],[d,"Nokia"],[u,y]],[/(pixel c)\b/i],[i,[d,de],[u,k]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[i,[d,de],[u,y]],[/droid.+ ([c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[i,[d,S],[u,y]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[i,"Xperia Tablet"],[d,S],[u,k]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[i,[d,"OnePlus"],[u,y]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[i,[d,L],[u,k]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[i,/(.+)/g,"Fire Phone $1"],[d,L],[u,y]],[/(playbook);[-\w\),; ]+(rim)/i],[i,d,[u,k]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[i,[d,Oe],[u,y]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[i,[d,pe],[u,k]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[i,[d,pe],[u,y]],[/(nexus 9)/i],[i,[d,"HTC"],[u,k]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic|sony)[-_ ]?([-\w]*)/i],[d,[i,/_/g," "],[u,y]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[i,[d,"Acer"],[u,k]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[i,[d,"Meizu"],[u,y]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[i,[d,"Sharp"],[u,y]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[d,i,[u,y]],[/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[d,i,[u,k]],[/(surface duo)/i],[i,[d,ge],[u,k]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[i,[d,"Fairphone"],[u,y]],[/(u304aa)/i],[i,[d,"AT&T"],[u,y]],[/\bsie-(\w*)/i],[i,[d,"Siemens"],[u,y]],[/\b(rct\w+) b/i],[i,[d,"RCA"],[u,k]],[/\b(venue[\d ]{2,7}) b/i],[i,[d,"Dell"],[u,k]],[/\b(q(?:mv|ta)\w+) b/i],[i,[d,"Verizon"],[u,k]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[i,[d,"Barnes & Noble"],[u,k]],[/\b(tm\d{3}\w+) b/i],[i,[d,"NuVision"],[u,k]],[/\b(k88) b/i],[i,[d,"ZTE"],[u,k]],[/\b(nx\d{3}j) b/i],[i,[d,"ZTE"],[u,y]],[/\b(gen\d{3}) b.+49h/i],[i,[d,"Swiss"],[u,y]],[/\b(zur\d{3}) b/i],[i,[d,"Swiss"],[u,k]],[/\b((zeki)?tb.*\b) b/i],[i,[d,"Zeki"],[u,k]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[d,"Dragon Touch"],i,[u,k]],[/\b(ns-?\w{0,9}) b/i],[i,[d,"Insignia"],[u,k]],[/\b((nxa|next)-?\w{0,9}) b/i],[i,[d,"NextBook"],[u,k]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[d,"Voice"],i,[u,y]],[/\b(lvtel\-)?(v1[12]) b/i],[[d,"LvTel"],i,[u,y]],[/\b(ph-1) /i],[i,[d,"Essential"],[u,y]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[i,[d,"Envizen"],[u,k]],[/\b(trio[-\w\. ]+) b/i],[i,[d,"MachSpeed"],[u,k]],[/\btu_(1491) b/i],[i,[d,"Rotor"],[u,k]],[/(shield[\w ]+) b/i],[i,[d,"Nvidia"],[u,k]],[/(sprint) (\w+)/i],[d,i,[u,y]],[/(kin\.[onetw]{3})/i],[[i,/\./g," "],[d,ge],[u,y]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[i,[d,C],[u,k]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[i,[d,C],[u,y]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[d,i,[u,$]],[/droid.+; (shield) bui/i],[i,[d,"Nvidia"],[u,$]],[/(playstation [345portablevi]+)/i],[i,[d,S],[u,$]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[i,[d,ge],[u,$]],[/smart-tv.+(samsung)/i],[d,[u,N]],[/hbbtv.+maple;(\d+)/i],[[i,/^/,"SmartTV"],[d,w],[u,N]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[d,Le],[u,N]],[/(apple) ?tv/i],[d,[i,ne+" TV"],[u,N]],[/crkey/i],[[i,_e+"cast"],[d,de],[u,N]],[/droid.+aft(\w)( bui|\))/i],[i,[d,L],[u,N]],[/\(dtv[\);].+(aquos)/i],[i,[d,"Sharp"],[u,N]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w ]*; *(\w[^;]*);([^;]*)/i],[[d,z],[i,z],[u,N]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[u,N]],[/((pebble))app/i],[d,i,[u,M]],[/droid.+; (glass) \d/i],[i,[d,de],[u,M]],[/droid.+; (wt63?0{2,3})\)/i],[i,[d,C],[u,M]],[/(quest( 2)?)/i],[i,[d,T],[u,M]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[d,[u,F]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[i,[u,y]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[i,[u,k]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[u,k]],[/(phone|mobile(?:[;\/]| safari)|pda(?=.+windows ce))/i],[[u,y]],[/(android[-\w\. ]{0,9});.+buil/i],[i,[d,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[_,[l,Ce+"HTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[_,[l,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[l,_],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[_,l]],os:[[/microsoft (windows) (vista|xp)/i],[l,_],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[l,[_,W,se]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[l,"Windows"],[_,W,se]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[_,/_/g,"."],[l,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[l,"Mac OS"],[_,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86)/i],[_,l],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[l,_],[/\(bb(10);/i],[_,[l,Oe]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[_,[l,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[_,[l,ve+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[_,[l,"webOS"]],[/crkey\/([\d\.]+)/i],[_,[l,_e+"cast"]],[/(cros) [\w]+ ([\w\.]+\w)/i],[[l,"Chromium OS"],_],[/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[l,_],[/(sunos) ?([\w\.\d]*)/i],[[l,"Solaris"],_],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[l,_]]},te=function(B,U){if(typeof B===b&&(U=B,B=o),!(this instanceof te))return new te(B,U).getResult();var O=B||(typeof e!==f&&e.navigator&&e.navigator.userAgent?e.navigator.userAgent:s),j=U?R(ke,U):ke;return this.getBrowser=function(){var H={};return H[l]=o,H[_]=o,V.call(H,O,j.browser),H.major=fe(H.version),H},this.getCPU=function(){var H={};return H[g]=o,V.call(H,O,j.cpu),H},this.getDevice=function(){var H={};return H[d]=o,H[i]=o,H[u]=o,V.call(H,O,j.device),H},this.getEngine=function(){var H={};return H[l]=o,H[_]=o,V.call(H,O,j.engine),H},this.getOS=function(){var H={};return H[l]=o,H[_]=o,V.call(H,O,j.os),H},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return O},this.setUA=function(H){return O=typeof H===p&&H.length>Y?z(H,Y):H,this},this.setUA(O),this};te.VERSION=a,te.BROWSER=q([l,_,r]),te.CPU=q([g]),te.DEVICE=q([i,d,u,$,y,N,k,M,F]),te.ENGINE=te.OS=q([l,_]),n.exports&&(t=n.exports=te),t.UAParser=te;var be=typeof e!==f&&(e.jQuery||e.Zepto);if(be&&!be.ua){var Ee=new te;be.ua=Ee.getResult(),be.ua.get=function(){return Ee.getUA()},be.ua.set=function(B){Ee.setUA(B);var U=Ee.getResult();for(var O in U)be.ua[O]=U[O]}}})(typeof window=="object"?window:Ze)})(Yt,Yt.exports);var Si=Yt.exports;const $n=Si(),$i=fi(),it=yi(),ki={size:1024,tiles:8,boardStyle:"standard",piecesStyle:"tatiana",showBorder:!1,showExtraInfo:!0,showMaterial:!0,showMoveIndicator:!0,showChecks:!0,showCoords:!0,showShadows:!1,flipped:!1,puzzle:!1},Ai={titleScreen:!0,format:"GIF",picSize:"M",animationSize:"M"},xi={darkMode:!0,sounds:!0,speech:!1,wrongBrowserPopup:!0,androidAppPopup:!0,iOSAppPopup:!0},Ti={boardConfig:{...ki,...it.boardConfig},gameConfig:{...Ai,...it.gameConfig},siteConfig:{...xi,...it.siteConfig},game:new st,pgn:"",fen:"",moves:[],ply:0,mobile:$i,layout:window.innerWidth<window.innerHeight?"single":window.innerWidth<1366?"double":"triple",activeTab:"load",activeLeftTab:"share",playing:!1,anonymous:!1,refreshHash:!0,browser:$n.browser.name,os:$n.os.name,about:!1,userStylesInfo:!1,fullscreenPopup:null,recent:it.recent,favoritePieces:it.pieces,favoriteBoards:it.boards,showFavoritePieces:!1,showFavoriteBoards:!1},[v,P]=bi(Ti);var le={};/*!
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(n){(function(){var t=function(){this.init()};t.prototype={init:function(){var r=this||e;return r._counter=1e3,r._html5AudioPool=[],r.html5PoolSize=10,r._codecs={},r._howls=[],r._muted=!1,r._volume=1,r._canPlayEvent="canplaythrough",r._navigator=typeof window<"u"&&window.navigator?window.navigator:null,r.masterGain=null,r.noAudio=!1,r.usingWebAudio=!0,r.autoSuspend=!0,r.ctx=null,r.autoUnlock=!0,r._setup(),r},volume:function(r){var i=this||e;if(r=parseFloat(r),i.ctx||p(),typeof r<"u"&&r>=0&&r<=1){if(i._volume=r,i._muted)return i;i.usingWebAudio&&i.masterGain.gain.setValueAtTime(r,e.ctx.currentTime);for(var l=0;l<i._howls.length;l++)if(!i._howls[l]._webAudio)for(var u=i._howls[l]._getSoundIds(),d=0;d<u.length;d++){var _=i._howls[l]._soundById(u[d]);_&&_._node&&(_._node.volume=_._volume*r)}return i}return i._volume},mute:function(r){var i=this||e;i.ctx||p(),i._muted=r,i.usingWebAudio&&i.masterGain.gain.setValueAtTime(r?0:i._volume,e.ctx.currentTime);for(var l=0;l<i._howls.length;l++)if(!i._howls[l]._webAudio)for(var u=i._howls[l]._getSoundIds(),d=0;d<u.length;d++){var _=i._howls[l]._soundById(u[d]);_&&_._node&&(_._node.muted=r?!0:_._muted)}return i},stop:function(){for(var r=this||e,i=0;i<r._howls.length;i++)r._howls[i].stop();return r},unload:function(){for(var r=this||e,i=r._howls.length-1;i>=0;i--)r._howls[i].unload();return r.usingWebAudio&&r.ctx&&typeof r.ctx.close<"u"&&(r.ctx.close(),r.ctx=null,p()),r},codecs:function(r){return(this||e)._codecs[r.replace(/^x-/,"")]},_setup:function(){var r=this||e;if(r.state=r.ctx&&r.ctx.state||"suspended",r._autoSuspend(),!r.usingWebAudio)if(typeof Audio<"u")try{var i=new Audio;typeof i.oncanplaythrough>"u"&&(r._canPlayEvent="canplay")}catch{r.noAudio=!0}else r.noAudio=!0;try{var i=new Audio;i.muted&&(r.noAudio=!0)}catch{}return r.noAudio||r._setupCodecs(),r},_setupCodecs:function(){var r=this||e,i=null;try{i=typeof Audio<"u"?new Audio:null}catch{return r}if(!i||typeof i.canPlayType!="function")return r;var l=i.canPlayType("audio/mpeg;").replace(/^no$/,""),u=r._navigator?r._navigator.userAgent:"",d=u.match(/OPR\/([0-6].)/g),_=d&&parseInt(d[0].split("/")[1],10)<33,g=u.indexOf("Safari")!==-1&&u.indexOf("Chrome")===-1,$=u.match(/Version\/(.*?) /),y=g&&$&&parseInt($[1],10)<15;return r._codecs={mp3:!!(!_&&(l||i.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!l,opus:!!i.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!i.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!i.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(i.canPlayType('audio/wav; codecs="1"')||i.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!i.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!i.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(i.canPlayType("audio/x-m4a;")||i.canPlayType("audio/m4a;")||i.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(i.canPlayType("audio/x-m4b;")||i.canPlayType("audio/m4b;")||i.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(i.canPlayType("audio/x-mp4;")||i.canPlayType("audio/mp4;")||i.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!y&&i.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!y&&i.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!i.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(i.canPlayType("audio/x-flac;")||i.canPlayType("audio/flac;")).replace(/^no$/,"")},r},_unlockAudio:function(){var r=this||e;if(!(r._audioUnlocked||!r.ctx)){r._audioUnlocked=!1,r.autoUnlock=!1,!r._mobileUnloaded&&r.ctx.sampleRate!==44100&&(r._mobileUnloaded=!0,r.unload()),r._scratchBuffer=r.ctx.createBuffer(1,1,22050);var i=function(l){for(;r._html5AudioPool.length<r.html5PoolSize;)try{var u=new Audio;u._unlocked=!0,r._releaseHtml5Audio(u)}catch{r.noAudio=!0;break}for(var d=0;d<r._howls.length;d++)if(!r._howls[d]._webAudio)for(var _=r._howls[d]._getSoundIds(),g=0;g<_.length;g++){var $=r._howls[d]._soundById(_[g]);$&&$._node&&!$._node._unlocked&&($._node._unlocked=!0,$._node.load())}r._autoResume();var y=r.ctx.createBufferSource();y.buffer=r._scratchBuffer,y.connect(r.ctx.destination),typeof y.start>"u"?y.noteOn(0):y.start(0),typeof r.ctx.resume=="function"&&r.ctx.resume(),y.onended=function(){y.disconnect(0),r._audioUnlocked=!0,document.removeEventListener("touchstart",i,!0),document.removeEventListener("touchend",i,!0),document.removeEventListener("click",i,!0),document.removeEventListener("keydown",i,!0);for(var k=0;k<r._howls.length;k++)r._howls[k]._emit("unlock")}};return document.addEventListener("touchstart",i,!0),document.addEventListener("touchend",i,!0),document.addEventListener("click",i,!0),document.addEventListener("keydown",i,!0),r}},_obtainHtml5Audio:function(){var r=this||e;if(r._html5AudioPool.length)return r._html5AudioPool.pop();var i=new Audio().play();return i&&typeof Promise<"u"&&(i instanceof Promise||typeof i.then=="function")&&i.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(r){var i=this||e;return r._unlocked&&i._html5AudioPool.push(r),i},_autoSuspend:function(){var r=this;if(!(!r.autoSuspend||!r.ctx||typeof r.ctx.suspend>"u"||!e.usingWebAudio)){for(var i=0;i<r._howls.length;i++)if(r._howls[i]._webAudio){for(var l=0;l<r._howls[i]._sounds.length;l++)if(!r._howls[i]._sounds[l]._paused)return r}return r._suspendTimer&&clearTimeout(r._suspendTimer),r._suspendTimer=setTimeout(function(){if(!!r.autoSuspend){r._suspendTimer=null,r.state="suspending";var u=function(){r.state="suspended",r._resumeAfterSuspend&&(delete r._resumeAfterSuspend,r._autoResume())};r.ctx.suspend().then(u,u)}},3e4),r}},_autoResume:function(){var r=this;if(!(!r.ctx||typeof r.ctx.resume>"u"||!e.usingWebAudio))return r.state==="running"&&r.ctx.state!=="interrupted"&&r._suspendTimer?(clearTimeout(r._suspendTimer),r._suspendTimer=null):r.state==="suspended"||r.state==="running"&&r.ctx.state==="interrupted"?(r.ctx.resume().then(function(){r.state="running";for(var i=0;i<r._howls.length;i++)r._howls[i]._emit("resume")}),r._suspendTimer&&(clearTimeout(r._suspendTimer),r._suspendTimer=null)):r.state==="suspending"&&(r._resumeAfterSuspend=!0),r}};var e=new t,o=function(r){var i=this;if(!r.src||r.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}i.init(r)};o.prototype={init:function(r){var i=this;return e.ctx||p(),i._autoplay=r.autoplay||!1,i._format=typeof r.format!="string"?r.format:[r.format],i._html5=r.html5||!1,i._muted=r.mute||!1,i._loop=r.loop||!1,i._pool=r.pool||5,i._preload=typeof r.preload=="boolean"||r.preload==="metadata"?r.preload:!0,i._rate=r.rate||1,i._sprite=r.sprite||{},i._src=typeof r.src!="string"?r.src:[r.src],i._volume=r.volume!==void 0?r.volume:1,i._xhr={method:r.xhr&&r.xhr.method?r.xhr.method:"GET",headers:r.xhr&&r.xhr.headers?r.xhr.headers:null,withCredentials:r.xhr&&r.xhr.withCredentials?r.xhr.withCredentials:!1},i._duration=0,i._state="unloaded",i._sounds=[],i._endTimers={},i._queue=[],i._playLock=!1,i._onend=r.onend?[{fn:r.onend}]:[],i._onfade=r.onfade?[{fn:r.onfade}]:[],i._onload=r.onload?[{fn:r.onload}]:[],i._onloaderror=r.onloaderror?[{fn:r.onloaderror}]:[],i._onplayerror=r.onplayerror?[{fn:r.onplayerror}]:[],i._onpause=r.onpause?[{fn:r.onpause}]:[],i._onplay=r.onplay?[{fn:r.onplay}]:[],i._onstop=r.onstop?[{fn:r.onstop}]:[],i._onmute=r.onmute?[{fn:r.onmute}]:[],i._onvolume=r.onvolume?[{fn:r.onvolume}]:[],i._onrate=r.onrate?[{fn:r.onrate}]:[],i._onseek=r.onseek?[{fn:r.onseek}]:[],i._onunlock=r.onunlock?[{fn:r.onunlock}]:[],i._onresume=[],i._webAudio=e.usingWebAudio&&!i._html5,typeof e.ctx<"u"&&e.ctx&&e.autoUnlock&&e._unlockAudio(),e._howls.push(i),i._autoplay&&i._queue.push({event:"play",action:function(){i.play()}}),i._preload&&i._preload!=="none"&&i.load(),i},load:function(){var r=this,i=null;if(e.noAudio){r._emit("loaderror",null,"No audio support.");return}typeof r._src=="string"&&(r._src=[r._src]);for(var l=0;l<r._src.length;l++){var u,d;if(r._format&&r._format[l])u=r._format[l];else{if(d=r._src[l],typeof d!="string"){r._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}u=/^data:audio\/([^;,]+);/i.exec(d),u||(u=/\.([^.]+)$/.exec(d.split("?",1)[0])),u&&(u=u[1].toLowerCase())}if(u||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),u&&e.codecs(u)){i=r._src[l];break}}if(!i){r._emit("loaderror",null,"No codec support for selected audio sources.");return}return r._src=i,r._state="loading",window.location.protocol==="https:"&&i.slice(0,5)==="http:"&&(r._html5=!0,r._webAudio=!1),new a(r),r._webAudio&&c(r),r},play:function(r,i){var l=this,u=null;if(typeof r=="number")u=r,r=null;else{if(typeof r=="string"&&l._state==="loaded"&&!l._sprite[r])return null;if(typeof r>"u"&&(r="__default",!l._playLock)){for(var d=0,_=0;_<l._sounds.length;_++)l._sounds[_]._paused&&!l._sounds[_]._ended&&(d++,u=l._sounds[_]._id);d===1?r=null:u=null}}var g=u?l._soundById(u):l._inactiveSound();if(!g)return null;if(u&&!r&&(r=g._sprite||"__default"),l._state!=="loaded"){g._sprite=r,g._ended=!1;var $=g._id;return l._queue.push({event:"play",action:function(){l.play($)}}),$}if(u&&!g._paused)return i||l._loadQueue("play"),g._id;l._webAudio&&e._autoResume();var y=Math.max(0,g._seek>0?g._seek:l._sprite[r][0]/1e3),k=Math.max(0,(l._sprite[r][0]+l._sprite[r][1])/1e3-y),N=k*1e3/Math.abs(g._rate),M=l._sprite[r][0]/1e3,F=(l._sprite[r][0]+l._sprite[r][1])/1e3;g._sprite=r,g._ended=!1;var Y=function(){g._paused=!1,g._seek=y,g._start=M,g._stop=F,g._loop=!!(g._loop||l._sprite[r][2])};if(y>=F){l._ended(g);return}var L=g._node;if(l._webAudio){var ne=function(){l._playLock=!1,Y(),l._refreshBuffer(g);var _e=g._muted||l._muted?0:g._volume;L.gain.setValueAtTime(_e,e.ctx.currentTime),g._playStart=e.ctx.currentTime,typeof L.bufferSource.start>"u"?g._loop?L.bufferSource.noteGrainOn(0,y,86400):L.bufferSource.noteGrainOn(0,y,k):g._loop?L.bufferSource.start(0,y,86400):L.bufferSource.start(0,y,k),N!==1/0&&(l._endTimers[g._id]=setTimeout(l._ended.bind(l,g),N)),i||setTimeout(function(){l._emit("play",g._id),l._loadQueue()},0)};e.state==="running"&&e.ctx.state!=="interrupted"?ne():(l._playLock=!0,l.once("resume",ne),l._clearTimer(g._id))}else{var pe=function(){L.currentTime=y,L.muted=g._muted||l._muted||e._muted||L.muted,L.volume=g._volume*e.volume(),L.playbackRate=g._rate;try{var _e=L.play();if(_e&&typeof Promise<"u"&&(_e instanceof Promise||typeof _e.then=="function")?(l._playLock=!0,Y(),_e.then(function(){l._playLock=!1,L._unlocked=!0,i?l._loadQueue():l._emit("play",g._id)}).catch(function(){l._playLock=!1,l._emit("playerror",g._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),g._ended=!0,g._paused=!0})):i||(l._playLock=!1,Y(),l._emit("play",g._id)),L.playbackRate=g._rate,L.paused){l._emit("playerror",g._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}r!=="__default"||g._loop?l._endTimers[g._id]=setTimeout(l._ended.bind(l,g),N):(l._endTimers[g._id]=function(){l._ended(g),L.removeEventListener("ended",l._endTimers[g._id],!1)},L.addEventListener("ended",l._endTimers[g._id],!1))}catch(Ce){l._emit("playerror",g._id,Ce)}};L.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(L.src=l._src,L.load());var Oe=window&&window.ejecta||!L.readyState&&e._navigator.isCocoonJS;if(L.readyState>=3||Oe)pe();else{l._playLock=!0,l._state="loading";var me=function(){l._state="loaded",pe(),L.removeEventListener(e._canPlayEvent,me,!1)};L.addEventListener(e._canPlayEvent,me,!1),l._clearTimer(g._id)}}return g._id},pause:function(r){var i=this;if(i._state!=="loaded"||i._playLock)return i._queue.push({event:"pause",action:function(){i.pause(r)}}),i;for(var l=i._getSoundIds(r),u=0;u<l.length;u++){i._clearTimer(l[u]);var d=i._soundById(l[u]);if(d&&!d._paused&&(d._seek=i.seek(l[u]),d._rateSeek=0,d._paused=!0,i._stopFade(l[u]),d._node))if(i._webAudio){if(!d._node.bufferSource)continue;typeof d._node.bufferSource.stop>"u"?d._node.bufferSource.noteOff(0):d._node.bufferSource.stop(0),i._cleanBuffer(d._node)}else(!isNaN(d._node.duration)||d._node.duration===1/0)&&d._node.pause();arguments[1]||i._emit("pause",d?d._id:null)}return i},stop:function(r,i){var l=this;if(l._state!=="loaded"||l._playLock)return l._queue.push({event:"stop",action:function(){l.stop(r)}}),l;for(var u=l._getSoundIds(r),d=0;d<u.length;d++){l._clearTimer(u[d]);var _=l._soundById(u[d]);_&&(_._seek=_._start||0,_._rateSeek=0,_._paused=!0,_._ended=!0,l._stopFade(u[d]),_._node&&(l._webAudio?_._node.bufferSource&&(typeof _._node.bufferSource.stop>"u"?_._node.bufferSource.noteOff(0):_._node.bufferSource.stop(0),l._cleanBuffer(_._node)):(!isNaN(_._node.duration)||_._node.duration===1/0)&&(_._node.currentTime=_._start||0,_._node.pause(),_._node.duration===1/0&&l._clearSound(_._node))),i||l._emit("stop",_._id))}return l},mute:function(r,i){var l=this;if(l._state!=="loaded"||l._playLock)return l._queue.push({event:"mute",action:function(){l.mute(r,i)}}),l;if(typeof i>"u")if(typeof r=="boolean")l._muted=r;else return l._muted;for(var u=l._getSoundIds(i),d=0;d<u.length;d++){var _=l._soundById(u[d]);_&&(_._muted=r,_._interval&&l._stopFade(_._id),l._webAudio&&_._node?_._node.gain.setValueAtTime(r?0:_._volume,e.ctx.currentTime):_._node&&(_._node.muted=e._muted?!0:r),l._emit("mute",_._id))}return l},volume:function(){var r=this,i=arguments,l,u;if(i.length===0)return r._volume;if(i.length===1||i.length===2&&typeof i[1]>"u"){var d=r._getSoundIds(),_=d.indexOf(i[0]);_>=0?u=parseInt(i[0],10):l=parseFloat(i[0])}else i.length>=2&&(l=parseFloat(i[0]),u=parseInt(i[1],10));var g;if(typeof l<"u"&&l>=0&&l<=1){if(r._state!=="loaded"||r._playLock)return r._queue.push({event:"volume",action:function(){r.volume.apply(r,i)}}),r;typeof u>"u"&&(r._volume=l),u=r._getSoundIds(u);for(var $=0;$<u.length;$++)g=r._soundById(u[$]),g&&(g._volume=l,i[2]||r._stopFade(u[$]),r._webAudio&&g._node&&!g._muted?g._node.gain.setValueAtTime(l,e.ctx.currentTime):g._node&&!g._muted&&(g._node.volume=l*e.volume()),r._emit("volume",g._id))}else return g=u?r._soundById(u):r._sounds[0],g?g._volume:0;return r},fade:function(r,i,l,u){var d=this;if(d._state!=="loaded"||d._playLock)return d._queue.push({event:"fade",action:function(){d.fade(r,i,l,u)}}),d;r=Math.min(Math.max(0,parseFloat(r)),1),i=Math.min(Math.max(0,parseFloat(i)),1),l=parseFloat(l),d.volume(r,u);for(var _=d._getSoundIds(u),g=0;g<_.length;g++){var $=d._soundById(_[g]);if($){if(u||d._stopFade(_[g]),d._webAudio&&!$._muted){var y=e.ctx.currentTime,k=y+l/1e3;$._volume=r,$._node.gain.setValueAtTime(r,y),$._node.gain.linearRampToValueAtTime(i,k)}d._startFadeInterval($,r,i,l,_[g],typeof u>"u")}}return d},_startFadeInterval:function(r,i,l,u,d,_){var g=this,$=i,y=l-i,k=Math.abs(y/.01),N=Math.max(4,k>0?u/k:u),M=Date.now();r._fadeTo=l,r._interval=setInterval(function(){var F=(Date.now()-M)/u;M=Date.now(),$+=y*F,$=Math.round($*100)/100,y<0?$=Math.max(l,$):$=Math.min(l,$),g._webAudio?r._volume=$:g.volume($,r._id,!0),_&&(g._volume=$),(l<i&&$<=l||l>i&&$>=l)&&(clearInterval(r._interval),r._interval=null,r._fadeTo=null,g.volume(l,r._id),g._emit("fade",r._id))},N)},_stopFade:function(r){var i=this,l=i._soundById(r);return l&&l._interval&&(i._webAudio&&l._node.gain.cancelScheduledValues(e.ctx.currentTime),clearInterval(l._interval),l._interval=null,i.volume(l._fadeTo,r),l._fadeTo=null,i._emit("fade",r)),i},loop:function(){var r=this,i=arguments,l,u,d;if(i.length===0)return r._loop;if(i.length===1)if(typeof i[0]=="boolean")l=i[0],r._loop=l;else return d=r._soundById(parseInt(i[0],10)),d?d._loop:!1;else i.length===2&&(l=i[0],u=parseInt(i[1],10));for(var _=r._getSoundIds(u),g=0;g<_.length;g++)d=r._soundById(_[g]),d&&(d._loop=l,r._webAudio&&d._node&&d._node.bufferSource&&(d._node.bufferSource.loop=l,l&&(d._node.bufferSource.loopStart=d._start||0,d._node.bufferSource.loopEnd=d._stop,r.playing(_[g])&&(r.pause(_[g],!0),r.play(_[g],!0)))));return r},rate:function(){var r=this,i=arguments,l,u;if(i.length===0)u=r._sounds[0]._id;else if(i.length===1){var d=r._getSoundIds(),_=d.indexOf(i[0]);_>=0?u=parseInt(i[0],10):l=parseFloat(i[0])}else i.length===2&&(l=parseFloat(i[0]),u=parseInt(i[1],10));var g;if(typeof l=="number"){if(r._state!=="loaded"||r._playLock)return r._queue.push({event:"rate",action:function(){r.rate.apply(r,i)}}),r;typeof u>"u"&&(r._rate=l),u=r._getSoundIds(u);for(var $=0;$<u.length;$++)if(g=r._soundById(u[$]),g){r.playing(u[$])&&(g._rateSeek=r.seek(u[$]),g._playStart=r._webAudio?e.ctx.currentTime:g._playStart),g._rate=l,r._webAudio&&g._node&&g._node.bufferSource?g._node.bufferSource.playbackRate.setValueAtTime(l,e.ctx.currentTime):g._node&&(g._node.playbackRate=l);var y=r.seek(u[$]),k=(r._sprite[g._sprite][0]+r._sprite[g._sprite][1])/1e3-y,N=k*1e3/Math.abs(g._rate);(r._endTimers[u[$]]||!g._paused)&&(r._clearTimer(u[$]),r._endTimers[u[$]]=setTimeout(r._ended.bind(r,g),N)),r._emit("rate",g._id)}}else return g=r._soundById(u),g?g._rate:r._rate;return r},seek:function(){var r=this,i=arguments,l,u;if(i.length===0)r._sounds.length&&(u=r._sounds[0]._id);else if(i.length===1){var d=r._getSoundIds(),_=d.indexOf(i[0]);_>=0?u=parseInt(i[0],10):r._sounds.length&&(u=r._sounds[0]._id,l=parseFloat(i[0]))}else i.length===2&&(l=parseFloat(i[0]),u=parseInt(i[1],10));if(typeof u>"u")return 0;if(typeof l=="number"&&(r._state!=="loaded"||r._playLock))return r._queue.push({event:"seek",action:function(){r.seek.apply(r,i)}}),r;var g=r._soundById(u);if(g)if(typeof l=="number"&&l>=0){var $=r.playing(u);$&&r.pause(u,!0),g._seek=l,g._ended=!1,r._clearTimer(u),!r._webAudio&&g._node&&!isNaN(g._node.duration)&&(g._node.currentTime=l);var y=function(){$&&r.play(u,!0),r._emit("seek",u)};if($&&!r._webAudio){var k=function(){r._playLock?setTimeout(k,0):y()};setTimeout(k,0)}else y()}else if(r._webAudio){var N=r.playing(u)?e.ctx.currentTime-g._playStart:0,M=g._rateSeek?g._rateSeek-g._seek:0;return g._seek+(M+N*Math.abs(g._rate))}else return g._node.currentTime;return r},playing:function(r){var i=this;if(typeof r=="number"){var l=i._soundById(r);return l?!l._paused:!1}for(var u=0;u<i._sounds.length;u++)if(!i._sounds[u]._paused)return!0;return!1},duration:function(r){var i=this,l=i._duration,u=i._soundById(r);return u&&(l=i._sprite[u._sprite][1]/1e3),l},state:function(){return this._state},unload:function(){for(var r=this,i=r._sounds,l=0;l<i.length;l++)i[l]._paused||r.stop(i[l]._id),r._webAudio||(r._clearSound(i[l]._node),i[l]._node.removeEventListener("error",i[l]._errorFn,!1),i[l]._node.removeEventListener(e._canPlayEvent,i[l]._loadFn,!1),i[l]._node.removeEventListener("ended",i[l]._endFn,!1),e._releaseHtml5Audio(i[l]._node)),delete i[l]._node,r._clearTimer(i[l]._id);var u=e._howls.indexOf(r);u>=0&&e._howls.splice(u,1);var d=!0;for(l=0;l<e._howls.length;l++)if(e._howls[l]._src===r._src||r._src.indexOf(e._howls[l]._src)>=0){d=!1;break}return s&&d&&delete s[r._src],e.noAudio=!1,r._state="unloaded",r._sounds=[],r=null,null},on:function(r,i,l,u){var d=this,_=d["_on"+r];return typeof i=="function"&&_.push(u?{id:l,fn:i,once:u}:{id:l,fn:i}),d},off:function(r,i,l){var u=this,d=u["_on"+r],_=0;if(typeof i=="number"&&(l=i,i=null),i||l)for(_=0;_<d.length;_++){var g=l===d[_].id;if(i===d[_].fn&&g||!i&&g){d.splice(_,1);break}}else if(r)u["_on"+r]=[];else{var $=Object.keys(u);for(_=0;_<$.length;_++)$[_].indexOf("_on")===0&&Array.isArray(u[$[_]])&&(u[$[_]]=[])}return u},once:function(r,i,l){var u=this;return u.on(r,i,l,1),u},_emit:function(r,i,l){for(var u=this,d=u["_on"+r],_=d.length-1;_>=0;_--)(!d[_].id||d[_].id===i||r==="load")&&(setTimeout(function(g){g.call(this,i,l)}.bind(u,d[_].fn),0),d[_].once&&u.off(r,d[_].fn,d[_].id));return u._loadQueue(r),u},_loadQueue:function(r){var i=this;if(i._queue.length>0){var l=i._queue[0];l.event===r&&(i._queue.shift(),i._loadQueue()),r||l.action()}return i},_ended:function(r){var i=this,l=r._sprite;if(!i._webAudio&&r._node&&!r._node.paused&&!r._node.ended&&r._node.currentTime<r._stop)return setTimeout(i._ended.bind(i,r),100),i;var u=!!(r._loop||i._sprite[l][2]);if(i._emit("end",r._id),!i._webAudio&&u&&i.stop(r._id,!0).play(r._id),i._webAudio&&u){i._emit("play",r._id),r._seek=r._start||0,r._rateSeek=0,r._playStart=e.ctx.currentTime;var d=(r._stop-r._start)*1e3/Math.abs(r._rate);i._endTimers[r._id]=setTimeout(i._ended.bind(i,r),d)}return i._webAudio&&!u&&(r._paused=!0,r._ended=!0,r._seek=r._start||0,r._rateSeek=0,i._clearTimer(r._id),i._cleanBuffer(r._node),e._autoSuspend()),!i._webAudio&&!u&&i.stop(r._id,!0),i},_clearTimer:function(r){var i=this;if(i._endTimers[r]){if(typeof i._endTimers[r]!="function")clearTimeout(i._endTimers[r]);else{var l=i._soundById(r);l&&l._node&&l._node.removeEventListener("ended",i._endTimers[r],!1)}delete i._endTimers[r]}return i},_soundById:function(r){for(var i=this,l=0;l<i._sounds.length;l++)if(r===i._sounds[l]._id)return i._sounds[l];return null},_inactiveSound:function(){var r=this;r._drain();for(var i=0;i<r._sounds.length;i++)if(r._sounds[i]._ended)return r._sounds[i].reset();return new a(r)},_drain:function(){var r=this,i=r._pool,l=0,u=0;if(!(r._sounds.length<i)){for(u=0;u<r._sounds.length;u++)r._sounds[u]._ended&&l++;for(u=r._sounds.length-1;u>=0;u--){if(l<=i)return;r._sounds[u]._ended&&(r._webAudio&&r._sounds[u]._node&&r._sounds[u]._node.disconnect(0),r._sounds.splice(u,1),l--)}}},_getSoundIds:function(r){var i=this;if(typeof r>"u"){for(var l=[],u=0;u<i._sounds.length;u++)l.push(i._sounds[u]._id);return l}else return[r]},_refreshBuffer:function(r){var i=this;return r._node.bufferSource=e.ctx.createBufferSource(),r._node.bufferSource.buffer=s[i._src],r._panner?r._node.bufferSource.connect(r._panner):r._node.bufferSource.connect(r._node),r._node.bufferSource.loop=r._loop,r._loop&&(r._node.bufferSource.loopStart=r._start||0,r._node.bufferSource.loopEnd=r._stop||0),r._node.bufferSource.playbackRate.setValueAtTime(r._rate,e.ctx.currentTime),i},_cleanBuffer:function(r){var i=this,l=e._navigator&&e._navigator.vendor.indexOf("Apple")>=0;if(e._scratchBuffer&&r.bufferSource&&(r.bufferSource.onended=null,r.bufferSource.disconnect(0),l))try{r.bufferSource.buffer=e._scratchBuffer}catch{}return r.bufferSource=null,i},_clearSound:function(r){var i=/MSIE |Trident\//.test(e._navigator&&e._navigator.userAgent);i||(r.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var a=function(r){this._parent=r,this.init()};a.prototype={init:function(){var r=this,i=r._parent;return r._muted=i._muted,r._loop=i._loop,r._volume=i._volume,r._rate=i._rate,r._seek=0,r._paused=!0,r._ended=!0,r._sprite="__default",r._id=++e._counter,i._sounds.push(r),r.create(),r},create:function(){var r=this,i=r._parent,l=e._muted||r._muted||r._parent._muted?0:r._volume;return i._webAudio?(r._node=typeof e.ctx.createGain>"u"?e.ctx.createGainNode():e.ctx.createGain(),r._node.gain.setValueAtTime(l,e.ctx.currentTime),r._node.paused=!0,r._node.connect(e.masterGain)):e.noAudio||(r._node=e._obtainHtml5Audio(),r._errorFn=r._errorListener.bind(r),r._node.addEventListener("error",r._errorFn,!1),r._loadFn=r._loadListener.bind(r),r._node.addEventListener(e._canPlayEvent,r._loadFn,!1),r._endFn=r._endListener.bind(r),r._node.addEventListener("ended",r._endFn,!1),r._node.src=i._src,r._node.preload=i._preload===!0?"auto":i._preload,r._node.volume=l*e.volume(),r._node.load()),r},reset:function(){var r=this,i=r._parent;return r._muted=i._muted,r._loop=i._loop,r._volume=i._volume,r._rate=i._rate,r._seek=0,r._rateSeek=0,r._paused=!0,r._ended=!0,r._sprite="__default",r._id=++e._counter,r},_errorListener:function(){var r=this;r._parent._emit("loaderror",r._id,r._node.error?r._node.error.code:0),r._node.removeEventListener("error",r._errorFn,!1)},_loadListener:function(){var r=this,i=r._parent;i._duration=Math.ceil(r._node.duration*10)/10,Object.keys(i._sprite).length===0&&(i._sprite={__default:[0,i._duration*1e3]}),i._state!=="loaded"&&(i._state="loaded",i._emit("load"),i._loadQueue()),r._node.removeEventListener(e._canPlayEvent,r._loadFn,!1)},_endListener:function(){var r=this,i=r._parent;i._duration===1/0&&(i._duration=Math.ceil(r._node.duration*10)/10,i._sprite.__default[1]===1/0&&(i._sprite.__default[1]=i._duration*1e3),i._ended(r)),r._node.removeEventListener("ended",r._endFn,!1)}};var s={},c=function(r){var i=r._src;if(s[i]){r._duration=s[i].duration,b(r);return}if(/^data:[^;]+;base64,/.test(i)){for(var l=atob(i.split(",")[1]),u=new Uint8Array(l.length),d=0;d<l.length;++d)u[d]=l.charCodeAt(d);f(u.buffer,r)}else{var _=new XMLHttpRequest;_.open(r._xhr.method,i,!0),_.withCredentials=r._xhr.withCredentials,_.responseType="arraybuffer",r._xhr.headers&&Object.keys(r._xhr.headers).forEach(function(g){_.setRequestHeader(g,r._xhr.headers[g])}),_.onload=function(){var g=(_.status+"")[0];if(g!=="0"&&g!=="2"&&g!=="3"){r._emit("loaderror",null,"Failed loading audio file with status: "+_.status+".");return}f(_.response,r)},_.onerror=function(){r._webAudio&&(r._html5=!0,r._webAudio=!1,r._sounds=[],delete s[i],r.load())},h(_)}},h=function(r){try{r.send()}catch{r.onerror()}},f=function(r,i){var l=function(){i._emit("loaderror",null,"Decoding audio data failed.")},u=function(d){d&&i._sounds.length>0?(s[i._src]=d,b(i,d)):l()};typeof Promise<"u"&&e.ctx.decodeAudioData.length===1?e.ctx.decodeAudioData(r).then(u).catch(l):e.ctx.decodeAudioData(r,u,l)},b=function(r,i){i&&!r._duration&&(r._duration=i.duration),Object.keys(r._sprite).length===0&&(r._sprite={__default:[0,r._duration*1e3]}),r._state!=="loaded"&&(r._state="loaded",r._emit("load"),r._loadQueue())},p=function(){if(!!e.usingWebAudio){try{typeof AudioContext<"u"?e.ctx=new AudioContext:typeof webkitAudioContext<"u"?e.ctx=new webkitAudioContext:e.usingWebAudio=!1}catch{e.usingWebAudio=!1}e.ctx||(e.usingWebAudio=!1);var r=/iP(hone|od|ad)/.test(e._navigator&&e._navigator.platform),i=e._navigator&&e._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),l=i?parseInt(i[1],10):null;if(r&&l&&l<9){var u=/safari/.test(e._navigator&&e._navigator.userAgent.toLowerCase());e._navigator&&!u&&(e.usingWebAudio=!1)}e.usingWebAudio&&(e.masterGain=typeof e.ctx.createGain>"u"?e.ctx.createGainNode():e.ctx.createGain(),e.masterGain.gain.setValueAtTime(e._muted?0:e._volume,e.ctx.currentTime),e.masterGain.connect(e.ctx.destination)),e._setup()}};n.Howler=e,n.Howl=o,typeof Ze<"u"?(Ze.HowlerGlobal=t,Ze.Howler=e,Ze.Howl=o,Ze.Sound=a):typeof window<"u"&&(window.HowlerGlobal=t,window.Howler=e,window.Howl=o,window.Sound=a)})();/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){var o=this;if(!o.ctx||!o.ctx.listener)return o;for(var a=o._howls.length-1;a>=0;a--)o._howls[a].stereo(e);return o},HowlerGlobal.prototype.pos=function(e,o,a){var s=this;if(!s.ctx||!s.ctx.listener)return s;if(o=typeof o!="number"?s._pos[1]:o,a=typeof a!="number"?s._pos[2]:a,typeof e=="number")s._pos=[e,o,a],typeof s.ctx.listener.positionX<"u"?(s.ctx.listener.positionX.setTargetAtTime(s._pos[0],Howler.ctx.currentTime,.1),s.ctx.listener.positionY.setTargetAtTime(s._pos[1],Howler.ctx.currentTime,.1),s.ctx.listener.positionZ.setTargetAtTime(s._pos[2],Howler.ctx.currentTime,.1)):s.ctx.listener.setPosition(s._pos[0],s._pos[1],s._pos[2]);else return s._pos;return s},HowlerGlobal.prototype.orientation=function(e,o,a,s,c,h){var f=this;if(!f.ctx||!f.ctx.listener)return f;var b=f._orientation;if(o=typeof o!="number"?b[1]:o,a=typeof a!="number"?b[2]:a,s=typeof s!="number"?b[3]:s,c=typeof c!="number"?b[4]:c,h=typeof h!="number"?b[5]:h,typeof e=="number")f._orientation=[e,o,a,s,c,h],typeof f.ctx.listener.forwardX<"u"?(f.ctx.listener.forwardX.setTargetAtTime(e,Howler.ctx.currentTime,.1),f.ctx.listener.forwardY.setTargetAtTime(o,Howler.ctx.currentTime,.1),f.ctx.listener.forwardZ.setTargetAtTime(a,Howler.ctx.currentTime,.1),f.ctx.listener.upX.setTargetAtTime(s,Howler.ctx.currentTime,.1),f.ctx.listener.upY.setTargetAtTime(c,Howler.ctx.currentTime,.1),f.ctx.listener.upZ.setTargetAtTime(h,Howler.ctx.currentTime,.1)):f.ctx.listener.setOrientation(e,o,a,s,c,h);else return b;return f},Howl.prototype.init=function(e){return function(o){var a=this;return a._orientation=o.orientation||[1,0,0],a._stereo=o.stereo||null,a._pos=o.pos||null,a._pannerAttr={coneInnerAngle:typeof o.coneInnerAngle<"u"?o.coneInnerAngle:360,coneOuterAngle:typeof o.coneOuterAngle<"u"?o.coneOuterAngle:360,coneOuterGain:typeof o.coneOuterGain<"u"?o.coneOuterGain:0,distanceModel:typeof o.distanceModel<"u"?o.distanceModel:"inverse",maxDistance:typeof o.maxDistance<"u"?o.maxDistance:1e4,panningModel:typeof o.panningModel<"u"?o.panningModel:"HRTF",refDistance:typeof o.refDistance<"u"?o.refDistance:1,rolloffFactor:typeof o.rolloffFactor<"u"?o.rolloffFactor:1},a._onstereo=o.onstereo?[{fn:o.onstereo}]:[],a._onpos=o.onpos?[{fn:o.onpos}]:[],a._onorientation=o.onorientation?[{fn:o.onorientation}]:[],e.call(this,o)}}(Howl.prototype.init),Howl.prototype.stereo=function(e,o){var a=this;if(!a._webAudio)return a;if(a._state!=="loaded")return a._queue.push({event:"stereo",action:function(){a.stereo(e,o)}}),a;var s=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof o>"u")if(typeof e=="number")a._stereo=e,a._pos=[e,0,0];else return a._stereo;for(var c=a._getSoundIds(o),h=0;h<c.length;h++){var f=a._soundById(c[h]);if(f)if(typeof e=="number")f._stereo=e,f._pos=[e,0,0],f._node&&(f._pannerAttr.panningModel="equalpower",(!f._panner||!f._panner.pan)&&t(f,s),s==="spatial"?typeof f._panner.positionX<"u"?(f._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),f._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),f._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):f._panner.setPosition(e,0,0):f._panner.pan.setValueAtTime(e,Howler.ctx.currentTime)),a._emit("stereo",f._id);else return f._stereo}return a},Howl.prototype.pos=function(e,o,a,s){var c=this;if(!c._webAudio)return c;if(c._state!=="loaded")return c._queue.push({event:"pos",action:function(){c.pos(e,o,a,s)}}),c;if(o=typeof o!="number"?0:o,a=typeof a!="number"?-.5:a,typeof s>"u")if(typeof e=="number")c._pos=[e,o,a];else return c._pos;for(var h=c._getSoundIds(s),f=0;f<h.length;f++){var b=c._soundById(h[f]);if(b)if(typeof e=="number")b._pos=[e,o,a],b._node&&((!b._panner||b._panner.pan)&&t(b,"spatial"),typeof b._panner.positionX<"u"?(b._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),b._panner.positionY.setValueAtTime(o,Howler.ctx.currentTime),b._panner.positionZ.setValueAtTime(a,Howler.ctx.currentTime)):b._panner.setPosition(e,o,a)),c._emit("pos",b._id);else return b._pos}return c},Howl.prototype.orientation=function(e,o,a,s){var c=this;if(!c._webAudio)return c;if(c._state!=="loaded")return c._queue.push({event:"orientation",action:function(){c.orientation(e,o,a,s)}}),c;if(o=typeof o!="number"?c._orientation[1]:o,a=typeof a!="number"?c._orientation[2]:a,typeof s>"u")if(typeof e=="number")c._orientation=[e,o,a];else return c._orientation;for(var h=c._getSoundIds(s),f=0;f<h.length;f++){var b=c._soundById(h[f]);if(b)if(typeof e=="number")b._orientation=[e,o,a],b._node&&(b._panner||(b._pos||(b._pos=c._pos||[0,0,-.5]),t(b,"spatial")),typeof b._panner.orientationX<"u"?(b._panner.orientationX.setValueAtTime(e,Howler.ctx.currentTime),b._panner.orientationY.setValueAtTime(o,Howler.ctx.currentTime),b._panner.orientationZ.setValueAtTime(a,Howler.ctx.currentTime)):b._panner.setOrientation(e,o,a)),c._emit("orientation",b._id);else return b._orientation}return c},Howl.prototype.pannerAttr=function(){var e=this,o=arguments,a,s,c;if(!e._webAudio)return e;if(o.length===0)return e._pannerAttr;if(o.length===1)if(typeof o[0]=="object")a=o[0],typeof s>"u"&&(a.pannerAttr||(a.pannerAttr={coneInnerAngle:a.coneInnerAngle,coneOuterAngle:a.coneOuterAngle,coneOuterGain:a.coneOuterGain,distanceModel:a.distanceModel,maxDistance:a.maxDistance,refDistance:a.refDistance,rolloffFactor:a.rolloffFactor,panningModel:a.panningModel}),e._pannerAttr={coneInnerAngle:typeof a.pannerAttr.coneInnerAngle<"u"?a.pannerAttr.coneInnerAngle:e._coneInnerAngle,coneOuterAngle:typeof a.pannerAttr.coneOuterAngle<"u"?a.pannerAttr.coneOuterAngle:e._coneOuterAngle,coneOuterGain:typeof a.pannerAttr.coneOuterGain<"u"?a.pannerAttr.coneOuterGain:e._coneOuterGain,distanceModel:typeof a.pannerAttr.distanceModel<"u"?a.pannerAttr.distanceModel:e._distanceModel,maxDistance:typeof a.pannerAttr.maxDistance<"u"?a.pannerAttr.maxDistance:e._maxDistance,refDistance:typeof a.pannerAttr.refDistance<"u"?a.pannerAttr.refDistance:e._refDistance,rolloffFactor:typeof a.pannerAttr.rolloffFactor<"u"?a.pannerAttr.rolloffFactor:e._rolloffFactor,panningModel:typeof a.pannerAttr.panningModel<"u"?a.pannerAttr.panningModel:e._panningModel});else return c=e._soundById(parseInt(o[0],10)),c?c._pannerAttr:e._pannerAttr;else o.length===2&&(a=o[0],s=parseInt(o[1],10));for(var h=e._getSoundIds(s),f=0;f<h.length;f++)if(c=e._soundById(h[f]),c){var b=c._pannerAttr;b={coneInnerAngle:typeof a.coneInnerAngle<"u"?a.coneInnerAngle:b.coneInnerAngle,coneOuterAngle:typeof a.coneOuterAngle<"u"?a.coneOuterAngle:b.coneOuterAngle,coneOuterGain:typeof a.coneOuterGain<"u"?a.coneOuterGain:b.coneOuterGain,distanceModel:typeof a.distanceModel<"u"?a.distanceModel:b.distanceModel,maxDistance:typeof a.maxDistance<"u"?a.maxDistance:b.maxDistance,refDistance:typeof a.refDistance<"u"?a.refDistance:b.refDistance,rolloffFactor:typeof a.rolloffFactor<"u"?a.rolloffFactor:b.rolloffFactor,panningModel:typeof a.panningModel<"u"?a.panningModel:b.panningModel};var p=c._panner;p?(p.coneInnerAngle=b.coneInnerAngle,p.coneOuterAngle=b.coneOuterAngle,p.coneOuterGain=b.coneOuterGain,p.distanceModel=b.distanceModel,p.maxDistance=b.maxDistance,p.refDistance=b.refDistance,p.rolloffFactor=b.rolloffFactor,p.panningModel=b.panningModel):(c._pos||(c._pos=e._pos||[0,0,-.5]),t(c,"spatial"))}return e},Sound.prototype.init=function(e){return function(){var o=this,a=o._parent;o._orientation=a._orientation,o._stereo=a._stereo,o._pos=a._pos,o._pannerAttr=a._pannerAttr,e.call(this),o._stereo?a.stereo(o._stereo):o._pos&&a.pos(o._pos[0],o._pos[1],o._pos[2],o._id)}}(Sound.prototype.init),Sound.prototype.reset=function(e){return function(){var o=this,a=o._parent;return o._orientation=a._orientation,o._stereo=a._stereo,o._pos=a._pos,o._pannerAttr=a._pannerAttr,o._stereo?a.stereo(o._stereo):o._pos?a.pos(o._pos[0],o._pos[1],o._pos[2],o._id):o._panner&&(o._panner.disconnect(0),o._panner=void 0,a._refreshBuffer(o)),e.call(this)}}(Sound.prototype.reset);var t=function(e,o){o=o||"spatial",o==="spatial"?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.panningModel=e._pannerAttr.panningModel,typeof e._panner.positionX<"u"?(e._panner.positionX.setValueAtTime(e._pos[0],Howler.ctx.currentTime),e._panner.positionY.setValueAtTime(e._pos[1],Howler.ctx.currentTime),e._panner.positionZ.setValueAtTime(e._pos[2],Howler.ctx.currentTime)):e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),typeof e._panner.orientationX<"u"?(e._panner.orientationX.setValueAtTime(e._orientation[0],Howler.ctx.currentTime),e._panner.orientationY.setValueAtTime(e._orientation[1],Howler.ctx.currentTime),e._panner.orientationZ.setValueAtTime(e._orientation[2],Howler.ctx.currentTime)):e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2])):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.setValueAtTime(e._stereo,Howler.ctx.currentTime)),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id,!0)}})()})(le);const ae={move:new le.Howl({src:["/sfx/move.mp3"],volume:.3}),take:new le.Howl({src:["/sfx/take.mp3"],volume:.9}),swap:new le.Howl({src:["/sfx/swap.mp3"],volume:.6}),snap:new le.Howl({src:["/sfx/snap.mp3"],volume:.6}),rewind:new le.Howl({src:["/sfx/rewind.mp3"],volume:1}),enPassant:new le.Howl({src:["/sfx/anarchy/en-passant.mp3"],volume:.5}),horsyMove:new le.Howl({src:["/sfx/anarchy/horsy-move.mp3"],volume:.5}),horsyTake:new le.Howl({src:["/sfx/anarchy/horsy-take.mp3"],volume:.5}),brickMove:new le.Howl({src:["/sfx/anarchy/brick-move.mp3"],volume:.3}),brickTake:new le.Howl({src:["/sfx/anarchy/brick-take.mp3"],volume:.2}),brickCastle:new le.Howl({src:["/sfx/anarchy/brick-castle.mp3"],volume:.3}),coneMove:new le.Howl({src:["/sfx/anarchy/cone-move.mp3"],volume:1}),coneTake:new le.Howl({src:["/sfx/anarchy/cone-take.mp3"],volume:.3}),pipiMove:new le.Howl({src:["/sfx/anarchy/pipi-move.mp3"],volume:.2}),pipiTake:new le.Howl({src:["/sfx/anarchy/pipi-take.mp3"],volume:.4}),toyMove:new le.Howl({src:["/sfx/anarchy/toy-move.mp3"],volume:.9}),toyTake:new le.Howl({src:["/sfx/anarchy/toy-take.mp3"],volume:.8}),deathMove:new le.Howl({src:["/sfx/anarchy/death-move.mp3"],volume:.4}),deathTake:new le.Howl({src:["/sfx/anarchy/death-take.mp3"],volume:.25}),death:new le.Howl({src:["/sfx/anarchy/checkmate.mp3"],volume:1}),hit:new le.Howl({src:["/sfx/anarchy/hit.mp3"],volume:.25})},kn={x:" takes ","+":" check!","#":" mate!","=":" promotes to a ",P:"pawn ",R:"rook ",B:"bishop ",N:"knight ",Q:"queen ",K:"king ","O-O":"short castle","O-O-O":"long castle"},yt={volume:50,rate:1,lang:"en-US"},Ci=n=>{if(n==="O-O"||n==="O-O-O")n=kn[n];else{const t=n.match(/[a-h1-8][a-h][1-8]/);t&&(n=n.replace(t[0],`${t[0][0]} ${t[0][1]}${t[0][2]}`)),n=n.split("").map(e=>kn[e]??e).join("").replace(/\s{2,}/g," ")}return n};class Ei{voice;constructor(){window.speechSynthesis?(this.setVoice(),window.speechSynthesis.onvoiceschanged=this.setVoice.bind(this)):this.voice=void 0}setVoice(){const t=speechSynthesis.getVoices();this.voice=t.length>0?t.find(e=>e.lang===yt.lang):void 0}say(t){const e=new SpeechSynthesisUtterance(t);e.volume=yt.volume/100,e.lang=yt.lang,this.voice&&(e.voice=this.voice),e.rate=1+yt.rate/10,speechSynthesis.speak(e)}}const Pi=n=>new Promise(t=>setTimeout(t,n));class Ni{constructor(t,e){this.board=t,this.config=e,this.speech=new Ei}interval=1e3;game=new st;ply=0;callback=()=>{};speech;playing=!1;async init(){await this.board.frame(this.game.getPosition(0),this.game.header).then(t=>this.board.render())}watch(t){this.callback=t}updateConfig(t){this.config={...this.config,...t}}getPosition(){const t=this.game.getPosition(this.ply);return P({ply:t.ply}),P({fen:t.fen}),t}async load(t){this.pause(),this.game=t,this.ply=0,await this.board.frame(this.getPosition(),this.game.header),this.board.render()}async play(){for(this.playing=!0,this.callback(this.playing,this.ply),this.ply===this.game.getMoves().length&&this.first();await Pi(this.interval),!!this.playing;)this.next()}pause(){this.playing=!1,this.callback(this.playing,this.ply)}async prev(){const t=this.ply-1;if(!(t<-1||t<0&&this.config.titleScreen===!1)){if(this.ply=t,t===-1){await this.board.titleFrame(this.game.header),this.board.render();return}await this.board.frame(this.getPosition(),this.game.header),this.board.render(),v.siteConfig.sounds&&ae.rewind.play()}}playSFX(t){t.mate?ae.snap.play():/[ce]/.test(t.move?.flags)?ae.take.play():/[kqp]/.test(t.move?.flags)?ae.swap.play():ae.move.play()}playAnarchySFX(t){if(t.move?.flags&&t.move.flags.includes("e")?ae.enPassant.play():t.mate&&ae.death.play(),t.move?.flags&&t.move.flags.includes("p")&&ae.brickCastle.play(),t.move?.flags&&t.move.flags.includes("c"))switch(t.move.piece){case"p":ae.coneTake.play();break;case"r":ae.brickTake.play();break;case"n":ae.hit.play(),ae.horsyTake.play();break;case"k":ae.pipiTake.play();break;case"q":ae.deathTake.play();break;case"b":ae.toyTake.play();break;default:ae.take.play()}else if(/[kq]/.test(t.move?.flags))ae.brickCastle.play();else switch(t.move?.piece){case"p":ae.coneMove.play();break;case"r":ae.brickMove.play();break;case"n":ae.horsyMove.play();break;case"k":ae.pipiMove.play();break;case"q":ae.deathMove.play();break;case"b":ae.toyMove.play();break;default:ae.move.play()}}async next(){const t=this.ply+1;if(t>=this.game.length){this.pause();return}this.ply=t;const e=this.getPosition();if(await this.board.frame(e,this.game.header),this.board.render(),window.speechSynthesis&&v.siteConfig.speech&&(this.ply>0&&this.speech.say(Ci(e.move?.san)),e.end===0)){const o=this.game.header.Result;o&&this.speech.say(o==="1-0"?"White wins!":o==="0-1"?"Black wins!":"Draw!")}this.ply>0&&v.siteConfig.sounds&&(v.boardConfig.piecesStyle.includes("anarchy")?this.playAnarchySFX(e):this.playSFX(e))}async first(){this.ply=0,await this.board.frame(this.getPosition(),this.game.header),this.board.render()}async last(){this.ply=this.game.length-1,await this.board.frame(this.getPosition(),this.game.header),this.board.render()}async goto(t){this.ply=t,await this.board.frame(this.getPosition(),this.game.header),this.board.render()}}const Ii=E('<div class="header__options-ico"><i class="las"></i></div>'),Oi=E('<div class="header__options-ico" title="SUPPORT"><i class="las la-heart"></i></div>'),Li=E('<a href="" class="header__support"><i class="las la-heart header__support-ico"></i> &nbsp;Support the project</a>'),Ri=E('<header class="header-box"><div class="header__logo"><a href="/"><div class="header__logo-pic"></div></a></div><div class="header__options"><div class="header__options-ico"><i class="las"></i></div><div class="header__options-ico"><i class="las"></i></div><div class="header__options-ico" title="VISIT SUBREDDIT"><a href="https://www.reddit.com/r/sharechess" target="_blank"><i class="lab la-reddit-alien"></i></a></div><div class="header__options-ico" title="SOURCE CODE"><a href="https://github.com/sharechess/sharechess" target="_blank"><i class="lab la-github"></i></a></div><div class="header__options-ico" title="ABOUT"><i class="las la-question-circle"></i></div></div></header>'),Bi=n=>(()=>{const t=Ri.cloneNode(!0),e=t.firstChild,o=e.nextSibling,a=o.firstChild,s=a.firstChild,c=a.nextSibling,h=c.firstChild,f=c.nextSibling,b=f.nextSibling,p=b.nextSibling;return ue(a,"click",n.handlers.toggleDarkMode,!0),ue(c,"click",n.handlers.toggleSound,!0),I(o,x(G,{get when(){return window.speechSynthesis},get children(){const r=Ii.cloneNode(!0),i=r.firstChild;return ue(r,"click",n.handlers.toggleSpeech,!0),Z(l=>{const u=v.siteConfig.speech?"SPEECH OFF":"SPEECH ON",d=!v.siteConfig.speech,_=!!v.siteConfig.speech;return u!==l._v$&&oe(r,"title",l._v$=u),d!==l._v$2&&i.classList.toggle("la-deaf",l._v$2=d),_!==l._v$3&&i.classList.toggle("la-assistive-listening-systems",l._v$3=_),l},{_v$:void 0,_v$2:void 0,_v$3:void 0}),r}}),f),p.$$click=()=>{P("fullscreenPopup",v.fullscreenPopup==="about"?null:"about")},I(o,x(G,{get when(){return v.mobile},get children(){const r=Oi.cloneNode(!0);return r.$$click=()=>{P("fullscreenPopup",v.fullscreenPopup==="support"?null:"support")},r}}),null),I(t,x(G,{get when(){return!v.mobile},get children(){const r=Li.cloneNode(!0);return r.$$click=i=>{i.preventDefault(),P("fullscreenPopup","support")},r}}),null),Z(r=>{const i=v.siteConfig.darkMode?"SWITCH TO LIGHT MODE":"SWITCH TO DARK MODE",l=!!v.siteConfig.darkMode,u=!v.siteConfig.darkMode,d=v.siteConfig.sounds?"MUTE":"SOUND ON",_=!v.siteConfig.sounds,g=!!v.siteConfig.sounds;return i!==r._v$4&&oe(a,"title",r._v$4=i),l!==r._v$5&&s.classList.toggle("la-sun",r._v$5=l),u!==r._v$6&&s.classList.toggle("la-moon",r._v$6=u),d!==r._v$7&&oe(c,"title",r._v$7=d),_!==r._v$8&&h.classList.toggle("la-volume-mute",r._v$8=_),g!==r._v$9&&h.classList.toggle("la-volume-up",r._v$9=g),r},{_v$4:void 0,_v$5:void 0,_v$6:void 0,_v$7:void 0,_v$8:void 0,_v$9:void 0}),t})();xe(["click"]);var Bt={},Mt={};Object.defineProperty(Mt,"__esModule",{value:!0});const on=(n,t=[])=>n.length<2?n:(...e)=>(o=>o.length>=n.length?n(...o):on(n,o))([...t,...e]);Mt.curry=on;Mt.default=on;Object.defineProperty(Bt,"__esModule",{value:!0});Bt.chunk_=void 0;const Mi=Mt,zi=(n,t)=>{if(n<=0)throw new Error("Chunk size has to be greater than 0.");const e=new Array(Math.ceil(t.length/n));for(let o=0,a=0;o<t.length;o=o+n,a++)e[a]=t.slice(o,o+n);return e},Yn=Mi.curry(zi);Bt.chunk_=Yn;var Fi=Bt.default=Yn;const Di=E('<div><div class="scrollable__content"></div></div>'),vt=n=>(()=>{const t=Di.cloneNode(!0),e=t.firstChild;return I(e,()=>n.children),Z(()=>bt(t,`scrollable ${n.class}`)),t})();const Hi=E('<p class="moves__turn"></p>'),qi=E('<div class="move"><span class="move__id">.</span><span class="move__ply"></span><span class="move__ply"></span></div>'),Gi=n=>(cr(()=>{v.mobile||document.querySelector(`[data-ply="${v.ply}"]`)?.scrollIntoView()}),x(vt,{get class(){return"moves"+(n.class?` ${n.class}`:"")},get children(){return[x(G,{get when(){return n.moves.length===0},get children(){const t=Hi.cloneNode(!0);return I(t,(()=>{const e=Hn(()=>!!v.game.getPosition(0).mate,!0);return()=>e()?"Checkmate.":v.game.getPosition(0).turn==="w"?"White to move.":"Black to move."})()),t}}),x(qe,{get each(){return Fi(2,n.moves)},children:(t,e)=>{const[o,a]=t;return(()=>{const s=qi.cloneNode(!0),c=s.firstChild,h=c.firstChild,f=c.nextSibling,b=f.nextSibling;return I(c,()=>e()+1,h),f.$$click=()=>n.handlers.goto(e()*2+1),I(f,o),b.$$click=()=>n.handlers.goto(e()*2+2),I(b,a),Z(p=>{const r=v.ply===e()*2+1,i=e()*2+1,l=v.ply===e()*2+2,u=e()*2+2;return r!==p._v$&&f.classList.toggle("move__ply--current",p._v$=r),i!==p._v$2&&oe(f,"data-ply",p._v$2=i),l!==p._v$3&&b.classList.toggle("move__ply--current",p._v$3=l),u!==p._v$4&&oe(b,"data-ply",p._v$4=u),p},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),s})()}})]}}));xe(["click"]);const ji=E('<i class="las la-play"></i>'),Wi=E('<div class="controls"><button class="controls__button controls__button--first" title="FIRST"><i class="las la-angle-double-left"></i></button><button class="controls__button" title="PREV"><i class="las la-angle-left"></i></button><button class="controls__button"></button><button class="controls__button controls__button--next" title="NEXT"><i class="las la-angle-right"></i></button><button class="controls__button controls__button--last" title="LAST"><i class="las la-angle-double-right"></i></button><button title="FLIP" class="flip__button"><i class="las la-sync rotatable"></i></button></div>'),Ui=E('<i class="las la-pause"></i>'),Qn=n=>(()=>{const t=Wi.cloneNode(!0),e=t.firstChild,o=e.nextSibling,a=o.nextSibling,s=a.nextSibling,c=s.nextSibling,h=c.nextSibling,f=h.firstChild;return ue(e,"click",n.handlers.first,!0),ue(o,"click",n.handlers.prev,!0),ue(a,"click",n.handlers.togglePlay,!0),I(a,x(G,{get when(){return!v.playing},get fallback(){return Ui.cloneNode(!0)},get children(){return ji.cloneNode(!0)}})),ue(s,"click",n.handlers.next,!0),ue(c,"click",n.handlers.last,!0),ue(h,"click",n.handlers.flip,!0),Z(b=>{const p=v.playing?"PAUSE":"PLAY",r=!!v.boardConfig.flipped;return p!==b._v$&&oe(a,"title",b._v$=p),r!==b._v$2&&f.classList.toggle("rotated",b._v$2=r),b},{_v$:void 0,_v$2:void 0}),t})();xe(["click"]);const Zn=n=>{if(n===null)return!1;try{return new URL(n).protocol==="https:"}catch{return!1}},An=E("<span></span>"),xn=E('<span class="info__rating"> (<!>)</span>'),Dt=E("<p></p>"),Vi=E("<p>Round </p>"),Xi=E("<a></a>"),Ki=E('<div class="info"><div class="info__header"><div class="info__players"><div class="info__player"><div class="info__left"><button class="info__color info__color--white"></button></div><div class="info__right"><span class="info__score"></span></div></div><div class="info__player"><div class="info__left"><button class="info__color info__color--black"></button></div><div class="info__right"><span class="info__score"></span></div></div></div><div class="info__event"></div><div class="info__site"></div></div><div class="info__analyze"><button><i class="las la-vial"></i> </button></div></div>'),Yi=n=>{const[t,e]=Fe(!1);return(()=>{const o=Ki.cloneNode(!0),a=o.firstChild,s=a.firstChild,c=s.firstChild,h=c.firstChild;h.firstChild;const f=h.nextSibling,b=f.firstChild,p=c.nextSibling,r=p.firstChild;r.firstChild;const i=r.nextSibling,l=i.firstChild,u=s.nextSibling,d=u.nextSibling,_=a.nextSibling,g=_.firstChild;return g.firstChild.nextSibling,I(h,x(G,{get when(){return!v.anonymous},fallback:"Anonymous",get children(){return[(()=>{const y=An.cloneNode(!0);return oe(y,"contenteditable",!1),I(y,()=>v.game.header.WhitePretty),y})()," "]}}),null),I(h,x(G,{get when(){return v.game.header.WhiteElo},get children(){const y=xn.cloneNode(!0),k=y.firstChild,N=k.nextSibling;return N.nextSibling,I(y,()=>v.game.header.WhiteElo,N),y}}),null),I(b,()=>v.game.header.Result==="1-0"?"1":v.game.header.Result==="0-1"?"0":v.game.header.Result==="1/2-1/2"?"1/2":""),I(r,x(G,{get when(){return!v.anonymous},fallback:"Anonymous",get children(){return[(()=>{const y=An.cloneNode(!0);return oe(y,"contenteditable",!1),I(y,()=>v.game.header.BlackPretty),y})()," "]}}),null),I(r,x(G,{get when(){return v.game.header.BlackElo},get children(){const y=xn.cloneNode(!0),k=y.firstChild,N=k.nextSibling;return N.nextSibling,I(y,()=>v.game.header.BlackElo,N),y}}),null),I(l,()=>v.game.header.Result==="1-0"?"0":v.game.header.Result==="0-1"?"1":v.game.header.Result==="1/2-1/2"?"1/2":""),I(u,x(G,{get when(){return v.game.header.Event},get children(){const y=Dt.cloneNode(!0);return I(y,()=>v.game.header.Event),y}}),null),I(u,x(G,{get when(){return v.game.header.Round},get children(){const y=Vi.cloneNode(!0);return y.firstChild,I(y,()=>v.game.header.Round,null),y}}),null),I(d,x(G,{get when(){return v.game.header.Site},get children(){const y=Dt.cloneNode(!0);return I(y,x(G,{get when(){return!v.anonymous||!Et(v.game.header.Site)},get children(){return x(G,{get when(){return Zn(v.game.header.Site)},get fallback(){return v.game.header.Site},get children(){const k=Xi.cloneNode(!0);return I(k,()=>v.game.header.Site?.replace(/^https:\/\//,"")),Z(()=>oe(k,"href",v.game.header.Site??"")),k}})}})),y}}),null),I(d,x(G,{get when(){return v.game.header.DatePretty},get children(){const y=Dt.cloneNode(!0);return I(y,()=>v.game.header.DatePretty),y}}),null),g.$$click=async()=>{await n.handlers.openOnLichess()||(e(!0),setTimeout(()=>e(!1),1e3))},I(g,()=>t()?"Cannot import to lichess":"Analyze on Lichess",null),Z(()=>g.classList.toggle("btn--error",!!t())),o})()};xe(["click"]);const Jn=n=>new Promise((t,e)=>{const o=new FileReader;o.onload=()=>{t(o.result)},o.onerror=e,o.readAsText(n)});const Qi=E('<button class="load__game-btn"><i class="las la-paste"></i> </button>'),Ht=E("<hr>"),Zi=E('<textarea class="load__game-input" name="load-game" placeholder="Paste PGN, FEN or Lichess link..."></textarea>'),Ji=E('<button class="load__game-btn"></button>'),eo=E('<input type="file" accept="application/vnd.chess-pgn,application/x-chess-pgn,.pgn">'),to=E('<button class="load__pgn-btn load__pgn-file">Upload PGN file</button>'),no=E('<div class="load__pgn-file-info"><p>or</p><p>drop the PGN file anywhere on the page</p></div>'),ro=E('<p class="load__daily-game"><a href="">Load game of the day</a></p>'),io=E("<h2>Recent:</h2>"),oo=E('<ul class="load__recent"></ul>'),ao=E('<a href=""></a>'),so=E('<p class="load__recent-options"><a href="">clear all</a></p>'),lo=E('<li class="load__recent-item"><a></a> <i class="las la-trash-alt load__recent-delete-item"></i></li>'),co=n=>{const[t,e]=Fe(""),[o,a]=Fe(!1),[s,c]=Fe(!1),[h,f]=Fe(!1);let b;return x(vt,{get class(){return"load"+(n.class?` ${n.class}`:"")},get children(){return[(()=>{const p=Qi.cloneNode(!0);return p.firstChild.nextSibling,p.$$click=async()=>{await n.handlers.loadFromClipboard()||(a(!0),setTimeout(()=>a(!1),1e3))},I(p,()=>o()?"Incorrect data":"Load from clipboard",null),Z(()=>p.classList.toggle("btn--error",!!o())),p})(),Ht.cloneNode(!0),(()=>{const p=Zi.cloneNode(!0);return p.$$input=r=>e(r.currentTarget.value),oe(p,"spellcheck",!1),Z(()=>p.value=t()),p})(),(()=>{const p=Ji.cloneNode(!0);return p.$$click=async()=>{await n.handlers.load(t())||(c(!0),setTimeout(()=>c(!1),1e3)),e("")},I(p,()=>s()?"Incorrect data":"LOAD"),Z(()=>p.classList.toggle("btn--error",!!s())),p})(),Ht.cloneNode(!0),(()=>{const p=eo.cloneNode(!0);p.addEventListener("change",async i=>{const l=i.target;if(l?.files&&l.files.length>0){const u=await Jn(l.files[0]);P("refreshHash",!1),n.handlers.loadPGN(u)}});const r=b;return typeof r=="function"?yr(r,p):b=p,p.style.setProperty("display","none"),p})(),(()=>{const p=to.cloneNode(!0);return p.$$click=()=>{b&&b.click()},p})(),x(G,{get when(){return!v.mobile},get children(){return no.cloneNode(!0)}}),Ht.cloneNode(!0),(()=>{const p=ro.cloneNode(!0),r=p.firstChild;return r.$$click=i=>{i.preventDefault(),n.handlers.loadGameOfTheDay()},p})(),x(G,{get when(){return v.recent.filter(p=>p.hash!==location.hash).length>0},get children(){return[io.cloneNode(!0),(()=>{const p=oo.cloneNode(!0);return I(p,x(qe,{get each(){return v.recent.filter(r=>r.hash!==location.hash).slice(0,h()?void 0:5)},children:r=>(()=>{const i=lo.cloneNode(!0),l=i.firstChild,u=l.nextSibling,d=u.nextSibling;return I(l,()=>r.title.split(" | ")[0]),d.$$click=()=>n.handlers.deleteRecent(r.hash),Z(()=>oe(l,"href",r.hash)),i})()})),p})(),(()=>{const p=so.cloneNode(!0),r=p.firstChild;return I(p,x(G,{get when(){return v.recent.filter(i=>i.hash!==location.hash).length>5},get children(){return[(()=>{const i=ao.cloneNode(!0);return i.$$click=l=>{l.preventDefault(),f(!h())},I(i,()=>h()?"show less":"show more"),i})()," ","|"," "]}}),r),ue(r,"click",n.handlers.clearRecent,!0),p})()]}})]}})};xe(["click","input"]);const Qt=(n,t,e)=>{const o=typeof n=="string"?n:URL.createObjectURL(n),a=document.createElement("a");a.href=o,a.download=`${t}.${e}`,a.target="_blank",a.click(),URL.revokeObjectURL(o)},er=async n=>{const[t,e]=n.pathname.replace(/^\//,"").split("/").map(o=>o.trim());if(/^(([a-z0-9]{8})|([a-z0-9]{12}))$/i.test(t)){const o=t.slice(0,8),a=await fetch(`https://lichess.org/game/export/${o}?evals=0&clocks=0`);if(!String(a.status).startsWith("2"))return{error:!0,errorType:"SERVER_ERROR"};const s=await a.text();return{error:!1,pgn:s,side:String(e).startsWith("black")||n.hash.startsWith("black")?"b":"w"}}return{error:!0,errorType:"INCORRECT_LINK"}},uo=async n=>{let t;try{t=new URL(n)}catch{return{error:!0,errorType:"INCORRECT_LINK"}}return/^(www\.)*lichess\.org/.test(t.hostname)?er(t):{error:!0,errorType:"INCORRECT_LINK"}},$t={pgn:"",fen:"",side:"w",ply:0};let re={...$t};const at={set(n){if(n.fen){re={...$t},re.fen=n.fen,location.hash=`fen/${re.fen.replace(/ /g,"_")}`;return}n.pgn&&(re={...$t},re.pgn=yn(n.pgn)),n.side&&(re.side=n.side),n.ply!==void 0&&(re.ply=n.ply),location.hash=`pgn/${re.side}/${re.ply}/${re.pgn}`},get(){return location.href},getFENLink(n){return`${location.origin}/#fen/${n.replace(/ /g,"_")}`},async read(){const n=new URL(location.href),[t,...e]=location.hash.split("/");if(/fen/.test(t))re={...$t},re.fen=decodeURI(e.join("/")).replace(/_/g," ");else if(/pgn/.test(t)){const[o,a,...s]=e;re.side=o,re.ply=Number(a),re.pgn=s.join("/"),re.fen=""}else if(/lid/.test(t)){const[o,a,...s]=e;re.side=o,re.ply=Number(a);const c=await er(new URL(`https://lichess.org/${s[0]}`));c.error?(re.pgn="",re.fen=""):(re.pgn=yn(Wn(c.pgn)),re.fen="")}return{pgn:re.pgn?oi(re.pgn):"",fen:re.fen,side:re.side,ply:re.ply,boardStyle:n.searchParams.get("b"),piecesStyle:n.searchParams.get("p")}},entries(){return{...re}}},fo=E('<div class="share__view"><h2 class="header--first">Board options</h2><button class="options__button" title="TOGGLE ANONYMOUS"><i class="las la-user-secret"></i></button><button class="options__button"><i class="las la-expand"></i></button><button class="options__button"><i class="las la-info-circle"></i></button><button class="options__button"><i class="las la-heading"></i></button><button class="options__button"><i class="las la-cloud"></i></button><button class="options__button" title="RENDER AS PUZZLE"><i class="las la-puzzle-piece"></i></button><button class="options__button options__button--last options__button--active" title="RANDOM STYLE"><i class="las la-dice-three"></i></button></div>'),qt=E("<hr>"),ho=E('<div class="share__fen"><h2>Current position</h2><input type="text" name="current_fen" readonly placeholder="Current FEN..."><div class="double"><button class="share__btn share__btn--left"></button><button class="share__btn share__btn--right"></button></div><hr class="invisible"><button class="share__size share__size--first" title="360px">XS</button><button class="share__size" title="512px">S</button><button class="share__size" title="720px">M</button><button class="share__size" title="1024px">L</button><button class="share__size share__size--last" title="1440px">XL</button><button class="share__btn"></button></div>'),_o=E('<div class="share__pgn"><h2>Game</h2><div class="double"><button class="share__btn"></button><button class="share__btn"></button></div><div class="double"><button class="share__btn">Export PGN</button><button class="share__btn"></button></div></div>'),po=E('<div class="share__animation"><hr class="invisible"><button class="share__size share__size--first" title="360px">XS</button><button class="share__size" title="512px">S</button><button class="share__size" title="720px">M</button><button class="share__size" title="1024px">L</button><button class="share__size share__size--last" title="1440px">XL</button><button class="share__format share__format--first">GIF</button><button class="share__format">MP4</button><button class="share__format share__format--last">WebM</button><button class="share__create-animation"></button></div>'),go=E('<button class="share__stylus">INSTALL STYLES<br><span>for lichess.org, chess.com & more</span></button>'),tr=n=>{const[t,e]=Fe(""),[o,a]=Fe(!1),[s,c]=Fe(!1),h=f=>{e(f),setTimeout(()=>e(""),1e3)};return x(vt,{get class(){return"share"+(n.class?` ${n.class}`:"")},get children(){return[(()=>{const f=fo.cloneNode(!0),b=f.firstChild,p=b.nextSibling,r=p.nextSibling,i=r.nextSibling,l=i.nextSibling,u=l.nextSibling,d=u.nextSibling,_=d.nextSibling;return ue(p,"click",n.handlers.toggleAnonymous,!0),ue(r,"click",n.handlers.toggleBorder,!0),ue(i,"click",n.handlers.toggleExtraInfo,!0),ue(l,"click",n.handlers.toggleTitleScreen,!0),ue(u,"click",n.handlers.toggleShadows,!0),ue(d,"click",n.handlers.togglePuzzle,!0),ue(_,"click",n.handlers.randomStyle,!0),Z(g=>{const $=!!v.anonymous,y=!!v.boardConfig.showBorder,k=v.boardConfig.showBorder?"HIDE BORDER":"SHOW BORDER",N=!!v.boardConfig.showExtraInfo,M=v.boardConfig.showExtraInfo?"HIDE EXTRA INFO":"SHOW EXTRA INFO",F=!!v.gameConfig.titleScreen,Y=v.gameConfig.titleScreen?"EXCLUDE TITLE SCREEN":"INCLUDE TITLE SCREEN",L=!!v.boardConfig.showShadows,ne=v.boardConfig.showShadows?"HIDE SHADOWS":"SHOW SHADOWS",pe=!!v.boardConfig.puzzle;return $!==g._v$&&p.classList.toggle("options__button--active",g._v$=$),y!==g._v$2&&r.classList.toggle("options__button--active",g._v$2=y),k!==g._v$3&&oe(r,"title",g._v$3=k),N!==g._v$4&&i.classList.toggle("options__button--active",g._v$4=N),M!==g._v$5&&oe(i,"title",g._v$5=M),F!==g._v$6&&l.classList.toggle("options__button--active",g._v$6=F),Y!==g._v$7&&oe(l,"title",g._v$7=Y),L!==g._v$8&&u.classList.toggle("options__button--active",g._v$8=L),ne!==g._v$9&&oe(u,"title",g._v$9=ne),pe!==g._v$10&&d.classList.toggle("options__button--active",g._v$10=pe),g},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0,_v$5:void 0,_v$6:void 0,_v$7:void 0,_v$8:void 0,_v$9:void 0,_v$10:void 0}),f})(),qt.cloneNode(!0),(()=>{const f=ho.cloneNode(!0),b=f.firstChild,p=b.nextSibling,r=p.nextSibling,i=r.firstChild,l=i.nextSibling,u=r.nextSibling,d=u.nextSibling,_=d.nextSibling,g=_.nextSibling,$=g.nextSibling,y=$.nextSibling,k=y.nextSibling;return p.$$click=N=>{N.target.select()},i.$$click=()=>{navigator.clipboard.writeText(v.fen),h("fen")},I(i,()=>t()==="fen"?"Copied!":"Copy FEN"),l.$$click=()=>{navigator.clipboard.writeText(at.getFENLink(v.fen)),h("fen-link")},I(l,()=>t()==="fen-link"?"Copied!":"Copy link"),d.$$click=()=>P("gameConfig","picSize","XS"),_.$$click=()=>P("gameConfig","picSize","S"),g.$$click=()=>P("gameConfig","picSize","M"),$.$$click=()=>P("gameConfig","picSize","L"),y.$$click=()=>P("gameConfig","picSize","XL"),k.$$click=async()=>{a(!0),await n.handlers.downloadImage(),a(!1)},I(k,()=>o()?"Please wait...":"Save as image"),Z(N=>{const M=v.gameConfig.picSize==="XS",F=v.gameConfig.picSize==="S",Y=v.gameConfig.picSize==="M",L=v.gameConfig.picSize==="L",ne=v.gameConfig.picSize==="XL";return M!==N._v$11&&d.classList.toggle("share__size--active",N._v$11=M),F!==N._v$12&&_.classList.toggle("share__size--active",N._v$12=F),Y!==N._v$13&&g.classList.toggle("share__size--active",N._v$13=Y),L!==N._v$14&&$.classList.toggle("share__size--active",N._v$14=L),ne!==N._v$15&&y.classList.toggle("share__size--active",N._v$15=ne),N},{_v$11:void 0,_v$12:void 0,_v$13:void 0,_v$14:void 0,_v$15:void 0}),Z(()=>p.value=v.fen),f})(),x(G,{get when(){return v.pgn},get children(){return[qt.cloneNode(!0),(()=>{const f=_o.cloneNode(!0),b=f.firstChild,p=b.nextSibling,r=p.firstChild,i=r.nextSibling,l=p.nextSibling,u=l.firstChild,d=u.nextSibling;return r.$$click=()=>{navigator.clipboard.writeText(v.anonymous?v.game.anonymousPGN:v.pgn),h("pgn")},I(r,()=>t()==="pgn"?"Copied!":"Copy PGN"),i.$$click=()=>{navigator.clipboard.writeText(window.location.href),h("pgn-link")},I(i,()=>t()==="pgn-link"?"Copied!":"Copy link"),u.$$click=()=>{const _=new Blob([v.pgn],{type:"application/vnd.chess-pgn;charset=utf-8"}),g=v.game.getFileName(v.anonymous);Qt(_,g,"pgn")},d.$$click=()=>{const g=`[${v.game.getTitle({anonymous:v.anonymous})}](${window.location.href})`;navigator.clipboard.writeText(g),h("markdown")},I(d,()=>t()==="markdown"?"Copied!":"Copy markdown"),f})(),(()=>{const f=po.cloneNode(!0),b=f.firstChild,p=b.nextSibling,r=p.nextSibling,i=r.nextSibling,l=i.nextSibling,u=l.nextSibling,d=u.nextSibling,_=d.nextSibling,g=_.nextSibling,$=g.nextSibling;return p.$$click=()=>P("gameConfig","animationSize","XS"),r.$$click=()=>P("gameConfig","animationSize","S"),i.$$click=()=>P("gameConfig","animationSize","M"),l.$$click=()=>P("gameConfig","animationSize","L"),u.$$click=()=>P("gameConfig","animationSize","XL"),d.$$click=()=>P("gameConfig","format","GIF"),_.$$click=()=>P("gameConfig","format","MP4"),g.$$click=()=>P("gameConfig","format","WebM"),$.$$click=async()=>{c(!0),await n.handlers.downloadAnimation(),c(!1)},I($,()=>s()?"Please wait...":"Save animation"),Z(y=>{const k=v.gameConfig.animationSize==="XS",N=v.gameConfig.animationSize==="S",M=v.gameConfig.animationSize==="M",F=v.gameConfig.animationSize==="L",Y=v.gameConfig.animationSize==="XL",L=v.gameConfig.format==="GIF",ne=v.gameConfig.format==="MP4",pe=v.gameConfig.format==="WebM";return k!==y._v$16&&p.classList.toggle("share__size--active",y._v$16=k),N!==y._v$17&&r.classList.toggle("share__size--active",y._v$17=N),M!==y._v$18&&i.classList.toggle("share__size--active",y._v$18=M),F!==y._v$19&&l.classList.toggle("share__size--active",y._v$19=F),Y!==y._v$20&&u.classList.toggle("share__size--active",y._v$20=Y),L!==y._v$21&&d.classList.toggle("share__format--active",y._v$21=L),ne!==y._v$22&&_.classList.toggle("share__format--active",y._v$22=ne),pe!==y._v$23&&g.classList.toggle("share__format--active",y._v$23=pe),y},{_v$16:void 0,_v$17:void 0,_v$18:void 0,_v$19:void 0,_v$20:void 0,_v$21:void 0,_v$22:void 0,_v$23:void 0}),f})()]}}),x(G,{get when(){return Hn(()=>!v.mobile,!0)()&&["Chrome","Firefox","Opera"].includes(v.browser)},get children(){return[qt.cloneNode(!0),(()=>{const f=go.cloneNode(!0);return f.$$click=()=>P("fullscreenPopup","styles"),f})()]}})]}})};xe(["click"]);const mo=E('<a target="_blank" class="collection__action collection__stylus" title="Install via Stylus"></a>'),bo=E('<a target="_blank" class="collection__action collection__download" title="Download"></a>'),vo=E('<div class="collection__card"><div></div><div class="collection__actions"><a href="" class="collection__action collection__favorite" title="Add to favorites"></a></div></div>'),Tn=n=>(()=>{const t=vo.cloneNode(!0),e=t.firstChild,o=e.nextSibling,a=o.firstChild;return e.$$click=()=>{P("boardConfig","boardStyle",n.item.key),n.handlers.changeBoardStyle(n.item.key)},oe(e,"draggable",!1),a.$$click=s=>{s.preventDefault(),n.handlers.toggleFavoriteBoard(n.item.key)},I(o,x(G,{get when(){return!v.mobile},get children(){return[(()=>{const s=mo.cloneNode(!0);return Z(()=>oe(s,"href",`stylus/boards/${n.item.key}.user.css`)),s})(),(()=>{const s=bo.cloneNode(!0);return Z(()=>oe(s,"href",`download/boards/${n.item.key}.zip`)),s})()]}}),null),Z(s=>{const c="collection__ico boards__ico"+(v.boardConfig.boardStyle===n.item.key?" collection__ico--active":""),h=`url(${n.item.img})`,f=n.item.key,b=!!v.favoriteBoards.has(n.item.key);return c!==s._v$&&bt(e,s._v$=c),h!==s._v$2&&e.style.setProperty("background-image",s._v$2=h),f!==s._v$3&&oe(e,"title",s._v$3=f),b!==s._v$4&&a.classList.toggle("collection__favorite--active",s._v$4=b),s},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),t})();xe(["click"]);const wo=E('<p class="switch"><button class="switch__btn switch__btn--left">All</button><button class="switch__btn switch__btn--right">Favorite</button></p>'),yo=E('<div class="collection_cards"></div>'),So=E('<div class="collection_cards"><h2 class="collection__title"></h2></div>'),nr=n=>x(vt,{get class(){return"collection"+(n.class?` ${n.class}`:"")},get children(){return[(()=>{const t=wo.cloneNode(!0),e=t.firstChild,o=e.nextSibling;return e.$$click=()=>P("showFavoriteBoards",!1),o.$$click=()=>P("showFavoriteBoards",!0),Z(a=>{const s=!v.showFavoriteBoards,c=!!v.showFavoriteBoards;return s!==a._v$&&e.classList.toggle("switch__btn--active",a._v$=s),c!==a._v$2&&o.classList.toggle("switch__btn--active",a._v$2=c),a},{_v$:void 0,_v$2:void 0}),t})(),x(G,{get when(){return!v.showFavoriteBoards},get children(){return x(qe,{get each(){return Object.entries(vi).filter(([t])=>t!=="hidden")},children:([t,e])=>(()=>{const o=So.cloneNode(!0),a=o.firstChild;return I(a,t),I(o,x(qe,{each:e,children:s=>x(Tn,{get handlers(){return n.handlers},item:{key:s,img:`/boards/ico/${s}_ico.png`}})}),null),o})()})}}),x(G,{get when(){return v.showFavoriteBoards},get children(){const t=yo.cloneNode(!0);return I(t,x(qe,{get each(){return Rt.filter(e=>v.favoriteBoards.has(e))},children:e=>x(Tn,{get handlers(){return n.handlers},item:{key:e,img:`/boards/ico/${e}_ico.png`}})})),t}})]}});xe(["click"]);const $o=E('<a target="_blank" class="collection__action collection__stylus" title="Install via Stylus"></a>'),ko=E('<a class="collection__action collection__download" title="Download"></a>'),Ao=E('<div class="collection__card"><div></div><div class="collection__actions"><a href="" class="collection__action collection__favorite" title="Add to favorites"></a></div></div>'),Cn=n=>(()=>{const t=Ao.cloneNode(!0),e=t.firstChild,o=e.nextSibling,a=o.firstChild;return e.$$click=()=>{P("boardConfig","piecesStyle",n.item.key),n.handlers.changePiecesStyle(n.item.key)},oe(e,"draggable",!1),a.$$click=s=>{s.preventDefault(),n.handlers.toggleFavoritePieces(n.item.key)},I(o,x(G,{get when(){return!v.mobile},get children(){return[(()=>{const s=$o.cloneNode(!0);return Z(()=>oe(s,"href",`stylus/pieces/${n.item.key}${v.boardConfig.showShadows?"_shadows":""}.user.css`)),s})(),(()=>{const s=ko.cloneNode(!0);return Z(()=>oe(s,"href",`download/pieces/${n.item.key}.zip`)),s})()]}}),null),Z(s=>{const c="collection__ico"+(v.boardConfig.piecesStyle===n.item.key?" collection__ico--active":""),h=`url(${n.item.img})`,f=n.item.key,b=!!v.favoritePieces.has(n.item.key);return c!==s._v$&&bt(e,s._v$=c),h!==s._v$2&&e.style.setProperty("background-image",s._v$2=h),f!==s._v$3&&oe(e,"title",s._v$3=f),b!==s._v$4&&a.classList.toggle("collection__favorite--active",s._v$4=b),s},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),t})();xe(["click"]);const xo=E('<p class="switch"><button class="switch__btn switch__btn--left">All</button><button class="switch__btn switch__btn--right">Favorite</button></p>'),To=E('<div class="collection_cards"></div>'),Co=E('<div class="collection_cards"><h2 class="collection__title"></h2></div>'),rr=n=>x(vt,{get class(){return"collection"+(n.class?` ${n.class}`:"")},get children(){return[(()=>{const t=xo.cloneNode(!0),e=t.firstChild,o=e.nextSibling;return e.$$click=()=>P("showFavoritePieces",!1),o.$$click=()=>P("showFavoritePieces",!0),Z(a=>{const s=!v.showFavoritePieces,c=!!v.showFavoritePieces;return s!==a._v$&&e.classList.toggle("switch__btn--active",a._v$=s),c!==a._v$2&&o.classList.toggle("switch__btn--active",a._v$2=c),a},{_v$:void 0,_v$2:void 0}),t})(),x(G,{get when(){return!v.showFavoritePieces},get children(){return x(qe,{get each(){return Object.entries(Qe).filter(([t])=>t!=="hidden")},children:([t,e])=>(()=>{const o=Co.cloneNode(!0),a=o.firstChild;return I(a,t),I(o,x(qe,{each:e,children:s=>x(Cn,{get handlers(){return n.handlers},item:{key:s,img:`/pieces/${s}/nw.svg`}})}),null),o})()})}}),x(G,{get when(){return v.showFavoritePieces},get children(){const t=To.cloneNode(!0);return I(t,x(qe,{get each(){return Ot.filter(e=>v.favoritePieces.has(e))},children:e=>x(Cn,{get handlers(){return n.handlers},item:{key:e,img:`/pieces/${e}/nw.svg`}})})),t}})]}});xe(["click"]);const Eo=E("<button></button>"),Ve=n=>(()=>{const t=Eo.cloneNode(!0);return t.$$click=()=>n.setTab(n.name),I(t,()=>n.children),Z(()=>bt(t,"tab"+(n.isActive?" tab--active":""))),t})();xe(["click"]);const Po=E('<i class="las la-chess-board"></i>'),No=E('<i class="las la-chess"></i>'),Io=E('<div class="game"><div class="game-tabs"></div></div>'),ft=n=>{P("activeTab",n)},Oo=n=>(()=>{const t=Io.cloneNode(!0),e=t.firstChild;return I(e,x(Ve,{name:"game",setTab:ft,get isActive(){return v.activeTab==="game"},children:"GAME"}),null),I(e,x(Ve,{name:"load",setTab:ft,get isActive(){return v.activeTab==="load"},children:"LOAD"}),null),I(e,x(G,{get when(){return v.layout!=="triple"},get children(){return[x(Ve,{name:"share",setTab:ft,get isActive(){return v.activeTab==="share"},children:"SHARE"}),x(Ve,{name:"boards",setTab:ft,get isActive(){return v.activeTab==="boards"},get children(){return Po.cloneNode(!0)}}),x(Ve,{name:"pieces",setTab:ft,get isActive(){return v.activeTab==="pieces"},get children(){return No.cloneNode(!0)}})]}}),null),I(t,x(Dn,{get children(){return[x(We,{get when(){return v.activeTab==="game"},get children(){return[x(Yi,{get handlers(){return n.handlers}}),x(Gi,{get moves(){return n.moves},get handlers(){return n.handlers},get class(){return v.layout==="single"?"span2":void 0}}),x(G,{get when(){return v.layout!=="single"},get children(){return x(Qn,{get handlers(){return n.handlers}})}})]}}),x(We,{get when(){return v.activeTab==="load"},get children(){return x(co,{get handlers(){return n.handlers},class:"span3"})}}),x(G,{get when(){return v.layout!=="triple"},get children(){return[x(We,{get when(){return v.activeTab==="share"},get children(){return x(tr,{get handlers(){return n.handlers},class:"span3"})}}),x(We,{get when(){return v.activeTab==="boards"},get children(){return x(nr,{get handlers(){return n.handlers},class:"span3"})}}),x(We,{get when(){return v.activeTab==="pieces"},get children(){return x(rr,{get handlers(){return n.handlers},class:"span3"})}})]}})]}}),null),Z(()=>e.classList.toggle("game-tabs--condensed",v.layout!=="triple")),t})();const Lo=E('<i class="las la-share"></i>'),Ro=E('<i class="las la-chess-board"></i>'),Bo=E('<i class="las la-chess"></i>'),Mo=E('<div class="setup"><div class="setup-tabs"></div></div>'),Gt=n=>P("activeLeftTab",n),zo=n=>(()=>{const t=Mo.cloneNode(!0),e=t.firstChild;return I(e,x(Ve,{name:"share",setTab:Gt,get isActive(){return v.activeLeftTab==="share"},get children(){return[Lo.cloneNode(!0)," SHARE"]}}),null),I(e,x(Ve,{name:"boards",setTab:Gt,get isActive(){return v.activeLeftTab==="boards"},get children(){return[Ro.cloneNode(!0)," BOARDS"]}}),null),I(e,x(Ve,{name:"pieces",setTab:Gt,get isActive(){return v.activeLeftTab==="pieces"},get children(){return[Bo.cloneNode(!0)," PIECES"]}}),null),I(t,x(Dn,{get children(){return[x(We,{get when(){return v.activeLeftTab==="share"},get children(){return x(tr,{get handlers(){return n.handlers}})}}),x(We,{get when(){return v.activeLeftTab==="boards"},get children(){return x(nr,{get handlers(){return n.handlers}})}}),x(We,{get when(){return v.activeLeftTab==="pieces"},get children(){return x(rr,{get handlers(){return n.handlers}})}})]}}),null),t})();const Fo=E('<div class="popup"><div class="popup__box"><button class="popup__close"><i class="las la-times"></i></button><h2 class="popup__title"></h2><div class="popup__content"></div></div></div>'),an=n=>(()=>{const t=Fo.cloneNode(!0),e=t.firstChild,o=e.firstChild,a=o.nextSibling,s=a.nextSibling;return ue(o,"click",n.onClose,!0),I(a,()=>n.title),I(s,()=>n.children),t})();xe(["click"]);const ce=n=>{switch(n){case"board":localStorage.setItem("boardConfig",JSON.stringify(v.boardConfig));break;case"game":localStorage.setItem("gameConfig",JSON.stringify(v.gameConfig));break;case"site":localStorage.setItem("siteConfig",JSON.stringify(v.siteConfig));break;case"recent":localStorage.setItem("recent",JSON.stringify(v.recent));break;case"pieces":localStorage.setItem("pieces",JSON.stringify([...v.favoritePieces]));break;case"boards":localStorage.setItem("boards",JSON.stringify([...v.favoriteBoards]));break}},Do=E("<p>Saving files may not work correctly in this browser.</p>"),Ho=E("<p>To enjoy the full functionality of the website, please open it in <u><b>Safari</b></u>.</p>"),qo=()=>x(G,{get when(){return!v.siteConfig.iOSAppPopup&&v.siteConfig.wrongBrowserPopup&&v.os==="iOS"&&!v.browser?.includes("Safari")},get children(){return x(an,{onClose:()=>{P("siteConfig","wrongBrowserPopup",!1),ce("site")},title:"Note",get children(){return[Do.cloneNode(!0),Ho.cloneNode(!0)]}})}}),Go=E("<p>For easy access, you can install this website as a standalone app.</p>"),jo=E("<ul>To do that:<li>open the website in Chrome,</li><li>tap the menu icon (3 dots in the corner),</li><li>tap <u><b>Add to Home screen</b></u>.</li></ul>"),Wo=()=>x(G,{get when(){return v.siteConfig.androidAppPopup&&v.os?.includes("Android")},get children(){return x(an,{onClose:()=>{P("siteConfig","androidAppPopup",!1),ce("site")},title:"Tip",get children(){return[Go.cloneNode(!0),jo.cloneNode(!0)]}})}}),Uo=E("<p>For easy access, you can install this website as a standalone app.</p>"),Vo=E("<ul>To do that:<li>open the website in Safari,</li><li>tap the Share icon,</li><li>tap <u><b>Add to Home Screen</b></u>.</li></ul>"),Xo=()=>x(G,{get when(){return v.siteConfig.iOSAppPopup&&v.os?.includes("iOS")},get children(){return x(an,{onClose:()=>{P("siteConfig","iOSAppPopup",!1),ce("site")},title:"Tip",get children(){return[Uo.cloneNode(!0),Vo.cloneNode(!0)]}})}});const Ko=E('<div class="fs-popup"><div class="fs-popup__box"><button class="fs-popup__close"><i class="las la-times"></i></button><div></div></div></div>'),sn=n=>(()=>{const t=Ko.cloneNode(!0),e=t.firstChild,o=e.firstChild,a=o.nextSibling;return ue(o,"click",n.onCLose,!0),I(a,()=>n.children),Z(()=>bt(a,`fs-popup__content ${n.class}`)),t})();xe(["click"]);const Yo=E("<h2>About</h2>"),Qo=E("<p><b>ShareChess</b> is a free, open-source website that allows you to:</p>"),Zo=E('<ul class="about__features"><li>share chess games as self-contained replay links (the whole game is stored in the URL),</li><li>create images and animations of chess games and positions,</li><li>install additional chessboard styles and piece sets for major chess websites!</li></ul>'),Jo=E('<p>You can find the complete source code on my <a href="https://github.com/sharechess/sharechess">GitHub page</a>.</p>'),ea=E('<p>Follow my <a href="https://www.reddit.com/r/sharechess/" target="_blank">subreddit</a> for news, updates, and chess-related content!</p>'),ta=E("<hr>"),na=E("<h2>Keyboard Shortcuts</h2>"),ra=E('<div class="about__shortcuts"><ul><li><kbd>\u2192</kbd> Next move</li><li><kbd>\u2190</kbd> Previous move</li><li><kbd>\u2191</kbd> Start position</li><li><kbd>\u2193</kbd> Final position</li><li><kbd>f</kbd> Flip the board</li><li><kbd>Space</kbd> Play / Pause</li><li><kbd>Enter</kbd> Analyze on Lichess</li></ul><ul><li><kbd>l</kbd> Load from clipboard</li><li><kbd>a</kbd> Toggle anonymous</li><li><kbd>b</kbd> Toggle border</li><li><kbd>i</kbd> Toggle extra info</li><li><kbd>h</kbd> Toggle header (title screen)</li><li><kbd>s</kbd> Toggle shadows</li><li><kbd>p</kbd> Toggle puzzle view</li></ul></div>'),ia=()=>x(G,{get when(){return v.fullscreenPopup==="about"},get children(){return x(sn,{class:"about",onCLose:()=>P("fullscreenPopup",null),get children(){return[Yo.cloneNode(!0),Qo.cloneNode(!0),Zo.cloneNode(!0),Jo.cloneNode(!0),ea.cloneNode(!0),x(G,{get when(){return!v.mobile},get children(){return[ta.cloneNode(!0),na.cloneNode(!0),ra.cloneNode(!0)]}})]}})}});const oa=E('<p class="us-info__intro">You can install any chessboard and piece styles from this website for <!>by following the instructions below.</p>'),aa=E('<div class="us-info__steps"><div class="us-info__step"><h2 class="us-info__step-num">1</h2><h3 class="us-info__step-title">Install Stylus</h3><p class="us-info__description">Get the Stylus extension for your browser, that allows you to use custom styles on other websites.</p><p class="us-info__install-stylus"><a class="btn" target="_blank">Install the extension</a></p></div><div class="us-info__step"><h2 class="us-info__step-num">2</h2><h3 class="us-info__step-title">Choose your chessboard and pieces</h3><p class="us-info__description">Install any of the piece or chessboard styles by clicking the <img class="us-info__text-ico" src="img/stylus.svg" alt=""> icon on the chessboard / piece set card.</p><p class="us-info__description">This will open a stylesheet, click <strong>"Install / Reinstall style"</strong> button in the top left corner.</p><p class="us-info__browse"><button>Browse Chessboards</button><button>Browse Pieces</button></p></div><div class="us-info__step"><h2 class="us-info__step-num">3</h2><h3 class="us-info__step-title">Manage your styles</h3><p class="us-info__description">Toggle installed styles via Stylus extension menu. Pin the extension for easy access.</p><p class="us-info__manage-stylus"><img src="img/stylus-popup.png" alt=""></p></div></div>'),sa=E('<a target="_blank">, </a>'),En=n=>()=>{P("fullscreenPopup",null),v.layout==="triple"?P("activeLeftTab",n):P("activeTab",n)},la=["lichess.org","chess.com","openingtree.com","chessgames.com","chess24.com","chesstempo.com","listudy.org","chesspecker.com","chessbase.com","wikipedia.org","aimchess.com","chessable.com"],ca=()=>x(G,{get when(){return v.fullscreenPopup==="styles"},get children(){return x(sn,{class:"us-info",onCLose:()=>P("fullscreenPopup",null),get children(){return[(()=>{const n=oa.cloneNode(!0),t=n.firstChild,e=t.nextSibling;return e.nextSibling,I(n,x(qe,{each:la,children:o=>(()=>{const a=sa.cloneNode(!0),s=a.firstChild;return oe(a,"href",`https://${o}`),I(a,o,s),a})()}),e),n})(),(()=>{const n=aa.cloneNode(!0),t=n.firstChild,e=t.firstChild,o=e.nextSibling,a=o.nextSibling,s=a.nextSibling,c=s.firstChild,h=t.nextSibling,f=h.firstChild,b=f.nextSibling,p=b.nextSibling,r=p.nextSibling,i=r.nextSibling,l=i.firstChild,u=l.nextSibling;return ue(l,"click",En("boards"),!0),ue(u,"click",En("pieces"),!0),Z(()=>oe(c,"href",v.browser==="Chrome"?"https://chrome.google.com/webstore/detail/stylus/clngdbkpkpeebahjckkjfobafhncgmne":v.browser==="Firefox"?"https://addons.mozilla.org/pl/firefox/addon/styl-us/":"https://addons.opera.com/pl/extensions/details/stylus/")),n})()]}})}});xe(["click"]);const ua=E(`<p class="support__intro">If you like what I'm doing, you can support the project financially, contribute your work and ideas, and share the projects with others.</p>`),da=E(`<div class="support__methods"><div class="support__method"><img class="support__ico" src="img/github.svg" alt="contribute"><h2 class="support__title">Help improve the website</h2><p class="support__description">You can suggest improvements and report bugs via <a href="https://github.com/sharechess/sharechess/issues" target="_blank">GitHub Issues</a> or by messaging me on <a href="https://www.reddit.com/message/compose/?to=kap89&amp;subject=ShareChess%20issue" target="_blank">Reddit.</a></p><p class="support__description">If you are a programmer, you can contribute to the project directly. Yu can find the source code on my <a href="https://github.com/sharechess/sharechess" target="_blank">GitHub Page.</a></p></div><div class="support__method"><img class="support__ico support__ico--coffee" src="img/donate.svg" alt="donate"><h2 class="support__title">Buy me a coffee</h2><p class="support__description">The project is free for everyone, and does not use ads or trackers. It takes some time and effort, but I'm fine supporting it on my own.</p><p class="support__description">If you really want to, you can help fuel the development of the project by buying me a symbolic coffee!</p><a href="https://www.buymeacoffee.com/maciejcaderek" target="_blank" class="support__donate-btn btn">DONATE</a></div><div class="support__method"><img class="support__ico" src="img/artists.svg" alt="design"><h2 class="support__title">Design a chessboard or piece set</h2><p class="support__description">If you are an artist, or just like to create stuff, you can submit a new board design or a piece set.</p><p class="support__description">You can find instructions on how to prepare the assets on my <a href="https://github.com/sharechess/sharechess#designing-new-boards-and-piece-sets" target="_blank">GitHub page.</a></p><p class="support__description">Message me on <a href="https://www.reddit.com/message/compose/?to=kap89&amp;subject=ShareChess%20design" target="_blank">Reddit</a> or open a <a href="https://github.com/sharechess/sharechess/issues" target="_blank">GitHub issue</a> to coordinate the details.</p></div></div>`),fa=E("<hr>"),ha=E('<div class="support__share"><p class="support__subreddit">Follow my <a href="https://www.reddit.com/r/sharechess/" target="_blank">subreddit</a> for news, updates, and chess-related content!</p><p class="support__share-intro">Share the project with others, to help it grow!</p><div class="share__targets"><a class="resp-sharing-button__link" href="https://facebook.com/sharer/sharer.php?u=https%3A%2F%2Fsharechess.github.io" target="_blank" rel="noopener" aria-label="Facebook"><div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18.77 7.46H14.5v-1.9c0-.9.6-1.1 1-1.1h3V.5h-4.33C10.24.5 9.5 3.44 9.5 5.32v2.15h-3v4h3v12h5v-12h3.85l.42-4z"></path></svg></div>Facebook</div></a><a class="resp-sharing-button__link" href="https://twitter.com/intent/tweet/?text=ShareChess%20-%20chess%20with%20style!&amp;url=https%3A%2F%2Fsharechess.github.io" target="_blank" rel="noopener" aria-label="Twitter"><div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M23.44 4.83c-.8.37-1.5.38-2.22.02.93-.56.98-.96 1.32-2.02-.88.52-1.86.9-2.9 1.1-.82-.88-2-1.43-3.3-1.43-2.5 0-4.55 2.04-4.55 4.54 0 .36.03.7.1 1.04-3.77-.2-7.12-2-9.36-4.75-.4.67-.6 1.45-.6 2.3 0 1.56.8 2.95 2 3.77-.74-.03-1.44-.23-2.05-.57v.06c0 2.2 1.56 4.03 3.64 4.44-.67.2-1.37.2-2.06.08.58 1.8 2.26 3.12 4.25 3.16C5.78 18.1 3.37 18.74 1 18.46c2 1.3 4.4 2.04 6.97 2.04 8.35 0 12.92-6.92 12.92-12.93 0-.2 0-.4-.02-.6.9-.63 1.96-1.22 2.56-2.14z"></path></svg></div>Twitter</div></a><a class="resp-sharing-button__link" href="mailto:?subject=ShareChess%20-%20chess%20with%20style!&amp;body=https%3A%2F%2Fsharechess.github.io" target="_self" rel="noopener" aria-label="E-Mail"><div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22 4H2C.9 4 0 4.9 0 6v12c0 1.1.9 2 2 2h20c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zM7.25 14.43l-3.5 2c-.08.05-.17.07-.25.07-.17 0-.34-.1-.43-.25-.14-.24-.06-.55.18-.68l3.5-2c.24-.14.55-.06.68.18.14.24.06.55-.18.68zm4.75.07c-.1 0-.2-.03-.27-.08l-8.5-5.5c-.23-.15-.3-.46-.15-.7.15-.22.46-.3.7-.14L12 13.4l8.23-5.32c.23-.15.54-.08.7.15.14.23.07.54-.16.7l-8.5 5.5c-.08.04-.17.07-.27.07zm8.93 1.75c-.1.16-.26.25-.43.25-.08 0-.17-.02-.25-.07l-3.5-2c-.24-.13-.32-.44-.18-.68s.44-.32.68-.18l3.5 2c.24.13.32.44.18.68z"></path></svg></div>E-Mail</div></a><a class="resp-sharing-button__link" href="https://reddit.com/submit/?url=https%3A%2F%2Fsharechess.github.io&amp;resubmit=true&amp;title=ShareChess%20-%20chess%20with%20style!" target="_blank" rel="noopener" aria-label="Reddit"><div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M24 11.5c0-1.65-1.35-3-3-3-.96 0-1.86.48-2.42 1.24-1.64-1-3.75-1.64-6.07-1.72.08-1.1.4-3.05 1.52-3.7.72-.4 1.73-.24 3 .5C17.2 6.3 18.46 7.5 20 7.5c1.65 0 3-1.35 3-3s-1.35-3-3-3c-1.38 0-2.54.94-2.88 2.22-1.43-.72-2.64-.8-3.6-.25-1.64.94-1.95 3.47-2 4.55-2.33.08-4.45.7-6.1 1.72C4.86 8.98 3.96 8.5 3 8.5c-1.65 0-3 1.35-3 3 0 1.32.84 2.44 2.05 2.84-.03.22-.05.44-.05.66 0 3.86 4.5 7 10 7s10-3.14 10-7c0-.22-.02-.44-.05-.66 1.2-.4 2.05-1.54 2.05-2.84zM2.3 13.37C1.5 13.07 1 12.35 1 11.5c0-1.1.9-2 2-2 .64 0 1.22.32 1.6.82-1.1.85-1.92 1.9-2.3 3.05zm3.7.13c0-1.1.9-2 2-2s2 .9 2 2-.9 2-2 2-2-.9-2-2zm9.8 4.8c-1.08.63-2.42.96-3.8.96-1.4 0-2.74-.34-3.8-.95-.24-.13-.32-.44-.2-.68.15-.24.46-.32.7-.18 1.83 1.06 4.76 1.06 6.6 0 .23-.13.53-.05.67.2.14.23.06.54-.18.67zm.2-2.8c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm5.7-2.13c-.38-1.16-1.2-2.2-2.3-3.05.38-.5.97-.82 1.6-.82 1.1 0 2 .9 2 2 0 .84-.53 1.57-1.3 1.87z"></path></svg></div>Reddit</div></a><a class="resp-sharing-button__link" href="whatsapp://send?text=ShareChess%20-%20chess%20with%20style!%20https%3A%2F%2Fsharechess.github.io" target="_blank" rel="noopener" aria-label="WhatsApp"><div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.1 3.9C17.9 1.7 15 .5 12 .5 5.8.5.7 5.6.7 11.9c0 2 .5 3.9 1.5 5.6L.6 23.4l6-1.6c1.6.9 3.5 1.3 5.4 1.3 6.3 0 11.4-5.1 11.4-11.4-.1-2.8-1.2-5.7-3.3-7.8zM12 21.4c-1.7 0-3.3-.5-4.8-1.3l-.4-.2-3.5 1 1-3.4L4 17c-1-1.5-1.4-3.2-1.4-5.1 0-5.2 4.2-9.4 9.4-9.4 2.5 0 4.9 1 6.7 2.8 1.8 1.8 2.8 4.2 2.8 6.7-.1 5.2-4.3 9.4-9.5 9.4zm5.1-7.1c-.3-.1-1.7-.9-1.9-1-.3-.1-.5-.1-.7.1-.2.3-.8 1-.9 1.1-.2.2-.3.2-.6.1s-1.2-.5-2.3-1.4c-.9-.8-1.4-1.7-1.6-2-.2-.3 0-.5.1-.6s.3-.3.4-.5c.2-.1.3-.3.4-.5.1-.2 0-.4 0-.5C10 9 9.3 7.6 9 7c-.1-.4-.4-.3-.5-.3h-.6s-.4.1-.7.3c-.3.3-1 1-1 2.4s1 2.8 1.1 3c.1.2 2 3.1 4.9 4.3.7.3 1.2.5 1.6.6.7.2 1.3.2 1.8.1.6-.1 1.7-.7 1.9-1.3.2-.7.2-1.2.2-1.3-.1-.3-.3-.4-.6-.5z"></path></svg></div>WhatsApp</div></a><a class="resp-sharing-button__link" href="https://telegram.me/share/url?text=ShareChess%20-%20chess%20with%20style!&amp;url=https%3A%2F%2Fsharechess.github.io" target="_blank" rel="noopener" aria-label="Telegram"><div class="resp-sharing-button resp-sharing-button--telegram resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M.707 8.475C.275 8.64 0 9.508 0 9.508s.284.867.718 1.03l5.09 1.897 1.986 6.38a1.102 1.102 0 0 0 1.75.527l2.96-2.41a.405.405 0 0 1 .494-.013l5.34 3.87a1.1 1.1 0 0 0 1.046.135 1.1 1.1 0 0 0 .682-.803l3.91-18.795A1.102 1.102 0 0 0 22.5.075L.706 8.475z"></path></svg></div>Telegram</div></a></div></div>'),_a=()=>x(G,{get when(){return v.fullscreenPopup==="support"},get children(){return x(sn,{class:"support",onCLose:()=>P("fullscreenPopup",null),get children(){return[ua.cloneNode(!0),da.cloneNode(!0),fa.cloneNode(!0),ha.cloneNode(!0)]}})}}),pa=E('<div id="setup" class="setup-box"></div>'),ga=E('<div><div class="layout"><div id="board" class="board-box"><canvas class="board" id="canvas"></canvas></div><div id="moves" class="game-box"></div></div></div>'),ma=n=>(()=>{const t=ga.cloneNode(!0),e=t.firstChild,o=e.firstChild;o.firstChild;const a=o.nextSibling;return I(t,x(Bi,{get handlers(){return n.handlers}}),e),I(e,x(G,{get when(){return v.layout==="triple"},get children(){const s=pa.cloneNode(!0);return I(s,x(zo,{get handlers(){return n.handlers}})),s}}),o),I(o,x(G,{get when(){return v.layout==="single"},get children(){return x(Qn,{get handlers(){return n.handlers}})}}),null),I(a,x(Oo,{get moves(){return n.state.moves},get handlers(){return n.handlers}})),I(t,x(ia,{}),null),I(t,x(ca,{}),null),I(t,x(_a,{}),null),I(t,x(qo,{}),null),I(t,x(Wo,{}),null),I(t,x(Xo,{}),null),Z(s=>{const c=!v.siteConfig.darkMode,h=v.layout==="double";return c!==s._v$&&t.classList.toggle("light",s._v$=c),h!==s._v$2&&o.classList.toggle("board-box--left",s._v$2=h),s},{_v$:void 0,_v$2:void 0}),t})(),ir={XS:360,S:512,M:720,L:1024,XL:1440},ba=async(n,t,e=0,o,a)=>{const s=new st;t?s.loadPGN(t):s.loadFEN(n);const c=new tn;await c.init({...o,size:ir[a]});const h=s.getPosition(e);return await c.frame(h,s.header),c.render(),c.toImgUrl()},va="modulepreload",Pn={},wa="/",jt=function(t,e){return!e||e.length===0?t():Promise.all(e.map(o=>{if(o=`${wa}${o}`,o in Pn)return;Pn[o]=!0;const a=o.endsWith(".css"),s=a?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${o}"]${s}`))return;const c=document.createElement("link");if(c.rel=a?"stylesheet":va,a||(c.as="script",c.crossOrigin=""),c.href=o,document.head.appendChild(c),a)return new Promise((h,f)=>{c.addEventListener("load",h),c.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>t())},ya=async(n,t,e,o,a)=>{const s=new st().loadPGN(n),c=new tn;await c.init({...t,size:ir[o]});const h=(await jt(e==="GIF"?()=>import("./GIF.b30f0300.js"):e==="MP4"?()=>import("./MP4.b21fca90.js"):()=>import("./WebM.13faa943.js"),[])).default,f=new h(c.width,c.height,!0),b=s.header;a&&(await c.titleFrame(b),c.render(),await f.add(c,4));for(let p=0;p<s.length;p++){const r=s.getPosition(p);await c.frame(r,b),c.render();const i=r.end===0?5:r.ply===0&&!a?2:1;await f.add(c,i)}return await f.render()},Sa=/^([1-8kqrbnp]+\/)+[1-8kqrbnp]+ [wb] ([kq]+|-) ([a-h1-8]{2}|-) \d+ \d+$/i,$a=n=>Sa.test(n.trim()),ka=/((\[[a-z0-9]+ +"[^"\n\r]+"](\r\n|\r|\n))*(\r\n|\r|\n)+){0,1}\d+\. *[a-h1-8x+#=.]+/i,Aa=n=>ka.test(n),xa=async(n,t)=>{if(t&&/^https:\/\/lichess\.org\/.{8}/.test(t))return t;const e=new URLSearchParams({pgn:n}).toString();try{const o=await fetch("https://lichess.org/api/import",{headers:{"content-type":"application/x-www-form-urlencoded"},body:e,method:"POST"});if(o.status===200)return(await o.json()).url;throw new Error("Cannot import to lichess")}catch{throw new Error("Cannot import to lichess")}},Ta=(n,t)=>Math.round(Math.random()*(n-t))+t,Nn=n=>{const t=Ta(0,n.length-1);return n[t]},Ca=20,Ea=(n,t)=>({prev(){n.pause(),n.prev()},next(){n.pause(),n.next()},first(){n.pause(),n.first()},last(){n.pause(),n.last()},togglePlay(){n.playing?n.pause():n.play()},goto(e){n.pause(),n.goto(e)},toggleBorder(){t.toggleBorder(),P("boardConfig","showBorder",!v.boardConfig.showBorder),ce("board")},showBorder(){t.showBorder(),P("boardConfig","showBorder",!0),ce("board")},hideBorder(){t.hideBorder(),P("boardConfig","showBorder",!1),ce("board")},toggleExtraInfo(){t.toggleExtraInfo(),P("boardConfig","showExtraInfo",!v.boardConfig.showExtraInfo),ce("board")},toggleAnonymous(){if(P("anonymous",!v.anonymous),t.anonymous=v.anonymous,v.pgn!==""){const e=v.anonymous?v.game.anonymousPGN:v.game.pgn;at.set({pgn:e}),P("refreshHash",!1)}},toggleTitleScreen(){P("gameConfig","titleScreen",!v.gameConfig.titleScreen),ce("game")},toggleShadows(){t.toggleShadows(),P("boardConfig","showShadows",!v.boardConfig.showShadows),ce("board")},flip(){const e=v.recent.findIndex(o=>o.hash===location.hash);t.flip(),P("boardConfig","flipped",!v.boardConfig.flipped),P("refreshHash",!1),at.set({side:v.boardConfig.flipped?"b":"w"}),e!==-1&&(P("recent",e,"hash",location.hash),ce("recent"))},changeBoardStyle(e){t.setStyle(e),P("boardConfig","boardStyle",e),ce("board")},changePiecesStyle(e){t.setPiecesStyle(e),P("boardConfig","piecesStyle",e),ce("board")},async loadPGN(e,o="w",a=0){const s=new st().loadPGN(e);P({pgn:s.pgn,fen:"",moves:s.getMoves(),ply:0,game:s}),at.set({pgn:s.pgn,side:o,ply:a}),await n.load(s),P("activeTab","game"),o==="w"?t.flipWhite():t.flipBlack(),P("boardConfig","flipped",o==="b"),document.title=`ShareChess - ${s.getTitle({anonymous:!1})}`,location.hash!==""&&(P("recent",c=>{const h=c.filter(({hash:f})=>f!==location.hash);return h.unshift({hash:location.hash,title:s.getShortTitle({anonymous:v.anonymous})}),h.slice(0,Ca)}),ce("recent"))},async loadFEN(e,o=!0){const a=new st().loadFEN(e);P({pgn:"",fen:e,moves:a.getMoves(),ply:0,game:a}),await n.load(a),o&&(at.set({fen:v.fen}),P("activeTab","game"));const s=a.getPosition(0).turn;s==="w"?t.flipWhite():t.flipBlack(),P("boardConfig","flipped",s==="b"),document.title=e==="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1"?"ShareChess - Chess With Style":`ShareChess - FEN ${e}`},async load(e){return P("refreshHash",!1),$a(e)?(await this.loadFEN(e),!0):Aa(e)?(await this.loadPGN(e),!0):Zn(e)?(await this.importPGN(e),!0):!1},async loadFromClipboard(){const e=await navigator.clipboard.readText();return this.load(e)},async importPGN(e){const o=await uo(e);o.error||await this.loadPGN(o.pgn,o.side)},async downloadImage(){await new Promise(o=>setTimeout(o,0));const e=await ba(v.fen,v.pgn,v.ply,v.boardConfig,v.gameConfig.picSize);Qt(e,`fen_${Date.now()}`,"png")},async downloadAnimation(){await new Promise(a=>setTimeout(a,0));const e=await ya(v.pgn,v.boardConfig,v.gameConfig.format,v.gameConfig.animationSize,v.gameConfig.titleScreen),o=v.game.getFileName(v.anonymous);Qt(e,o,v.gameConfig.format.toLowerCase())},toggleSound(){P("siteConfig","sounds",!v.siteConfig.sounds),ce("site")},toggleSpeech(){P("siteConfig","speech",!v.siteConfig.speech),ce("site")},toggleDarkMode(){P("siteConfig","darkMode",!v.siteConfig.darkMode),ce("site")},async openOnLichess(){if(v.pgn==="")return window.open(`https://lichess.org/analysis/${v.fen.replace(/\s+/g,"_")}`),!0;try{const e=await xa(v.pgn,v.game.header.Site);return window.open(`${e}/${v.boardConfig.flipped?"black":""}`),!0}catch{return!1}},toggleFavoritePieces(e){v.favoritePieces.has(e)?P("favoritePieces",o=>{const a=new Set([...o]);return a.delete(e),a}):P("favoritePieces",o=>{const a=new Set([...o]);return a.add(e),a}),ce("pieces")},toggleFavoriteBoard(e){v.favoriteBoards.has(e)?P("favoriteBoards",o=>{const a=new Set([...o]);return a.delete(e),a}):P("favoriteBoards",o=>{const a=new Set([...o]);return a.add(e),a}),ce("boards")},clearRecent(e){e.preventDefault(),P("recent",v.recent.filter(o=>o.hash===location.hash)),ce("recent")},deleteRecent(e){P("recent",o=>o.filter(s=>s.hash!==e)),ce("recent")},async loadGameOfTheDay(){const e=new Date,o=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0"),c=`daily-games/${a}.${s}.json`,f=await(await fetch(c)).json(),b=o%f.length,p=f[b];location.hash=`#pgn/w/0/${p}`},async randomStyle(){const e=Nn(Rt),o=Nn(Ot);await t.setAllStyles(o,e),P("boardConfig","boardStyle",e),P("boardConfig","piecesStyle",o),ce("board")},togglePuzzle(){t.togglePuzzle(),P("boardConfig","puzzle",!v.boardConfig.puzzle),ce("board")}}),or=async(n,t,e)=>{P("refreshHash",n);const{pgn:o,fen:a,side:s,ply:c,boardStyle:h,piecesStyle:f}=await at.read();await(o?t.loadPGN(o,s,c):a?t.loadFEN(a):t.loadFEN("rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",!1)),c!==0&&t.goto(c),h&&Rt.includes(h)&&(P("boardConfig","boardStyle",h),e.setStyle(h)),f&&Ot.includes(f)&&(P("boardConfig","piecesStyle",f),e.setPiecesStyle(f)),P("refreshHash",!0)},Pa=(n,t)=>{if(document.addEventListener("dblclick",function(e){e.preventDefault()}),window.addEventListener("resize",()=>{P("layout",window.innerWidth<window.innerHeight?"single":window.innerWidth<1366?"double":"triple")}),window.addEventListener("hashchange",()=>{if(!v.refreshHash){P("refreshHash",!0);return}or(!0,n,t)}),!v.mobile){const e={ArrowLeft:n.prev,ArrowRight:n.next,ArrowUp:n.first,ArrowDown:n.last,f:n.flip," ":n.togglePlay,Enter:n.openOnLichess,l:n.loadFromClipboard.bind(n),a:n.toggleAnonymous,b:n.toggleBorder,i:n.toggleExtraInfo,h:n.toggleTitleScreen,s:n.toggleShadows,p:n.togglePuzzle};document.addEventListener("keydown",a=>{const s=a.target;e[a.key]&&s?.nodeName!=="INPUT"&&s?.nodeName!=="TEXTAREA"&&(a.preventDefault(),e[a.key]())});const o=a=>{a.preventDefault(),a.stopPropagation()};["dragenter","dragover","dragleave","drop"].forEach(a=>{document.addEventListener(a,o,!1)}),document.addEventListener("drop",async a=>{if(a.dataTransfer?.files&&a.dataTransfer.files.length>0){const s=await Jn(a.dataTransfer.files[0]);P("refreshHash",!1),n.loadPGN(s)}})}},Na=async()=>{const n=new tn;await n.init(),console.log(v.boardConfig),await n.init(v.boardConfig);const t=new Ni(n,v.gameConfig);t.watch(a=>P("playing",a));const e=Ea(t,n);wr(()=>x(ma,{handlers:e,state:v}),document.getElementById("root"));const o=document.getElementById("canvas");await n.setCanvas(o),await t.init(),await or(!1,e,n),Pa(e,n)};Na();export{Ia as __vite_legacy_guard,La as c,Oa as g};
